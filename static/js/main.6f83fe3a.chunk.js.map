{"version":3,"sources":["images/logo.png","images/AnalyticalChemistry.png","images/LabSupplies.png","images/LifeScience.png","images/MaterialScience.png","images/OrganicChemistry.png","mainSubs/mainSubs.tsx","mainSubs/render.tsx","mainSubs/index.ts","images/pig.png","tools/groupByProduct.ts","cart/Cart.ts","CurrentUser.ts","CBase.ts","home/VSearchHeader.tsx","home/VSiteHeader.tsx","home/VHome.tsx","home/CHome.tsx","cart/VCartLabel.tsx","tools/minusPlusWidget.tsx","cart/VCart.tsx","cart/CCart.tsx","tools/productImage.tsx","product/VProductView.tsx","product/VProduct.tsx","product/VProductList.tsx","mainSubs/loader.ts","tools/productChemical.ts","product/itemLoader.ts","product/VProductDelivery.tsx","product/VChemicalInfo.tsx","product/CProduct.tsx","me/loginTop.tsx","tvs/common.tsx","tvs/product.tsx","tvs/customer.tsx","tvs/index.tsx","tvs/warehouse.tsx","tvs/order.tsx","configuration.ts","order/VCreateOrder.tsx","order/Order.ts","order/OrderSuccess.tsx","customer/VContactList.tsx","tools/inputValidations.ts","customer/VContact.tsx","customer/VAddress.tsx","customer/CAddress.tsx","customer/CSelectContact.tsx","order/VMyOrders.tsx","order/VOrderDetail.tsx","customer/VInvoiceInfo.tsx","customer/CInvoiceInfo.tsx","order/COrder.tsx","productCategory/VRootCategory.tsx","productCategory/VCategory.tsx","productCategory/CProductCategory.tsx","member/VMember.tsx","member/CMember.tsx","me/about.tsx","me/EditMeInfo.tsx","me/aboutThisApp.tsx","me/privacy.tsx","me/VMe.tsx","me/EditMeInfoFirstOrder.tsx","pointMarket/VPointProduct.tsx","pointMarket/VExchangeOrder.tsx","pointMarket/VPointRule.tsx","pointMarket/VMyPoint.tsx","pointMarket/OrderSuccess.tsx","pointMarket/pointOrder.ts","pointMarket/VExchangeHistoryDetail.tsx","pointMarket/VExchangeHistory.tsx","pointMarket/VPlatformOrderPoint.tsx","pointMarket/CPointProduct.tsx","me/CMe.tsx","ui/main.tsx","coupon/VCouponEdit.tsx","coupon/VSharedCoupon.tsx","coupon/CCoupon.tsx","CApp.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","ViewBase","model","ViewMainSubs","main","sub","renderSubs","subsContainer","renderSubItems","subViews","subs","this","map","v","index","key","groupByProduct","packItems","result","packItem","product","pack","quantity","price","currency","packRow","id","cpi","find","e","undefined","packs","push","sort","a","b","Cart","cApp","cartStore","disposer","cartItems","count","observable","box","amount","calcSum","cp","$isSelected","$isDeleted","pi","Number","NaN","set","parseFloat","toFixed","add","cartItemExists","createdate","Date","now","splice","packExists","added","length","unshift","storeCart","data","list","autorun","isLogined","CartRemote","CartLocal","load","cartData","cartDataGrouped","i","productId","packId","cpp","findIndex","filter","rows","forEach","pe","cartItemIndex","cartItem","removeFromCart","CartStore","uqs","order","GetCart","page","SetCart","submit","param","RemoveFromCart","productTuid","packTuid","ProductX","div","cartstring","localStorage","getItem","JSON","parse","cartDataBoxed","productbox","boxId","packbox","removeItem","equ","setItem","stringify","WebUser","name","nick","icon","guest","token","gender","salutation","departmentName","telephone","email","fax","address","addressString","zipCode","_user","webUserSettings","setUser","user","loadWebUser","currentCustomer","buyerAccount","organizationName","invoiceInfo","obj","shippingContact","invoiceContact","firstName","mobile","webUserTuid","webuser","WebUserContact","WebUserSetting","WebUserCustomer","WebUserBuyerAccount","webUser","contact","value","Customer","customer","init","query","accountValue","buyerAccounts","ret","WebUserContacts","table","contactId","arr1","Contact","save","newContact","newContactId","addContact","newContactBox","setDefaultShippingContact","del","saveDefaultSettings","invoiceTypeId","invoiceInfoId","invoiceType","webUserContact","getPoints","computed","customerSettings","Contractor","CustomerContacts","CustomerSetting","customerContactorMap","contractor","setDefaultSettings","积分商城","CUqBase","_cApp","_uqs","CBase","VSearchHeader","CSub","onSearch","controller","cProduct","topKey","nav","popTo","start","size","className","placeholder","View","VSiteHeader","left","src","logo","alt","style","height","width","right","renderSearchHeader","VHome","header","content","renderCategoryRootList","siteHeader","renderVm","openPage","CHome","PageItems","homeSections","sectionTuid","renderView","cProductCategory","renderRootList","tab","openVPage","VCartLabel","showCart","observer","badge","onClick","pointer","cart","get","classNames","keys","MinusPlusWidget","minusClick","getValue","setValue","plusClick","ref","input","p","parentElement","tagName","disabled","renderContent","renderTemplet","cn","hasError","itemSchema","required","cursorPointer","minusColor","plusColor","hasFocus","hasAction","readOnly","hasValue","isNaN","minus","invisible","type","defaultValue","onChange","onKeyDown","onFocus","evt","onBlur","maxLength","plus","renderErrors","UpdownWidget","cartSchema","arr","VCart","CheckOutButton","checkOut","renderCartItem","item","onProductClick","renderCartProduct","packsRow","tv","renderDeliveryTime","uiSchema","selectable","deletable","restorable","items","widget","Templet","ArrContainer","label","RowContainer","RowSeperator","WidgetClass","onChanged","onQuantityChanged","cartForm","schema","formData","params","footer","empty","VPage","CCart","selectedCartItems","context","prev","parentData","onRowStateChanged","selected","deleted","alert","loginCallback","currentUser","loginCallBack","closePage","doFirstOrderChecking","isDeleted","showProductDetail","getSelectedItems","showLogin","cMe","allowOrdering","openMeInfoFirstOrder","doCheckOut","cOrder","imagePath","pointProductImagePath","altimagePath","ProductImage","props","chemicalId","substr","altImage","PointProductImage","VCartProuductView","brand","description","descriptionC","origin","imageUrl","productPropItem","renderChemicalInfoInCart","renderBrand","VProuductView","renderProduct","productBox","getProudct","getProductAndDiscount","discount","VProductPrice","retail","vipPrice","promotionPrice","minPrice","visible","initPrices","salesRegionId","prices","getProductPrice","priceUI","SalesRegionId","renderPrice","retailUI","Math","min","Infinity","currentSalesRegion","VProductWithPrice","renderProductPrice","caption","captionClass","capClass","valClass","CAS","purity","molecularFomula","molecularWeight","VProduct","arrTemplet","renderPack","cHome","cartLabel","cCart","renderCartLabel","viewProduct","render","productData","VProductList","searchKey","onScrollBottom","scroller","scrollToBottom","pageProducts","more","none","before","Loader","entities","schemaLoaded","Promise","all","loadSchemas","initData","loadToData","LoaderProductChemical","ProductChemical","productChemical","chemical","LoaderBrand","brandId","Brand","LoaderProductWithChemical","_","merge","brandLoader","productChemicalLoader","packx","LoaderProductChemicalWithPrices","customerDiscount","promotion","productLoader","currentLanguage","hasCustomer","GetDiscount","discountSetting","currentSalesRegionId","PriceX","salesRegion","discountinued","expireDate","element","round","getQuantity","promises","GetPromotionPack","language","results","VProductDelivery","initInventoryAllocation","inventoryAllocation","getInventoryAllocation","initFutureDeliveryTimeDescription","futureDeliveryTimeDescription","getFutureDeliveryTimeDescription","warehouse","deliveryTimeDescription","values","packObj","owner","VChemicalInfoInCart","chemicalInfo","chemicalInfoContainer","getChemicalInfo","PageProducts","searchProductQuery","firstSize","pageSize","pageStart","seq","CProduct","loader","renderProductWithPrice","priceSet","GetInventoryAllocation","cacheId","futureDeliveryTimeDescriptionContainer","GetFutureDeliveryTime","futureDeliveryTime","minValue","maxValue","unit","searchByKey","SearchProduct","first","keyWord","category","SearchProductByCategory","productCategoryId","productCategory","jnkTop","tvAddress","country","province","city","county","tvCountry","chineseName","tvCurrency","tvProduct","tvContact","tvs","common","productx","radiox","radioy","children","title","taxNo","appConfig","appName","version","loginTop","oem","GLOABLE_TEST","OrganicChemistry","AnalyticalChemistry","LifeScience","MaterialScience","LabSupplies","CHINA","CHINESE","SALESREGION_CN","ROOTCATEGORY","7","labelColor","430","986","1214","1545","TIPDISPLAYTIME","VCreateOrder","nullContact","renderOrderItem","orderItem","renderOrderItemProduct","orderItemKey","renderCoupon","couponData","offsetUI","remittedUI","noOffsetUI","code","types","preferential","validitydate","isValid","couponOffsetAmount","couponRemitted","couponCredits","onBuyerAccountChanged","renderBuyerAccount","organization","o","renderBuyerAccounts","onSelect","onSubmit","orderData","shippingAddressIsBlank","setTimeout","GLOABLE","useShippingAddress","invoiceAddressIsBlank","invoiceIsBlank","submitOrder","onSelectShippingContact","onSelectInvoiceContact","onInvoiceInfoEdit","onCouponEdit","fontSize","chevronRight","shippingAddressBlankTip","invoiceAddressBlankTip","divInvoiceContact","invoiceContactUI","defaultChecked","currentTarget","checked","invoiceBlankTip","invoiceInfoUI","freightFeeUI","freightFeeRemittedUI","freightFee","freightFeeRemitted","couponUI","orderItems","productAmount","Order","oi","pk","subAmount","coupon","orderitems","reduce","pv","cv","subListAmount","OrderItem","c","OrderSuccess","orderCreateResult","back","no","VContactList","onContactRender","onEditContact","onContactSelected","onNewContact","userContacts","contactList","telephoneValidation","test","mobileValidation","emailValidation","faxValidation","addressDetailValidation","zipCodeValidation","organizationNameValidation","nameValidation","VContact","userContactData","form","rules","pickId","pickAddress","addressValue","isDefault","onSaveContact","buttonClick","onFormButtonClick","saveContact","onDelContact","vCall","VConfirmDeleteContact","delContact","buttonDel","contactData","clone","defaultOrganizationName","defaultName","defaultMobile","fromOrderCreation","onButtonClick","fieldLabelSize","onConfirm","returnCall","onCancel","top","VAddress","provinceId","cityId","countyId","backLevel","provinces","renderPCC","onProvinceClick","pcc","border","marginRight","marginBottom","getProvinceCities","cities","len","onCityClick","openPageElement","saveAddress","getCityCounties","counties","onCountyClick","getCountryProvince","CAddress","countryId","GetCountryProvinces","GetProvinceCities","GetCityCounties","Address","newAddress","addressId","CSelectContact","userContact","userContactId","getSetting","userSetting","getIsDefault","setDefaultContact","contactTuid","contactBox","backPage","cAddress","newC","call","getContacts","userContactMaps","CSelectShippingContact","CSelectInvoiceContact","setDefaultInvoiceContact","VMyOrders","currentState","renderOrder","openOrderDetail","date","discription","flow","tabs","processingOrders","isSelected","getMyOrders","completedOrders","allOrders","tabPosition","VOrderDetail","brief","state","invoiceTypeUI","invoiceTemplate","bank","accountNo","regArr","j","commonRequired","valueAddedRequired","commonVisible","valueAddedVisible","VInvoiceInfo","saveTip","invoiceInfoData","invoice","saveInvoiceInfo","showTip","onSaveInvoice","onInvoiceTypeClick","event","parseInt","frm","buildForm","tipUI","role","htmlFor","origInvoice","assure","requiredFields","visibleFields","CInvoiceInfo","InvoiceInfo","newInvoiceInfo","newInvoiceInfoId","invoiceBox","InvoiceType","setDefaultInvoice","FREIGHTFEEFIXED","FREIGHTFEEREMITTEDSTARTPOINT","COrder","createOrderFromCart","currentCouponCode","removeCoupon","buyerAccountQResult","getDefaultShippingContact","getDefaultInvoiceContact","getDefaultInvoiceType","getDefaultInvoiceInfo","cCoupon","getCouponValidationResult","applyCoupon","defaultSetting","contact0","getDataForSave","action","cSelect","validationResult","getTime","AgentPrice","agentPrices","eachProductAgentPrice","agentPrice","max","openMyOrders","GetPendingPayment","mySheets","presult","concat","cInvoiceInfo","newInvoice","orderId","getSheet","orderItemsGrouped","openMeInfo","contactArr","getDefaultSetting","getContact","VRootCategory","categoryClick","categoryWapper","parent","openMainPage","renderRootCategory","productCategoryID","renderSubCategory","subsub","total","renderThirdCategory","categories","rootCategories","root","console","log","VCategory","childWapper","categoryWaper","CProductCategory","ProductCategory","stopCache","GetRootCategory","secend","third","buildCategories","parentCategoryId","GetChildrenCategory","firstCategory","secendCategory","catId","f","pcid","getCategoryChildren","rootCategory","searchByCategory","stylePig","backgroundImage","pig","backgroundSize","backgroundColor","opacity","position","VMember","recommendationCodeRef","React","member","recommendationCode","point","im","inviteCode","divPoints","pointThisWeek","pointAll","fansTitle","fansDetail","submitRecommendationCode","current","setReferrer","CMember","referrer","pop","internalStart","currentUserId","MemberAction","MemberRecommender","fans","About","dangerouslySetInnerHTML","__html","marked","EditMeInfo","onItemChanged","newValue","preValue","userApi","userSetProp","saveLocalUser","onWebUserChanged","webUserData","changeWebUser","onWebUserContactChanged","webUserContactData","changeWebUserContact","webUserSchema","webUserUiSchema","webUserContactSchema","webUserContactUiSchema","AboutThisApp","Privacy","privacy","getCommonText","VMe","about","aboutThisApp","changePassword","openContactList","openInvoice","openPoint","meInfo","userSpan","String","orderStates","aboutRows","component","iconClass","text","logOutRows","bk","exit","showLogout","EditMeInfoFirstOrder","addContactFromAccount","doCheckout","tips","tipsUI","VPointProduct","renderPointProduct","pointProduct","openExchangeOrder","pointsSum","myPointSum","productIsNull","pointIsEnough","pointProducts","ExchangePoint","productIsNullTip","pointIsEnoughTip","VExchangeOrder","pointProductsSelected","VPointRule","VMyPoint","openPointProduct","openExchangeHistory","openPlatformOrderPoint","remarks","myPointInvalid","dateYear","getFullYear","nowPoint","nowPointTip","actions","pointOrder","exchangeItems","exchangeitems","VExchangeHistoryDetail","renderexchangeItem","VExchangeHistory","renderExchangeHistory","exchangeHistory","VPlatformOrderPoint","orderIdInput","couponInput","currentCredits","applyCouponOrder","applyOrder","addPlatformOrderPoint","retOrder","retCoupon","tip","CPointProduct","getPointsProducts","PointExchangeSheet","credits","getPointProduct","getExchangeSheets","IsContain","nowQuantity","getOrderValidationResult","rtn","IsCanUseOrder","couponId","salesTask","IsCanUseCoupon","AddPoint","AddPlatformOrderPoint","myPoints","usedPoint","pointYear","CMe","pick","cPointProduct","textId","CommonText","color","VMain","cMember","faceTabs","notify","TabCaptionComponent","VCouponEdit","VSharedCoupon","couponValidationResult","products","couponUi","codeShow","p1","p2","discountShow","CCoupon","showSharedCoupon","productids","productidArray","split","CApp","SalesRegion","Language","showMain","document","location","search","qs","toLowerCase","prouductBoxId","initTabName","dispose","CAppBase","setSettings","App","onLogined","notLogined","Boolean","window","hostname","match","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.6f83fe3a.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/AnalyticalChemistry.f85ff3e0.png\";","module.exports = __webpack_public_path__ + \"static/media/LabSupplies.3f6ce00f.png\";","module.exports = __webpack_public_path__ + \"static/media/LifeScience.5c2e6ff5.png\";","module.exports = __webpack_public_path__ + \"static/media/MaterialScience.f2439aa0.png\";","module.exports = __webpack_public_path__ + \"static/media/OrganicChemistry.6d56971c.png\";","import * as React from 'react';\r\nimport { Render } from './render';\r\n\r\nexport interface MainSubs<M, S> {\r\n    main: M;\r\n    subs: S[];\r\n}\r\n\r\nexport abstract class ViewBase<T> {\r\n    model: T;\r\n    abstract render(): JSX.Element;\r\n}\r\n\r\nexport class ViewMainSubs<M, S> extends ViewBase<MainSubs<M, S>> {\r\n    protected main: Render<M>;\r\n    protected sub: Render<S>;\r\n    constructor(main: Render<M>, sub: Render<S>) {\r\n        super();\r\n        this.main = main;\r\n        this.sub = sub;\r\n    }\r\n    protected subsContainer(subViews: JSX.Element[]): JSX.Element {\r\n        return <div>{subViews}</div>\r\n    }\r\n\r\n    protected renderSubItems(): JSX.Element[] {\r\n        let { subs } = this.model;\r\n        if (!subs) return null;\r\n        let subViews: JSX.Element[] = subs.map((v, index) => {\r\n            return <this.sub key={index} {...v} />;\r\n        });\r\n        return subViews;\r\n    }\r\n\r\n    protected renderSubs = (): JSX.Element => {\r\n        return this.subsContainer(this.renderSubItems());\r\n    }\r\n\r\n    render(): JSX.Element {\r\n        let { main } = this.model;\r\n        return <>\r\n            <this.main {...main} />\r\n            <this.renderSubs />\r\n        </>;\r\n    }\r\n}\r\n\r\nexport class ViewListMainSubs<M, S> extends ViewBase<MainSubs<M, S>[]> {\r\n    private row: new (main: Render<M>, sub: Render<S>) => ViewMainSubs<M, S>;\r\n    private main: Render<M>;\r\n    private sub: Render<S>;\r\n    constructor(\r\n        row: new (main: Render<M>, sub: Render<S>) => ViewMainSubs<M, S>,\r\n        main: Render<M>,\r\n        sub: Render<S>) {\r\n        super();\r\n        this.row = row;\r\n        this.main = main;\r\n        this.sub = sub;\r\n    }\r\n    render(): JSX.Element {\r\n        return <>\r\n            {this.model.map((v, index) => {\r\n                let view = new this.row(this.main, this.sub);\r\n                view.model = v;\r\n                return <React.Fragment key={index}>{view.render()}</React.Fragment>;\r\n            })}\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { MainProduct, SubPack } from './model';\r\n\r\nexport type Render<T> = (model: T) => JSX.Element;\r\n\r\nexport function renderMainProduct(model: MainProduct): JSX.Element {\r\n    return <div>\r\n        {model.description}\r\n    </div>\r\n}\r\n\r\nexport function renderSubPack(model: SubPack): JSX.Element {\r\n    let { pack, vipPrice, price, quantity, amount } = model;\r\n    return <div>\r\n        {pack.unit}, {vipPrice}, {price}, {quantity}, {amount}\r\n    </div>\r\n}\r\n","export * from './mainSubs';\r\nexport * from './model';\r\nexport * from './render';\r\n","module.exports = __webpack_public_path__ + \"static/media/pig.772a31a6.png\";","\r\nexport function groupByProduct(packItems: any[]) {\r\n    let result: any[] = [];\r\n    for (let packItem of packItems.sort((a, b) => a.price - b.price)) {\r\n        let { product, pack, quantity, price, currency } = packItem;\r\n        let packRow: any = {\r\n            pack: pack,\r\n            price: price,\r\n            quantity: quantity,\r\n            currency: currency && currency.id\r\n        }\r\n        let cpi = result.find(e => e.product.id === product.id);\r\n        if (cpi === undefined) {\r\n            cpi = { product: product, packs: [] };\r\n            result.push(cpi);\r\n        }\r\n        cpi.packs.push(packRow);\r\n    }\r\n    return result;\r\n}","import { observable, autorun, IReactionDisposer } from 'mobx';\r\nimport { Action, Query, TuidDiv, BoxId, Tuid } from 'tonva';\r\n//import { CCartApp } from '../CCartApp';\r\nimport { PackRow } from 'product/Product';\r\nimport { groupByProduct } from 'tools/groupByProduct';\r\nimport { CApp } from '../CApp';\r\n\r\nexport interface CartItem2 {\r\n    product: BoxId;\r\n    packs: CartPackRow[];\r\n    $isSelected?: boolean;\r\n    $isDeleted?: boolean;\r\n    createdate: number;\r\n}\r\n\r\nexport interface CartPackRow extends PackRow {\r\n    price: number;\r\n    retail?: number;\r\n    currency: any;\r\n}\r\n\r\nexport class Cart {\r\n    cApp: CApp;\r\n\r\n    private cartStore: CartStore;\r\n    private disposer: IReactionDisposer;\r\n\r\n    @observable data: any = {\r\n        list: observable<CartItem2>([]),\r\n    };\r\n    cartItems: CartItem2[];\r\n    count = observable.box<number>(0);\r\n    amount = observable.box<number>(0);\r\n\r\n    constructor(cApp: CApp) {\r\n        this.cApp = cApp;\r\n        this.cartItems = this.data.list;\r\n        this.disposer = autorun(this.calcSum);\r\n    }\r\n\r\n    dispose() {\r\n        this.disposer();\r\n    }\r\n\r\n    protected calcSum = () => {\r\n        let count = 0, amount = 0;\r\n        for (let cp of this.cartItems) {\r\n            let { $isSelected, $isDeleted, packs } = cp;\r\n            if ($isDeleted === true || !($isSelected === true)) continue;\r\n            for (let pi of packs) {\r\n                let { price, quantity } = pi;\r\n                count += quantity;\r\n                if (price === Number.NaN || quantity === Number.NaN) continue;\r\n                amount += quantity * price;\r\n            }\r\n        }\r\n        this.count.set(count);\r\n        this.amount.set(parseFloat(amount.toFixed(2)));\r\n    }\r\n\r\n    async init(): Promise<void> {\r\n        if (this.cApp.isLogined)\r\n            this.cartStore = new CartRemote(this.cApp);\r\n        else\r\n            this.cartStore = new CartLocal(this.cApp);\r\n        let cartData = await this.cartStore.load();\r\n        let cartDataGrouped = groupByProduct(cartData);\r\n        if (cartDataGrouped && cartDataGrouped.length > 0) {\r\n            for (let i = 0; i < cartDataGrouped.length; i++) {\r\n                let { product, packs, createdate } = cartDataGrouped[i];\r\n                this.cartItems.push({\r\n                    product: product,\r\n                    packs: packs,\r\n                    $isSelected: true,\r\n                    $isDeleted: false,\r\n                    createdate: createdate,\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    /*\r\n    private mergeToRemote(localItems: any[]) {\r\n        let originLength = localItems.length;\r\n        let nowLength = this.items.length;\r\n        if (originLength > 0) {\r\n            if (nowLength > 0) {\r\n                // 合并，谁覆盖谁？\r\n                for (let i = 0; i < originLength; i++) {\r\n                    let { product: tempProduct, pack: tempPack } = localItems[i];\r\n                    let cartItemExits = this.items.find(v => v.product === tempProduct && v.pack === tempPack);\r\n                    if (cartItemExits) {\r\n                        // 如果本地购物车中的产品已经过期，则要删除\r\n                    } else {\r\n                        this.items.push(localItems[i]);\r\n                    }\r\n                }\r\n            } else {\r\n                this.items.push(...localItems);\r\n            }\r\n            // 保存到远程\r\n        }\r\n    }\r\n    */\r\n\r\n    getQuantity(productId: number, packId: number): number {\r\n        let cp = this.cartItems.find(v => v.$isDeleted !== true && v.product.id === productId);\r\n        if (!cp) return 0;\r\n        let cpp = cp.packs.find(v => v.pack.id === packId);\r\n        return cpp === undefined ? 0 : cpp.quantity;\r\n    }\r\n\r\n    isDeleted(productId: number): boolean {\r\n        let i = this.cartItems.findIndex(v => v.$isDeleted === true && v.product.id === productId);\r\n        return i !== -1;\r\n    }\r\n\r\n    getSelectedItems(): CartItem2[] {\r\n        return this.cartItems.filter(v => {\r\n            let { $isSelected, $isDeleted } = v;\r\n            return $isSelected === true && $isDeleted !== true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    add = async (product: BoxId, pack: BoxId, quantity: number, price: number, currency: any) => {\r\n\r\n        let cartItemExists = this.cartItems.find((e) => e.product.id === product.id);\r\n        if (!cartItemExists) {\r\n            cartItemExists = {\r\n                product: product,\r\n                packs: [{ pack: pack, quantity: quantity, price: price, currency: currency }],\r\n                $isSelected: true,\r\n                $isDeleted: false,\r\n                createdate: Date.now()\r\n            };\r\n            this.cartItems.push(cartItemExists);\r\n        }\r\n        else {\r\n            let { $isDeleted, packs } = cartItemExists;\r\n            if ($isDeleted === true)\r\n                packs.splice(0);\r\n\r\n            let packExists: CartPackRow = packs.find(e => e.pack.id === pack.id);\r\n            if (packExists === undefined) {\r\n                let added = false;\r\n                for (let index = packs.length - 1; index >= 0; index--) {\r\n                    if (packs[index].price < price) {\r\n                        packs.splice(index + 1, 0, { pack: pack, quantity: quantity, price: price, currency: currency });\r\n                        added = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (!added)\r\n                    packs.unshift({ pack: pack, quantity: quantity, price: price, currency: currency })\r\n                // packs.push();\r\n            }\r\n            else {\r\n                packExists.quantity = quantity;\r\n                packExists.price = price;\r\n                packExists.currency = currency;\r\n            }\r\n            cartItemExists.$isSelected = true;\r\n            cartItemExists.$isDeleted = false;\r\n            cartItemExists.createdate = Date.now();\r\n        }\r\n\r\n        await this.cartStore.storeCart(product, pack, quantity, price, currency);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param rows\r\n     */\r\n    async removeFromCart(rows: [{ productId: number, packId: number }]) {\r\n        if (rows && rows.length > 0) {\r\n            rows.forEach(pe => {\r\n                let cartItemIndex = this.cartItems.findIndex(e => e.product.id === pe.productId);\r\n                if (cartItemIndex >= 0) {\r\n                    let cartItem = this.cartItems[cartItemIndex];\r\n                    let i = cartItem.packs.findIndex(e => e.pack.id === pe.packId)\r\n                    if (i >= 0) {\r\n                        cartItem.packs.splice(i, 1);\r\n                        if (cartItem.packs.length === 0) {\r\n                            this.cartItems.splice(cartItemIndex, 1);\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n            this.cartStore.removeFromCart(rows);\r\n        }\r\n    }\r\n\r\n    /*\r\n    setDeletedMark(productId: number, packId: number) {\r\n        let cp = this.items.find(v => v.$isDeleted !== true && v.product === productId && v.pack === packId);\r\n        if (cp !== undefined)\r\n            cp.$isDeleted = true;\r\n    }\r\n\r\n    async removeDeletedItem() {\r\n        let rows: { product: number, packItem: CartPackRow }[] = [];\r\n        for (let cp of this.items) {\r\n            let { quantity, $isDeleted } = cp;\r\n            if ($isDeleted === true || quantity === 0) {\r\n                // TODO:\r\n            }\r\n        }\r\n        if (rows.length === 0) return;\r\n        await this.cartStore.removeFromCart(rows);\r\n\r\n        // 下面是从本地数据结构中删除\r\n        for (let cp of this.items) {\r\n            let { packs } = cp;\r\n            let packIndexes: number[] = [];\r\n            let len = packs.length;\r\n            for (let i = 0; i < len; i++) {\r\n                if (packs[i].quantity === 0) packIndexes.push(i);\r\n            }\r\n            for (let i = packIndexes.length - 1; i >= 0; i--) packs.splice(packIndexes[i], 1);\r\n        }\r\n\r\n        let itemIndexes: number[] = [];\r\n        let len = this.items.length;\r\n        for (let i = 0; i < len; i++) {\r\n            let { $isDeleted, packs } = this.items[i];\r\n            if ($isDeleted === true || packs.length === 0) itemIndexes.push(i);\r\n        }\r\n        for (let i = itemIndexes.length - 1; i >= 0; i--) this.items.splice(itemIndexes[i], 1);\r\n    }\r\n\r\n    async clear() {\r\n        this.items.forEach(v => v.$isDeleted = true);\r\n        await this.removeDeletedItem();\r\n    }\r\n    */\r\n\r\n}\r\n\r\nabstract class CartStore {\r\n\r\n    protected cApp: CApp;\r\n    constructor(cApp: CApp) {\r\n        this.cApp = cApp;\r\n    }\r\n    abstract get isLocal(): boolean;\r\n    abstract async load(): Promise<CartItem2[]>;\r\n    abstract async storeCart(product: BoxId, pack: BoxId, quantity: number, price: number, currency: any): Promise<void>;\r\n    abstract async removeFromCart(rows: [{ productId: number, packId: number }]): Promise<void>;\r\n}\r\n\r\nclass CartRemote extends CartStore {\r\n    //private getCartQuery: Query;\r\n    //private setCartAction: Action;\r\n    //private removeFromCartAction: Action;\r\n\r\n    get isLocal(): boolean { return false }\r\n\r\n    /*\r\n    constructor(cApp: CApp) {\r\n        super(cApp);\r\n\r\n        let { cUqOrder } = this.cApp;\r\n        this.getCartQuery = cUqOrder.query('getcart')\r\n        this.setCartAction = cUqOrder.action('setcart');\r\n        this.removeFromCartAction = cUqOrder.action('removefromcart');\r\n    }\r\n    */\r\n\r\n    async load(): Promise<CartItem2[]> {\r\n        return await this.cApp.uqs.order.GetCart.page(undefined, 0, 100);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param product\r\n     * @param pack\r\n     * @param quantity\r\n     * @param price\r\n     * @param currency\r\n     */\r\n    async storeCart(product: BoxId, pack: BoxId, quantity: number, price: number, currency: any) {\r\n        await this.cApp.uqs.order.SetCart.submit({\r\n            product: product.id,\r\n            pack: pack.id,\r\n            price: price,\r\n            currency: currency,\r\n            quantity: quantity\r\n        });\r\n    }\r\n\r\n    async removeFromCart(rows: [{ productId: number, packId: number }]) {\r\n        let param = rows.map(e => { return { product: e.productId, pack: e.packId } });\r\n        await this.cApp.uqs.order.RemoveFromCart.submit({ rows: param });\r\n    }\r\n}\r\n\r\nconst LOCALCARTNAME: string = \"cart\";\r\nclass CartLocal extends CartStore {\r\n\r\n    private cartData: any[] = [];\r\n    private productTuid: Tuid;\r\n    private packTuid: TuidDiv;\r\n    constructor(cApp: CApp) {\r\n        super(cApp);\r\n\r\n        this.productTuid = this.cApp.uqs.product.ProductX;\r\n        this.packTuid = this.productTuid.div('packx');\r\n    }\r\n\r\n    get isLocal(): boolean { return true }\r\n\r\n    async load(): Promise<CartItem2[]> {\r\n        try {\r\n            let cartstring = localStorage.getItem(LOCALCARTNAME);\r\n            if (cartstring === null) return [];\r\n            this.cartData = JSON.parse(cartstring);\r\n            let cartDataBoxed = [];\r\n            for (let i = 0; i < this.cartData.length; i++) {\r\n                let { product, pack, quantity, price, currency } = this.cartData[i];\r\n                let productbox = this.productTuid.boxId(product);\r\n                let packbox = this.packTuid.boxId(pack);\r\n                cartDataBoxed.push({\r\n                    product: productbox,\r\n                    pack: packbox,\r\n                    quantity: quantity,\r\n                    price: price,\r\n                    currency: currency\r\n                } as any)\r\n            }\r\n            return cartDataBoxed;\r\n        }\r\n        catch {\r\n            localStorage.removeItem(LOCALCARTNAME);\r\n            this.cartData = [];\r\n            return this.cartData;\r\n        }\r\n    }\r\n\r\n    async storeCart(product: BoxId, pack: BoxId, quantity: number, price: number, currency: any) {\r\n        let cartItemExists = this.cartData.find(e => this.productTuid.equ(e.product, product) && this.packTuid.equ(e.pack, pack));\r\n        if (cartItemExists !== undefined) {\r\n            cartItemExists.quantity = quantity;\r\n            cartItemExists.price = price;\r\n            cartItemExists.currency = currency && currency.id;\r\n        } else\r\n            this.cartData.push({ product: product.id, pack: pack.id, quantity: quantity, price: price, currency: currency && currency.id });\r\n        localStorage.setItem(LOCALCARTNAME, JSON.stringify(this.cartData));\r\n    }\r\n\r\n    async removeFromCart(rows: [{ productId: number, packId: number }]) {\r\n\r\n        rows.forEach(e => {\r\n            let i = this.cartData.findIndex(v => v.product = e.productId && v.pack === e.packId);\r\n            if (i >= 0)\r\n                this.cartData.splice(i, 1);\r\n        })\r\n        localStorage.setItem(LOCALCARTNAME, JSON.stringify(this.cartData));\r\n    }\r\n}","import { User, loadAppUqs } from 'tonva';\r\nimport { Map, BoxId, CUq, Tuid } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\nimport { UQs } from './uqs';\r\n\r\nexport class WebUser {\r\n\r\n    id: number;\r\n    name: string;\r\n    nick?: string;\r\n    icon?: string;\r\n    guest: number;\r\n    token: string;\r\n\r\n    @observable firstName: string;\r\n    gender: string;\r\n    salutation: string;\r\n    @observable organizationName: string;\r\n    departmentName: string;\r\n\r\n    get defaultOrganizationName(): string {\r\n        return this.organizationName ||\r\n            (this.webUserSettings &&\r\n                (\r\n                    (this.webUserSettings.invoiceInfo && this.webUserSettings.invoiceInfo.obj['title'])\r\n                    || (this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['organizationName'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['organizationName'])\r\n                )\r\n            );\r\n    }\r\n\r\n    get defaultName(): string {\r\n        return this.firstName ||\r\n            (this.webUserSettings &&\r\n                ((\r\n                    this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['name'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['name'])\r\n                )\r\n            );\r\n    }\r\n\r\n    get defaultMobile(): string {\r\n        return this.mobile ||\r\n            (this.webUserSettings &&\r\n                ((\r\n                    this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['mobile'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['mobile'])\r\n                )\r\n            );\r\n    }\r\n\r\n    telephone: string;\r\n    @observable mobile: string;\r\n    email: string;\r\n    fax: string;\r\n    address: BoxId;\r\n    addressString: string;\r\n    zipCode: string;\r\n    @computed get allowOrdering() {\r\n        // 这个地方要改成相关账号吧？\r\n        return this.currentCustomer !== undefined ||\r\n            (this.mobile && this.firstName && this.organizationName);\r\n    }\r\n\r\n    private _user: User;\r\n\r\n    private webUserSettings: any;\r\n\r\n    private uqs: UQs;\r\n\r\n\r\n    constructor(uqs: UQs) {// cUsqWebUser: CUq, cUsqCustomer: CUq) {\r\n        this.uqs = uqs;\r\n    }\r\n\r\n    setUser = async (user: User) => {\r\n        if (user !== undefined) {\r\n            this._user = user;\r\n            this.id = user.id;\r\n            this.name = user.name;\r\n            this.nick = user.nick;\r\n            this.icon = user.icon;\r\n            this.guest = user.guest;\r\n            this.token = user.token;\r\n\r\n            await this.loadWebUser();\r\n        }\r\n    }\r\n\r\n    private async loadWebUser() {\r\n        let { id, _user } = this;\r\n        if (this._user !== undefined) {\r\n            let { webuser: webUserTuid } = this.uqs;\r\n            let { WebUser, WebUserContact, WebUserSetting, WebUserCustomer, WebUserBuyerAccount } = webUserTuid;\r\n            let webUser = await WebUser.load(this.id);\r\n            if (webUser) {\r\n                let { firstName, gender, salutation, organizationName, departmentName } = webUser;\r\n                this.firstName = firstName;\r\n                this.gender = gender;\r\n                this.salutation = salutation;\r\n                this.organizationName = organizationName;\r\n                this.departmentName = departmentName;\r\n            }\r\n\r\n            let contact = await WebUserContact.obj({ \"webUser\": id });\r\n            if (contact) {\r\n                let { telephone, mobile, email, fax, address, addressString, zipCode } = contact;\r\n                this.telephone = telephone;\r\n                this.mobile = mobile;\r\n                this.email = email;\r\n                this.fax = fax;\r\n                this.address = address;\r\n                this.addressString = addressString;\r\n                this.zipCode = zipCode;\r\n            }\r\n\r\n            this.webUserSettings = await WebUserSetting.obj({ webUser: id }) || { webUser: id };\r\n\r\n            let value = await WebUserCustomer.obj({ webUser: id });\r\n            if (value !== undefined) {\r\n                this.currentCustomer = new Customer(value.customer, this.uqs);\r\n                await this.currentCustomer.init();\r\n            }\r\n            let accountValue = await WebUserBuyerAccount.query({ webUser: id });\r\n            let { ret: buyerAccounts } = accountValue;\r\n            if (buyerAccounts && buyerAccounts.length > 0) {\r\n                // TODO: 暂时不考虑有多个相关账号的情况\r\n                this.buyerAccount = buyerAccounts[0].buyerAccount;\r\n            }\r\n        }\r\n    }\r\n\r\n    get isLogined(): boolean {\r\n        return this._user !== undefined;\r\n    }\r\n    get hasCustomer(): boolean {\r\n        return this.currentCustomer !== undefined;\r\n    }\r\n    currentCustomer: Customer;\r\n    buyerAccount: any;\r\n\r\n    async getContacts(): Promise<any[]> {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            return await this.currentCustomer.getContacts()\r\n        }\r\n        */\r\n        return await this.uqs.webuser.WebUserContacts.table({ webUser: this.id });\r\n    }\r\n\r\n    async addContact(contactId: number) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.addContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        await this.uqs.webuser.WebUserContacts.add({ webUser: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async addContactFromAccount() {\r\n        let { firstName, organizationName, mobile, telephone, email, address, addressString } = this;\r\n        if (firstName && organizationName && mobile && address && addressString) {\r\n            let newContact = await this.uqs.customer.Contact.save(undefined, {\r\n                name: firstName,\r\n                organizationName: organizationName,\r\n                mobile: mobile,\r\n                telephone: telephone,\r\n                email: email,\r\n                address: address,\r\n                addressString: addressString\r\n            })\r\n            if (newContact) {\r\n                let { id: newContactId } = newContact;\r\n                await this.addContact(newContactId);\r\n                let newContactBox = this.uqs.customer.Contact.boxId(newContactId);\r\n                this.setDefaultShippingContact(newContactBox);\r\n            }\r\n        }\r\n    }\r\n\r\n    async delContact(contactId: number) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.delContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        await this.uqs.webuser.WebUserContacts.del({ webUser: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async getSetting() {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            return this.currentCustomer.getSetting();\r\n        }\r\n        */\r\n        return this.webUserSettings;\r\n    }\r\n\r\n    async setDefaultShippingContact(contactId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultShippingContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        this.webUserSettings.shippingContact = contactId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoiceContact(contactId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultInvoiceContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        this.webUserSettings.invoiceContact = contactId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoice(invoiceTypeId: BoxId, invoiceInfoId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultInvoice(invoiceTypeId, invoiceInfoId);\r\n            return;\r\n        }\r\n        */\r\n        // await this.webUserSettingMap.add({ webUser: this.id, arr1: [{ invoiceType: invoiceTypeId, invoiceInfo: invoiceInfoId }] });\r\n        this.webUserSettings.invoiceType = invoiceTypeId;\r\n        this.webUserSettings.invoiceInfo = invoiceInfoId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async saveDefaultSettings() {\r\n        await this.uqs.webuser.WebUserSetting.add(this.webUserSettings);\r\n    }\r\n\r\n\r\n    async changeWebUser(webUser: any) {\r\n        await this.uqs.webuser.WebUser.save(this.id, webUser);\r\n        await this.loadWebUser();\r\n    }\r\n\r\n    async changeWebUserContact(webUserContact: any) {\r\n        webUserContact.webUser = this.id;\r\n        await this.uqs.webuser.WebUserContact.add(webUserContact);\r\n        await this.loadWebUser();\r\n    }\r\n\r\n    async getPoints() {\r\n        if (this.currentCustomer !== undefined) {\r\n            return await this.currentCustomer.getPoints();\r\n        }\r\n        return [];\r\n    }\r\n};\r\n\r\nexport class Customer {\r\n    private readonly uqs: UQs;\r\n    id: number;\r\n\r\n    private customerSettings: any;\r\n    Contractor: any;\r\n\r\n    constructor(customer: BoxId, uqs: UQs) {\r\n        this.id = customer.id;\r\n        this.uqs = uqs;\r\n    };\r\n\r\n    async getContacts(): Promise<any[]> {\r\n        return await this.uqs.customer.CustomerContacts.table({ customer: this.id });\r\n    }\r\n\r\n    async addContact(contactId: number) {\r\n        await this.uqs.customer.CustomerContacts.add({ customer: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async delContact(contactId: number) {\r\n        await this.uqs.customer.CustomerContacts.del({ customer: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async init() {\r\n        this.customerSettings = await this.uqs.customer.CustomerSetting.obj({ customer: this.id }) || { customer: this.id };\r\n        let customerContactorMap: any = await this.uqs.customer.CustomerContacts.obj({ customer: this.id });\r\n        if (customerContactorMap)\r\n            this.Contractor = customerContactorMap.contractor;\r\n    }\r\n\r\n    getSetting() {\r\n        return this.customerSettings;\r\n    }\r\n\r\n    async setDefaultShippingContact(contactId: BoxId) {\r\n        this.customerSettings.shippingContact = contactId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoiceContact(contactId: BoxId) {\r\n        this.customerSettings.invoiceContact = contactId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoice(invoiceTypeId: BoxId, invoiceInfoId: BoxId) {\r\n        this.customerSettings.invoiceType = invoiceTypeId;\r\n        this.customerSettings.invoiceInfo = invoiceInfoId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultSettings() {\r\n        await this.uqs.customer.CustomerSetting.add(this.customerSettings);\r\n    }\r\n\r\n    async getPoints() {\r\n        return await this.uqs.积分商城.getPoints.table({ customer: this.id });\r\n    }\r\n\r\n}","import { CSub, CBase } from \"tonva\";\r\nimport { UQs } from \"./uqs\";\r\nimport { CApp } from \"CApp\";\r\n\r\nexport abstract class CUqBase extends CBase {\r\n    get cApp(): CApp { return this._cApp; }\r\n    protected get uqs(): UQs { return this._uqs as UQs };\r\n}\r\n\r\nexport abstract class CUqSub extends CSub {\r\n    get cApp(): CApp { return this._cApp; }\r\n    protected get uqs(): UQs { return this._uqs as UQs };\r\n    protected get owner(): CUqBase { return this._owner as CUqBase; };\r\n}\r\n","import * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { CHome } from './CHome';\r\nimport { SearchBox } from 'tonva';\r\n\r\nexport class VSearchHeader extends View<CHome> {\r\n\r\n    private onSearch = async (key: string, param: 'home' | 'insearch' | 'productdetail') => {\r\n        let { cProduct, topKey } = this.controller.cApp;\r\n        if (param !== 'home') {\r\n            nav.popTo(topKey);\r\n        }\r\n\r\n        cProduct.start(key);\r\n    }\r\n\r\n    render(param: 'home' | 'insearch' | 'productdetail') {\r\n        let size: any = param === 'home' ? \"md\" : 'sm';\r\n        return <SearchBox className=\"w-100\"\r\n            size={size}\r\n            onSearch={(key: string) => this.onSearch(key, param)}\r\n            placeholder=\"搜索品名、编号、CAS、MDL等\" />\r\n    }\r\n}","import * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { LMR, FA, SearchBox } from 'tonva';\r\nimport logo from '../images/logo.png';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSiteHeader extends View<CHome> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{ height: \"3rem\", width: \"3rem\" }} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"px-3 py-4\">\r\n                {this.controller.renderSearchHeader('md')}\r\n            </div>\r\n        </LMR>\r\n        //<div className=\"h4 px-3 mb-0\">百灵威科技</div>\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page, View } from 'tonva';\r\n//import { observer } from 'mobx-react';\r\nimport { CHome } from './CHome';\r\nimport { VSiteHeader } from './VSiteHeader';\r\n//import { observable } from 'mobx';\r\n\r\nexport class VHome extends View<CHome> {\r\n\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    render(param: any): JSX.Element {\r\n        return <this.content />\r\n    }\r\n\r\n    private page = () => {\r\n        return <Page header={false}>\r\n            <this.content />\r\n        </Page>;\r\n    };\r\n\r\n    private content = () => {\r\n        let { controller } = this;\r\n        let { renderCategoryRootList } = controller;\r\n        let siteHeader = this.renderVm(VSiteHeader);\r\n        return <>\r\n            {siteHeader}\r\n            {renderCategoryRootList()}\r\n        </>\r\n    };\r\n}","import { Tuid } from 'tonva';\r\n//import { CCartApp } from '../CCartApp';\r\nimport { PageItems, Controller } from 'tonva';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VSearchHeader } from './VSearchHeader';\r\nimport { VHome } from './VHome';\r\n\r\nclass HomeSections extends PageItems<any> {\r\n\r\n    private sectionTuid: Tuid;\r\n\r\n    constructor(sectionTuid: Tuid) {\r\n        super();\r\n        this.firstSize = this.pageSize = 13;\r\n        this.sectionTuid = sectionTuid;\r\n    }\r\n\r\n    protected async load(param: any, pageStart: any, pageSize: number): Promise<any[]> {\r\n        if (pageStart === undefined) pageStart = 0;\r\n        let ret = await this.sectionTuid.search(\"\", pageStart, pageSize);\r\n        return ret;\r\n    }\r\n\r\n    protected setPageStart(item: any): any {\r\n        if (item === undefined) return 0;\r\n        return item.id;\r\n    }\r\n}\r\n\r\nexport class CHome extends CUqBase {\r\n\r\n    //    cApp: CApp;\r\n    homeSections: HomeSections;\r\n    sectionTuid: Tuid;\r\n\r\n    async internalStart(param: any) {\r\n\r\n        let { cProductCategory } = this.cApp;\r\n        await cProductCategory.start();\r\n        this.openVPage(VHome);\r\n    }\r\n\r\n    renderSearchHeader = (size?: string) => {\r\n        return this.renderView(VSearchHeader, size);\r\n    }\r\n\r\n    renderCategoryRootList = () => {\r\n        let { cProductCategory } = this.cApp;\r\n        return cProductCategory.renderRootList();\r\n    }\r\n\r\n    tab = () => this.renderView(VHome);\r\n}","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { View } from 'tonva';\r\nimport { CCart } from './CCart';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VCartLabel extends View<CCart> {\r\n\r\n    private showCart = async () => {\r\n        this.controller.start();\r\n    }\r\n\r\n    render(param: any): JSX.Element {\r\n        return <this.content />\r\n    };\r\n\r\n    private content = observer(() => {\r\n        let { cart } = this.controller.cApp;\r\n        let count: any = cart.count.get();\r\n        let badge, onClick, pointer;\r\n        if (count > 0) {\r\n            onClick = this.showCart;\r\n            pointer = 'cursor-pointer';\r\n            if (count < 100) badge = <u>{count}</u>;\r\n            else badge = <u>99+</u>;\r\n        }\r\n        return <div className={classNames('jk-cart ml-1 mr-2', pointer)} onClick={onClick}>\r\n            <div>\r\n                <span className=\"fa-stack\">\r\n                    <i className=\"fa fa-square fa-stack-2x text-white\"></i>\r\n                    <i className=\"fa fa-shopping-cart fa-stack-1x text-info\"></i>\r\n                </span>\r\n                {badge}\r\n            </div>\r\n        </div>\r\n    });\r\n}","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { UpdownWidget } from 'tonva';\r\n\r\nconst keys = [107, 109, 110, 187, 189];\r\n\r\nexport class MinusPlusWidget extends UpdownWidget {\r\n    @observable protected value: any;\r\n    @observable protected disabled: boolean;\r\n    @observable protected hasFocus: boolean;\r\n\r\n    protected isValidKey(key: number): boolean {\r\n        if (keys.find(v => v === key) !== undefined) return false;\r\n        return super.isValidKey(key);\r\n    }\r\n\r\n    protected onBlur(evt: React.FocusEvent<any>) {\r\n        super.onBlur(evt);\r\n        this.hasFocus = false;\r\n    }\r\n\r\n    protected onFocus(evt: React.FocusEvent<any>) {\r\n        super.onFocus(evt);\r\n        this.hasFocus = true;\r\n    }\r\n\r\n    protected onChange(evt: React.ChangeEvent<any>) {\r\n    }\r\n\r\n    private minusClick = () => {\r\n        let v = this.getValue();\r\n        if (!v) v = 0;\r\n        this.setValue(v - 1);\r\n    }\r\n    private plusClick = () => {\r\n        let v = this.getValue();\r\n        if (!v) v = 0;\r\n        this.setValue(v + 1);\r\n    }\r\n\r\n    private ref = (input: HTMLInputElement) => {\r\n        this.input = input;\r\n        if (this.input === null) return;\r\n        let p: HTMLElement;\r\n        for (p = this.input; ; p = p.parentElement) {\r\n            if (!p) break;\r\n            if (p.tagName !== 'FIELDSET') continue;\r\n            if ((p as any)['disabled'] === true) {\r\n                this.disabled = true;\r\n            }\r\n            break;\r\n        }\r\n    }\r\n\r\n    private renderContent = observer((): JSX.Element => {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn: any = {\r\n            //'form-control': true,\r\n        };\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        let hasFocus = this.hasFocus; // document.hasFocus() && document.activeElement === this.input;\r\n        let hasAction = this.readOnly !== true && this.disabled !== true;\r\n        let hasValue = isNaN(this.value) === false && this.value !== undefined && this.value > 0;\r\n        let cursorPointer: string,\r\n            minusColor: string, minusClick: any,\r\n            plusColor: string, plusClick: any;\r\n        if (this.disabled === true) {\r\n            cursorPointer = 'cursor-pointer';\r\n            minusColor = plusColor = 'text-light';\r\n        }\r\n        else {\r\n            minusClick = this.minusClick;\r\n            plusClick = this.plusClick;\r\n            minusColor = 'text-danger-2'; //'text-black-50';\r\n            plusColor = 'text-danger';\r\n        }\r\n        let minus = <i className={classNames('fa',\r\n            'fa-minus-circle', 'fa-lg', minusColor, cursorPointer,\r\n            { invisible: !(hasFocus === true || (hasAction === true && hasValue === true)) })}\r\n            onClick={minusClick} />;\r\n        let input = <input ref={this.ref}\r\n            className={classNames(this.className, cn, 'mx-1 w-4c form-control',\r\n                { invisible: !(hasFocus === true || hasValue === true) })}\r\n            type=\"text\"\r\n            defaultValue={this.value}\r\n            onChange={this.onChange}\r\n            placeholder={this.placeholder}\r\n            readOnly={this.readOnly}\r\n            disabled={this.disabled}\r\n            onKeyDown={this.onKeyDown}\r\n            onFocus={(evt: React.FocusEvent<any>) => this.onFocus(evt)}\r\n            onBlur={(evt: React.FocusEvent<any>) => this.onBlur(evt)}\r\n            maxLength={10} />;\r\n\r\n        let plus = <i className={classNames('fa fa-plus-circle fa-lg',\r\n            plusColor, cursorPointer,\r\n            { invisible: !(hasAction === true) })}\r\n            onClick={plusClick} />;\r\n        return <div className=\"d-flex align-items-center\">{minus}{input}{plus}\r\n            {this.renderErrors()}\r\n        </div>;\r\n    });\r\n\r\n    render() {\r\n        return <this.renderContent />;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, Form, ObjectSchema, NumSchema, ArrSchema, UiSchema, UiArr, FormField } from 'tonva';\r\nimport { FA } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { MinusPlusWidget } from '../tools';\r\nimport { CCart } from './CCart';\r\nimport { CartPackRow, CartItem2 } from './Cart';\r\n\r\nconst cartSchema = [\r\n    {\r\n        name: 'list',\r\n        type: 'arr',\r\n        arr: [\r\n            { name: 'checked', type: 'boolean' },\r\n            { name: 'product', type: 'object' } as ObjectSchema,\r\n            {\r\n                name: 'packs', type: 'arr', arr: [\r\n                    { name: 'pack', type: 'object' } as ObjectSchema,\r\n                    { name: 'price', type: 'number' } as NumSchema,\r\n                    { name: 'quantity', type: 'number' } as NumSchema,\r\n                    { name: 'currency', type: 'object' } as ObjectSchema\r\n                ]\r\n            }\r\n        ],\r\n    } as ArrSchema\r\n];\r\n\r\nexport class VCart extends VPage<CCart> {\r\n    async open() {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    protected CheckOutButton = observer(() => {\r\n        let { checkOut, cApp } = this.controller;\r\n        let { cart } = cApp;\r\n        let amount = cart.amount.get();\r\n        let check = \"去结算\";\r\n        let content = amount > 0 ?\r\n            <>{check} (¥{amount})</> :\r\n            <>{check}</>;\r\n        return <button className=\"btn btn-success w-100\" type=\"button\" onClick={checkOut} disabled={amount <= 0}>\r\n            {content}\r\n        </button>;\r\n    });\r\n\r\n    render(params: any): JSX.Element {\r\n        return <this.tab />;\r\n    }\r\n\r\n    private renderCartItem = (item: CartItem2) => {\r\n        let { product } = item;\r\n        let { controller } = this;\r\n        let { onProductClick, renderCartProduct } = controller;\r\n        return <div className=\"pr-1\">\r\n            <div className=\"row\">\r\n                <div className=\"col-lg-6 pb-3\" onClick={() => onProductClick(product)}>\r\n                    {renderCartProduct(product)}\r\n                </div>\r\n                <div className=\"col-lg-6\"><FormField name=\"packs\" /></div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private packsRow = (item: CartPackRow) => {\r\n        let { pack, price, currency } = item;\r\n\r\n        return <div className=\"px-2\">\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-6c mr-4 text-right\"><span className=\"text-danger h5\">¥{price}</span></div>\r\n                <FormField name=\"quantity\" />\r\n            </div>\r\n            <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n        </div>;\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        selectable: true,\r\n        deletable: true,\r\n        restorable: true,\r\n        items: {\r\n            list: {\r\n                widget: 'arr',\r\n                Templet: this.renderCartItem,\r\n                ArrContainer: (label: any, content: JSX.Element) => content,\r\n                RowContainer: (content: JSX.Element) => <div className=\"py-3\">{content}</div>,\r\n                items: {\r\n                    packs: {\r\n                        widget: 'arr',\r\n                        Templet: this.packsRow,\r\n                        selectable: false,\r\n                        deletable: false,\r\n                        ArrContainer: (label: any, content: JSX.Element) => content,\r\n                        RowContainer: (content: JSX.Element) => content,\r\n                        RowSeperator: <div className=\"border border-gray border-top my-3\" />,\r\n                        items: {\r\n                            quantity: {\r\n                                widget: 'custom',\r\n                                className: 'text-center',\r\n                                WidgetClass: MinusPlusWidget,\r\n                                onChanged: this.controller.onQuantityChanged as any\r\n                            }\r\n                        },\r\n                    } as UiArr\r\n                }\r\n            } as UiArr\r\n        }\r\n    }\r\n\r\n    protected cartForm = observer(() => {\r\n        let { cart } = this.controller.cApp;\r\n        let { data: cartData } = cart;\r\n        return <Form className=\"bg-white flex-fill overflow-auto\" schema={cartSchema} uiSchema={this.uiSchema} formData={cartData} />\r\n    });\r\n\r\n    private empty() {\r\n        return <div className=\"py-5 text-center bg-white\">你的购物车空空如也</div>\r\n    }\r\n\r\n    private page = observer((params: any): JSX.Element => {\r\n        let { cart } = this.controller.cApp;\r\n        let footer: any, content: any;\r\n        if (cart.count.get() === 0 && cart.cartItems.length === 0) {\r\n            content = this.empty();\r\n            footer = undefined;\r\n        }\r\n        else {\r\n            content = <this.cartForm />;\r\n            footer = <this.CheckOutButton />;\r\n        }\r\n        return <Page header=\"购物车\" footer={footer}>\r\n            {content}\r\n        </Page>;\r\n    })\r\n\r\n    private tab = observer(() => {\r\n        let { cart } = this.controller.cApp;\r\n        let header = <header className=\"py-2 text-center bg-info text-white\">\r\n            <FA className=\"align-middle\" name=\"shopping-cart\" size=\"2x\" /> &nbsp; <span className=\"h5 align-middle\">购物车</span>\r\n        </header>;\r\n        if (cart.count.get() === 0 && cart.cartItems.length === 0) {\r\n            return <>\r\n                {header}\r\n                {this.empty()}\r\n            </>;\r\n        }\r\n        return <div className=\"bg-white d-flex flex-column h-100\">\r\n            {header}\r\n            <this.cartForm />\r\n            <footer className=\"p-3\"><this.CheckOutButton /></footer>\r\n        </div>\r\n    });\r\n}","import { RowContext, nav, User, BoxId } from 'tonva';\r\nimport { CUqBase } from '../CBase';\r\nimport { VCartLabel } from './VCartLabel';\r\nimport { VCart } from './VCart';\r\nimport { CartPackRow, CartItem2 } from './Cart';\r\n\r\nexport class CCart extends CUqBase {\r\n\r\n    private selectedCartItems: CartItem2[];\r\n\r\n    protected async internalStart(param: any) {\r\n        this.openVPage(VCart);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * 显示购物车图标\r\n     */\r\n    renderCartLabel() {\r\n        return this.renderView(VCartLabel);\r\n    }\r\n\r\n    onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data, parentData } = context;\r\n        let { product } = parentData;\r\n        let { pack, price, currency } = data as CartPackRow;\r\n        let { cart } = this.cApp;\r\n        if (value > 0)\r\n            await cart.add(product, pack, value, price, currency);\r\n        else\r\n            await cart.removeFromCart([{ productId: product.id, packId: pack.id }]);\r\n    }\r\n\r\n    onRowStateChanged = async (context: RowContext, selected: boolean, deleted: boolean) => {\r\n        alert('onRowStateChanged')\r\n    }\r\n\r\n    private loginCallback = async (user: User): Promise<void> => {\r\n        let { cApp } = this;\r\n        await cApp.currentUser.setUser(user);\r\n        await cApp.loginCallBack(user);\r\n        this.closePage(1);\r\n        await this.doFirstOrderChecking();\r\n    };\r\n\r\n    onProductClick = (product: BoxId) => {\r\n        let { cart, cProduct } = this.cApp;\r\n        if (!cart.isDeleted(product.id)) {\r\n            cProduct.showProductDetail(product);\r\n        }\r\n    }\r\n\r\n    checkOut = async () => {\r\n        let { cart } = this.cApp;\r\n        this.selectedCartItems = cart.getSelectedItems();\r\n        if (this.selectedCartItems === undefined) return;\r\n        if (!this.isLogined) {\r\n            nav.showLogin(this.loginCallback, true);\r\n        } else {\r\n            this.doFirstOrderChecking();\r\n        }\r\n    }\r\n\r\n    private doFirstOrderChecking = async () => {\r\n        let { cMe, currentUser } = this.cApp;\r\n        if (!currentUser.allowOrdering) {\r\n            cMe.openMeInfoFirstOrder();\r\n        } else {\r\n            await this.doCheckOut();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 导航到CheckOut界面\r\n     */\r\n    doCheckOut = async () => {\r\n\r\n        let { cOrder } = this.cApp;\r\n        if (this.selectedCartItems === undefined) return;\r\n        await cOrder.start(this.selectedCartItems);\r\n    }\r\n\r\n    tab = () => this.renderView(VCart);\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderDeliveryTime(pack);\r\n    }\r\n\r\n    renderCartProduct = (product: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderCartProduct(product);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Image } from 'tonva';\r\n\r\nconst imagePath = \"https://www.jkchemical.com/static/Structure/\";\r\nconst pointProductImagePath = \"https://www.jkchemical.com/static/images/pointshop\";\r\nconst altimagePath = \"https://www.jkchemical.com/static/Structure/999.png\";\r\n\r\ninterface ProductImageProps {\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    chemicalId: string;\r\n}\r\n\r\nexport function ProductImage(props: ProductImageProps) {\r\n\r\n    let { style, className, chemicalId } = props;\r\n    return <Image src={chemicalId && (imagePath + chemicalId.substr(0, 3) + '/' + chemicalId + '.png')}\r\n        style={style} className={className} altImage={altimagePath} />;\r\n}\r\n\r\nexport function PointProductImage(props: ProductImageProps) {\r\n\r\n    let { style, className, chemicalId } = props;\r\n    return <Image src={chemicalId && (pointProductImagePath + '/' + chemicalId + '.png')}\r\n        style={style} className={className} altImage={altimagePath} />;\r\n}\r\n","import * as React from 'react';\r\nimport { View, tv, FormField, ObjectSchema, NumSchema, UiSchema, UiCustom, RowContext, BoxId, Form, ItemSchema } from 'tonva';\r\nimport { CProduct } from './CProduct';\r\nimport { ProductImage } from 'tools/productImage';\r\nimport { observer } from 'mobx-react';\r\nimport { MinusPlusWidget } from 'tools';\r\nimport { observable } from 'mobx';\r\nimport classNames from 'classnames';\r\n\r\nexport class VCartProuductView extends View<CProduct> {\r\n\r\n    render(param: any): JSX.Element {\r\n        return <>{tv(param, this.renderCartProduct)}</>;\r\n    }\r\n\r\n\r\n    private renderCartProduct = (product: any) => {\r\n        let { id, brand, description, descriptionC, origin, imageUrl } = product;\r\n\r\n        return <div className=\"row d-flex mb-3 px-2\">\r\n            <div className=\"col-12\">\r\n                <div className=\"py-2\">\r\n                    <strong>{description}</strong>\r\n                </div>\r\n                <div className=\"pb-2\">\r\n                    <strong>{descriptionC}</strong>\r\n                </div>\r\n                <div className=\"row\">\r\n                    <div className=\"col-3\">\r\n                        <ProductImage chemicalId={imageUrl} className=\"w-4c h-4c\" />\r\n                    </div>\r\n                    <div className=\"col-9\">\r\n                        <div className=\"row\">\r\n                            {productPropItem('编号', origin)}\r\n                            {this.controller.renderChemicalInfoInCart(product)}\r\n                            {tv(brand, renderBrand)}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    };\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport class VProuductView extends View<CProduct> {\r\n\r\n    @observable product: any;\r\n    @observable discount: number;\r\n\r\n    render(product: BoxId): JSX.Element {\r\n        return <this.renderProduct productBox={product} />;\r\n    }\r\n\r\n    private async getProudct(product: BoxId) {\r\n        if (this.product === undefined) {\r\n            let ret = await this.controller.getProductAndDiscount(product);\r\n            this.product = ret.product;\r\n            this.discount = ret.discount;\r\n        }\r\n    }\r\n\r\n    private renderProduct = observer((param: any) => {\r\n        let { productBox } = param;\r\n        this.getProudct(productBox);\r\n        if (!this.product)\r\n            return null;\r\n        let { renderChemicalInfoInCart } = this.controller;\r\n        let { id, brand, description, descriptionC, origin, imageUrl } = this.product;\r\n        return <div className=\"d-block mb-4 px-3\">\r\n            <div className=\"py-2\">\r\n                <div><strong>{description}</strong></div>\r\n                <div>{descriptionC}</div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-9\">\r\n                    <div className=\"row\">\r\n                        {productPropItem('产品编号', origin)}\r\n                        {renderChemicalInfoInCart(productBox)}\r\n                        {tv(brand, renderBrand)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    })\r\n}\r\n\r\n/**\r\n * 显示产品包装价格，配合CProduct.renderProductPrice使用\r\n * 需要的参数product必须是BoxId(或者object?)\r\n */\r\nexport class VProductPrice extends View<CProduct> {\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'pack', type: 'object' } as ObjectSchema,\r\n        { name: 'quantity', type: 'number' } as NumSchema,\r\n        { name: 'retail', type: 'number' } as NumSchema,\r\n        { name: 'vipPrice', type: 'number' } as NumSchema,\r\n        { name: 'promotionPrice', type: 'number' } as NumSchema,\r\n        { name: 'currency', type: 'string' },\r\n    ];\r\n\r\n    private onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data } = context;\r\n        let { pack, retail, vipPrice, promotionPrice, currency } = data;\r\n        let price = this.minPrice(vipPrice, promotionPrice) || retail;\r\n        let { cApp } = this.controller;\r\n        let { cart } = cApp;\r\n        if (value > 0)\r\n            await cart.add(this.product, pack, value, price, currency);\r\n        else\r\n            await cart.removeFromCart([{ productId: this.product.id, packId: pack.id }]);\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            pack: { visible: false },\r\n            retail: { visible: false },\r\n            vipPrice: { visible: false },\r\n            promotionPrice: { visible: false },\r\n            currency: { visible: false },\r\n            quantity: {\r\n                widget: 'custom',\r\n                label: null,\r\n                className: 'text-center',\r\n                WidgetClass: MinusPlusWidget,\r\n                onChanged: this.onQuantityChanged as any\r\n            } as UiCustom\r\n        }\r\n    }\r\n\r\n    @observable private prices: any;\r\n    private initPrices = async (product: BoxId, salesRegionId: number, discount: number) => {\r\n        if (this.prices === undefined)\r\n            this.prices = await this.controller.getProductPrice(product, salesRegionId, discount);\r\n    }\r\n\r\n    private renderPrice(item: any) {\r\n        let { pack, retail, vipPrice, promotionPrice } = item;\r\n        let right = null;\r\n        if (retail) {\r\n            let price: number = this.minPrice(vipPrice, promotionPrice);\r\n            let retailUI: any;\r\n            if (price) {\r\n                retailUI = <small className=\"text-muted\"><del>¥{retail}</del></small>;\r\n            }\r\n            else {\r\n                price = retail;\r\n            }\r\n            right = <div className=\"row\">\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                    <small className=\"text-muted\">{retailUI}</small>&nbsp; &nbsp;\r\n                    <span className=\"text-danger\">¥ <span className=\"h5\">{price}</span></span>\r\n                </div>\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                    <Form schema={this.schema} uiSchema={this.uiSchema} formData={item} />\r\n                </div>\r\n            </div >\r\n        } else {\r\n            right = <small>请询价</small>\r\n        }\r\n        return right;\r\n    }\r\n\r\n    private minPrice(vipPrice: any, promotionPrice: any) {\r\n        if (vipPrice || promotionPrice)\r\n            return Math.min(typeof (vipPrice) === 'number' ? vipPrice : Infinity, typeof (promotionPrice) === 'number' ? promotionPrice : Infinity);\r\n    }\r\n\r\n    private product: BoxId;\r\n    render(param: any): JSX.Element {\r\n        let { product, discount } = param;\r\n        this.product = product;\r\n        let { currentSalesRegion } = this.controller.cApp;\r\n        return <this.content product={product} SalesRegionId={currentSalesRegion} discount={discount} />;\r\n    }\r\n\r\n    private content = observer((param?: any) => {\r\n        let priceUI;\r\n        let { product, SalesRegionId, discount } = param;\r\n\r\n        let { renderDeliveryTime } = this.controller;\r\n        this.initPrices(product, SalesRegionId, discount);\r\n        if (this.prices && this.prices.length > 0) {\r\n            priceUI = this.prices.map((v: any, index: number) => {\r\n                let { pack, retail } = v;\r\n                if (retail) {\r\n                    return <div className=\"px-2\" key={pack.id}>\r\n                        <div className=\"row\">\r\n                            <div className=\"col-6\">\r\n                                <div><b>{tv(pack)}</b></div>\r\n                                <div>{renderDeliveryTime(pack)}</div>\r\n                            </div>\r\n                            <div className=\"col-6\">\r\n                                {this.renderPrice(v)}\r\n                            </div>\r\n                        </div>\r\n                    </div>;\r\n                } else {\r\n                    return <small>请询价</small>\r\n                }\r\n            });\r\n        }\r\n        return <>\r\n            {priceUI}\r\n        </>;\r\n    })\r\n}\r\n\r\nexport class VProductWithPrice extends View<CProduct> {\r\n    @observable product: any;\r\n    @observable discount: number;\r\n\r\n    render(product: BoxId): JSX.Element {\r\n        return <this.renderProduct productBox={product} />;\r\n    }\r\n\r\n    private async getProudct(product: BoxId) {\r\n        if (this.product === undefined) {\r\n            let ret = await this.controller.getProductAndDiscount(product);\r\n            this.product = ret.product;\r\n            this.discount = ret.discount;\r\n        }\r\n    }\r\n\r\n    private renderProduct = observer((param: any) => {\r\n        let { productBox } = param;\r\n        this.getProudct(productBox);\r\n        if (!this.product)\r\n            return null;\r\n        let { renderChemicalInfoInCart, renderProductPrice } = this.controller;\r\n        let { id, brand, description, descriptionC, origin, imageUrl } = this.product;\r\n        return <div className=\"d-block mb-2 px-3\">\r\n            <div className=\"py-2\">\r\n                <div><strong>{description}</strong></div>\r\n                <div>{descriptionC}</div>\r\n            </div>\r\n            <div className=\"row py-2\">\r\n                <div className=\"col-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-9\">\r\n                    <div className=\"row\">\r\n                        {productPropItem('产品编号', origin)}\r\n                        {renderChemicalInfoInCart(productBox)}\r\n                        {tv(brand, renderBrand)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"border-top pt-2\">\r\n                {renderProductPrice(productBox, this.discount)}\r\n            </div>\r\n        </div>\r\n    })\r\n    /*\r\n    render(product: BoxId): JSX.Element {\r\n        let { renderProduct, renderProductPrice } = this.controller;\r\n        return <div className=\"d-flex flex-column\">\r\n            <div>{renderProduct(product)}</div>\r\n            <div className=\"p-2 border-top\">{renderProductPrice(product, 1)}</div>\r\n        </div>\r\n    }\r\n    */\r\n}\r\n\r\nexport function renderBrand(brand: any) {\r\n    return productPropItem('品牌', brand.name);\r\n}\r\n\r\nexport function productPropItem(caption: string, value: any, captionClass?: string) {\r\n    if (value === null || value === undefined || value === '0') return null;\r\n    let capClass = captionClass ? classNames(captionClass) : classNames(\"text-muted\");\r\n    let valClass = captionClass ? classNames(captionClass) : \"\";\r\n    return <>\r\n        <div className={classNames(\"col-6 col-sm-2 pr-0 small\", capClass)}> {caption}</div>\r\n        <div className={classNames(\"col-6 col-sm-4\", valClass)}>{value}</div>\r\n    </>;\r\n}\r\n\r\n/**\r\n * 显示产品信息（不包含包装价格），特定于参数包含相关的CAS/Purity等信息），现应用于产品列表\r\n * @param product\r\n */\r\nexport function renderProduct(product: any) {\r\n    let { brand, description, descriptionC, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl } = product;\r\n    return <div className=\"d-block mb-4 px-3\">\r\n        <div className=\"py-2\">\r\n            <div><strong>{description}</strong></div>\r\n            <div>{descriptionC}</div>\r\n        </div>\r\n        <div className=\"row\">\r\n            <div className=\"col-3\">\r\n                <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n            </div>\r\n            <div className=\"col-9\">\r\n                <div className=\"row\">\r\n                    {productPropItem('产品编号', origin)}\r\n                    {productPropItem('CAS', CAS)}\r\n                    {productPropItem('纯度', purity)}\r\n                    {productPropItem('分子式', molecularFomula)}\r\n                    {productPropItem('分子量', molecularWeight)}\r\n                    {tv(brand, renderBrand)}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n}","import * as React from 'react';\r\nimport { CProduct } from './CProduct';\r\nimport {\r\n    VPage, Page, Form, ItemSchema, NumSchema, UiSchema, Field,\r\n    ObjectSchema, RowContext, UiCustom, FormField, BoxId\r\n} from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { MinusPlusWidget } from '../tools/minusPlusWidget';\r\nimport { ProductPackRow } from './Product';\r\nimport { ViewMainSubs, MainProductChemical } from 'mainSubs';\r\nimport { ProductImage } from 'tools/productImage';\r\nimport { productPropItem, renderBrand } from './VProductView';\r\n\r\nconst schema: ItemSchema[] = [\r\n    { name: 'pack', type: 'object' } as ObjectSchema,\r\n    { name: 'retail', type: 'number' } as NumSchema,\r\n    { name: 'vipPrice', type: 'number' } as NumSchema,\r\n    { name: 'promotionPrice', type: 'number' } as NumSchema,\r\n    { name: 'currency', type: 'string' },\r\n    { name: 'quantity', type: 'number' } as NumSchema,\r\n    { name: 'inventoryAllocation', type: 'object' } as ObjectSchema,\r\n    { name: 'futureDeliveryTimeDescription', type: 'string' }\r\n];\r\n\r\nexport class VProduct extends VPage<CProduct> {\r\n    private productBox: BoxId;\r\n    private discount: number;\r\n\r\n    async open(param: any) {\r\n        let { productData, product, discount } = param;\r\n        this.productBox = product;\r\n        this.discount = discount;\r\n        this.openPage(this.page, productData);\r\n    }\r\n\r\n    private renderProduct = (product: MainProductChemical) => {\r\n\r\n        let { brand, description, descriptionC, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl } = product;\r\n        return <div className=\"mb-3 px-2\">\r\n            <div className=\"py-2\"><strong>{description}</strong></div>\r\n            <div>{descriptionC}</div>\r\n            <div className=\"row mt-3\">\r\n                <div className=\"col-12 col-sm-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-12 col-sm-9\">\r\n                    <div className=\"row mx-3\">\r\n                        {productPropItem('产品编号', origin, \"font-weight-bold\")}\r\n                        {productPropItem('CAS', CAS, \"font-weight-bold\")}\r\n                        {productPropItem('纯度', purity)}\r\n                        {productPropItem('分子式', molecularFomula)}\r\n                        {productPropItem('分子量', molecularWeight)}\r\n                        {renderBrand(brand)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    private arrTemplet = (item: ProductPackRow) => {\r\n        let { pack, retail, vipPrice, promotionPrice } = item;\r\n        let right = null;\r\n        if (retail) {\r\n            let price: number = this.minPrice(vipPrice, promotionPrice);\r\n            let retailUI: any;\r\n            if (price) {\r\n                retailUI = <small className=\"text-muted\"><del>¥{retail}</del></small>;\r\n            }\r\n            else {\r\n                price = retail;\r\n            }\r\n            right = <div className=\"row\">\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                    <small className=\"text-muted\">{retailUI}</small>&nbsp; &nbsp;\r\n                    <span className=\"text-danger\">¥ <span className=\"h5\">{price}</span></span>\r\n                </div>\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\"><FormField name=\"quantity\" /></div>\r\n            </div >\r\n        } else {\r\n            right = <small>请询价</small>\r\n        }\r\n\r\n        return <div className=\"px-2\">\r\n            <div className=\"row\">\r\n                <div className=\"col-6\">\r\n                    <div><b>{tv(pack)}</b></div>\r\n                    <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n                </div>\r\n                <div className=\"col-6\">\r\n                    {right}\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data } = context;\r\n        let { pack, retail, vipPrice, promotionPrice, currency } = data;\r\n        let price = this.minPrice(vipPrice, promotionPrice) || retail;\r\n        let { cApp } = this.controller;\r\n        let { cart } = cApp;\r\n        if (value > 0)\r\n            await cart.add(this.productBox, pack, value, price, currency);\r\n        else\r\n            await cart.removeFromCart([{ productId: this.productBox.id, packId: pack.id }]);\r\n    }\r\n\r\n    private minPrice(vipPrice: any, promotionPrice: any) {\r\n        if (vipPrice || promotionPrice)\r\n            return Math.min(typeof (vipPrice) === 'number' ? vipPrice : Infinity, typeof (promotionPrice) === 'number' ? promotionPrice : Infinity);\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        Templet: this.arrTemplet,\r\n        items: {\r\n            quantity: {\r\n                widget: 'custom',\r\n                className: 'text-center',\r\n                WidgetClass: MinusPlusWidget as any,\r\n                onChanged: this.onQuantityChanged\r\n            } as UiCustom\r\n        },\r\n    };\r\n\r\n    private renderPack = (pack: ProductPackRow) => {\r\n        return <>\r\n            <div className=\"sep-product-select\" />\r\n            <Form className=\"mx-3\" schema={schema} uiSchema={this.uiSchema} formData={pack} />\r\n        </>;\r\n    }\r\n\r\n    private page = (product: any) => {\r\n\r\n        let { cApp } = this.controller;\r\n        let header = cApp.cHome.renderSearchHeader();\r\n        let cartLabel = cApp.cCart.renderCartLabel();\r\n        if (true) {\r\n            let viewProduct = new ViewMainSubs<MainProductChemical, ProductPackRow>(this.renderProduct, this.renderPack);\r\n            viewProduct.model = product;\r\n\r\n            return <Page header={header} right={cartLabel}>\r\n                <div className=\"px-2 py-2 bg-white mb-3\">{viewProduct.render()}</div>\r\n            </Page>\r\n        } else {\r\n            /*\r\n            下面的做法大概不行，因为嵌套的层次较深，且都是observer的，上层observable的变化会嵌套执行下层的代码，而下层代码的render\r\n            会操作数据库，得不偿失（和React的可能还不一样，React只会更新必要的html，不会再执行查询DB的操作）\r\n            */\r\n            let { controller, productBox } = this;\r\n            let { renderProductWithPrice } = controller;\r\n            return <Page header={header} right={cartLabel}>\r\n                <div className=\"px-2 py-2 bg-white mb-3\">\r\n                    {renderProductWithPrice(productBox)}\r\n                </div>\r\n            </Page>\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, Scroller } from 'tonva';\r\nimport { CProduct } from './CProduct';\r\nimport { List } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { renderProduct } from './VProductView';\r\n\r\nexport class VProductList extends VPage<CProduct> {\r\n\r\n    private searchKey: string;\r\n    async open(key: string) {\r\n        this.searchKey = key;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onProductClick = async (product: any) => {\r\n        await this.controller.showProductDetail(product.id);\r\n    }\r\n\r\n    private onScrollBottom = async (scroller: Scroller) => {\r\n        scroller.scrollToBottom();\r\n        await this.controller.pageProducts.more();\r\n    }\r\n\r\n    private page = observer(() => {\r\n\r\n        let { pageProducts, cApp } = this.controller;\r\n        let { cHome, cCart } = cApp;\r\n        let header = cHome.renderSearchHeader();\r\n        let cart = cCart.renderCartLabel();\r\n        let none = <div className=\"my-3 mx-2 text-warning\">抱歉，未找到相关产品，请重新搜索！</div>\r\n        return <Page header={header} right={cart} onScrollBottom={this.onScrollBottom}>\r\n            <div className=\"bg-white p-2 mb-1\">搜索条件: <strong>{this.searchKey}</strong></div>\r\n            <List before={''} none={none} items={pageProducts} item={{ render: renderProduct, onClick: this.onProductClick }} />\r\n        </Page>\r\n    });\r\n}","import { Entity } from 'tonva';\r\nimport { CApp } from '../CApp';\r\n//import { CCartApp } from 'CCartApp';\r\n\r\nexport abstract class Loader<T> {\r\n    protected cApp: CApp;\r\n    private entities: Entity[] = [];\r\n    private schemaLoaded: boolean = false;\r\n    constructor(cApp: CApp) {\r\n        this.cApp = cApp;\r\n        //this.initEntities();\r\n    }\r\n\r\n    //protected abstract initEntities(): void;\r\n\r\n    protected async loadSchemas() {\r\n        if (this.schemaLoaded === true) return;\r\n        await Promise.all(this.entities);\r\n        this.schemaLoaded = true;\r\n    }\r\n\r\n    async load(param: any): Promise<T> {\r\n        await this.loadSchemas();\r\n        let data = this.initData();\r\n        await this.loadToData(param, data);\r\n        return data;\r\n    }\r\n    protected abstract async loadToData(param: any, data: T): Promise<void>;\r\n    protected abstract initData(): T;\r\n}\r\n","import { Loader } from '../mainSubs/loader';\r\n\r\nexport class LoaderProductChemical extends Loader<any> {\r\n    protected async loadToData(productId: number, data: any): Promise<void> {\r\n\r\n        let productChemical = await this.cApp.uqs.product.ProductChemical.obj({ product: productId });\r\n        if (productChemical) {\r\n            let { chemical, purity, CAS, molecularFomula, molecularWeight } = productChemical;\r\n            data.chemical = chemical;\r\n            data.purity = purity;\r\n            data.CAS = CAS;\r\n            data.molecularFomula = molecularFomula;\r\n            data.molecularWeight = molecularWeight;\r\n        }\r\n    }\r\n\r\n    protected initData(): any {\r\n        return {};\r\n    }\r\n}","import _ from 'lodash';\r\nimport { ProductPackRow } from './Product';\r\nimport { Loader } from '../mainSubs/loader';\r\nimport { MainSubs, MainProductChemical, MainBrand } from '../mainSubs';\r\nimport { LoaderProductChemical } from '../tools/productChemical';\r\n\r\nexport class LoaderBrand extends Loader<MainBrand> {\r\n    protected async loadToData(brandId: number, data: MainBrand): Promise<void> {\r\n        let brand = await this.cApp.uqs.product.Brand.load(brandId);\r\n        data.id = brand.id;\r\n        data.name = brand.name;\r\n    }\r\n\r\n    protected initData(): MainBrand {\r\n        return {} as MainBrand;\r\n    }\r\n}\r\n\r\nexport class LoaderProductWithChemical extends Loader<MainProductChemical> {\r\n\r\n    protected async loadToData(productId: number, data: MainProductChemical): Promise<void> {\r\n\r\n        let product = await this.cApp.uqs.product.ProductX.load(productId);\r\n        if (product === undefined)\r\n            return;\r\n        _.merge(data, product);\r\n\r\n        let brandLoader = new LoaderBrand(this.cApp);\r\n        data.brand = await brandLoader.load(data.brand.id);\r\n\r\n        let productChemicalLoader = new LoaderProductChemical(this.cApp);\r\n        let productChemical: any = await productChemicalLoader.load(productId);\r\n        if (productChemical) {\r\n            let { chemical, purity, CAS, molecularFomula, molecularWeight } = productChemical;\r\n            data.chemical = chemical;\r\n            data.purity = purity;\r\n            data.CAS = CAS;\r\n            data.molecularFomula = molecularFomula;\r\n            data.molecularWeight = molecularWeight;\r\n        }\r\n\r\n        data.packs = [];\r\n        product.packx.forEach((e: any) => {\r\n            data.packs.push(e);\r\n        });\r\n    }\r\n\r\n    protected initData(): MainProductChemical {\r\n        return {} as MainProductChemical;\r\n    }\r\n}\r\n\r\nexport class LoaderProductChemicalWithPrices extends Loader<MainSubs<MainProductChemical, ProductPackRow>> {\r\n\r\n    protected initData(): MainSubs<MainProductChemical, ProductPackRow> {\r\n        return { main: {} as MainProductChemical, subs: [] as ProductPackRow[] };\r\n    }\r\n\r\n    protected async loadToData(productId: any, data: MainSubs<MainProductChemical, ProductPackRow>): Promise<void> {\r\n        let { customerDiscount, product, promotion } = this.cApp.uqs;\r\n        let productLoader = new LoaderProductWithChemical(this.cApp);\r\n        data.main = await productLoader.load(productId);\r\n\r\n        let discount = 0;\r\n        let { currentUser, currentSalesRegion, cart, currentLanguage } = this.cApp;\r\n        if (currentUser.hasCustomer) {\r\n            let discountSetting = await customerDiscount.GetDiscount.obj({ brand: data.main.brand.id, customer: currentUser.currentCustomer });\r\n            discount = discountSetting && discountSetting.discount;\r\n        }\r\n\r\n        let { id: currentSalesRegionId } = currentSalesRegion;\r\n        let prices = await product.PriceX.table({ product: productId, salesRegion: currentSalesRegionId });\r\n        data.subs = prices.filter(e => e.discountinued === 0 && e.expireDate > Date.now()).sort((a, b) => a.retail - b.retail).map(element => {\r\n            let ret: any = {};\r\n            ret.pack = element.pack;\r\n            ret.retail = element.retail;\r\n            if (discount !== 0)\r\n                ret.vipPrice = Math.round(element.retail * (1 - discount));\r\n            ret.currency = currentSalesRegion.currency;\r\n            ret.quantity = cart.getQuantity(productId, element.pack.id)\r\n            return ret;\r\n        });\r\n\r\n        let promises: PromiseLike<any>[] = [];\r\n        data.subs.forEach(v => {\r\n            promises.push(promotion.GetPromotionPack.obj({ product: productId, pack: v.pack, salesRegion: currentSalesRegion, language: currentLanguage }));\r\n        })\r\n        let results = await Promise.all(promises);\r\n\r\n        for (let i = 0; i < data.subs.length; i++) {\r\n            let promotion = results[i];\r\n            let discount = promotion && promotion.discount;\r\n            if (discount)\r\n                data.subs[i].promotionPrice = Math.round((1 - discount) * data.subs[i].retail);\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { tv, View } from 'tonva';\r\nimport { CProduct } from './CProduct';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\n\r\nexport class VProductDelivery extends View<CProduct> {\r\n\r\n    @observable private inventoryAllocation: any[];\r\n    @observable private futureDeliveryTimeDescription: string;\r\n\r\n    render(param: any): JSX.Element {\r\n        let { obj: packObj, id: packId } = param;\r\n        let { owner: productId } = packObj;\r\n        let { controller } = this;\r\n        let { currentSalesRegion } = controller.cApp;\r\n        return <this.content packId={packId} productId={productId} currentSalesRegion={currentSalesRegion} />;\r\n    }\r\n\r\n    private initInventoryAllocation = async (productId: number, packId: number, salesRegionId: number) => {\r\n        if (this.inventoryAllocation === undefined)\r\n            this.inventoryAllocation = await this.controller.getInventoryAllocation(productId, packId, salesRegionId);\r\n    }\r\n\r\n    private initFutureDeliveryTimeDescription = async (productId: number, salesRegionId: number) => {\r\n        if (this.futureDeliveryTimeDescription === undefined)\r\n            this.futureDeliveryTimeDescription = await this.controller.getFutureDeliveryTimeDescription(productId, salesRegionId);\r\n    }\r\n\r\n    private content = observer((param: any): any => {\r\n\r\n        let deliveryTimeUI;\r\n        let { packId, productId, currentSalesRegion } = param;\r\n        if (productId) {\r\n            this.initInventoryAllocation(productId, packId, currentSalesRegion);\r\n            this.initFutureDeliveryTimeDescription(productId, currentSalesRegion);\r\n        }\r\n        if (this.inventoryAllocation === undefined || this.futureDeliveryTimeDescription === undefined)\r\n            return null;\r\n        if (this.inventoryAllocation && this.inventoryAllocation.length > 0) {\r\n            deliveryTimeUI = this.inventoryAllocation.map((v, index) => {\r\n                let { warehouse, quantity, deliveryTimeDescription } = v;\r\n                if (quantity > 0) {\r\n                    return <div key={index} className=\"text-success\">\r\n                        {tv(warehouse, (values: any) => <span className=\"small\">{values.name}</span>)}: {(quantity > 10 ? '>10' : quantity)}\r\n                        {deliveryTimeDescription}\r\n                    </div>\r\n                } else {\r\n                    return undefined;\r\n                }\r\n            });\r\n        } else {\r\n            deliveryTimeUI = <div>{this.futureDeliveryTimeDescription && '期货: ' + this.futureDeliveryTimeDescription}</div>;\r\n        }\r\n        return deliveryTimeUI;\r\n    })\r\n}","import * as React from 'react';\r\nimport { tv, View } from 'tonva';\r\nimport { CProduct } from './CProduct';\r\nimport { observer } from 'mobx-react';\r\nimport { productPropItem } from './VProductView';\r\n\r\nexport class VChemicalInfoInCart extends View<CProduct> {\r\n\r\n    render(param: any): JSX.Element {\r\n        let { id: productId } = param;\r\n        if (typeof productId === 'object')\r\n            productId = productId.id;\r\n        let { controller } = this;\r\n        controller.getChemicalInfo(productId);\r\n        return <this.content productId={productId} />;\r\n    }\r\n\r\n    private content = observer((param: any) => {\r\n\r\n        let { productId } = param;\r\n        let { chemicalInfoContainer } = this.controller;\r\n        let chemicalInfo = chemicalInfoContainer[productId];\r\n        if (chemicalInfo !== undefined) {\r\n            let { chemical, purity, CAS, molecularFomula, molecularWeight } = chemicalInfo;\r\n            return <>\r\n                {productPropItem('CAS', CAS)}\r\n                {productPropItem('纯度', purity)}\r\n            </>\r\n        }\r\n        return <></>;\r\n    })\r\n}\r\n","import * as _ from 'lodash';\r\nimport { observable } from 'mobx';\r\nimport { Query, tv, BoxId, PageItems } from 'tonva';\r\nimport { CUqBase } from '../CBase';\r\nimport { VProduct } from './VProduct';\r\nimport { VProductList } from './VProductList';\r\nimport { LoaderProductChemicalWithPrices } from './itemLoader';\r\nimport { VProductDelivery } from './VProductDelivery';\r\nimport { VCartProuductView, VProductWithPrice, VProuductView, VProductPrice } from './VProductView';\r\nimport { VChemicalInfoInCart } from './VChemicalInfo';\r\n\r\nclass PageProducts extends PageItems<any> {\r\n\r\n    private searchProductQuery: Query;\r\n\r\n    constructor(searchProductQuery: Query) {\r\n        super();\r\n        this.firstSize = this.pageSize = 10;\r\n        this.searchProductQuery = searchProductQuery;\r\n    }\r\n\r\n    protected async load(param: any, pageStart: any, pageSize: number): Promise<any[]> {\r\n        if (pageStart === undefined) pageStart = 0;\r\n        let ret = await this.searchProductQuery.page(param, pageStart, pageSize, false);\r\n        return ret;\r\n    }\r\n\r\n    protected setPageStart(item: any): any {\r\n        this.pageStart = item === undefined ? 0 : item.seq;\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport class CProduct extends CUqBase {\r\n    pageProducts: PageProducts;\r\n\r\n    @observable futureDeliveryTimeDescriptionContainer: { [cacheId: string]: string } = {};\r\n    @observable chemicalInfoContainer: { [productId: number]: any } = {};\r\n\r\n    protected async internalStart(param: any) {\r\n        this.searchByKey(param);\r\n    }\r\n\r\n    searchByKey(key: string) {\r\n        let { currentSalesRegion } = this.cApp;\r\n        this.pageProducts = new PageProducts(this.uqs.product.SearchProduct);\r\n        this.pageProducts.first({ keyWord: key, salesRegion: currentSalesRegion.id });\r\n        this.openVPage(VProductList, key);\r\n    }\r\n\r\n    async searchByCategory(category: any) {\r\n        let { currentSalesRegion } = this.cApp;\r\n        this.pageProducts = new PageProducts(this.uqs.product.SearchProductByCategory);\r\n        let { productCategoryId, name } = category;\r\n        this.pageProducts.first({ productCategory: productCategoryId, salesRegion: currentSalesRegion.id });\r\n        this.openVPage(VProductList, name);\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    showProductDetail = async (productId: BoxId | any) => {\r\n\r\n        if (productId) {\r\n            let discount = 0, product = productId;\r\n            /*\r\n            product = await this.uqs.product.ProductX.load(productId);\r\n            let { currentUser } = this.cApp;\r\n            if (currentUser.hasCustomer) {\r\n                let discountSetting = await this.uqs.customerDiscount.GetDiscount.obj({ brand: product.brand.id, customer: currentUser.currentCustomer });\r\n                discount = discountSetting && discountSetting.discount;\r\n            }\r\n            */\r\n            let loader = new LoaderProductChemicalWithPrices(this.cApp);\r\n            let productData = await loader.load(productId);\r\n            this.openVPage(VProduct, { productData, product, discount });\r\n        }\r\n    }\r\n\r\n    renderProductPrice = (product: BoxId, discount: number) => {\r\n        return this.renderView(VProductPrice, { product: product, discount: discount });\r\n    }\r\n\r\n    renderProductWithPrice = (product: BoxId) => {\r\n        return this.renderView(VProductWithPrice, product);\r\n    }\r\n\r\n    getProductPrice = async (product: BoxId, salesRegionId: number, discount: number) => {\r\n        let { id: productId } = product;\r\n        let { currentSalesRegion, cart, currentLanguage, uqs } = this.cApp;\r\n\r\n        let prices = await uqs.product.PriceX.table({ product: product, salesRegion: salesRegionId });\r\n        let priceSet = prices.filter(e => e.discountinued === 0 && e.expireDate > Date.now()).sort((a, b) => a.retail - b.retail).map(element => {\r\n            let ret: any = {};\r\n            ret.pack = element.pack;\r\n            ret.retail = element.retail;\r\n            if (discount !== 0)\r\n                ret.vipPrice = Math.round(element.retail * (1 - discount));\r\n            ret.currency = currentSalesRegion.currency;\r\n            ret.quantity = cart.getQuantity(productId, element.pack.id)\r\n            return ret;\r\n        });\r\n        let promises: PromiseLike<any>[] = [];\r\n        priceSet.forEach(v => {\r\n            promises.push(uqs.promotion.GetPromotionPack.obj({ product: productId, pack: v.pack, salesRegion: currentSalesRegion, language: currentLanguage }));\r\n        })\r\n        let results = await Promise.all(promises);\r\n\r\n        for (let i = 0; i < priceSet.length; i++) {\r\n            let promotion = results[i];\r\n            let discount = promotion && promotion.discount;\r\n            if (discount)\r\n                priceSet[i].promotionPrice = Math.round((1 - discount) * priceSet[i].retail);\r\n        }\r\n        return priceSet;\r\n    }\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        return this.renderView(VProductDelivery, pack);\r\n    }\r\n\r\n    getInventoryAllocation = async (productId: number, packId: number, salesRegionId: number) => {\r\n        return await this.uqs.warehouse.GetInventoryAllocation.table({ product: productId, pack: packId, salesRegion: this.cApp.currentSalesRegion });\r\n    }\r\n\r\n    getFutureDeliveryTimeDescription = async (productId: number, salesRegionId: number) => {\r\n        let cacheId = productId + '_' + salesRegionId;\r\n        if (this.futureDeliveryTimeDescriptionContainer[cacheId] === undefined) {\r\n            let futureDeliveryTime = await this.uqs.product.GetFutureDeliveryTime.table({ product: productId, salesRegion: salesRegionId });\r\n            if (futureDeliveryTime.length > 0) {\r\n                let { minValue, maxValue, unit, deliveryTimeDescription } = futureDeliveryTime[0];\r\n                this.futureDeliveryTimeDescriptionContainer[cacheId] = minValue + (maxValue > minValue ? '~' + maxValue : '') + ' ' + unit;\r\n            } else {\r\n                this.futureDeliveryTimeDescriptionContainer[cacheId] = null;\r\n            }\r\n        }\r\n        return this.futureDeliveryTimeDescriptionContainer[cacheId];\r\n    }\r\n\r\n    renderChemicalInfoInCart = (product: BoxId) => {\r\n        return this.renderView(VChemicalInfoInCart, product);\r\n    }\r\n\r\n    getChemicalInfo = async (productId: number) => {\r\n        if (this.chemicalInfoContainer[productId] === undefined) {\r\n            this.chemicalInfoContainer[productId] = await this.uqs.product.ProductChemical.obj({ product: productId });\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    renderProduct = (product: any) => {\r\n        return this.renderView(VProuductView, product);\r\n    }\r\n\r\n    getProductAndDiscount = async (productId: BoxId) => {\r\n        let product = await this.uqs.product.ProductX.load(productId);\r\n        let discount = 0;\r\n        let { currentUser } = this.cApp;\r\n        if (currentUser.hasCustomer) {\r\n            let discountSetting = await this.uqs.customerDiscount.GetDiscount.obj({ brand: product.brand.id, customer: currentUser.currentCustomer });\r\n            discount = discountSetting && discountSetting.discount;\r\n        }\r\n        return { product: product, discount: discount };\r\n    }\r\n\r\n    renderCartProduct = (product: BoxId) => {\r\n        return this.renderView(VCartProuductView, product);\r\n    }\r\n}","import * as React from 'react';\r\nimport logo from '../images/logo.png';\r\n\r\nexport const jnkTop = <div className=\"d-flex align-items-center\">\r\n    <img className=\"h-3c position-absolute\" src={logo} alt=\"百灵威\" />\r\n    <div className=\"h3 flex-fill text-center\">\r\n        <span className=\"text-primary mr-3\">百灵威</span>\r\n    </div>\r\n</div>;\r\n","import * as React from 'react';\r\nimport { tv } from 'tonva';\r\n\r\nexport const tvAddress = (values: any) => {\r\n    let { country, province, city, county } = values;\r\n    return <>\r\n        {tv(country)}{tv(province, undefined, undefined, () => <></>)}{tv(city, undefined, undefined, () => <></>)}{tv(county, undefined, undefined, () => <></>)}\r\n    </>\r\n}\r\n\r\nexport const tvCountry = (values: any) => {\r\n    return <> {values.chineseName} </>;\r\n}\r\n\r\nexport const tvCurrency = (values: any) => {\r\n    return <> {values.name} </>;\r\n}\r\n\r\nexport const common = {\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    currency: tvCurrency,\r\n};\r\n","import * as React from 'react';\r\nimport { tv } from 'tonva';\r\nimport { ProductImage } from 'tools/productImage';\r\n\r\nexport const tvProduct = (values: any) => {\r\n    let product = values;\r\n    let { brand, description, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl } = product;\r\n    return <div className=\"row d-flex\">\r\n        <div className=\"col-12\">\r\n            <div className=\"row py-2\">\r\n                <div className=\"col-12\"><strong>{description}</strong></div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-9\">\r\n                    <div className=\"row\">\r\n                        {item('CAS', CAS)}\r\n                        {item('纯度', purity)}\r\n                        {item('分子式', molecularFomula)}\r\n                        {item('分子量', molecularWeight)}\r\n                        {item('产品编号', origin)}\r\n                        {tv(brand, (values: any) => <>{item(\"品牌\", values.name)}</>)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n};\r\n\r\nconst tvPackx = (values: any) => {\r\n    let { radiox, radioy, unit } = values;\r\n    if (radiox !== 1) return <>{radiox} * {radioy}{unit}</>;\r\n    return <>{radioy}{unit}</>;\r\n}\r\n\r\nfunction item(caption: string, value: any) {\r\n    if (value === null || value === undefined) return null;\r\n    return <>\r\n        <div className=\"col-4 text-muted pr-0\">{caption}:</div>\r\n        <div className=\"col-8\">{value}</div>\r\n    </>;\r\n}\r\n\r\nconst tvProductCategory = (values: any) => {\r\n    let { children } = values;\r\n    return <>\r\n        aaa\r\n    </>\r\n};\r\n\r\nexport const product = {\r\n    productx: tvProduct,\r\n    packx: tvPackx,\r\n    productCategory: tvProductCategory,\r\n}\r\n","import * as React from 'react';\r\nimport { tv } from 'tonva';\r\nimport { tvAddress, tvCountry } from './common';\r\n\r\nexport const tvContact = (values: any) => {\r\n    let { name, mobile, organizationName, address, addressString } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        <b>\r\n            {name}\r\n        </b>\r\n        &nbsp; {mobile} &nbsp; {organizationName}<br />\r\n        <small>{tv(address)} {addressString}</small>\r\n    </div>\r\n}\r\n\r\nexport const tvInvoiceType = (values: any) => {\r\n    let { id, description } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        {description}\r\n    </div>\r\n}\r\n\r\nexport const tvInvoiceInfo = (values: any) => {\r\n    let { title, taxNo } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        <b>\r\n            {title}\r\n        </b>\r\n        &nbsp; {taxNo}\r\n    </div>\r\n}\r\n\r\nexport const customer = {\r\n    contact: tvContact,\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    invoiceInfo: tvInvoiceInfo,\r\n    invoiceType: tvInvoiceType\r\n}\r\n","import { TVs } from \"tonva\";\r\nimport { common } from \"./common\";\r\nimport { warehouse } from \"./warehouse\";\r\nimport { product } from \"./product\";\r\nimport { order } from \"./order\";\r\nimport { customer } from './customer';\r\n\r\nexport const tvs:TVs = {\r\n    common: common,\r\n    warehouse: warehouse,\r\n    product: product,\r\n    order: order,\r\n    customer: customer,\r\n}","import * as React from 'react';\r\n\r\nconst tvWarehouse = (values: any) => {\r\n    let { name } = values;\r\n    return <div>\r\n        {name}\r\n    </div>\r\n}\r\n\r\nexport const warehouse = {\r\n    warehouse: tvWarehouse,\r\n}\r\n","import { tvProduct } from \"./product\";\r\nimport { tvAddress, tvCountry, tvCurrency } from \"./common\";\r\nimport { tvContact } from \"./customer\";\r\n\r\nexport const order = {\r\n    productx: tvProduct,\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    contact: tvContact,\r\n    currency: tvCurrency,\r\n}\r\n","import { AppConfig } from \"tonva\";\r\nimport { jnkTop } from \"./me/loginTop\";\r\nimport { tvs } from \"./tvs\";\r\nimport AnalyticalChemistry from './images/AnalyticalChemistry.png';\r\nimport LabSupplies from './images/LabSupplies.png';\r\nimport LifeScience from './images/LifeScience.png';\r\nimport MaterialScience from './images/MaterialScience.png';\r\nimport OrganicChemistry from './images/OrganicChemistry.png';\r\n\r\nexport { CApp } from './CApp';\r\n\r\nexport const appConfig: AppConfig = {\r\n    appName: '百灵威系统工程部/cart',\r\n    version: '1.1.53',\r\n    tvs: tvs,\r\n    loginTop: jnkTop,\r\n    oem: '百灵威'\r\n};\r\n\r\n// 生产配置\r\nconst GLOABLE_PRODUCTION = {\r\n    CHINA: 44,\r\n    CHINESE: 196,\r\n    SALESREGION_CN: 1,\r\n    ROOTCATEGORY: {\r\n        47: {\r\n            src: OrganicChemistry,\r\n            labelColor: 'text-info',\r\n        },\r\n        470: {\r\n            src: AnalyticalChemistry,\r\n            labelColor: 'text-success',\r\n        },\r\n        1013: {\r\n            src: LifeScience,\r\n            labelColor: 'text-danger',\r\n        },\r\n        1219: {\r\n            src: MaterialScience,\r\n            labelColor: 'text-warning',\r\n        },\r\n        1545: {\r\n            src: LabSupplies,\r\n            labelColor: 'text-primary',\r\n        },\r\n    } as any,\r\n    TIPDISPLAYTIME: 2000\r\n}\r\n\r\n// 测试环境配置\r\nconst GLOABLE_TEST = {\r\n    CHINA: 43,\r\n    CHINESE: 197,\r\n    SALESREGION_CN: 4,\r\n    ROOTCATEGORY: {\r\n        7: {\r\n            src: OrganicChemistry,\r\n            labelColor: 'text-info',\r\n        },\r\n        430: {\r\n            src: AnalyticalChemistry,\r\n            labelColor: 'text-success',\r\n        },\r\n        986: {\r\n            src: LifeScience,\r\n            labelColor: 'text-danger',\r\n        },\r\n        1214: {\r\n            src: MaterialScience,\r\n            labelColor: 'text-warning',\r\n        },\r\n        1545: {\r\n            src: LabSupplies,\r\n            labelColor: 'text-primary',\r\n        },\r\n    } as any,\r\n    TIPDISPLAYTIME: 2000\r\n}\r\n\r\n// export { GLOABLE_PRODUCTION as GLOABLE };\r\nexport { GLOABLE_TEST as GLOABLE };","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, tv, List, LMR, FA } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { OrderItem } from './Order';\r\nimport { CartPackRow } from '../cart/Cart';\r\nimport classNames from 'classnames';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class VCreateOrder extends VPage<COrder> {\r\n    @observable private useShippingAddress: boolean = true;\r\n    @observable private shippingAddressIsBlank: boolean = false;\r\n    @observable private invoiceAddressIsBlank: boolean = false;\r\n    @observable private invoiceIsBlank: boolean = false;\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private nullContact = () => {\r\n        return <span className=\"text-primary\">选择收货地址</span>;\r\n    }\r\n\r\n    private packsRow = (item: CartPackRow, index: number) => {\r\n        let { pack, quantity, price, retail, currency } = item;\r\n\r\n        return <div key={index} className=\"px-2 py-2 border-top\">\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-12c mr-4 text-right\">\r\n                    <span className=\"text-danger h5\"><small>¥</small>{parseFloat((retail * quantity).toFixed(2))}</span>\r\n                    <small className=\"text-muted\">(¥{parseFloat(retail.toFixed(2))} × {quantity})</small>\r\n                </div>\r\n            </div>\r\n            <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n        </div>;\r\n    }\r\n\r\n    private renderOrderItem = (orderItem: OrderItem) => {\r\n        let { product, packs } = orderItem;\r\n        let { controller, packsRow } = this;\r\n        return <div>\r\n            <div className=\"row\">\r\n                <div className=\"col-lg-6 pb-3\">{controller.renderOrderItemProduct(product)}</div>\r\n                <div className=\"col-lg-6\">{\r\n                    packs.map((p, index) => {\r\n                        return packsRow(p, index);\r\n                    })\r\n                }</div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private orderItemKey = (orderItem: OrderItem) => {\r\n        return orderItem.product.id;\r\n    }\r\n\r\n    private renderCoupon = observer((param: any) => {\r\n        let { couponData } = this.controller;\r\n        if (couponData['id'] === undefined) {\r\n            return <span className=\"text-primary\">使用优惠券/积分码</span>;\r\n        } else {\r\n            let { id, code, discount, preferential, validitydate, isValid, types } = couponData;\r\n            let { couponOffsetAmount, couponRemitted, couponCredits } = param;\r\n            let offsetUI, remittedUI, noOffsetUI;\r\n            if (types == \"credits\") {\r\n                offsetUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                    <div className=\"text-muted\">积分倍数:</div>\r\n                    <div className=\"text-right text-danger\"><small>x</small>{couponCredits}</div>\r\n                </div>\r\n            }\r\n            else if (couponOffsetAmount || couponRemitted) {\r\n                if (couponOffsetAmount) {\r\n                    offsetUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                        <div className=\"text-muted\">折扣:</div>\r\n                        <div className=\"text-right text-danger\"><small>¥</small>{couponOffsetAmount.toFixed(2)}</div>\r\n                    </div>\r\n                }\r\n                if (couponRemitted) {\r\n                    remittedUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                        <div className=\"text-muted\">抵扣:</div>\r\n                        <div className=\"text-right text-danger\"><small>¥</small>{couponRemitted.toFixed(2)}</div>\r\n                    </div>\r\n                }\r\n            } else {\r\n                noOffsetUI = <div>谢谢惠顾</div>;\r\n            }\r\n            return <div className=\"mr-2\">\r\n                <div className=\"text-success\">{code.substr(0, 4)} {code.substr(4)}</div>\r\n                {offsetUI}\r\n                {remittedUI}\r\n                {noOffsetUI}\r\n            </div>\r\n        }\r\n    });\r\n\r\n    private onBuyerAccountChanged = () => {\r\n\r\n    }\r\n\r\n    private renderBuyerAccount = (item: any) => {\r\n        let { buyerAccount } = item;\r\n        return <div>{tv(buyerAccount, (v) => {\r\n            let { id, description, organization } = v;\r\n            return <>{description}{tv(organization, (o) => {\r\n                return <>{o.name}</>\r\n            }, undefined, () => null)}</>\r\n        })}</div>\r\n    }\r\n\r\n    private renderBuyerAccounts = observer(() => {\r\n        let { buyerAccounts } = this.controller;\r\n        if (!buyerAccounts || buyerAccounts.length === 0) return null;\r\n        return <div className=\"row py-3 bg-white mb-1\">\r\n            <div className=\"col-4 col-sm-2 pb-2 text-muted\">订单账号:</div>\r\n            <div className=\"col-8 col-sm-10\">\r\n                <List items={buyerAccounts} item={{ render: this.renderBuyerAccount, onSelect: this.onBuyerAccountChanged }}></List>\r\n            </div>\r\n        </div>\r\n    })\r\n\r\n    private onSubmit = async () => {\r\n        let { orderData } = this.controller;\r\n        // 必填项验证\r\n        let { shippingContact, invoiceContact, invoiceType, invoiceInfo } = orderData;\r\n        if (!shippingContact) {\r\n            this.shippingAddressIsBlank = true;\r\n            setTimeout(() => this.shippingAddressIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n        if (!invoiceContact) {\r\n            if (this.useShippingAddress) {\r\n                orderData.invoiceContact = shippingContact; //contactBox;\r\n                this.invoiceAddressIsBlank = false;\r\n            } else {\r\n                this.invoiceAddressIsBlank = true;\r\n                setTimeout(() => this.invoiceAddressIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n                return;\r\n            }\r\n        }\r\n        if (!invoiceType || !invoiceInfo) {\r\n            this.invoiceIsBlank = true;\r\n            setTimeout(() => this.invoiceIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n\r\n        this.controller.submitOrder();\r\n    }\r\n\r\n    private page = observer(() => {\r\n\r\n        let { cApp, orderData, onSelectShippingContact, onSelectInvoiceContact, onInvoiceInfoEdit, onCouponEdit } = this.controller;\r\n        let { currentUser } = cApp;\r\n        let footer = <div className=\"d-block\">\r\n            <div className=\"w-100 px-3\">\r\n                <div className=\"d-flex justify-content-left flex-grow-1\">\r\n                    <span className=\"text-danger\" style={{ fontSize: '1.8rem' }}><small>¥</small>{orderData.amount}</span>\r\n                </div>\r\n                <button type=\"button\"\r\n                    className={classNames('btn', 'w-30', { 'btn-danger': currentUser.allowOrdering, 'btn-secondary': !currentUser.allowOrdering })}\r\n                    onClick={this.onSubmit} disabled={!currentUser.allowOrdering}>提交订单\r\n                </button>\r\n            </div>\r\n        </div >;\r\n\r\n        let chevronRight = <FA name=\"chevron-right\" className=\"cursor-pointer\" />\r\n        let shippingAddressBlankTip = this.shippingAddressIsBlank ?\r\n            <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写收货地址</div>\r\n            : null;\r\n        let invoiceAddressBlankTip = this.invoiceAddressIsBlank ? <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写发票地址</div> : null;\r\n\r\n        let divInvoiceContact: any = null;\r\n        if (this.useShippingAddress === false) {\r\n            if (orderData.invoiceContact !== undefined) {\r\n                divInvoiceContact = <div className=\"col-8 col-sm-10 offset-4 offset-sm-2 d-flex\">\r\n                    {tv(orderData.invoiceContact, undefined, undefined, this.nullContact)}\r\n                    <div>{chevronRight}</div>\r\n                </div>\r\n            } else {\r\n                divInvoiceContact = <div className=\"col-8 offset-4 offset-sm-2\">\r\n                    <button className=\"btn btn-outline-primary\"\r\n                        onClick={onSelectInvoiceContact}>选择发票地址</button>\r\n                    {invoiceAddressBlankTip}\r\n                </div>\r\n            }\r\n        }\r\n\r\n        let invoiceContactUI = <div className=\"row py-3 bg-white mb-1\">\r\n            <div className=\"col-4 col-sm-2 pb-2 text-muted\">发票地址:</div>\r\n            <div className=\"col-8 col-sm-10\">\r\n                <div>\r\n                    <label className=\"cursor-pointer\">\r\n                        <input type=\"checkbox\"\r\n                            defaultChecked={this.useShippingAddress}\r\n                            onChange={e => {\r\n                                this.useShippingAddress = e.currentTarget.checked;\r\n                                orderData.invoiceContact = undefined;\r\n                                this.invoiceAddressIsBlank = false;\r\n                            }} /> 同收货地址\r\n                    </label>\r\n                </div>\r\n            </div>\r\n            {divInvoiceContact}\r\n        </div>\r\n\r\n        let invoiceBlankTip = this.invoiceIsBlank ? <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写发票信息</div> : null;\r\n        let invoiceInfoUI = <div className=\"row py-3 bg-white mb-1\" onClick={onInvoiceInfoEdit}>\r\n            <div className=\"col-4 col-sm-2 pb-2 text-muted\">发票信息:</div>\r\n            <div className=\"col-8 col-sm-10\">\r\n                <LMR className=\"w-100 align-items-center\" right={chevronRight}>\r\n                    {tv(orderData.invoiceType, (v) => <>{v.description}</>, undefined, () => <span className=\"text-primary\">填写发票信息</span>)}\r\n                    {tv(orderData.invoiceInfo, (v) => <> -- {v.title}</>, undefined, () => <></>)}\r\n                    {invoiceBlankTip}\r\n                </LMR>\r\n            </div>\r\n        </div>\r\n\r\n        let freightFeeUI = <></>;\r\n        let freightFeeRemittedUI = <></>;\r\n        if (orderData.freightFee) {\r\n            freightFeeUI = <>\r\n                <div className=\"col-4 col-sm-2 pb-2 text-muted\">运费:</div>\r\n                <div className=\"col-8 col-sm-10 text-right text-danger\"><small>¥</small>{orderData.freightFee}</div>\r\n            </>\r\n            if (orderData.freightFeeRemitted) {\r\n                freightFeeRemittedUI = <>\r\n                    <div className=\"col-4 col-sm-2 pb-2 text-muted\">运费减免:</div>\r\n                    <div className=\"col-8 col-sm-10 text-right text-danger\"><small>¥</small>{orderData.freightFeeRemitted}</div>\r\n                </>\r\n            }\r\n        }\r\n\r\n        let couponUI = <></>;\r\n        if (1 === 1) {\r\n            couponUI = <div className=\"row py-3 bg-white mb-1\" onClick={onCouponEdit}>\r\n                <div className=\"col-4 col-sm-2 pb-2 text-muted\">优惠券/积分码:</div>\r\n                <div className=\"col-8 col-sm-10\">\r\n                    <LMR className=\"w-100 align-items-center\" right={chevronRight}>\r\n                        <this.renderCoupon couponOffsetAmount={orderData.couponOffsetAmount} couponRemitted={orderData.couponRemitted} couponCredits={orderData.couponCredits} />\r\n                    </LMR>\r\n                </div>\r\n            </div>\r\n        }\r\n\r\n        return <Page header=\"订单预览\" footer={footer}>\r\n            <div className=\"px-2\">\r\n                <div className=\"row py-3 bg-white mb-1\" onClick={onSelectShippingContact}>\r\n                    <div className=\"col-4 col-sm-2 pb-2 text-muted\">收货地址:</div>\r\n                    <div className=\"col-8 col-sm-10\">\r\n                        <LMR className=\"w-100 align-items-center\" right={chevronRight}>{tv(orderData.shippingContact, undefined, undefined, this.nullContact)}</LMR>\r\n                        {shippingAddressBlankTip}\r\n                    </div>\r\n                </div>\r\n                {invoiceContactUI}\r\n                {invoiceInfoUI}\r\n            </div>\r\n            <List items={orderData.orderItems} item={{ render: this.renderOrderItem, key: this.orderItemKey as any }} />\r\n            <div className=\"px-2\">\r\n                <div className=\"row py-3 pr-3 bg-white my-1\">\r\n                    <div className=\"col-4 col-sm-2 pb-2 text-muted\">商品总额:</div>\r\n                    <div className=\"col-8 col-sm-10 text-right\"><small>¥</small>{orderData.productAmount}</div>\r\n                    {freightFeeUI}\r\n                    {freightFeeRemittedUI}\r\n                </div >\r\n                {couponUI}\r\n            </div>\r\n        </Page >\r\n    })\r\n}","import { BoxId } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\nimport { CartPackRow } from 'cart/Cart';\r\n\r\nexport class Order {\r\n\r\n    webUser: any;\r\n    organization: BoxId;\r\n    customer: any;\r\n\r\n    @observable shippingContact: BoxId;\r\n    @observable invoiceContact: BoxId;\r\n    @observable invoiceType: BoxId;\r\n    @observable invoiceInfo: BoxId;\r\n    @observable orderItems: OrderItem[] = [];\r\n\r\n    @observable freightFee: number;\r\n    @observable freightFeeRemitted: number;\r\n\r\n    /*\r\n    @computed get amount() {\r\n        return parseFloat((this.orderItems.reduce((pv, cv) => (pv + cv.subAmount), 0) +\r\n            (this.freightFee ? this.freightFee : 0) +\r\n            (this.freightFeeRemitted ? this.freightFeeRemitted : 0) +\r\n            (this.couponOffsetAmount ? this.couponOffsetAmount : 0) +\r\n            (this.couponRemitted ? this.couponRemitted : 0)).toFixed(2));\r\n    };\r\n    */\r\n    @computed get amount() {\r\n        return parseFloat((this.orderItems.reduce((pv, cv) => (pv + cv.subAmount), 0) +\r\n            (this.freightFee ? this.freightFee : 0) +\r\n            (this.freightFeeRemitted ? this.freightFeeRemitted : 0)).toFixed(2));\r\n    };\r\n    // @computed get productAmount() {\r\n    //     return parseFloat(this.orderItems.reduce((pv, cv) => pv + cv.subAmount, 0).toFixed(2));\r\n    // };\r\n    @computed get productAmount() {\r\n        return parseFloat(this.orderItems.reduce((pv, cv) => pv + cv.subListAmount, 0).toFixed(2));\r\n    };\r\n    currency: BoxId;\r\n    @observable coupon: BoxId;\r\n    @observable couponOffsetAmount: number;\r\n    @observable couponRemitted: number;\r\n    @observable couponCredits: number;\r\n    salesRegion: BoxId;\r\n\r\n    getDataForSave() {\r\n        let orderItems: any[] = [];\r\n        this.orderItems.forEach(oi => {\r\n            oi.packs.forEach(pk => {\r\n                this.currency = pk.currency;\r\n                orderItems.push({\r\n                    product: oi.product, pack: pk.pack, price: pk.price, quantity: pk.quantity\r\n                    , subAmount: pk.quantity * pk.price\r\n                })\r\n            })\r\n        });\r\n        return {\r\n            webUser: this.webUser,\r\n            organization: this.organization,\r\n            customer: this.customer,\r\n            shippingContact: this.shippingContact,\r\n            invoiceContact: this.invoiceContact,\r\n            invoiceType: this.invoiceType,\r\n            invoiceInfo: this.invoiceInfo,\r\n            amount: this.amount,\r\n            currency: this.currency,\r\n            freightFee: this.freightFee,\r\n            freightFeeRemitted: this.freightFeeRemitted,\r\n            coupon: this.coupon,\r\n            couponOffsetAmount: this.couponOffsetAmount,\r\n            couponRemitted: this.couponRemitted,\r\n            orderitems: orderItems, // 前面的必须是小写的orderitems\r\n            salesRegion: this.salesRegion,\r\n        }\r\n    }\r\n}\r\n\r\nexport class OrderItem {\r\n\r\n    product: BoxId;\r\n    @observable packs: CartPackRow[];\r\n    @computed get subAmount() {\r\n        return this.packs.reduce((p, c) => {\r\n            return p + c.price * c.quantity\r\n        }, 0);\r\n    }\r\n    @computed get subListAmount() {\r\n        return this.packs.reduce((p, c) => {\r\n            return p + c.retail * c.quantity\r\n        }, 0);\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, FA } from 'tonva';\r\nimport { COrder } from './COrder';\r\n\r\nexport class OrderSuccess extends VPage<COrder> {\r\n\r\n    async open(orderCreateResult: any) {\r\n\r\n        this.openPage(this.page, orderCreateResult);\r\n    }\r\n\r\n    private page = (orderCreateResult: any) => {\r\n        return <Page header=\"下单成功\" back=\"close\">\r\n            <div className=\"py-4 px-3 bg-white mb-3 d-flex\">\r\n                <FA name=\"list-alt\" className=\"text-success mr-3\" size=\"4x\" />\r\n                <div>\r\n                    <p className=\"text-primary\"><span className=\"h4\">下单成功！</span></p>\r\n                    <p className=\"\">\r\n                        订单编号: <span className=\"h5 text-info\">{orderCreateResult.no}</span><br /><br />\r\n                        <span className=\"text-muted\">我们会加紧处理，请注意查收短信。</span>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </Page>\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { CSelectContact } from './CSelectContact';\r\nimport { List, LMR, FA } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VContactList extends VPage<CSelectContact> {\r\n\r\n    async open() {\r\n\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onContactRender = (contact: any) => {\r\n        let { onEditContact, onContactSelected } = this.controller;\r\n        let right = <div className=\"p-2 cursor-pointer text-info\" onClick={() => onEditContact(contact)}>\r\n            <FA name=\"edit\" />\r\n        </div>\r\n        return <LMR right={right} className=\"px-3 py-2\">\r\n            <div onClick={() => onContactSelected(contact)}>\r\n                {tv(contact)}\r\n            </div>\r\n        </LMR>\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { onNewContact, userContacts } = this.controller;\r\n        let footer = <button type=\"button\" className=\"btn btn-primary w-100\" onClick={() => onNewContact()} >添加新地址</button>;\r\n        let contactList = <List items={userContacts} item={{ render: this.onContactRender }} none=\"无地址\" />;\r\n        return <Page footer={footer} header=\"管理地址\">\r\n            {contactList}\r\n        </Page>\r\n    })\r\n}","\r\nexport function telephoneValidation(value: string) {\r\n    if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n        return \"固定电话格式不正确，请重新输入！\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function mobileValidation(value: string) {\r\n    if (value && !/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(value))\r\n        return \"手机号格式不正确，请重新输入！\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function emailValidation(value: string) {\r\n    if (value && !/\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/.test(value))\r\n        return \"Email格式不正确，请重新输入！\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function faxValidation(value: string) {\r\n    if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n        return \"传真号码格式不正确，请重新输入！\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function addressDetailValidation(value: string) {\r\n    return (value && value.length > 200) ? \"详细地址最多200个字！\" : undefined;\r\n}\r\n\r\nexport function zipCodeValidation(value: string) {\r\n    return (value && value.length > 15) ? \"邮编过长，请修改后录入！\" : undefined;\r\n}\r\n\r\n\r\nexport function organizationNameValidation(value: string) {\r\n    return (value && value.length > 100) ? \"单位名称最多100个字！\" : undefined;\r\n}\r\n\r\nexport function departmentNameValidation(value: string) {\r\n    return (value && value.length > 100) ? \"部门名称名称最多100个字！\" : undefined;\r\n}\r\n\r\nexport function salutationValidation(value: string) {\r\n    return (value && value.length > 100) ? \"单位名称最多100个字！\" : undefined;\r\n}\r\n\r\nexport function nameValidation(value: string) {\r\n    return (value && value.length > 50) ? \"姓名最多50个字！\" : undefined;\r\n}","import * as React from 'react';\r\nimport _ from 'lodash';\r\nimport { VPage, Page, Form, Schema, UiSchema, Context, UiInputItem, UiIdItem, BoxId } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { CSelectContact } from './CSelectContact';\r\nimport { addressDetailValidation, emailValidation, telephoneValidation, mobileValidation, organizationNameValidation, nameValidation } from 'tools/inputValidations';\r\n\r\nconst schema: Schema = [\r\n    { name: 'id', type: 'id', required: false },\r\n    { name: 'name', type: 'string', required: true },\r\n    { name: 'organizationName', type: 'string', required: true },\r\n    { name: 'mobile', type: 'string', required: true },\r\n    { name: 'telephone', type: 'string', required: false },\r\n    { name: 'email', type: 'string', required: false },\r\n    { name: 'address', type: 'id', required: true },\r\n    { name: 'addressString', type: 'string', required: true },\r\n    { name: 'isDefault', type: 'boolean', required: false },\r\n];\r\n\r\nexport class VContact extends VPage<CSelectContact> {\r\n\r\n    private userContactData: any;\r\n    private form: Form;\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            id: { visible: false },\r\n            name: { widget: 'text', label: '姓名', placeholder: '姓名', rules: nameValidation } as UiInputItem,\r\n            organizationName: { widget: 'text', label: '单位名称', placeholder: '单位名称', rules: organizationNameValidation } as UiInputItem,\r\n            mobile: { widget: 'text', label: '手机号', placeholder: '手机号', rules: mobileValidation } as UiInputItem, telephone: { widget: 'text', label: '电话', placeholder: '电话', rules: telephoneValidation } as UiInputItem,\r\n            email: { widget: 'email', label: 'Email', rules: emailValidation, placeholder: 'Email' } as UiInputItem,\r\n            address: {\r\n                widget: 'id', label: '所在地区', placeholder: '所在地区',\r\n                pickId: async (context: Context, name: string, value: number) => await this.controller.pickAddress(context, name, value),\r\n                Templet: (address: BoxId) => {\r\n                    return tv(address, (addressValue) => {\r\n                        let { country, province, city, county } = addressValue;\r\n                        /* 下面这种在使用tv之前的一堆判断应该是tv或者什么的有bug, 应该让Henry改改 */\r\n                        return <div className=\"text-truncate\">\r\n                            {country && country.id && tv(country, v => <>{v.chineseName}</>)}\r\n                            {province && province.id && tv(province, (v) => <>{v.chineseName}</>)}\r\n                            {city && city.id && tv(city, (v) => <>{v.chineseName}</>)}\r\n                            {county && county.id && tv(county, (v) => <>{v.chineseName}</>)}\r\n                        </div>;\r\n                    }, () => {\r\n                        return <small className=\"text-muted\">请选择地区</small>;\r\n                    })\r\n                }\r\n            } as UiIdItem,\r\n            addressString: { widget: 'text', label: '详细地址', placeholder: '详细地址', className: \"text-truncate\", rules: addressDetailValidation } as UiInputItem,\r\n            isDefault: { widget: 'checkbox', label: '作为默认地址' },\r\n            submit: { widget: 'button', label: '提交' },\r\n        }\r\n    }\r\n\r\n    async open(userContactData: any) {\r\n        this.userContactData = userContactData;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onSaveContact = async () => {\r\n        if (!this.form) return;\r\n        await this.form.buttonClick(\"submit\");\r\n    }\r\n\r\n    private onFormButtonClick = async (name: string, context: Context) => {\r\n        await this.controller.saveContact(context.form.data);\r\n    }\r\n\r\n    private onDelContact = async () => {\r\n        let { contact } = this.userContactData;\r\n        if (await this.vCall(VConfirmDeleteContact, contact) === true) {\r\n            await this.controller.delContact(contact);\r\n            this.closePage();\r\n        };\r\n    }\r\n\r\n    private page = () => {\r\n        let contactData = _.clone(this.userContactData.contact);\r\n\r\n        let buttonDel: any;\r\n        if (contactData !== undefined) {\r\n            buttonDel = <button className=\"btn btn-sm btn-info\" onClick={this.onDelContact}>删除</button>;\r\n        } else {\r\n            let { defaultOrganizationName, defaultName, defaultMobile, address, addressString } = this.controller.cApp.currentUser;\r\n            contactData = {\r\n                'organizationName': defaultOrganizationName,\r\n                'name': defaultName,\r\n                'mobile': defaultMobile,\r\n                'address': address,\r\n                'addressString': addressString\r\n            };\r\n        }\r\n        let { fromOrderCreation } = this.controller;\r\n        let footer = <button type=\"button\"\r\n            className=\"btn btn-primary w-100\"\r\n            onClick={this.onSaveContact}>{fromOrderCreation ? '保存并使用' : '保存'}</button>;\r\n        return <Page header=\"地址信息\" footer={footer} right={buttonDel}>\r\n            <div className=\"App-container container text-left\">\r\n                <Form ref={v => this.form = v} className=\"my-3\"\r\n                    schema={schema}\r\n                    uiSchema={this.uiSchema}\r\n                    formData={contactData}\r\n                    onButtonClick={this.onFormButtonClick}\r\n                    fieldLabelSize={3} />\r\n            </div>\r\n        </Page>\r\n    }\r\n}\r\n\r\nclass VConfirmDeleteContact extends VPage<CSelectContact> {\r\n    async open(contact: any) {\r\n        this.openPage(this.page, contact);\r\n    }\r\n\r\n    private onConfirm = async () => {\r\n        await this.returnCall(true);\r\n        this.closePage();\r\n    }\r\n\r\n    private onCancel = async () => {\r\n        await this.returnCall(false);\r\n        this.closePage();\r\n    }\r\n\r\n    private page = (contact: any) => {\r\n        return <Page header=\"删除地址\" back=\"close\">\r\n            <div className=\"w-75 mx-auto border border-primary rounded my-3 p-3 bg-white\">\r\n                <div className=\"p-4 position-relative\">\r\n                    <i className=\"fa fa-question-circle position-absolute fa-2x text-warning\" style={{ left: 0, top: 0 }} />\r\n                    <b className=\"\">是否删除该地址？</b>\r\n                </div>\r\n                <div className=\"d-flex mt-3 justify-content-end\">\r\n                    <button className=\"btn btn-danger mr-3\" onClick={this.onConfirm}>删除地址</button>\r\n                    <button className=\"btn btn-outline-info mr-3\" onClick={this.onCancel}>取消</button>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page, BoxId } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { List, FA } from 'tonva';\r\nimport { CAddress } from './CAddress';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class VAddress extends VPage<CAddress> {\r\n    private provinceId: number;\r\n    private cityId: number;\r\n    private countyId: number;\r\n    private backLevel = 0;\r\n\r\n    async open(param: any) {\r\n        let provinces = await this.controller.getCountryProvince(GLOABLE.CHINA);\r\n        this.openPage(this.page, { provinces: provinces });\r\n    }\r\n\r\n    private page = (param: any) => {\r\n        this.backLevel++;\r\n        return <Page header=\"选择所在省市\">\r\n            <div className=\"row no-gutters\">\r\n                {param.provinces.map((v: any) => this.renderPCC(v.province, this.onProvinceClick))}\r\n            </div>\r\n        </Page>\r\n    }\r\n\r\n    private renderPCC = (pcc: BoxId, onClick: any) => {\r\n        return <div key={pcc.id} className=\"col-6 col-md-4 col-lg-3 cursor-pointer\">\r\n            {tv(pcc, (value) => {\r\n                let { id, chineseName } = value;\r\n                return <>\r\n                    <div className=\"pt-1 pb-1 px-2\" onClick={() => onClick(id)}\r\n                        style={{ border: '1px solid #eeeeee', marginRight: '-1px', marginBottom: '-1px' }}\r\n                    >\r\n                        <span className=\"ml-1 align-middle\">\r\n                            <FA name=\"chevron-right\" className=\"text-info small\" />\r\n                            &nbsp; {chineseName}\r\n                        </span>\r\n                    </div>\r\n                </>;\r\n            })}\r\n        </div>\r\n    }\r\n\r\n    private onProvinceClick = async (provinceId: any) => {\r\n        this.provinceId = provinceId;\r\n        let cities = await this.controller.getProvinceCities(provinceId);\r\n        if (cities) {\r\n            let len = cities.length;\r\n            if (len === 1) {\r\n                await this.onCityClick(cities[0].city.id);\r\n                return;\r\n            }\r\n            if (len > 1) {\r\n                this.backLevel++;\r\n                this.openPageElement(<Page header=\"选择所在城市\">\r\n                    <div className=\"row no-gutters\">\r\n                        {cities.map(v => this.renderPCC(v.city, this.onCityClick))}\r\n                    </div>\r\n                </Page>);\r\n                return;\r\n            }\r\n        } else {\r\n            this.closePage(this.backLevel);\r\n            this.saveAddress();\r\n        }\r\n    }\r\n\r\n    private onCityClick = async (cityId: any) => {\r\n        this.cityId = cityId;\r\n        let counties = await this.controller.getCityCounties(cityId);\r\n        if (counties && counties.length > 0) {\r\n            this.backLevel++;\r\n            this.openPageElement(<Page header=\"选择所在区县\">\r\n                <div className=\"row no-gutters\">\r\n                    {counties.map(v => this.renderPCC(v.county, this.onCountyClick))}\r\n                </div>\r\n            </Page>);\r\n        } else {\r\n            this.closePage(this.backLevel);\r\n            this.saveAddress();\r\n        }\r\n    }\r\n\r\n    private onCountyClick = async (countyId: any) => {\r\n        this.countyId = countyId;\r\n        this.closePage(this.backLevel);\r\n        this.saveAddress();\r\n    }\r\n\r\n    private saveAddress = async () => {\r\n        await this.controller.saveAddress(GLOABLE.CHINA, this.provinceId, this.cityId, this.countyId);\r\n    }\r\n}\r\n","import { VAddress } from './VAddress';\r\nimport { CUqBase } from '../CBase';\r\n\r\nexport class CAddress extends CUqBase {\r\n    protected async internalStart() {\r\n        this.openVPage(VAddress);\r\n    }\r\n\r\n    getCountryProvince = async (countryId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetCountryProvinces.table({ country: countryId });\r\n    }\r\n\r\n    getProvinceCities = async (provinceId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetProvinceCities.table({ province: provinceId });\r\n    }\r\n\r\n    getCityCounties = async (cityId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetCityCounties.table({ city: cityId });\r\n    }\r\n\r\n    saveAddress = async (countryId: number, provinceId: number, cityId?: number, countyId?: number): Promise<any> => {\r\n        let { Address } = this.uqs.common;\r\n        let newAddress = await Address.save(undefined, { country: countryId, province: provinceId, city: cityId, county: countyId });\r\n        let addressId = newAddress && Address.boxId(newAddress.id);\r\n        this.returnCall(addressId);\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport _ from 'lodash';\r\nimport { Context, BoxId } from 'tonva';\r\nimport { CUqBase } from '../CBase';\r\nimport { VContactList } from './VContactList';\r\n//import { CCartApp } from 'CCartApp';\r\nimport { VContact } from './VContact';\r\nimport { CAddress } from './CAddress';\r\n\r\nexport abstract class CSelectContact extends CUqBase {\r\n    fromOrderCreation: boolean;\r\n\r\n    @observable userContacts: BoxId[] = [];\r\n\r\n    async internalStart(fromOrderCreation: boolean/*contactType: ContactType*/) {\r\n        this.fromOrderCreation = fromOrderCreation;\r\n        let userContactMaps = await this.cApp.currentUser.getContacts();\r\n        this.userContacts = userContactMaps.map((v: any) => v.contact);\r\n        this.openVPage(VContactList);\r\n        if (this.fromOrderCreation && (!this.userContacts || this.userContacts.length === 0)) {\r\n            this.onNewContact();\r\n        }\r\n    }\r\n\r\n    protected abstract async getIsDefault(userSetting: any, userContactId: number): Promise<boolean>;\r\n\r\n    /**\r\n     * 打开地址新建界面\r\n     */\r\n    onNewContact = async () => {\r\n        this.openVPage(VContact, { contact: undefined });\r\n    }\r\n\r\n    /**\r\n     * 打开地址编辑界面\r\n     */\r\n    onEditContact = async (userContact: BoxId) => {\r\n        let userContactId = userContact.id;\r\n        let contact = await this.uqs.customer.Contact.load(userContactId);\r\n        let userSetting = await this.cApp.currentUser.getSetting();\r\n        contact.isDefault = await this.getIsDefault(userSetting, userContactId);\r\n        let userContactData: any = { contact: contact };\r\n        this.openVPage(VContact, userContactData);\r\n    }\r\n\r\n    delContact = async (contact: any) => {\r\n        let { id } = contact;\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.delContact(id);\r\n        if (contact.isDefault) {\r\n            this.setDefaultContact(undefined);\r\n        }\r\n        let index = this.userContacts.findIndex(v => v.id === id);\r\n        if (index > -1)\r\n            this.userContacts.splice(index, 1);\r\n    }\r\n\r\n    saveContact = async (contact: any) => {\r\n        let { Contact: contactTuid } = this.uqs.customer;\r\n        let newContact = await contactTuid.save(undefined, contact);\r\n        let { id: newContactId } = newContact;\r\n        let contactBox = contactTuid.boxId(newContactId);\r\n\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.addContact(newContactId);\r\n        this.userContacts.push(contactBox);\r\n        let { id, isDefault } = contact;\r\n        if (isDefault === true || this.userContacts.length === 1) {\r\n            await this.setDefaultContact(contactBox);\r\n        }\r\n        // contact.id !== undefined表示是修改了已有的contact(我们只能用“替换”表示“修改”，所以此时需要删除原contact)\r\n        if (id !== undefined) {\r\n            await currentUser.delContact(id);\r\n            let index = this.userContacts.findIndex(v => v.id === id);\r\n            if (index > -1)\r\n                this.userContacts.splice(index, 1);\r\n        }\r\n        this.backPage();\r\n        if (this.fromOrderCreation) {\r\n            this.onContactSelected(contactBox);\r\n        }\r\n    }\r\n\r\n    protected abstract async setDefaultContact(contactId: BoxId): Promise<any>;\r\n\r\n    onContactSelected = (contact: BoxId) => {\r\n        if (this.fromOrderCreation) {\r\n            this.backPage();\r\n            this.returnCall(contact);\r\n        }\r\n    }\r\n\r\n    pickAddress = async (context: Context, name: string, value: number): Promise<number> => {\r\n        let cAddress = this.newC(CAddress); // new CAddress(this.cApp, undefined);\r\n        return await cAddress.call<number>();\r\n    }\r\n}\r\n\r\nexport class CSelectShippingContact extends CSelectContact {\r\n    protected async getIsDefault(userSetting: any, userContactId: number): Promise<boolean> {\r\n        if (userSetting !== undefined) {\r\n            let { shippingContact } = userSetting;\r\n            return shippingContact && shippingContact.id === userContactId;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected async setDefaultContact(contactId: BoxId) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultShippingContact(contactId);\r\n    }\r\n}\r\n\r\nexport class CSelectInvoiceContact extends CSelectContact {\r\n    protected async getIsDefault(userSetting: any, userContactId: number): Promise<boolean> {\r\n        if (userSetting !== undefined) {\r\n            let { invoiceContact } = userSetting;\r\n            return invoiceContact && invoiceContact.id === userContactId;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected async setDefaultContact(contactId: BoxId) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultInvoiceContact(contactId);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { List, EasyDate } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { async } from 'q';\r\n\r\nexport class VMyOrders extends VPage<COrder> {\r\n\r\n    @observable private pendingOrders: any[];\r\n    @observable private processingOrders: any[];\r\n    @observable private completedOrders: any[];\r\n    @observable private allOrders: any[];\r\n    private currentState: string;\r\n    async open(param: any) {\r\n        this.currentState = param;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderOrder = (order: any, index: number) => {\r\n        let { openOrderDetail } = this.controller;\r\n        let { id, no, date, discription, flow } = order;\r\n        return <div className=\"m-3 justify-content-between cursor-pointer\" onClick={() => openOrderDetail(id)}>\r\n            <div><span className=\"small text-muted\">订单编号: </span><strong>{no}</strong></div>\r\n            <div className=\"small text-muted\"><EasyDate date={date} /></div>\r\n        </div>;\r\n    }\r\n\r\n    private page = () => {\r\n\r\n        let tabs = [{\r\n            title: '待审核',\r\n            content: () => {\r\n                return <List items={this.processingOrders} item={{ render: this.renderOrder }} none=\"无待审核订单\" />\r\n            },\r\n            isSelected: this.currentState === 'processing',\r\n            load: async () => {\r\n                this.currentState = 'processing';\r\n                this.processingOrders = await this.controller.getMyOrders(this.currentState);\r\n            }\r\n        }, {\r\n            title: '待发货',\r\n            content: () => {\r\n                return <List items={this.completedOrders} item={{ render: this.renderOrder }} none=\"还没有已完成的订单\" />\r\n            },\r\n            isSelected: this.currentState === 'completed',\r\n            load: async () => {\r\n                this.currentState = 'completed';\r\n                this.completedOrders = await this.controller.getMyOrders(this.currentState);\r\n            }\r\n        }, {\r\n            title: '所有订单',\r\n            content: () => {\r\n                return <List items={this.allOrders} item={{ render: this.renderOrder }} none=\"还没有订单\" />\r\n            },\r\n            isSelected: this.currentState === 'all',\r\n            load: async () => {\r\n                this.currentState = 'all';\r\n                this.allOrders = await this.controller.getMyOrders(this.currentState);\r\n            }\r\n        }];\r\n        return <Page header=\"我的订单\" tabs={tabs} tabPosition=\"top\" />\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, BoxId, EasyTime, EasyDate } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { tv } from 'tonva';\r\nimport { List } from 'tonva';\r\nimport { OrderItem } from './Order';\r\n\r\nexport class VOrderDetail extends VPage<COrder> {\r\n\r\n    async open(order: any) {\r\n\r\n        this.openPage(this.page, order);\r\n    }\r\n\r\n\r\n    private packsRow = (item: any, index: number) => {\r\n        let { pack, quantity, price, currency } = item;\r\n\r\n        return <div key={index} className=\"px-2 py-2 border-top\">\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-12c mr-4 text-right\">\r\n                    <span className=\"text-danger h5\"><small>¥</small>{parseFloat((price * quantity).toFixed(2))}</span>\r\n                    <small className=\"text-muted\">(¥{parseFloat(price.toFixed(2))} × {quantity})</small>\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private renderOrderItem = (orderItem: OrderItem) => {\r\n        let { product, packs } = orderItem;\r\n        let { controller, packsRow } = this;\r\n        return <div>\r\n            <div className=\"row p-1 my-1\">\r\n                <div className=\"col-lg-6 pb-3\">{controller.renderOrderItemProduct(product)}</div>\r\n                <div className=\"col-lg-6\">{\r\n                    packs.map((p, index) => {\r\n                        return packsRow(p, index);\r\n                    })\r\n                }</div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private page = (order: any) => {\r\n\r\n        let { brief, data } = order;\r\n        let { id, no, state, description, date } = brief;\r\n        let { orderItems, currency, shippingContact, invoiceContact, invoiceType, invoiceInfo, amount, couponOffsetAmount, couponRemitted\r\n            , freightFee, freightFeeRemitted } = data;\r\n        let couponUI;\r\n        if (couponOffsetAmount || couponRemitted) {\r\n            let offsetUI, remittedUI;\r\n            if (couponOffsetAmount) {\r\n                offsetUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                    <div className=\"text-muted\">折扣:</div>\r\n                    <div className=\"text-right text-danger\"><small>¥</small>{couponOffsetAmount}</div>\r\n                </div>\r\n            }\r\n            if (couponRemitted) {\r\n                remittedUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                    <div className=\"text-muted\">抵扣:</div>\r\n                    <div className=\"text-right text-danger\"><small>¥</small>{couponRemitted}</div>\r\n                </div>\r\n            }\r\n            couponUI = <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">优惠券:</div>\r\n                <div className=\"col-9\">\r\n                    {offsetUI}\r\n                    {remittedUI}\r\n                </div>\r\n            </div>\r\n        }\r\n\r\n        let freightFeeUI, freightFeeRemittedUI;\r\n        if (freightFee) {\r\n            freightFeeUI = <>\r\n                <div className=\"text-right text-danger\"><small>¥</small>{freightFee}</div>\r\n            </>\r\n            if (freightFeeRemitted) {\r\n                freightFeeRemittedUI = <>\r\n                    <div className=\"text-right text-danger\"><small>¥</small>{freightFeeRemitted}(减免)</div>\r\n                </>\r\n            }\r\n        }\r\n\r\n        let header = <>订单详情: {no}</>\r\n        return <Page header={header}>\r\n            <List items={orderItems} item={{ render: this.renderOrderItem }} />\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">收货地址:</div>\r\n                <div className=\"col-9\">{tv(shippingContact)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">发票地址:</div>\r\n                <div className=\"col-9\">{tv(invoiceContact)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">发票信息:</div>\r\n                <div className=\"col-9\">{invoiceTemplate(invoiceType, invoiceInfo)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">运费:</div>\r\n                <div className=\"col-9\">{freightFeeUI}{freightFeeRemittedUI}</div>\r\n            </div>\r\n            {couponUI}\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">下单时间:</div>\r\n                <div className=\"col-9 text-right\"><EasyDate date={date} /></div>\r\n            </div>\r\n            <div className=\"bg-white p-3 my-1 text-right\">\r\n                <span className=\"text-danger font-weight-bold\">总金额: {amount}{tv(currency)}</span>\r\n            </div>\r\n        </Page>\r\n    }\r\n}\r\n\r\nfunction invoiceTemplate(invoiceType: BoxId, invoiceInfo: BoxId): JSX.Element {\r\n    return <>\r\n        {tv(invoiceType, invoiceTypeUI, undefined, () => <></>)}<br />\r\n        {tv(invoiceInfo, invoiceInfoUI, undefined, () => <></>)}\r\n    </>\r\n}\r\n\r\nfunction invoiceTypeUI(values: any) {\r\n    let { id, description } = values;\r\n    return <>{description}</>;\r\n}\r\n\r\nfunction invoiceInfoUI(values: any) {\r\n    let { id, title, taxNo, address, telephone, bank, accountNo } = values;\r\n    return <>{title}</>;\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, UiSchema, UiInputItem, Form, Context, tv, BoxId, FA } from 'tonva';\r\nimport { Schema } from 'tonva';\r\nimport { CInvoiceInfo } from './CInvoiceInfo';\r\n\r\nconst schema: Schema = [\r\n    { name: 'id', type: 'id', required: false },\r\n    { name: 'title', type: 'string', required: false },\r\n    { name: 'taxNo', type: 'string', required: false },\r\n    { name: 'address', type: 'id', required: false },\r\n    { name: 'telephone', type: 'string', required: false },\r\n    { name: 'bank', type: 'string', required: false },\r\n    { name: 'accountNo', type: 'string', required: false },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n    items: {\r\n        id: { visible: false },\r\n        title: {\r\n            widget: 'text', label: '单位全称', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 200) ? '单位全称最多200个字！' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        taxNo: {\r\n            widget: 'text', label: '纳税人识别码', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                if (value) {\r\n                    var regArr = [/^[\\da-z]{10,15}$/i, /^\\d{6}[\\da-z]{10,12}$/i, /^[a-z]\\d{6}[\\da-z]{9,11}$/i, /^[a-z]{2}\\d{6}[\\da-z]{8,10}$/i, /^\\d{14}[\\dx][\\da-z]{4,5}$/i, /^\\d{17}[\\dx][\\da-z]{1,2}$/i, /^[a-z]\\d{14}[\\dx][\\da-z]{3,4}$/i, /^[a-z]\\d{17}[\\dx][\\da-z]{0,1}$/i, /^[\\d]{6}[\\da-z]{13,14}$/i],\r\n                        j = regArr.length;\r\n                    for (var i = 0; i < j; i++) {\r\n                        if (regArr[i].test(value)) {\r\n                            return undefined;\r\n                        }\r\n                    }\r\n                    return '纳税人识别码格式不正确，请重新输入！';\r\n                }\r\n            }\r\n        } as UiInputItem,\r\n        address: {\r\n            widget: 'text', label: '注册地址', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 200) ? '注册地址最多200个字！' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        telephone: {\r\n            widget: 'text', label: '注册电话', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n                    return \"注册电话格式不正确，请重新输入！\";\r\n                else\r\n                    return undefined;\r\n            }\r\n        } as UiInputItem,\r\n        bank: {\r\n            widget: 'text', label: '开户银行', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 100) ? '开户银行名称最多100个字！' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        accountNo: {\r\n            widget: 'text', label: '银行账号', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                if (value && !/^([1-9]{1})(\\d{14}|\\d{18}|\\d{15})$/.test(value))\r\n                    return \"银行账号格式不正确，请重新输入！\";\r\n                else\r\n                    return undefined;\r\n            }\r\n        } as UiInputItem,\r\n        submit: { widget: 'button', label: '提交' },\r\n    }\r\n}\r\n\r\nconst commonRequired = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: false,\r\n    address: false,\r\n    telephone: false,\r\n    bank: false,\r\n    accountNo: false,\r\n    isDefault: false,\r\n};\r\n\r\nconst valueAddedRequired = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: true,\r\n    address: true,\r\n    telephone: true,\r\n    bank: true,\r\n    accountNo: true,\r\n    isDefault: false,\r\n}\r\n\r\nconst commonVisible = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: false,\r\n    address: false,\r\n    telephone: false,\r\n    bank: false,\r\n    accountNo: false,\r\n    isDefault: true,\r\n};\r\n\r\nconst valueAddedVisible = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: true,\r\n    address: true,\r\n    telephone: true,\r\n    bank: true,\r\n    accountNo: true,\r\n    isDefault: true,\r\n}\r\n\r\nexport class VInvoiceInfo extends VPage<CInvoiceInfo> {\r\n    private form: Form;\r\n    @observable showTip: boolean = false;\r\n    saveTip: string = \"\";\r\n    private invoiceInfoData: any;\r\n\r\n    async open(origInvoice?: any) {\r\n        let { invoiceType, invoiceInfo } = origInvoice;\r\n        this.invoiceType = (invoiceType && invoiceType.id) || 1;\r\n        if (invoiceInfo) {\r\n            invoiceInfo.assure();\r\n            this.invoiceInfoData = { ...invoiceInfo.obj };\r\n        } else {\r\n            this.invoiceInfoData = { 'title': this.controller.cApp.currentUser.defaultOrganizationName };\r\n        }\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onFormButtonClick = async (name: string, context: Context) => {\r\n        let { form } = context;\r\n        let { data } = form;\r\n        let invoice = {\r\n            invoiceType: this.invoiceType,\r\n            invoiceInfo: data,\r\n        };\r\n        this.invoiceInfoData = data;\r\n\r\n        try {\r\n            await this.controller.saveInvoiceInfo(invoice);\r\n            this.saveTip = \"发票信息已经保存\";\r\n        } catch (error) {\r\n            this.saveTip = \"发票信息保存失败，请稍后再试\";\r\n        }\r\n        this.showTip = true;\r\n        setTimeout(() => { this.showTip = false; }, 2000);\r\n    }\r\n\r\n    private onSaveInvoice = async () => {\r\n        if (!this.form) return;\r\n        await this.form.buttonClick(\"submit\");\r\n    }\r\n\r\n    @observable invoiceType: number;\r\n\r\n    private buildForm(): JSX.Element {\r\n        let requiredFields: any = this.invoiceType === 1 ? commonRequired : valueAddedRequired;\r\n        let visibleFields: any = this.invoiceType === 1 ? commonVisible : valueAddedVisible;\r\n        schema.forEach(e => {\r\n            let { items } = uiSchema;\r\n            e.required = requiredFields[e.name];\r\n            items[e.name].visible = visibleFields[e.name];\r\n        });\r\n        return <Form ref={v => this.form = v} className=\"my-3\"\r\n            schema={schema}\r\n            uiSchema={uiSchema}\r\n            formData={this.invoiceInfoData}\r\n            onButtonClick={this.onFormButtonClick}\r\n            fieldLabelSize={3} />\r\n    }\r\n\r\n    private onInvoiceTypeClick = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.invoiceType = parseInt(event.currentTarget.value);\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let frm = this.buildForm();\r\n\r\n        let tipUI = this.showTip ? (<div className=\"alert alert-primary\" role=\"alert\">\r\n            <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n            {this.saveTip}\r\n        </div>) : null;\r\n        return <Page header=\"发票\">\r\n            <div className=\"px-3\">\r\n                <div className=\"form-group row py-3 mb-1 bg-white\">\r\n                    <div className=\"col-12 col-sm-3 pb-2 text-muted\">发票类型:</div>\r\n                    <div className=\"col-12 col-sm-9\">\r\n                        <div className=\"form-check form-check-inline\">\r\n                            <input className=\"form-check-input\" type=\"radio\" name=\"invoiceType\" id=\"common\" value=\"1\"\r\n                                onChange={(event) => this.onInvoiceTypeClick(event)} checked={this.invoiceType === 1}></input>\r\n                            <label className=\"form-check-label\" htmlFor=\"common\">增值税普通发票</label>\r\n                        </div>\r\n                        <div className=\"form-check form-check-inline\">\r\n                            <input className=\"form-check-input\" type=\"radio\" name=\"invoiceType\" id=\"valueAdded\" value=\"2\"\r\n                                onChange={(event) => this.onInvoiceTypeClick(event)} checked={this.invoiceType === 2}></input>\r\n                            <label className=\"form-check-label\" htmlFor=\"valueAdded\">增值税专用发票</label>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"p-3 bg-white\">\r\n                {frm}\r\n                <button type=\"button\"\r\n                    className=\"btn btn-primary w-100\"\r\n                    onClick={this.onSaveInvoice}>确定</button>\r\n                {tipUI}\r\n            </div>\r\n        </Page>\r\n    });\r\n}","//import { Controller } from 'tonva';\r\nimport { CUqBase } from '../CBase';\r\nimport { VInvoiceInfo } from './VInvoiceInfo';\r\n//import { CCartApp } from 'CCartApp';\r\n//import { Tuid } from 'tonva';\r\n\r\nexport class CInvoiceInfo extends CUqBase {\r\n    fromOrderCreation: boolean;\r\n\r\n    async internalStart(origInvoice: any, fromOrderCreation: boolean) {\r\n        this.fromOrderCreation = fromOrderCreation;\r\n        this.openVPage(VInvoiceInfo, origInvoice);\r\n    }\r\n\r\n    async saveInvoiceInfo(invoice: any) {\r\n        let { invoiceType, invoiceInfo, isDefault } = invoice;\r\n        let newInvoiceInfo = await this.uqs.customer.InvoiceInfo.save(undefined, invoiceInfo);\r\n\r\n        let { id: newInvoiceInfoId } = newInvoiceInfo;\r\n        let invoiceBox = {\r\n            invoiceType: this.uqs.common.InvoiceType.boxId(invoiceType),\r\n            invoiceInfo: this.uqs.customer.InvoiceInfo.boxId(newInvoiceInfoId),\r\n        }\r\n        // if (isDefault === true || !this.fromOrderCreation) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultInvoice(invoiceBox.invoiceType, invoiceBox.invoiceInfo);\r\n        // }\r\n        if (this.fromOrderCreation) {\r\n            this.backPage();\r\n            this.returnCall(invoiceBox);\r\n        }\r\n    }\r\n}","import { observable } from 'mobx';\r\nimport { BoxId } from 'tonva';\r\nimport { nav } from 'tonva';\r\nimport { CUqBase } from '../CBase';\r\nimport { VCreateOrder } from './VCreateOrder';\r\nimport { Order, OrderItem } from './Order';\r\nimport { OrderSuccess } from './OrderSuccess';\r\nimport { CSelectShippingContact, CSelectInvoiceContact } from '../customer/CSelectContact';\r\nimport { VMyOrders } from './VMyOrders';\r\nimport { VOrderDetail } from './VOrderDetail';\r\nimport { CInvoiceInfo } from '../customer/CInvoiceInfo';\r\nimport { groupByProduct } from '../tools/groupByProduct';\r\nimport { CartItem2 } from '../cart/Cart';\r\n\r\nconst FREIGHTFEEFIXED = 12;\r\nconst FREIGHTFEEREMITTEDSTARTPOINT = 100;\r\n\r\nexport class COrder extends CUqBase {\r\n    //    cApp: CApp;\r\n    @observable orderData: Order = new Order();\r\n    @observable couponData: any = {};\r\n    @observable buyerAccounts: any[] = [];\r\n\r\n    protected async internalStart(param: any) {\r\n        let cart = param;\r\n        await this.createOrderFromCart(cart);\r\n        this.openVPage(VCreateOrder);\r\n    }\r\n\r\n    private createOrderFromCart = async (cartItems: CartItem2[]) => {\r\n        let { currentUser, currentSalesRegion, currentCouponCode } = this.cApp;\r\n        this.orderData.webUser = currentUser.id;\r\n        this.orderData.salesRegion = currentSalesRegion.id;\r\n        this.removeCoupon();\r\n\r\n        let buyerAccountQResult = await this.uqs.webuser.WebUserBuyerAccount.query({ webUser: currentUser.id })\r\n        if (buyerAccountQResult) {\r\n            this.buyerAccounts = buyerAccountQResult.ret;\r\n            if (this.buyerAccounts && this.buyerAccounts.length === 1) {\r\n                this.orderData.customer = this.buyerAccounts[0].buyerAccount;\r\n            }\r\n        }\r\n\r\n        if (this.orderData.shippingContact === undefined) {\r\n            this.orderData.shippingContact = await this.getDefaultShippingContact();\r\n        }\r\n\r\n        if (this.orderData.invoiceContact === undefined) {\r\n            this.orderData.invoiceContact = await this.getDefaultInvoiceContact();\r\n        }\r\n\r\n        if (this.orderData.invoiceType === undefined) {\r\n            this.orderData.invoiceType = await this.getDefaultInvoiceType();\r\n        }\r\n\r\n        if (this.orderData.invoiceInfo === undefined) {\r\n            this.orderData.invoiceInfo = await this.getDefaultInvoiceInfo();\r\n        }\r\n\r\n        if (cartItems !== undefined && cartItems.length > 0) {\r\n            this.orderData.currency = cartItems[0].packs[0].currency;\r\n            this.orderData.orderItems = cartItems.map((e: any) => {\r\n                var item = new OrderItem();\r\n                item.product = e.product;\r\n                item.packs = e.packs.map((v: any) => { return { ...v } }).filter((v: any) => v.quantity > 0 && v.price);\r\n                item.packs.forEach((pk) => {\r\n                    pk.retail = pk.price;\r\n                })\r\n                return item;\r\n            });\r\n\r\n            // 运费和运费减免\r\n            this.orderData.freightFee = FREIGHTFEEFIXED;\r\n            if (this.orderData.productAmount > FREIGHTFEEREMITTEDSTARTPOINT)\r\n                this.orderData.freightFeeRemitted = FREIGHTFEEFIXED * -1;\r\n        }\r\n        if (currentCouponCode) {\r\n            let coupon = await this.cApp.cCoupon.getCouponValidationResult(currentCouponCode);\r\n            if (coupon.result === 1)\r\n                this.applyCoupon(coupon);\r\n            else\r\n                this.cApp.currentCouponCode = undefined;\r\n        }\r\n    }\r\n\r\n    private defaultSetting: any;\r\n    private async getDefaultSetting() {\r\n        if (this.defaultSetting) return this.defaultSetting;\r\n        let { currentUser } = this.cApp;\r\n        return this.defaultSetting = await currentUser.getSetting() || {};\r\n    }\r\n\r\n    private contact0: BoxId;\r\n    private async getContact(): Promise<BoxId> {\r\n        if (this.contact0 === null) return;\r\n        if (this.contact0 !== undefined) return this.contact0;\r\n        let { currentUser } = this.cApp;\r\n        let contactArr = await currentUser.getContacts();\r\n        if (contactArr === undefined || contactArr.length === 0) {\r\n            this.contact0 = null;\r\n            return;\r\n        }\r\n        return this.contact0 = contactArr[0].contact;\r\n    }\r\n\r\n    private async getDefaultShippingContact() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.shippingContact || await this.getContact();\r\n    }\r\n\r\n    private async getDefaultInvoiceContact() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceContact || await this.getContact();\r\n    }\r\n\r\n    private async getDefaultInvoiceType() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceType;\r\n    }\r\n\r\n    private async getDefaultInvoiceInfo() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceInfo;\r\n    }\r\n\r\n    submitOrder = async () => {\r\n        let { orderItems } = this.orderData;\r\n\r\n        let result: any = await this.uqs.order.Order.save(\"order\", this.orderData.getDataForSave());\r\n        await this.uqs.order.Order.action(result.id, result.flow, result.state, \"submit\");\r\n\r\n        let param: [{ productId: number, packId: number }] = [] as any;\r\n        orderItems.forEach(e => {\r\n            e.packs.forEach(v => {\r\n                param.push({ productId: e.product.id, packId: v.pack.id })\r\n            })\r\n        });\r\n        let { cart } = this.cApp;\r\n        cart.removeFromCart(param);\r\n\r\n        // 打开下单成功显示界面\r\n        nav.popTo(this.cApp.topKey);\r\n        this.openVPage(OrderSuccess, result);\r\n    }\r\n\r\n    onSelectShippingContact = async () => {\r\n        let cSelect = this.newC(CSelectShippingContact);\r\n        let contactBox = await cSelect.call<BoxId>(true);\r\n        this.orderData.shippingContact = contactBox;\r\n    }\r\n\r\n    onSelectInvoiceContact = async () => {\r\n        let cSelect = this.newC(CSelectInvoiceContact);\r\n        let contactBox = await cSelect.call<BoxId>(true);\r\n        this.orderData.invoiceContact = contactBox;\r\n    }\r\n\r\n    onCouponEdit = async () => {\r\n        let { cCoupon } = this.cApp;\r\n        let coupon = await cCoupon.call<any>(this.orderData.coupon);\r\n        if (coupon) {\r\n            await this.applyCoupon(coupon);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 使用优惠券后计算折扣金额和抵扣额\r\n     */\r\n    applyCoupon = async (coupon: any) => {\r\n\r\n        let { result: validationResult, id, code, discount, preferential, validitydate, isValid, types } = coupon;\r\n        if (validationResult === 1 && code !== undefined && isValid === 1 && new Date(validitydate).getTime() > Date.now()) {\r\n            this.orderData.coupon = id;\r\n            this.couponData = coupon;\r\n            if (discount) {\r\n                // this.orderData.couponOffsetAmount = Math.round(this.orderData.productAmount * discount) * -1;\r\n                let { orderItems } = this.orderData;\r\n                if (orderItems !== undefined && orderItems.length > 0) {\r\n                    let promises: PromiseLike<any>[] = [];\r\n                    orderItems.forEach(e => {\r\n                        promises.push(this.uqs.product.AgentPrice.table({ product: e.product.id, salesRegion: this.cApp.currentSalesRegion.id }));\r\n                    });\r\n                    let agentPrices = await Promise.all(promises);\r\n                    if (agentPrices && agentPrices.length > 0) {\r\n                        let couponOffsetAmount = 0;\r\n                        for (let i = 0; i < orderItems.length; i++) {\r\n                            let oi = orderItems[i];\r\n                            let { product, packs } = oi;\r\n                            let eachProductAgentPrice = agentPrices[i];\r\n                            for (let j = 0; j < packs.length; j++) {\r\n                                let pk = packs[j];\r\n                                let agentPrice: any = eachProductAgentPrice.find(\r\n                                    (p: any) => p.product.id === product.id &&\r\n                                        p.pack.id === pk.pack.id &&\r\n                                        p.discountinued === 0 &&\r\n                                        p.expireDate > Date.now());\r\n                                if (!agentPrice) break;\r\n                                pk.price = Math.round(Math.max(agentPrice.agentPrice, pk.retail * (1 - discount)));\r\n                                couponOffsetAmount += Math.round(pk.quantity * (pk.retail - pk.price) * -1);\r\n                                /*\r\n                                if (agentPrice) {\r\n                                    pk.price = Math.round(agentPrice.retail * (1 - discount));\r\n                                }\r\n                                */\r\n                            };\r\n                        };\r\n                        this.orderData.couponOffsetAmount = Math.round(couponOffsetAmount);\r\n                    };\r\n                }\r\n            }\r\n            if (preferential) {\r\n                this.orderData.couponRemitted = preferential * -1;\r\n            }\r\n            if (types = \"credits\") {\r\n                this.orderData.couponCredits = 2;\r\n            }\r\n            // 运费和运费减免\r\n            this.orderData.freightFee = FREIGHTFEEFIXED;\r\n            if (this.orderData.productAmount > FREIGHTFEEREMITTEDSTARTPOINT)\r\n                this.orderData.freightFeeRemitted = FREIGHTFEEFIXED * -1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 删除优惠券\r\n     */\r\n    removeCoupon = () => {\r\n        this.orderData.coupon = undefined;\r\n        this.couponData = {};\r\n        this.orderData.couponOffsetAmount = 0;\r\n        this.orderData.couponRemitted = 0;\r\n    }\r\n\r\n\r\n    /*\r\n    * 打开我的订单列表（在“我的”界面使用）\r\n    */\r\n    openMyOrders = async (state: string) => {\r\n\r\n        this.openVPage(VMyOrders, state);\r\n    }\r\n\r\n    /**\r\n     * 根据状态读取我的订单\r\n     */\r\n    getMyOrders = async (state: string) => {\r\n\r\n        switch (state) {\r\n            case 'pendingpayment':\r\n                return await this.uqs.order.GetPendingPayment.table(undefined);\r\n            case 'processing':\r\n                return await this.uqs.order.Order.mySheets(undefined, 1, -20);\r\n            case 'completed':\r\n                return await this.uqs.order.Order.mySheets(\"#\", 1, -20)\r\n            case 'all':\r\n                let promises: PromiseLike<any>[] = [];\r\n                promises.push(this.uqs.order.Order.mySheets(undefined, 1, -20));\r\n                promises.push(this.uqs.order.Order.mySheets(\"#\", 1, -20));\r\n                let presult = await Promise.all(promises);\r\n                return presult[0].concat(presult[1]);\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 打开发票信息编辑界面\r\n     */\r\n    onInvoiceInfoEdit = async () => {\r\n        let cInvoiceInfo = this.newC(CInvoiceInfo); // new CInvoiceInfo(this.cApp, undefined, true);\r\n        let { invoiceType, invoiceInfo } = this.orderData;\r\n        let origInvoice = {\r\n            invoiceType: invoiceType,\r\n            invoiceInfo: invoiceInfo,\r\n        }\r\n        let newInvoice = await cInvoiceInfo.call<any>(origInvoice, true);\r\n        this.orderData.invoiceType = newInvoice.invoiceType;\r\n        this.orderData.invoiceInfo = newInvoice.invoiceInfo;\r\n    }\r\n\r\n    openOrderDetail = async (orderId: number) => {\r\n\r\n        let order = await this.uqs.order.Order.getSheet(orderId);\r\n        let { data } = order;\r\n        let { orderitems } = data;\r\n        let orderItemsGrouped = groupByProduct(orderitems);\r\n        data.orderItems = orderItemsGrouped;\r\n        this.openVPage(VOrderDetail, order);\r\n    }\r\n\r\n    openMeInfo = async () => {\r\n        let { cMe } = this.cApp;\r\n        await cMe.openMeInfoFirstOrder();\r\n    }\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderDeliveryTime(pack);\r\n    }\r\n\r\n    renderOrderItemProduct = (product: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderCartProduct(product);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { View } from 'tonva';\r\nimport { CProductCategory } from './CProductCategory';\r\nimport { FA } from 'tonva';\r\n//import { observer } from 'mobx-react';\r\nimport { GLOABLE } from 'configuration';\r\n\r\n/*\r\nconst imgStyle: React.CSSProperties = {\r\n    height: '1.5rem', width: '1.5rem',\r\n    marginLeft: '0.1rem',\r\n    marginRight: '0.3rem'\r\n}\r\n\r\nexport const titleTitle: React.CSSProperties = {\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n    whiteSpace: 'nowrap',\r\n}\r\n\r\nexport const subStyle: React.CSSProperties = {\r\n    fontSize: '0.75rem',\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n    whiteSpace: 'nowrap',\r\n}\r\n*/\r\n\r\nexport class VRootCategory extends View<CProductCategory> {\r\n\r\n    private categoryClick = async (categoryWapper: any, parent: any, labelColor: string) => {\r\n        await this.controller.openMainPage(categoryWapper, parent, labelColor);\r\n    }\r\n\r\n    private renderRootCategory = (item: any, parent: any) => {\r\n        let { name, children, productCategory } = item;\r\n        let { id: productCategoryID } = productCategory;\r\n        let { src, labelColor } = GLOABLE.ROOTCATEGORY[productCategoryID];\r\n        return <div className=\"bg-white mb-3\" key={name}>\r\n            <div className=\"py-2 px-3 cursor-pointer\" onClick={() => this.categoryClick(item, undefined, labelColor)}>\r\n                <img className=\"mr-4 cat-root-img\" src={src} alt={name} />\r\n                <b>{name}</b>\r\n            </div>\r\n            <div className=\"cat-root-sub\">\r\n                <div className=\"row no-gutters\">\r\n                    {children.map((v: any) => this.renderSubCategory(v, item, labelColor))}\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private renderSubCategory = (item: any, parent: any, labelColor: string) => {\r\n        let { name, subsub, total } = item;\r\n        return <div key={name}\r\n            className=\"col-6 col-md-4 col-lg-3 cursor-pointer\"\r\n            onClick={() => this.categoryClick(item, parent, labelColor)}>\r\n            <div className=\"py-2 px-2 cat-sub\">\r\n                <div className=\"text-truncate\">\r\n                    <span className=\"ml-1 align-middle\">\r\n                        <FA name=\"chevron-circle-right\" className={labelColor} />\r\n                        &nbsp; {name}\r\n                    </span>\r\n                </div>\r\n                {renderThirdCategory(subsub, total)}\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    render(param: any): JSX.Element {\r\n        return <this.content />\r\n    }\r\n\r\n    private content = () => {\r\n        let { rootCategories: categories } = this.controller;\r\n        return <>{categories.map((v: any) => this.renderRootCategory(v, undefined))}</>;\r\n        // return <>{categories2.map(v => <div key={v.productCategory.id}>{tv(v, e => this.renderRoot(e))}</div>)}</>;\r\n    };\r\n\r\n    private renderRoot(root: any) {\r\n        let { productCategory } = root;\r\n        let { id } = productCategory;\r\n        console.log(id);\r\n        return <div key={id}>{id}</div>\r\n    }\r\n}\r\n\r\n\r\nexport function renderThirdCategory(subsub: string, total: number) {\r\n    /*\r\n    return <div className=\"py-1 px-1 text-muted small cat-sub-style\">\r\n        {items.length === 0 ? <>该类产品数量: {total > 1000 ? '>1000' : total}</> : items.map((v: any) => v.name).join(' / ')}\r\n    </div>\r\n    */\r\n    return <div className=\"py-1 px-1 text-muted small text-truncate\">\r\n        {\r\n            subsub === undefined ?\r\n                <>该类产品数量: {total > 1000 ? '>1000' : total}</>\r\n                :\r\n                subsub\r\n        }\r\n    </div>\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page, FA } from 'tonva';\r\nimport { CProductCategory } from './CProductCategory';\r\n//import { tv } from 'tonva';\r\nimport { renderThirdCategory } from './VRootCategory';\r\n\r\nexport class VCategory extends VPage<CProductCategory> {\r\n\r\n    async open(categoryWaper: any) {\r\n        this.openPage(this.page, categoryWaper);\r\n    }\r\n\r\n    /*\r\n    private renderChild = (childWapper: any) => {\r\n        return <div className=\"py-2\"><FA name=\"hand-o-right mr-2\"></FA>{childWapper.name}</div>\r\n    }*/\r\n\r\n    private categoryClick = async (childWapper: any, parent: any, labelColor: string) => {\r\n        await this.controller.openMainPage(childWapper, parent, labelColor);\r\n    }\r\n\r\n    /*\r\n    private breadCrumb = (item: any, parent: any) => {\r\n        return <nav arial-babel=\"breadcrumb\">\r\n            <ol className=\"breadcrumb\">\r\n                {tv(item, this.breadCrumbItem)}\r\n            </ol>\r\n        </nav>\r\n\r\n    }*/\r\n\r\n    /*\r\n    private breadCrumbItem = (values: any, parent: any) => {\r\n        if (values === undefined || values.productCategory === undefined)\r\n            return <></>;\r\n        return <>\r\n            {tv(values.productCategory.parent, this.breadCrumbItem)}\r\n            <li className=\"breadcrumb-item\" onClick={() => this.categoryClick(values, undefined, \"\")}>{values.name}</li>\r\n        </>\r\n    }*/\r\n\r\n    private renderRootCategory = (item: any, parent: any, labelColor: string) => {\r\n        let { productCategory, name, children } = item;\r\n        return <div className=\"bg-white mb-3\" key={name}>\r\n            <div className=\"py-2 px-3 cursor-pointer\" onClick={() => this.categoryClick(item, parent, labelColor)}>\r\n                <b>{name}</b>\r\n            </div>\r\n            <div className=\"cat-root-sub\">\r\n                <div className=\"row no-gutters\">\r\n                    {children.map((v: any) => this.renderSubCategory(v, item, labelColor))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    private renderSubCategory = (item: any, parent: any, labelColor: string) => {\r\n        let { name, subsub, total } = item;\r\n        return <div key={name}\r\n            className=\"col-6 col-md-4 col-lg-3 cursor-pointer\"\r\n            onClick={() => this.categoryClick(item, parent, labelColor)}>\r\n            <div className=\"py-2 px-2 cat-sub\">\r\n                <div className=\"cat-title-title\">\r\n                    <span className=\"ml-1 align-middle\">\r\n                        <FA name=\"chevron-circle-right\" className={labelColor} />\r\n                        &nbsp; {name}\r\n                    </span>\r\n                </div>\r\n                {renderThirdCategory(subsub, total)}\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private page = (categoryWaper: any) => {\r\n        let { cHome } = this.controller.cApp;\r\n        let header = cHome.renderSearchHeader();\r\n        let cartLabel = this.controller.cApp.cCart.renderCartLabel();\r\n\r\n        let { categoryWaper: item, parent, labelColor } = categoryWaper;\r\n        return <Page header={header} right={cartLabel}>\r\n            {this.renderRootCategory(item, parent, labelColor)}\r\n        </Page>\r\n    }\r\n}","//import { observable } from 'mobx';\r\nimport _ from 'lodash';\r\nimport { CUqBase } from '../CBase';\r\nimport { VRootCategory } from './VRootCategory';\r\nimport { VCategory } from './VCategory';\r\nimport './cat.css';\r\n\r\nexport class CProductCategory extends CUqBase {\r\n    rootCategories: any[] = [];\r\n    //@observable categories2: any[] = [];\r\n\r\n    async internalStart(param: any) {\r\n        this.uqs.product.ProductCategory.stopCache();\r\n\r\n        let { currentSalesRegion, currentLanguage } = this.cApp;\r\n        let results = await this.uqs.product.GetRootCategory.query({\r\n            salesRegion: currentSalesRegion.id, \r\n            language: currentLanguage.id \r\n        });\r\n        let {first, secend, third} = results;\r\n        /*\r\n        (first as any[]).forEach(element => {\r\n            this.buildCategories(element, secend, third);\r\n        });\r\n        */\r\n        this.rootCategories = (first as any[]).map(v => {\r\n            return this.buildCategories(v, secend, third);\r\n        });\r\n        /*\r\n        let result2 = await this.getRootCategoriesQuery.query({ salesRegion: currentSalesRegion.id, language: currentLanguage.id });\r\n        if (result2)\r\n            this.categories2 = result2.ret;\r\n        */\r\n    }\r\n\r\n    renderRootList = () => {\r\n        return this.renderView(VRootCategory);\r\n    };\r\n\r\n    private async getCategoryChildren(parentCategoryId: number) {\r\n        let { currentSalesRegion, currentLanguage } = this.cApp;\r\n        return await this.uqs.product.GetChildrenCategory.query({ \r\n            parent: parentCategoryId,\r\n            salesRegion: currentSalesRegion.id, \r\n            language: currentLanguage.id \r\n        });\r\n    }\r\n\r\n    private buildCategories(categoryWapper: any, firstCategory: any[], secendCategory: any[]):any {\r\n        let {productCategory} = categoryWapper;\r\n        let catId:number = productCategory.id, children:any[] = [];\r\n        for (let f of firstCategory) {\r\n            if (f.parent !== catId) continue;\r\n            let pcid = f.productCategory.id;\r\n            let len = secendCategory.length;\r\n            let subsub = '';\r\n            for (let j=0; j<len; j++) {\r\n                //element.children = secendCategory.filter((v: any) => v.parent === pcid);\r\n                let {name, parent} = secendCategory[j];\r\n                if (parent !== pcid) continue;\r\n                if (subsub.length > 0) subsub += ' / ';\r\n                subsub += name;\r\n                let sLen = subsub.length;\r\n                if (sLen > 40) break;\r\n            }\r\n            if (subsub.length > 0) f.subsub = subsub;\r\n            children.push(f);\r\n        }\r\n        //categoryWapper.children = firstCategory.filter((v: any) => v.parent === pcid);\r\n        let ret = _.clone(categoryWapper);\r\n        ret.children = children; // firstCategory.filter((v: any) => v.parent === pcid);\r\n        return ret;\r\n    }\r\n\r\n    async openMainPage(categoryWaper: any, parent: any, labelColor: string) {\r\n\r\n        let { productCategory, name } = categoryWaper;\r\n        let { id: productCategoryId } = productCategory;\r\n        let results = await this.getCategoryChildren(productCategoryId);\r\n        if (results.first.length !== 0) {\r\n            let rootCategory = this.buildCategories(categoryWaper, results.first, results.secend);\r\n            this.openVPage(VCategory, { categoryWaper: rootCategory, parent, labelColor });\r\n        } else {\r\n            let { cProduct } = this.cApp;\r\n            await cProduct.searchByCategory({ productCategoryId, name });\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Image } from 'tonva';\r\nimport { CMember } from './CMember';\r\nimport { LMR, Muted, FA, Media } from 'tonva';\r\nimport pig from '../images/pig.png';\r\nimport { observer } from 'mobx-react';\r\n\r\nconst stylePig: React.CSSProperties = {\r\n    width: '100%',\r\n    height: '20rem',\r\n    backgroundImage: `url(${pig})`,\r\n    backgroundSize: 'contain',\r\n    backgroundColor: 'rgba(255,255,255,0.1)',\r\n    opacity: 0.09,\r\n    position: 'absolute',\r\n}\r\n\r\nexport class VMember extends VPage<CMember> {\r\n    private recommendationCodeRef = React.createRef<HTMLInputElement>();\r\n\r\n    async open(param: any) {\r\n\r\n    }\r\n\r\n    render(member: any): JSX.Element {\r\n\r\n        return <this.content />;\r\n    }\r\n\r\n    private submitRecommendationCode() {\r\n        let code = this.recommendationCodeRef.current.value;\r\n        if (code) {\r\n            let { setReferrer: submit } = this.controller;\r\n            submit(code);\r\n        }\r\n    }\r\n\r\n    private content = observer(() => {\r\n        let { cApp, member } = this.controller;\r\n        if (member === undefined)\r\n            return <></>;\r\n        let { currentUser } = cApp;\r\n        let { recommendationCode, point } = member;\r\n        if (!point) point = 0;\r\n\r\n        let im = <Image className=\"mr-3 w-3c h-3c\" src={currentUser.icon} />;\r\n        let inviteCode = <div className=\"small\">邀请码: {recommendationCode}</div>;\r\n\r\n        let divPoints = <div className=\"my-3 text-center bg-white h-25\" style={{ position: 'relative' }}>\r\n            <div className=\"w-100 bg-white h-20c\" style={{ position: 'absolute' }} />\r\n            <div className=\"d-flex align-items-center justify-content-center\" style={stylePig} />\r\n            <div className=\"w-100 d-flex align-items-center justify-content-center h-20c\" style={{ position: 'absolute' }}>\r\n                <div className=\"muted mr-3 small\">积分: </div>\r\n                <div className=\"text-danger\" style={{ fontSize: '2rem' }}>{point}</div>\r\n            </div>\r\n        </div>\r\n\r\n        let pointTitle = <p className=\"h4\">我的积分</p>\r\n        let pointDetail = <p className=\"small align-self-end\">查看详情 <FA name=\"angle-right\"></FA></p>\r\n        let pointThisWeek = <><p className=\"h5 mb-0\">0</p><Muted>本周</Muted></>\r\n        let pointAll = <><p className=\"h5 mb-0\">{point}</p><Muted>累计</Muted></>\r\n\r\n        let fansTitle = <p>我的粉丝</p>\r\n        let fansDetail = <p className=\"small align-self-end\">查看详情 <FA name=\"angle-right\"></FA></p>;\r\n        let detail = <div className=\"shadow bg-white rounded p-3 mb-1\">\r\n            <LMR left={fansTitle} right={fansDetail}></LMR>\r\n            <LMR className=\"pb-2\">\r\n                <p className=\"h4 mb-0\">0</p>\r\n                <Muted>今日</Muted>\r\n            </LMR>\r\n            <LMR left={pointThisWeek} right={pointAll} />\r\n            <LMR>\r\n                <input type=\"text\" className=\"form-control\" ref={this.recommendationCodeRef} />\r\n                <button type=\"button\" className=\"btn btn-primary\" onClick={() => this.submitRecommendationCode()}>输入邀请码</button>\r\n            </LMR>\r\n        </div>;\r\n\r\n        return <div>\r\n            <LMR className=\"bg-white p-3 mb-1 align-items-center\"\r\n                left={im} right={inviteCode}>\r\n                <b>{currentUser.name}</b>\r\n            </LMR>\r\n            {divPoints}\r\n            {/*detail*/}\r\n        </div>\r\n    })\r\n}\r\n/*\r\n<div className=\"shadow bg-white rounded p-3 mb-1\">\r\n<LMR left={pointTitle} right={pointDetail}></LMR>\r\n<LMR className=\"pb-2\">\r\n    <p className=\"h4 mb-0\">0</p>\r\n    <Muted>今日</Muted>\r\n</LMR>\r\n<LMR left={pointThisWeek} right={pointAll} />\r\n</div>\r\n*/","import * as React from 'react';\r\n//import Loadable from 'react-loadable';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { FA } from 'tonva';\r\nimport { Controller, Loading, nav } from 'tonva';\r\nimport { Action, Map, BoxId } from 'tonva';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VMember } from './VMember';\r\n//import { CCartApp } from 'CCartApp';\r\n//import { jnkTop } from 'me/loginTop';\r\n\r\nexport class CMember extends CUqBase {\r\n\r\n    //cApp: CCartApp;\r\n    //    cApp: CApp;\r\n    @observable member: any;\r\n    private referrer: BoxId;\r\n\r\n    protected async internalStart(param: any) {\r\n\r\n        if (this.isLogined) {\r\n            let { member } = this.uqs;\r\n            let { id: currentUserId } = this.user;\r\n            let promises: PromiseLike<any>[] = [];\r\n            promises.push(member.MemberAction.submit({}));\r\n            promises.push(member.MemberRecommender.table({ referrer: currentUserId }));\r\n            promises.push(member.MemberRecommender.table({ member: currentUserId }));\r\n            let result = await Promise.all(promises);\r\n            let { code, point } = result[0];\r\n            this.referrer = result[2];\r\n            this.member = { recommendationCode: code, point: point, fans: result[1], referrer: result[2] };\r\n        }\r\n    }\r\n\r\n    private loginCallback = async () => {\r\n        nav.pop();\r\n        await this.internalStart(undefined);\r\n    }\r\n\r\n    render = observer(() => {\r\n        if (this.isLogined) {\r\n            return this.member === undefined ? <Loading /> : this.renderView(VMember);\r\n        } else {\r\n            return <div\r\n                className=\"d-flex h-100 flex-column align-items-center justify-content-center\">\r\n                <div className=\"flex-fill\" />\r\n                <button className=\"btn btn-success w-20c\"\r\n                    onClick={() => nav.showLogin(this.loginCallback, true)}>\r\n                    <FA name=\"sign-out\" size=\"lg\" /> 请登录\r\n                </button>\r\n                <div className=\"flex-fill\" />\r\n                <div className=\"flex-fill\" />\r\n            </div>;\r\n        }\r\n    })\r\n\r\n    tab = () => {\r\n        this.start();\r\n        return <this.render />;\r\n    }\r\n\r\n    setReferrer(code: string) {\r\n        if (code) {\r\n            // 写入map，方法是add，用这个方法可能会写入多次，多以在写入之前要检查有没有，有的话，就不能再调用这个方法了\r\n            // 这个逻辑我认为应该是在服务端，写入的时候要给双方积分，给多少积分的逻辑，也应该在后端，从邀请码到拥有此邀请码\r\n            // 的会员id之间的转换，逻辑也应该在后台，这个后端的逻辑写在ACTION中？\r\n            if (!this.referrer) {\r\n                let { id: currentUserId } = this.user;\r\n            }\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page } from 'tonva';\r\nimport marked from 'marked';\r\nimport logo from '../images/logo.png';\r\n\r\nconst content = `<p>　　百灵威科技有限公司是一家致力于研发和生产化学及相关产品，集敏捷制造、全球营销和现代物流为一体的高科技企业。\r\n百灵威在中国内地、香港，欧洲及北美等多个国家和地区设有物流中心，实行专业化、个性化的一站式服务，\r\n为全球超过200,000 名科技和工业领域的客户提供产品资源及配套技术服务。</p>\r\n<p>　　百灵威现代化的研发制造基地拥有一支富有创造天赋的专业团队，新技术、新产品层出不穷，J&K®、Amethyst®、J&K Scientific® 产品\r\n已多达30,000 种以上，并呈几何级数增长。作为国际化的资源平台公司，百灵威致力于促进全球产业链的合作，不断推进集约式发展，\r\n集成资源600,000 余种，包括高纯有机试剂、无机试剂、生化试剂、分析试剂、标准品、金属有机催化剂、医药中间体、超精细材料、\r\n以及实验室仪器、耗材等众多产品。百灵威的柔性生产线能够快速提供小批量、多品种的原料，满足实验、中试以至规模化生产的需要。\r\n</p>\r\n<p>　　百灵威秉承“诚实守信、开拓创新、合作共赢、实现卓越”的价值观，致力于与化学、生物医药、精细化工、食品工业、现代农业、电子、日化、\r\n石化、纺织、生命科学、环境保护、疾病控制、新能源、新材料、航空航天等领域的客户建立互信、长久的合作关系，\r\n为实现“促进科技与工业发展，造福人类”的使命而不懈努力！\r\n</p>\r\n`\r\n\r\nexport class About extends React.Component {\r\n    render() {\r\n        let right = null;\r\n        return <Page header=\"关于百灵威\" right={right}>\r\n            <div className='bg-white p-3'>\r\n                <img className=\"h-3c position-absolute\" src={logo} alt=\"百灵威\" />\r\n                <div className=\"h3 flex-fill text-center\">\r\n                    <span className=\"text-primary mr-3\">百灵威集团</span>\r\n                </div>\r\n                <div className=\"mt-5\" dangerouslySetInnerHTML={{ __html: marked(content) }} />\r\n            </div>\r\n        </Page>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport {\r\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema,\r\n    VPage, UiRadio, IdSchema, UiIdItem, Context, BoxId, tv\r\n} from 'tonva';\r\nimport { CMe } from './CMe';\r\nimport {\r\n    faxValidation, emailValidation, mobileValidation, telephoneValidation,\r\n    addressDetailValidation, zipCodeValidation,\r\n    organizationNameValidation, departmentNameValidation,\r\n    salutationValidation, nameValidation\r\n} from '../tools/inputValidations';\r\n\r\nexport class EditMeInfo extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\r\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    @observable private webUserData: any;\r\n\r\n    @observable private webUserContactData: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n\r\n        let { cApp } = this.controller;\r\n        let { firstName, gender, salutation, organizationName, departmentName, telephone\r\n            , mobile, email, fax, zipCode, address, addressString } = cApp.currentUser;\r\n        this.webUserData = {\r\n            firstName: firstName,\r\n            gender: gender,\r\n            salutation: salutation,\r\n            organizationName: organizationName,\r\n            departmentName: departmentName,\r\n        };\r\n\r\n        this.webUserContactData = {\r\n            telephone: telephone,\r\n            mobile: mobile,\r\n            email: email,\r\n            fax: fax,\r\n            address: address,\r\n            addressString: addressString,\r\n            zipCode: zipCode,\r\n        }\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        (nav.user as any)[name] = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n    private onWebUserChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserData[name] = newValue;\r\n        await this.controller.changeWebUser(this.webUserData);\r\n    }\r\n\r\n    private onWebUserContactChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserContactData[name] = newValue;\r\n        await this.controller.changeWebUserContact(this.webUserContactData);\r\n    }\r\n\r\n    private page = () => {\r\n        let { schema, uiSchema, data, onItemChanged, webUserData, onWebUserChanged, webUserContactData, onWebUserContactChanged, controller } = this;\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n            <Edit schema={webUserSchema} uiSchema={webUserUiSchema}\r\n                data={webUserData}\r\n                onItemChanged={onWebUserChanged} />\r\n            <Edit schema={webUserContactSchema} uiSchema={webUserContactUiSchema(controller.pickAddress)}\r\n                data={webUserContactData}\r\n                onItemChanged={onWebUserContactChanged} />\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\nexport const webUserUiSchema: UiSchema = {\r\n    items: {\r\n        firstName: {\r\n            widget: 'text', label: '真实姓名',\r\n            placeholder: '化学品是受国家安全法规限制的特殊商品，百灵威提供技术咨询、资料以及化学产品的对象必须是具有化学管理和应用能力的专业单位（非个人）。为此，需要您重新提供非虚拟的、可核查的信息。',\r\n            rules: nameValidation\r\n        } as UiTextItem,\r\n        gender: { widget: 'radio', label: '性别', list: [{ value: '1', title: '男' }, { value: '0', title: '女' }] } as UiRadio,\r\n        salutation: { widget: 'text', label: '称谓', rules: salutationValidation } as UiTextItem,\r\n        organizationName: { widget: 'text', label: '单位名称', rules: organizationNameValidation } as UiTextItem,\r\n        departmentName: { widget: 'text', label: '部门名称', rules: departmentNameValidation } as UiTextItem,\r\n    }\r\n}\r\n\r\n// 个人联系方式信息\r\nexport const webUserContactSchema: ItemSchema[] = [\r\n    { name: 'telephone', type: 'string' } as StringSchema,\r\n    { name: 'mobile', type: 'string', required: true } as StringSchema,\r\n    { name: 'email', type: 'string' } as StringSchema,\r\n    { name: 'fax', type: 'string', required: false } as StringSchema,\r\n    { name: 'address', type: 'id', required: false } as IdSchema,\r\n    { name: 'addressString', type: 'string', required: false } as StringSchema,\r\n    { name: 'zipCode', type: 'string', required: false } as StringSchema,\r\n];\r\n\r\nexport function webUserContactUiSchema(pickAddress: any) {\r\n    return {\r\n        items: {\r\n            telephone: { widget: 'text', label: '固定电话', rules: telephoneValidation } as UiTextItem,\r\n            mobile: { widget: 'text', label: '手机号', rules: mobileValidation } as UiTextItem,\r\n            email: { widget: 'text', label: 'Email', rules: emailValidation, placeholder: 'Email' } as UiTextItem,\r\n            fax: { widget: 'text', label: '传真', rules: faxValidation } as UiTextItem,\r\n            address: {\r\n                widget: 'id', label: '所在地区',\r\n                pickId: async (context: Context, name: string, value: number) => await pickAddress(context, name, value),\r\n                Templet: (address: BoxId) => {\r\n                    if (!address) return <small className=\"text-muted\">(无)</small>;\r\n                    return tv(address, (addressValue) => {\r\n                        let { country, province, city, county } = addressValue;\r\n                        /* 下面这种在使用tv之前的一堆判断应该是tv或者什么的有bug, 应该让Henry改改 */\r\n                        return <>\r\n                            {country !== undefined && country.id !== undefined && tv(country, v => <>{v.chineseName}</>)}\r\n                            {province !== undefined && province.id !== undefined && tv(province, (v) => <>{v.chineseName}</>)}\r\n                            {city !== undefined && city.id !== undefined && tv(city, (v) => <>{v.chineseName}</>)}\r\n                            {county !== undefined && county.id !== undefined && tv(county, (v) => <>{v.chineseName}</>)}\r\n                        </>;\r\n                    }, () => {\r\n                        return <small className=\"text-muted\">请选择地区</small>;\r\n                    })\r\n                }\r\n            } as UiIdItem,\r\n            addressString: { widget: 'text', label: '详细地址', rules: addressDetailValidation } as UiTextItem,\r\n            zipCode: { widget: 'text', label: '邮编', rules: zipCodeValidation } as UiTextItem,\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page } from 'tonva';\r\nimport logo from '../images/logo.png';\r\nimport { appConfig } from 'configuration';\r\n\r\nexport class AboutThisApp extends React.Component {\r\n    render() {\r\n        let right = null;\r\n        return <Page header=\"关于百灵威购物APP\" right={right}>\r\n            <div className='bg-white p-3'>\r\n                <div className=\"h3 flex-fill text-center\">\r\n                    <img src={logo} />\r\n                </div>\r\n                <div className=\"h3 flex-fill text-center\">\r\n                    <span className=\"text-primary mr-3\">百灵威购物APP</span>\r\n                </div>\r\n                <div className=\"h3 flex-fill text-center small\">\r\n                    <span className=\"text-muted mr-3\">V{appConfig.version}</span>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page, VPage } from 'tonva';\r\nimport marked from 'marked';\r\nimport { CMe } from './CMe';\r\nimport { observable } from 'mobx';\r\n\r\nexport class Privacy extends VPage<CMe>{\r\n\r\n    @observable private privacy: any;\r\n    async open(param?: any) {\r\n\r\n        this.privacy = await this.controller.getCommonText(1);\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private page = () => {\r\n        return <Page header=\"百灵威购物服务条款与隐私政策\">\r\n            <div className='bg-white p-3'>\r\n                <div className=\"mx-auto text-center\" style={{ width: 300 }}>\r\n                    <h4>服务条款与隐私政策</h4>\r\n                    <p>VS.20190920</p>\r\n                </div>\r\n                <div className=\"mt-4\" dangerouslySetInnerHTML={{ __html: marked(this.privacy.content) }} />\r\n            </div>\r\n        </Page>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { nav, User, Page, Image, VPage } from 'tonva';\r\nimport { Prop, Media, IconText, FA, PropGrid, LMR } from 'tonva';\r\nimport { About } from './about';\r\nimport { observer } from 'mobx-react';\r\nimport { EditMeInfo } from './EditMeInfo';\r\nimport { CMe } from './CMe';\r\nimport { AboutThisApp } from './aboutThisApp';\r\nimport { appConfig } from 'configuration';\r\nimport { Privacy } from './privacy';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\r\n    async open(param?: any) {\r\n\r\n    }\r\n\r\n    private exit() {\r\n        nav.showLogout();\r\n    }\r\n\r\n    private about = () => nav.push(<About />);\r\n    private privacy = () => this.openVPage(Privacy);\r\n    private aboutThisApp = () => nav.push(<AboutThisApp />);\r\n\r\n    private changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private openContactList = async () => {\r\n        this.controller.openContactList();\r\n    }\r\n\r\n    private openInvoice = async () => {\r\n        this.controller.openInvoice();\r\n    }\r\n\r\n    private openPoint = async () => {\r\n        this.controller.openPoint();\r\n    }\r\n\r\n    private meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) return null;\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={() => {\r\n                this.openVPage(EditMeInfo);\r\n            }}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n    private orderStates = () => {\r\n\r\n        let { openMyOrders } = this.controller;\r\n        return <div className=\"d-flex justify-content-around w-100 my-3\">\r\n            <div className=\"d-flex flex-column align-items-center\" onClick={() => openMyOrders('processing')}>\r\n                <FA name=\"desktop\" className=\"text-info fa-2x\" />\r\n                <small>待审核</small>\r\n            </div>\r\n            <div className=\"d-flex flex-column align-items-center\" onClick={() => openMyOrders('completed')}>\r\n                <FA name=\"truck\" className=\"text-info fa-2x\" />\r\n                <small>待发货</small>\r\n            </div>\r\n            <div className=\"d-flex flex-column align-items-center\" onClick={() => openMyOrders('all')}>\r\n                <FA name=\"file-text-o\" className=\"text-info fa-2x\" />\r\n                <small>所有订单</small>\r\n            </div>\r\n        </div>\r\n    };\r\n\r\n    render() {\r\n        return <this.content />;\r\n    }\r\n\r\n    private content = observer(() => {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text=\"关于百灵威\" />,\r\n                onClick: this.about\r\n            },\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <div className=\"w-100 d-flex justify-content-between\" onClick={this.aboutThisApp}>\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text=\"关于本APP\" />\r\n                    <div className=\"py-2 small\">V{appConfig.version}</div>\r\n                </div>,\r\n            },\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text=\"隐私政策\" />,\r\n                onClick: this.privacy\r\n            },\r\n            ''\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.showLogin(undefined, true)}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> 请登录\r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    bk: '',\r\n                    component: <button className=\"btn btn-danger w-100\" onClick={this.exit}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> 退出登录\r\n                </button>\r\n                },\r\n            ];\r\n\r\n            rows = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.orderStates />,\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"地址管理\" />,\r\n                    onClick: this.openContactList\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"发票管理\" />,\r\n                    onClick: this.openInvoice\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"积分管理\" />,\r\n                    onClick: this.openPoint\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text=\"修改密码\" />,\r\n                    onClick: this.changePassword\r\n                },\r\n            ]\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n        return <PropGrid rows={rows} values={{}} />;\r\n    })\r\n}\r\n\r\n\r\nfunction userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { ItemSchema, Page, Edit, VPage, FA } from 'tonva';\r\nimport { CMe } from './CMe';\r\nimport { webUserSchema, webUserUiSchema, webUserContactSchema, webUserContactUiSchema } from './EditMeInfo';\r\nimport { observer } from 'mobx-react';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class EditMeInfoFirstOrder extends VPage<CMe>{\r\n\r\n    @observable tips: JSX.Element;\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    @observable private webUserData: any;\r\n    @observable private webUserContactData: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n\r\n        let { cApp } = this.controller;\r\n        let { firstName, gender, salutation, organizationName, departmentName, telephone\r\n            , mobile, email, fax, address, addressString, zipCode } = cApp.currentUser;\r\n        this.webUserData = {\r\n            firstName: firstName,\r\n            gender: gender,\r\n            salutation: salutation,\r\n            organizationName: organizationName,\r\n            departmentName: departmentName\r\n        };\r\n\r\n        this.webUserContactData = {\r\n            telephone: telephone,\r\n            mobile: mobile,\r\n            email: email,\r\n            fax: fax,\r\n            address: address,\r\n            addressString: addressString,\r\n            zipCode: zipCode\r\n        }\r\n    }\r\n\r\n    private onWebUserChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserData[name] = newValue;\r\n        await this.controller.changeWebUser(this.webUserData);\r\n    }\r\n\r\n    private onWebUserContactChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserContactData[name] = newValue;\r\n        await this.controller.changeWebUserContact(this.webUserContactData);\r\n    }\r\n\r\n    private checkOut = async () => {\r\n        let { currentUser } = this.controller.cApp;\r\n        if (currentUser.allowOrdering) {\r\n            this.closePage();\r\n            await currentUser.addContactFromAccount();\r\n            await this.controller.doCheckout();\r\n        } else {\r\n            this.tips = <>以上带有 <span className='text-danger'>*</span> 的内容均须填写！</>;\r\n            setTimeout(() => {\r\n                this.tips = undefined;\r\n            }, GLOABLE.TIPDISPLAYTIME);\r\n        }\r\n    }\r\n\r\n    private page = observer(() => {\r\n\r\n        let tipsUI = <></>;\r\n        if (this.tips) {\r\n            tipsUI = <div className=\"alert alert-primary\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {this.tips}\r\n            </div>\r\n        }\r\n        return <Page header=\"首次下单须补充账户信息\">\r\n            <div className=\"alert alert-primary small\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning mr-3 my-1 float-left\" size=\"3x\" />\r\n                化学品是受国家安全法规限制的特殊商品，百灵威提供技术咨询、资料以及化学产品的对象必须是具有化学管理和应用能力的专业单位（非个人）。\r\n                为此，需要您重新提供非虚拟的、可核查的信息。这些信息包括下面所有带有 <span className=\"text-danger\">*</span> 的信息。\r\n            </div>\r\n            <Edit schema={webUserSchema} uiSchema={webUserUiSchema}\r\n                data={this.webUserData}\r\n                onItemChanged={this.onWebUserChanged} />\r\n            <Edit schema={webUserContactSchema} uiSchema={webUserContactUiSchema(this.controller.pickAddress)}\r\n                data={this.webUserContactData}\r\n                onItemChanged={this.onWebUserContactChanged} />\r\n            <div className=\"p-3 bg-white\">\r\n                {tipsUI}\r\n                <button type=\"button\" className=\"btn btn-primary w-100\" onClick={() => this.checkOut()}>下一步</button>\r\n            </div>\r\n        </Page>;\r\n    });\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page, Form, List, tv, ObjectSchema, NumSchema, UiSchema, UiCustom, FA } from 'tonva';\r\nimport { CPointProduct } from 'pointMarket/CPointProduct';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { PointProductImage } from 'tools/productImage';\r\nimport { MinusPlusWidget } from 'tools';\r\nimport { observable } from 'mobx';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class VPointProduct extends VPage<CPointProduct> {\r\n\r\n    @observable private productIsNull: boolean = false;\r\n    @observable private pointIsEnough: boolean = false;\r\n\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema = [\r\n        { name: 'product', type: 'object' } as ObjectSchema,\r\n        { name: 'pack', type: 'object' } as ObjectSchema,\r\n        { name: 'quantity', type: 'number' } as NumSchema,\r\n        { name: 'point', type: 'number' } as NumSchema,\r\n        { name: 'imageUrl', type: 'object' } as ObjectSchema,\r\n    ];\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            product: { visible: false },\r\n            pack: { visible: false },\r\n            quantity: {\r\n                widget: 'custom',\r\n                label: null,\r\n                className: 'text-center',\r\n                WidgetClass: MinusPlusWidget,\r\n                onChanged: this.controller.onQuantityChanged as any\r\n            } as UiCustom,\r\n            point: { visible: false },\r\n            imageUrl: { visible: false }\r\n        }\r\n    }\r\n\r\n    private renderPointProduct = (pointProduct: any, index: number) => {\r\n        let { product, pack, point, imageUrl } = pointProduct;\r\n        return <>\r\n            {tv(product, (v) => {\r\n                return <div className=\"row m-1 w-100\">\r\n                    <div title={v.description} className=\"col-4 m-0 p-0\"><PointProductImage chemicalId={imageUrl} className=\"w-100\" /></div>\r\n                    {tv(pack, (c) => {\r\n                        return <div className=\"col-8 small\">\r\n                            <div>{v.descriptionC}</div>\r\n                            <div className=\"my-2\">{c.radioy}{c.unit}</div>\r\n                            <div className=\"row m-0 p-0\">\r\n                                <div className=\"col-5 m-0 p-0\">\r\n                                    <span className=\"text-danger h5\">{point}</span>\r\n                                    <small>分</small>\r\n                                </div>\r\n                                <div className=\"col-7 d-flex justify-content-end align-items-right m-0 p-0\">\r\n                                    <Form schema={this.schema} uiSchema={this.uiSchema} formData={pointProduct} className=\"mr-2\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    })}\r\n                </div>\r\n            })}\r\n        </>\r\n    }\r\n\r\n    private openExchangeOrder = async () => {\r\n        // 未选择产品\r\n        let { pointsSum, myPointSum } = this.controller;\r\n\r\n        if (pointsSum < 1) {\r\n            this.productIsNull = true;\r\n            this.pointIsEnough = false;\r\n            setTimeout(() => this.productIsNull = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n        // 积分不足\r\n        if (pointsSum > myPointSum) {\r\n            this.productIsNull = false;\r\n            this.pointIsEnough = true;\r\n            setTimeout(() => this.pointIsEnough = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n\r\n        this.controller.openExchangeOrder();\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { pointProducts } = this.controller;\r\n        let footer = <this.ExchangePoint />;\r\n        return <Page header=\"积分商城\" footer={footer} right={null}>\r\n            <div>\r\n                <List items={pointProducts} item={{ render: this.renderPointProduct }} none=\"暂无可兑换产品\"></List>\r\n            </div>\r\n        </Page >;\r\n    });\r\n\r\n    protected ExchangePoint = observer(() => {\r\n        let { pointsSum, myPointSum } = this.controller;\r\n\r\n        let productIsNullTip = this.productIsNull ?\r\n            <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" />未选择产品</div>\r\n            : null;\r\n        let pointIsEnoughTip = this.pointIsEnough ?\r\n            <div className=\"text-danger small m-0 p-0\"><FA name=\"exclamation-circle\" />积分不足<br />剩余{myPointSum}分</div>\r\n            : null;\r\n\r\n        return <div className=\"d-block\">\r\n            <div className=\"w-100 px-3 d-flex justify-content-between\">\r\n                <div>总计:<span className=\"text-danger ml-2 mr-1 h2\" >{pointsSum}</span>分</div>\r\n                <div>{productIsNullTip}{pointIsEnoughTip}</div>\r\n                <button type=\"button\" className=\"btn btn-danger m-1\" onClick={this.openExchangeOrder}>去兑换</button>\r\n            </div>\r\n        </div>;\r\n    });\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, nav, Page, LMR, FA, tv, List } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { observable } from 'mobx';\r\nimport { ProductImage, PointProductImage } from 'tools/productImage';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class VExchangeOrder extends VPage<CPointProduct> {\r\n    @observable private shippingAddressIsBlank: boolean = false;\r\n\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private nullContact = () => {\r\n        return <span className=\"text-primary\">选择收货地址</span>;\r\n    }\r\n\r\n    private renderPointProduct = (pointProduct: any, index: number) => {\r\n        let { product, pack, quantity, point, imageUrl } = pointProduct;\r\n        if (quantity > 0) {\r\n            return <>\r\n                {tv(product, (v) => {\r\n                    return <div className=\"row m-1 w-100\">\r\n                        <div title={v.description} className=\"col-4 m-0 p-0\"><PointProductImage chemicalId={imageUrl} className=\"w-100\" /></div>\r\n                        {tv(pack, (c) => {\r\n                            return <div className=\"col-8 small\">\r\n                                <div>{v.descriptionC}</div>\r\n                                <div className=\"d-flex justify-content-between my-3\">\r\n                                    <div className=\"mt-1\"><b>{c.radioy}{c.unit}</b></div>\r\n                                    <div>\r\n                                        <span className=\"text-danger h5\">{(point * quantity)}</span>\r\n                                        <small className=\"text-muted\">分 ({point} × {quantity})</small>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        })}\r\n                    </div>\r\n                })}\r\n            </>;\r\n        }\r\n    }\r\n\r\n    private onSubmit = async () => {\r\n        let { orderData } = this.controller;\r\n        // 必填项验证\r\n        let { shippingContact } = orderData;\r\n        if (!shippingContact) {\r\n            this.shippingAddressIsBlank = true;\r\n            setTimeout(() => this.shippingAddressIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n        this.controller.submitOrder();\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { pointProductsSelected, pointsSum, orderData, onSelectShippingContact } = this.controller;\r\n        let chevronRight = <FA name=\"chevron-right\" className=\"cursor-pointer\" />\r\n        let shippingAddressBlankTip = this.shippingAddressIsBlank ?\r\n            <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写收货地址</div>\r\n            : null;\r\n\r\n        let footer = <div className=\"d-block\">\r\n            <div className=\"w-100 px-3 d-flex justify-content-between\">\r\n                <div>总计:<span className=\"text-danger ml-2 mr-1 h2\" >{pointsSum}</span>分</div>\r\n                <button type=\"button\" className=\"btn btn-danger m-1\" onClick={this.onSubmit}>确认兑换</button>\r\n            </div>\r\n        </div>;\r\n\r\n        return <Page header=\"确认兑换信息\" footer={footer}>\r\n            <div className=\"px-2\">\r\n                <div className=\"row py-3 bg-white mb-1\" onClick={onSelectShippingContact}>\r\n                    <div className=\"col-3 text-muted pr-0\">收货地址:</div>\r\n                    <div className=\"col-9 col-sm-10\">\r\n                        <LMR className=\"w-100 align-items-center\" right={chevronRight}>{tv(orderData.shippingContact, undefined, undefined, this.nullContact)}</LMR>\r\n                        {shippingAddressBlankTip}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <List items={pointProductsSelected} item={{ render: this.renderPointProduct }} ></List>\r\n        </Page>\r\n    })\r\n}","import * as React from 'react';\r\nimport { Page } from 'tonva';\r\n\r\nexport class VPointRule extends React.Component {\r\n\r\n    render() {\r\n        let right = null;\r\n        return <Page header=\"积分兑换说明\" right={right}>\r\n            <div className='bg-white p-3'>\r\n                <ul className=\"point-remarks\">\r\n                    <li>订购产品满1元积1分（活动期间积分按活动规则执行），积分按消费额累计；付款后，积分变为有效积分，可以使用；</li>\r\n                    <li>特价产品、产业型产品不计入积分；</li>\r\n                    <li>积分有效期为自然年三年，过期作废；（示例：2010年1-12月份产生的积分在2012年12月31日作废清零，以此类推）</li>\r\n                    <li>积分目前仅限兑换使用，不兑换现金；</li>\r\n                    <li>此积分政策只针对百灵威终端客户；</li>\r\n                </ul>\r\n                <div className=\"text-muted px-3 small\">\r\n                    <p>百灵威保留本积分活动中条款的解释权利，并有权根据需要取消本活动或增删、修订本规定的权利，并于百灵威官网、邮件、报纸或其他公告后生效。</p>\r\n                    <p>如有疑问，请致电百灵威客服中心400-666-7788</p>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, Prop, IconText, PropGrid, LMR, List, tv, EasyDate, nav, DropdownActions, DropdownAction, FA } from \"tonva\";\r\nimport { CPointProduct } from \"./CPointProduct\";\r\nimport { observer } from 'mobx-react-lite';\r\nimport { observable } from 'mobx';\r\nimport { VPointRule } from './VPointRule';\r\n\r\nexport class VMyPoint extends VPage<CPointProduct> {\r\n    @observable private openMyPointList: boolean = false;\r\n\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private openPointProduct = async () => {\r\n        this.controller.openPointProduct();\r\n    }\r\n    private openExchangeHistory = async () => {\r\n        this.controller.openExchangeHistory();\r\n    }\r\n    private openPlatformOrderPoint = async () => {\r\n        this.controller.openPlatformOrderPoint();\r\n    }\r\n\r\n    private remarks = () => nav.push(<VPointRule />);\r\n\r\n    private page = observer(() => {\r\n        let { myPointSum, myPointInvalid } = this.controller;\r\n        var date = new Date();\r\n        let dateYear = date.getFullYear();\r\n\r\n        let point = myPointSum;\r\n        let nowPoint = myPointInvalid;\r\n        let nowPointTip = nowPoint > 0 ?\r\n            <div className=\"alert alert-warning m-2\" role=\"alert\">\r\n                <span className=\"text-muted\">友情提示: 将有{nowPoint}积分于{dateYear}-12-31过期</span>\r\n            </div>\r\n            : null;\r\n        let actions: DropdownAction[] = [\r\n            {\r\n                icon: 'history',\r\n                caption: '兑换历史记录',\r\n                action: this.openExchangeHistory\r\n            },\r\n            {\r\n                icon: 'history',\r\n                caption: '提取其它平台积分',\r\n                action: this.openPlatformOrderPoint\r\n            },\r\n            {\r\n                icon: 'book',\r\n                caption: '积分兑换说明',\r\n                action: this.remarks\r\n            }\r\n        ];\r\n        let right = <DropdownActions className=\"align-self-center mr-1\" icon=\"navicon\" actions={actions} />;\r\n        return <Page header=\"积分管理\" right={right}>\r\n            <div className=\"bg-white h-100\">\r\n                <div className=\"small d-flex flex-column align-items-center py-5 point-man-top\">\r\n                    <div className=\"text-white\">\r\n                        <small>当前</small> <span className=\"h2\">{point}</span> <small>分</small>\r\n                    </div>\r\n                    <div className=\"mt-3\">\r\n                        <button className=\"btn btn-light\" onClick={this.openPointProduct}><label className=\"m-0 p-0\">积分兑换</label></button>\r\n                    </div>\r\n                </div>\r\n                {nowPointTip}\r\n            </div>\r\n        </Page >;\r\n    });\r\n}\r\n\r\n\r\n","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\n\r\nexport class OrderSuccess extends VPage<CPointProduct> {\r\n\r\n    async open(orderCreateResult: any) {\r\n        this.openPage(this.page, orderCreateResult);\r\n    }\r\n\r\n    private page = (orderCreateResult: any) => {\r\n        return <Page header=\"兑换成功\" back=\"close\">\r\n            <div className=\"p-3 bg-white mb-3\">\r\n                <div className=\"mb-3\">兑换成功，感谢您对百灵威的厚爱！</div>\r\n                <p className=\"\">\r\n                    订单编号: <span className=\"h5 text-info\">{orderCreateResult.no}</span><br /><br />\r\n                    我们将立刻处理您的订单，请注意查收到货短信。\r\n                </p>\r\n            </div>\r\n        </Page>\r\n    }\r\n}","import { BoxId } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\nimport { PackRow } from 'product/Product';\r\n\r\nexport class pointOrder {\r\n\r\n    webUser: any;   // OK\r\n    organization: BoxId;\r\n    customer: any;  //OK\r\n    salesRegion: BoxId;   // OK\r\n\r\n    @observable shippingContact: BoxId; //OK\r\n    @observable exchangeItems: OrderItem[] = [];\r\n\r\n    @computed get amount() {\r\n        return this.exchangeItems.reduce((pv, cv) => (pv + cv.subAmount), 0);\r\n    };\r\n\r\n    getDataForSave() {\r\n        let exchangeItems: any[] = [];\r\n        this.exchangeItems.forEach(oi => {\r\n            exchangeItems.push({\r\n                product: oi.product, pack: oi.pack, point: oi.point, quantity: oi.quantity\r\n                , subAmount: oi.quantity * oi.point\r\n            })\r\n        });\r\n        return {\r\n            webUser: this.webUser,\r\n            organization: this.organization,\r\n            customer: this.customer,\r\n            shippingContact: this.shippingContact,\r\n            amount: this.amount,\r\n            exchangeitems: exchangeItems, // 前面的必须是小写的\r\n            salesRegion: this.salesRegion\r\n        }\r\n    }\r\n}\r\n\r\nexport class OrderItem {\r\n    product: BoxId;\r\n    @observable pack: BoxId;\r\n    @observable quantity: any;\r\n    @observable point: any;\r\n    @computed get subAmount() {\r\n        return this.quantity * this.point;\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, EasyDate } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\nimport { tv, List } from 'tonva';\r\nimport { OrderItem } from './pointOrder';\r\nimport { ProductImage, PointProductImage } from 'tools/productImage';\r\n\r\nexport class VExchangeHistoryDetail extends VPage<CPointProduct> {\r\n\r\n    async open(order: any) {\r\n\r\n        this.openPage(this.page, order);\r\n    }\r\n\r\n    private renderexchangeItem = (orderItem: OrderItem) => {\r\n        let { product, pack, quantity, point } = orderItem;\r\n        return <>\r\n            {tv(product, (v) => {\r\n                return <div className=\"row m-1 w-100\">\r\n                    {/* <div title={v.description} className=\"col-4 m-0 p-0\"><ProductImage chemicalId={v.imageUrl} className=\"w-100\" /></div> */}\r\n                    <div title={v.description} className=\"col-4 m-0 p-0\"><PointProductImage chemicalId={v.imageUrl} className=\"w-100\" /></div>\r\n                    {tv(pack, (c) => {\r\n                        return <div className=\"col-8 small\">\r\n                            <div><label>{v.descriptionC}</label></div>\r\n                            <div className=\"d-flex justify-content-between my-3\">\r\n                                <div className=\"mt-1\"><b>{c.radioy}{c.unit}</b></div>\r\n                                <div>\r\n                                    <span className=\"text-danger h6\">{(point * quantity)}</span>\r\n                                    <small className=\"text-muted\">分 ({point} × {quantity})</small>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    })}\r\n                </div>\r\n            })}\r\n        </>;\r\n    }\r\n\r\n    private page = (order: any) => {\r\n        let { brief, data } = order;\r\n        let { no, date } = brief;\r\n        let { exchangeitems, shippingContact, amount } = data;\r\n\r\n        let header = <>订单详情: {no}</>\r\n        return <Page header={header}>\r\n            <List items={exchangeitems} item={{ render: this.renderexchangeItem }} />\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">收货地址:</div>\r\n                <div className=\"col-9\">{tv(shippingContact)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">下单时间:</div>\r\n                <div className=\"col-9 text-right\"><EasyDate date={date} /></div>\r\n            </div>\r\n            <div className=\"bg-white p-3 my-1 text-right\">\r\n                <span className=\"text-danger font-weight-bold\">总积分: {amount}</span>\r\n            </div>\r\n        </Page>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page, EasyDate } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\nimport { List } from 'tonva';\r\nimport { observer } from 'mobx-react-lite';\r\n\r\n\r\nexport class VExchangeHistory extends VPage<CPointProduct> {\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderExchangeHistory = (pointProduct: any, index: number) => {\r\n        let { openOrderDetail } = this.controller;\r\n        let { id, no, date } = pointProduct;\r\n        return <div className=\"p-3 justify-content-between\">\r\n            <div className=\"mr-5\" onClick={() => openOrderDetail(id)}><span className=\"small text-muted\">兑换单号: </span><strong>{no}</strong></div>\r\n            <div className=\"small text-muted\"><EasyDate date={date} /></div>\r\n        </div>;\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { exchangeHistory } = this.controller;\r\n        return <Page header=\"兑换历史记录\">\r\n            <List items={exchangeHistory} item={{ render: this.renderExchangeHistory }} none=\"暂无记录\"></List>\r\n        </Page>;\r\n    });\r\n}","import React from \"react\";\r\nimport { VPage, Page, FA } from \"tonva\";\r\nimport { CPointProduct } from \"./CPointProduct\";\r\nimport { observer } from \"mobx-react-lite\";\r\nimport { observable } from \"mobx\";\r\nimport { GLOABLE } from \"configuration\";\r\n\r\nexport class VPlatformOrderPoint extends VPage<CPointProduct> {\r\n\r\n    private orderIdInput: HTMLInputElement;\r\n    private couponInput: HTMLInputElement;\r\n    private currentCredits: string;\r\n    @observable tips: string;\r\n\r\n    async open(param?: any) {\r\n        this.currentCredits = param;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private applyCouponOrder = async () => {\r\n\r\n        let { applyOrder, applyCoupon, addPlatformOrderPoint } = this.controller;\r\n\r\n        let orderId = this.orderIdInput.value;\r\n        let coupon = this.couponInput.value;\r\n        if (!orderId || !coupon) {\r\n            if (!orderId) {\r\n                this.tips = '请填写合同号';\r\n            } else {\r\n                this.tips = '请填写积分码';\r\n            }\r\n            setTimeout(() => this.tips = undefined, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n\r\n        let retOrder = await applyOrder(orderId);\r\n        let retCoupon = await applyCoupon(coupon);\r\n        if (retOrder == 1 && retCoupon == 1) {\r\n            let rtn = await addPlatformOrderPoint(orderId);\r\n            if (rtn == 1) {\r\n                this.tips = \"提取成功,积分稍后到账\";\r\n            }\r\n        } else {\r\n            let tip = \"\";\r\n            switch (retCoupon) {\r\n                case -1:\r\n                    tip = '对不起，当前服务器繁忙，请稍后再试，';\r\n                    break;\r\n                case 1:\r\n                    tip = '积分码有效，';\r\n                    break;\r\n                case 0:\r\n                case 2:\r\n                case 4:\r\n                case 6:\r\n                    tip = '积分码无效，';\r\n                    break;\r\n                case 3:\r\n                    tip = '这是其他人的独享积分码，';\r\n                    break;\r\n                case 5:\r\n                    tip = '积分码的创建人不是您的专属销售，';\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            switch (retOrder) {\r\n                case 1:\r\n                    tip += '合同号有效。';\r\n                    break;\r\n                case 0:\r\n                    tip += \"合同号无效。\";\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            tip += \"请重新输入或与您的专属销售人员联系。\";\r\n            this.tips = tip;\r\n        }\r\n        if (this.tips) {\r\n            setTimeout(() => this.tips = undefined, GLOABLE.TIPDISPLAYTIME);\r\n        }\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let tipsUI = <div className=\"noneMassage\"></div>;\r\n        if (this.tips) {\r\n            tipsUI = <div className=\"alert alert-primary\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {this.tips}\r\n            </div>\r\n        }\r\n\r\n        return <Page header=\"提取其它平台积分\" right={null}>\r\n            <div>\r\n                <div className=\"px-2 bg-white\">\r\n                    <div className=\"row py-2\">\r\n                        <div className=\"col-3 text-muted pr\">积分码:</div>\r\n                        <div className=\"col-9 d-flex pl-0\">\r\n                            <input ref={v => this.couponInput = v} type=\"text\" className=\"form-control\" value={this.currentCredits}></input>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                        <div className=\"col-3 text-muted\">合同号:</div>\r\n                        <div className=\"col-9 d-flex pl-0\">\r\n                            <input ref={v => this.orderIdInput = v} type=\"text\" className=\"form-control\"></input>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"row py-2\">\r\n                        <div className=\"col-12\">\r\n                            <button className=\"btn btn-primary w-100\" onClick={this.applyCouponOrder}>确认</button>\r\n                        </div>\r\n                    </div>\r\n                    {tipsUI}\r\n                    <div>\r\n                        <ul className=\"point-remarks mt-3\">\r\n                            <li>此界面录入其它平台百灵威产品订单号</li>\r\n                            <li>平台订单号的买方必须和当前登录人一致</li>\r\n                            <li>每个合同号只能提取一次积分</li>\r\n                            <li>合同总金额小数部分将被舍弃</li>\r\n                            {/* <li>增加积分=合同总金额*积分码倍数</li> */}\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Page >;\r\n    });\r\n}","import * as React from 'react';\r\nimport { BoxId, RowContext, nav } from 'tonva';\r\nimport { CUqBase } from 'CBase';\r\nimport { observable } from 'mobx';\r\nimport { VPointProduct } from 'pointMarket/VPointProduct';\r\nimport { VExchangeOrder } from './VExchangeOrder';\r\nimport { VMyPoint } from './VMyPoint';\r\nimport { CSelectShippingContact } from 'customer/CSelectContact';\r\nimport { OrderSuccess } from './OrderSuccess';\r\nimport { pointOrder, OrderItem } from './pointOrder';\r\nimport { VExchangeHistoryDetail } from './VExchangeHistoryDetail';\r\nimport { VExchangeHistory } from './VExchangeHistory';\r\nimport { VPlatformOrderPoint } from './VPlatformOrderPoint';\r\n\r\nexport class CPointProduct extends CUqBase {\r\n\r\n    @observable myPoints: any[] = [];              /*我的积分 */\r\n    @observable myPointSum: number = 0;            /*我的积分(计算后) */\r\n    @observable myPointInvalid: number = 0;        /*我的快过期积分 */\r\n\r\n    @observable pointProducts: any[] = [];          /*可兑产品列表 */\r\n    @observable pointProductsSelected: any[] = [];  /*已选择产品列表 */\r\n    @observable pointsSum: number = 0;              /*积分总计 */\r\n    @observable exchangeHistory: any[] = [];        /*积分产品列表 */\r\n    @observable orderData: pointOrder = new pointOrder();   /*正在提交的产品列表*/\r\n    @observable couponId: number;                    /*积分码 */\r\n\r\n    protected async internalStart(param: any) {\r\n        let { currentUser } = this.cApp;\r\n        let date = new Date();\r\n        let dateYear = date.getFullYear();\r\n        this.myPoints = await currentUser.getPoints();\r\n        this.myPointSum = this.myPoints.reduce((v, e) => { return v + e.point - e.usedPoint }, 0);\r\n        this.myPointInvalid = this.myPoints.reduce((v, e) => { return v + ((dateYear - e.pointYear) > 1 ? (e.point - e.usedPoint) : 0) }, 0);\r\n        this.exchangeHistory = await this.uqs.积分商城.PointExchangeSheet.mySheets(undefined, 1, -20);\r\n        this.openVPage(VMyPoint);\r\n    }\r\n\r\n    openPointProduct = async () => {\r\n        //清空选择的积分产品\r\n        this.orderData.exchangeItems = undefined;\r\n        this.pointProductsSelected.length = 0;\r\n        this.pointsSum = 0;\r\n        this.pointProducts = await this.getPointsProducts();\r\n        this.openVPage(VPointProduct);\r\n    }\r\n\r\n    openExchangeHistory = async () => {\r\n        this.exchangeHistory = await this.uqs.积分商城.PointExchangeSheet.mySheets(undefined, 1, -20);\r\n        this.openVPage(VExchangeHistory);\r\n    }\r\n\r\n    openPlatformOrderPoint = async (credits?: string) => {\r\n        this.openVPage(VPlatformOrderPoint, credits);\r\n    }\r\n\r\n    openExchangeOrder = async () => {\r\n        if (this.orderData.shippingContact === undefined) {\r\n            this.orderData.shippingContact = await this.getDefaultShippingContact();\r\n        }\r\n        this.openVPage(VExchangeOrder);\r\n    }\r\n\r\n    openOrderDetail = async (orderId: number) => {\r\n        let order = await this.uqs.积分商城.PointExchangeSheet.getSheet(orderId);\r\n        this.openVPage(VExchangeHistoryDetail, order);\r\n    }\r\n\r\n    renderOrderItemProduct = (product: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderCartProduct(product);\r\n    }\r\n\r\n    getPointsProducts = async () => {\r\n        return await this.uqs.积分商城.getPointProduct.table({});\r\n    }\r\n\r\n    getExchangeSheets = async () => {\r\n        return await this.uqs.积分商城.getExchangeSheets.table({});\r\n    }\r\n\r\n    onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data } = context;\r\n        let IsContain = 0;\r\n        let nowQuantity = value - (prev ? prev : 0);\r\n        this.pointsSum = this.pointsSum + (data.point * nowQuantity);\r\n\r\n        this.pointProductsSelected.forEach(element => {\r\n            if (element.pack.id == data.pack.id) {\r\n                element.quantity = element.quantity + nowQuantity;\r\n                IsContain = IsContain + 1;\r\n            }\r\n        });\r\n        if (IsContain == 0) {\r\n            this.pointProductsSelected.push(data);\r\n        }\r\n    }\r\n\r\n    private createOrderFromCart = async () => {\r\n        let { currentUser, currentSalesRegion } = this.cApp;\r\n        this.orderData.webUser = currentUser.id;\r\n        this.orderData.salesRegion = currentSalesRegion.id;\r\n        if (currentUser.currentCustomer !== undefined) {\r\n            this.orderData.customer = currentUser.currentCustomer.id;\r\n        }\r\n        if (this.pointProductsSelected !== undefined && this.pointProductsSelected.length > 0) {\r\n            this.orderData.exchangeItems = this.pointProductsSelected.map((e: any) => {\r\n                if (e.quantity > 0) {\r\n                    var item = new OrderItem();\r\n                    item.product = e.product;\r\n                    item.pack = e.pack;\r\n                    item.quantity = e.quantity;\r\n                    item.point = e.point;\r\n                    return item;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    submitOrder = async () => {\r\n        this.createOrderFromCart();\r\n\r\n        let PointExchangeSheet = this.uqs.积分商城.PointExchangeSheet;\r\n        let getDataForSave = this.orderData.getDataForSave();\r\n        let result: any = await PointExchangeSheet.save(\"PointExchangeSheet\", getDataForSave);\r\n        let { id, flow, state } = result;\r\n        await PointExchangeSheet.action(id, flow, state, \"submit\");\r\n\r\n        //暂时扣除已经兑换的积分;\r\n        this.myPointSum = this.myPointSum - this.pointsSum;\r\n        if (this.pointsSum > this.myPointInvalid) {\r\n            this.myPointInvalid = 0;\r\n        } else {\r\n            this.myPointInvalid = this.myPointInvalid - this.pointsSum;\r\n        }\r\n\r\n        //兑换后清空选择的积分产品\r\n        this.orderData.exchangeItems = undefined;\r\n        this.pointProductsSelected.length = 0;\r\n        this.pointsSum = 0;\r\n\r\n        // 打开下单成功显示界面\r\n        nav.popTo(this.cApp.topKey);\r\n        this.openVPage(OrderSuccess, result);\r\n    }\r\n\r\n    applyOrder = async (orderId: string) => {\r\n        let validationResult = await this.getOrderValidationResult(orderId);\r\n        let rtn = validationResult.result;\r\n        return rtn;\r\n    }\r\n    getOrderValidationResult = async (orderId: string) => {\r\n        let { currentCustomer } = this.cApp.currentUser;\r\n        return await this.uqs.积分商城.IsCanUseOrder.submit({ orderId: orderId, customer: currentCustomer && currentCustomer.id });\r\n    }\r\n\r\n    applyCoupon = async (coupon: string) => {\r\n        let validationResult = await this.getCouponValidationResult(coupon);\r\n        this.couponId = validationResult.id;\r\n        let rtn = validationResult.result;\r\n        if (rtn !== 0 && validationResult.types !== \"credits\") {\r\n            rtn = 0;\r\n        }\r\n        return rtn;\r\n    }\r\n    getCouponValidationResult = async (coupon: string) => {\r\n        let { currentCustomer } = this.cApp.currentUser;\r\n        return await this.uqs.salesTask.IsCanUseCoupon.submit({ code: coupon, customer: currentCustomer && currentCustomer.id });\r\n    }\r\n\r\n    addPlatformOrderPoint = async (orderId: string) => {\r\n        let { currentCustomer } = this.cApp.currentUser;\r\n        let AddPoint = this.uqs.积分商城.AddPlatformOrderPoint;\r\n        let result = await AddPoint.submit({ orderId: orderId, couponId: this.couponId, customer: currentCustomer && currentCustomer.id });\r\n        let rtn = result.result;\r\n        return rtn;\r\n    }\r\n\r\n    private defaultSetting: any;\r\n    private async getDefaultSetting() {\r\n        if (this.defaultSetting) return this.defaultSetting;\r\n        let { currentUser } = this.cApp;\r\n        return this.defaultSetting = await currentUser.getSetting() || {};\r\n    }\r\n    private contact0: BoxId;\r\n    private async getContact(): Promise<BoxId> {\r\n        if (this.contact0 === null) return;\r\n        if (this.contact0 !== undefined) return this.contact0;\r\n        let { currentUser } = this.cApp;\r\n        let contactArr = await currentUser.getContacts();\r\n        if (contactArr === undefined || contactArr.length === 0) {\r\n            this.contact0 = null;\r\n            return;\r\n        }\r\n        return this.contact0 = contactArr[0].contact;\r\n    }\r\n    private async getDefaultShippingContact() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.shippingContact || await this.getContact();\r\n    }\r\n    onSelectShippingContact = async () => {\r\n        let cSelect = this.newC(CSelectShippingContact);\r\n        let contactBox = await cSelect.call<BoxId>(true);\r\n        this.orderData.shippingContact = contactBox;\r\n    }\r\n}","import _ from 'lodash';\r\nimport { Context } from 'tonva';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VMe } from './VMe';\r\nimport { CSelectShippingContact } from '../customer/CSelectContact';\r\nimport { EditMeInfoFirstOrder } from './EditMeInfoFirstOrder';\r\nimport { CInvoiceInfo } from '../customer/CInvoiceInfo';\r\nimport { CAddress } from '../customer/CAddress';\r\nimport { CPointProduct } from 'pointMarket/CPointProduct';\r\n\r\nexport class CMe extends CUqBase {\r\n    //    cApp: CApp;\r\n    protected async internalStart() {\r\n\r\n    }\r\n\r\n    async changeWebUser(webUser: any) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.changeWebUser(webUser);\r\n    }\r\n\r\n    async changeWebUserContact(webUserContact: any) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.changeWebUserContact(webUserContact);\r\n    }\r\n\r\n    tab = () => this.renderView(VMe);\r\n\r\n    openMyOrders = async (state: string) => {\r\n        let { cOrder } = this.cApp;\r\n        await cOrder.openMyOrders(state);\r\n    }\r\n\r\n    openContactList = async () => {\r\n        let contactList = this.newC(CSelectShippingContact); // new CSelectShippingContact(this.cApp, undefined, false);\r\n        await contactList.start(false);\r\n    }\r\n\r\n    openInvoice = async () => {\r\n        let cInvoiceInfo = this.newC(CInvoiceInfo); // new CInvoiceInfo(this.cApp, undefined, false);\r\n        let { currentUser } = this.cApp;\r\n        let defaultSetting = await currentUser.getSetting();\r\n\r\n        let origInvoice = _.pick(defaultSetting, ['invoiceType', 'invoiceInfo']);\r\n        cInvoiceInfo.start(origInvoice);\r\n    }\r\n\r\n    openPoint = async () => {\r\n        let cPointProduct = this.newC(CPointProduct);// new CSelectShippingContact(this.cApp, undefined, false);\r\n        await cPointProduct.start();\r\n    }\r\n\r\n    openMeInfoFirstOrder = async () => {\r\n        await this.openVPage(EditMeInfoFirstOrder);\r\n    }\r\n\r\n    doCheckout = async () => {\r\n        let { cCart } = this.cApp;\r\n        await cCart.doCheckOut();\r\n    }\r\n\r\n    pickAddress = async (context: Context, name: string, value: number): Promise<number> => {\r\n        let cAddress = this.newC(CAddress); // new CAddress(this.cApp, undefined);\r\n        return await cAddress.call<number>();\r\n    }\r\n\r\n    getCommonText = async (textId: number) => {\r\n        return await this.uqs.order.CommonText.load(textId);\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, TabCaptionComponent, Page, Tabs } from 'tonva';\r\nimport { CApp } from '../CApp';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VMain extends VPage<CApp> {\r\n    async open(param?: any) {\r\n        this.openPage(this.render);\r\n    }\r\n    render = (param?: any): JSX.Element => {\r\n        let { cHome, cMember, cCart, cMe, cart } = this.controller;\r\n        let faceTabs = [\r\n            { name: 'home', label: '首页', icon: 'home', content: cHome.tab, notify: undefined/*store.homeCount*/ },\r\n            // { name: 'member', label: '会员', icon: 'vcard', content: cMember.tab },\r\n            { name: 'cart', label: '购物车', icon: 'shopping-cart', content: cCart.tab, notify: cart.count },\r\n            { name: 'me', label: '我的', icon: 'user', content: cMe.tab }\r\n        ].map(v => {\r\n            let { name, label, icon, content, notify } = v;\r\n            return {\r\n                name: name,\r\n                caption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n                content: content,\r\n                notify: notify,\r\n            }\r\n        });\r\n        return <Page header={false}>\r\n            <Tabs tabs={faceTabs} />\r\n        </Page>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, FA, Page } from 'tonva';\r\nimport { CCoupon } from './CCoupon';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class VCouponEdit extends VPage<CCoupon> {\r\n\r\n    private couponInput: HTMLInputElement;\r\n    @observable tips: string;\r\n    async open(param: any) {\r\n        if (param !== undefined) {\r\n\r\n        }\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private applyCoupon = async () => {\r\n        let coupon = this.couponInput.value;\r\n        if (!coupon)\r\n            return;\r\n        let ret = await this.controller.applyCoupon(coupon);\r\n        switch (ret) {\r\n            case -1:\r\n                this.tips = '对不起，当前服务器繁忙，请稍后再试。';\r\n                break;\r\n            case 1:\r\n                this.tips = '有效';\r\n                break;\r\n            case 0:\r\n                this.tips = \"无此优惠券，请重新输入或与您的专属销售人员联系确认优惠码是否正确。\";\r\n                break;\r\n            case 2:\r\n            case 3:\r\n            case 5:\r\n                this.tips = '优惠券无效，请重新输入或与您的专属销售人员联系。';\r\n                break;\r\n            case 6:\r\n                this.tips = '不允许使用本人优惠券！';\r\n                break;\r\n            case 4:\r\n                this.tips = '该优惠券已经被使用过了，不允许重复使用。';\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        if (this.tips)\r\n            setTimeout(() => this.tips = undefined, GLOABLE.TIPDISPLAYTIME);\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let tipsUI = <></>;\r\n        if (this.tips) {\r\n            tipsUI = <div className=\"alert alert-primary\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {this.tips}\r\n            </div>\r\n        }\r\n        return <Page header=\"填写优惠券/积分码\">\r\n            <div className=\"px-2 bg-white\">\r\n                <div className=\"row py-3 pr-3 my-1\">\r\n                    <div className=\"col-4 col-sm-2 pb-2 text-muted\">优惠券/积分码:</div>\r\n                    <div className=\"col-8 col-sm-10 d-flex\">\r\n                        <input ref={v => this.couponInput = v} type=\"number\" className=\"form-control\"></input>\r\n                    </div>\r\n                </div>\r\n                <div className=\"row my-1\">\r\n                    <div className=\"col-12\">\r\n                        <button className=\"btn btn-primary w-100\" onClick={this.applyCoupon}>使用</button>\r\n                    </div>\r\n                </div>\r\n                {tipsUI}\r\n            </div>\r\n        </Page>\r\n    })\r\n}","import * as React from 'react';\r\nimport { CCoupon } from './CCoupon';\r\nimport { VPage, Page, BoxId, List, tv, FA, EasyDate, LMR } from 'tonva';\r\n\r\nexport class VSharedCoupon extends VPage<CCoupon> {\r\n\r\n    private couponValidationResult: any;\r\n    private products: any[] = [];\r\n    async open(param: any) {\r\n        this.couponValidationResult = param.couponValidationResult;\r\n        this.products = param.products || [];\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private showProductDetail = async (product: any) => {\r\n        await this.controller.showProductDetail(product);\r\n    }\r\n\r\n    private page = () => {\r\n        let { result, id, code, discount, preferential, validitydate, isValid } = this.couponValidationResult;\r\n\r\n        let couponUi;\r\n        if (result !== 1 || !isValid) {\r\n            this.controller.cApp.currentCouponCode = undefined;\r\n            couponUi = <div className=\"alert alert-primary my-1\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                优惠券【{code}】无效，请与您的专属销售人员联系。\r\n            </div>\r\n        } else {\r\n            this.controller.cApp.currentCouponCode = code;\r\n            let codeShow = String(code);\r\n            let p1 = codeShow.substr(0, 4);\r\n            let p2 = codeShow.substr(4);\r\n            codeShow = p1 + ' ' + p2;\r\n\r\n            let aleft = <div><FA name='th-large' className='my-2 mr-3 text-warning' />{codeShow}</div>;\r\n            let bcenter: any;\r\n            if (preferential)\r\n                bcenter = <div className=\"text-muted\"><small>优惠：<span className=\"mx-3\">￥{preferential}</span></small></div>;\r\n\r\n            let right = <div>\r\n                <div className=\"pb-1\">\r\n                    <FA name='th-large' className='mr-1 text-warning' />{codeShow}\r\n                    <small className=\"ml-3\">有效期：<EasyDate date={validitydate} /></small>\r\n                </div>\r\n                <div><small className=\"text-success\">此优惠券也可用于订购其他产品</small></div>\r\n            </div>;\r\n\r\n            let left: any;\r\n            if (typeof discount === 'number') {\r\n                let discountShow: any;\r\n                discountShow = (1 - discount) * 10;\r\n                left = <div>\r\n                    <div className=\"mr-3 font-weight-bold text-danger\"><big>{discountShow === 10 ? '无折扣' : <>{discountShow.toFixed(1)} 折</>}</big></div>\r\n                    {discountShow === 10 ? null : <span className=\"text-muted\"><small>结算时自动扣减</small></span>}\r\n                </div>;\r\n            }\r\n\r\n            couponUi = <div className=\"bg-white p-3 mb-1\">\r\n                <LMR left={left} right={right}>\r\n                </LMR>\r\n            </div>\r\n        }\r\n\r\n        let { renderProduct, cApp } = this.controller;\r\n        let { cCart } = cApp;\r\n        let cart = cCart.renderCartLabel();\r\n        return <Page header=\"与您分享\" right={cart}>\r\n            {couponUi}\r\n            <List items={this.products} item={{ render: renderProduct, className: \"mb-1\" }} none={null} />\r\n        </Page>\r\n    }\r\n}","import { CUqBase } from '../CBase';\r\nimport { VCouponEdit } from './VCouponEdit';\r\nimport { VSharedCoupon } from './VSharedCoupon';\r\nimport { BoxId } from 'tonva';\r\n\r\nexport class CCoupon extends CUqBase {\r\n\r\n    applyCoupon = async (coupon: string) => {\r\n        let validationResult = await this.getCouponValidationResult(coupon);\r\n        let rtn = validationResult.result;\r\n        if (rtn === 1) {\r\n            this.returnCall(validationResult);\r\n            this.closePage();\r\n        }\r\n        return rtn;\r\n    }\r\n\r\n    getCouponValidationResult = async (coupon: string) => {\r\n        let { currentCustomer } = this.cApp.currentUser;\r\n        return await this.uqs.salesTask.IsCanUseCoupon.submit({ code: coupon, customer: currentCustomer && currentCustomer.id });\r\n    }\r\n\r\n    protected async internalStart(param: any) {\r\n        this.openVPage(VCouponEdit);\r\n    }\r\n\r\n    showSharedCoupon = async (param: any) => {\r\n        let { coupon, productids } = param;\r\n\r\n        let couponValidationResult = await this.getCouponValidationResult(coupon);\r\n        let products: any;\r\n        if (productids) {\r\n            let { ProductX } = this.uqs.product;\r\n            let productidArray = productids.split('-').filter((v: any) => /^\\d{1,10}$/.test(v));\r\n            // let promises: PromiseLike<void>[] = productidArray.map((v: any) => ProductX.load(v));\r\n            // products = await Promise.all(promises);\r\n            products = productidArray.map((v: any) => ProductX.boxId(v));\r\n        }\r\n        this.openVPage(VSharedCoupon, { couponValidationResult, products });\r\n    }\r\n\r\n    async showProductDetail(product: BoxId) {\r\n        let { cProduct } = this.cApp;\r\n        await cProduct.showProductDetail(product);\r\n    }\r\n\r\n    renderProduct = (product: any) => {\r\n        let { cProduct } = this.cApp;\r\n        // return cProduct.renderProduct(product);\r\n        return cProduct.renderProductWithPrice(product);\r\n    }\r\n}","import { CAppBase, IConstructor, User, nav } from \"tonva\";\r\nimport { UQs } from \"./uqs\";\r\nimport { Cart } from \"./cart/Cart\";\r\nimport { WebUser } from \"./CurrentUser\";\r\nimport { CHome } from \"./home\";\r\nimport { CCart } from \"./cart\";\r\nimport { CProduct } from \"./product\";\r\nimport { COrder } from \"./order/COrder\";\r\nimport { CProductCategory } from \"./productCategory/CProductCategory\";\r\nimport { CMember } from \"./member\";\r\nimport { CMe } from \"./me/CMe\";\r\nimport { CUqBase } from \"./CBase\";\r\nimport { VMain } from 'ui/main';\r\nimport { GLOABLE } from 'configuration';\r\nimport * as qs from 'querystringify';\r\nimport { CCoupon } from \"coupon/CCoupon\";\r\nimport { CPointProduct } from \"pointMarket/CPointProduct\";\r\n\r\nexport class CApp extends CAppBase {\r\n    get uqs(): UQs { return this._uqs as UQs };\r\n\r\n    cart: Cart;\r\n    topKey: any;\r\n\r\n    currentSalesRegion: any;\r\n    currentLanguage: any;\r\n    currentUser: WebUser;\r\n    currentCouponCode: string;\r\n\r\n    cHome: CHome;\r\n    cCart: CCart;\r\n    cProduct: CProduct;\r\n    cOrder: COrder;\r\n    cCoupon: CCoupon;\r\n    cProductCategory: CProductCategory;\r\n    cMember: CMember;\r\n    cMe: CMe;\r\n    cPointProduct: CPointProduct;\r\n\r\n    protected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n        return new type(this);\r\n    }\r\n\r\n    protected async internalStart() {\r\n        this.currentSalesRegion = await this.uqs.common.SalesRegion.load(GLOABLE.SALESREGION_CN);\r\n\r\n        this.currentLanguage = await this.uqs.common.Language.load(GLOABLE.CHINESE);\r\n\r\n        this.currentUser = new WebUser(this.uqs); //this.cUqWebUser, this.cUqCustomer);\r\n        if (this.isLogined) {\r\n            await this.currentUser.setUser(this.user);\r\n        }\r\n\r\n        this.cart = new Cart(this);\r\n        await this.cart.init();\r\n\r\n        this.cProductCategory = this.newC(CProductCategory);\r\n        this.cCart = this.newC(CCart);\r\n        this.cHome = this.newC(CHome);\r\n        this.cProduct = this.newC(CProduct);\r\n        this.cOrder = this.newC(COrder);\r\n        this.cCoupon = this.newC(CCoupon);\r\n        this.cMember = this.newC(CMember);\r\n        this.cMe = this.newC(CMe);\r\n        this.cPointProduct = this.newC(CPointProduct);\r\n\r\n\r\n        let promises: PromiseLike<void>[] = [];\r\n        promises.push(this.cProductCategory.start());\r\n        await Promise.all(promises);\r\n\r\n        this.showMain();\r\n        let { location } = document;\r\n        let { search } = location;\r\n        if (search) {\r\n            let query: any = qs.parse(search.toLowerCase());\r\n            switch (query.type) {\r\n                case \"product\":\r\n                    let prouductBoxId = await this.uqs.product.ProductX.boxId(query.product).assure();\r\n                    await this.cProduct.showProductDetail(prouductBoxId);\r\n                    break;\r\n                case \"coupon\":\r\n                    if (query.coupon)\r\n                        await this.cCoupon.showSharedCoupon(query);\r\n                    break;\r\n                case \"credits\":\r\n                    if (query.credits)\r\n                        await this.cPointProduct.openPlatformOrderPoint(query.credits);\r\n                    break;\r\n                case \"order\":\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n        this.topKey = nav.topKey();\r\n    }\r\n\r\n    showMain(initTabName?: string) {\r\n        this.openVPage(VMain, initTabName);\r\n    }\r\n\r\n    async loginCallBack(user: User) {\r\n        /*\r\n        if (this.cartService.isLocal) {\r\n            let cartLocal = { ...this.cartViewModel } as CartViewModel;\r\n            // this.cartService.clear(this.cartViewModel);\r\n            this.cartService = CartServiceFactory.getCartService(this);\r\n            this.cartViewModel = await this.cartService.load();\r\n            // this.cartViewModel = await this.cartService.merge(cartLocal);\r\n        }\r\n        */\r\n    }\r\n\r\n    protected onDispose() {\r\n        this.cart.dispose();\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport './App.css';\r\nimport { NavView, nav, Page, Tabs, start } from 'tonva';\r\nimport { CApp } from 'CApp';\r\nimport { appConfig } from 'configuration';\r\n\r\n//const tonvaApp = \"bruce/TestApp\";\r\nnav.setSettings(appConfig);\r\n\r\nclass App extends React.Component {\r\n\r\n  private onLogined = async () => {\r\n    await start(CApp, appConfig);\r\n  }\r\n  public render() {\r\n    return <NavView onLogined={this.onLogined} notLogined={this.onLogined} />\r\n  }\r\n}\r\n\r\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}