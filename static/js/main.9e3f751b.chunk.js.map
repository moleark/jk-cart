{"version":3,"sources":["tools/groupByProduct.ts","cart/Cart.ts","CurrentUser.ts","CBase.ts","home/VSearchHeader.tsx","home/VSiteHeader.tsx","home/VHome.tsx","home/CHome.tsx","cart/VCartLabel.tsx","tools/minusPlusWidget.tsx","cart/VCart.tsx","cart/CCart.tsx","tools/productImage.tsx","product/VProduct.tsx","product/VProductList.tsx","mainSubs/loader.ts","tools/productChemical.ts","product/itemLoader.ts","product/VProductDelivery.tsx","product/VProductView.tsx","product/VChemicalInfo.tsx","product/CProduct.tsx","me/loginTop.tsx","tvs/common.tsx","tvs/product.tsx","tvs/customer.tsx","tvs/index.tsx","tvs/warehouse.tsx","tvs/order.tsx","configuration.ts","order/VCreateOrder.tsx","order/Order.ts","order/OrderSuccess.tsx","customer/VContactList.tsx","tools/inputValidations.ts","customer/VContact.tsx","customer/VAddress.tsx","customer/CAddress.tsx","customer/CSelectContact.tsx","order/VMyOrders.tsx","order/VOrderDetail.tsx","customer/VInvoiceInfo.tsx","customer/CInvoiceInfo.tsx","order/VCouponEdit.tsx","order/CCoupon.tsx","order/COrder.tsx","productCategory/VRootCategory.tsx","productCategory/VCategory.tsx","productCategory/CProductCategory.tsx","member/VMember.tsx","member/CMember.tsx","me/about.tsx","me/EditMeInfo.tsx","me/aboutThisApp.tsx","me/VMe.tsx","me/EditMeInfoFirstOrder.tsx","me/CMe.tsx","ui/main.tsx","CApp.ts","App.tsx","serviceWorker.ts","index.tsx","images/logo.png","mainSubs/mainSubs.tsx","mainSubs/render.tsx","mainSubs/index.ts","images/AnalyticalChemistry.png","images/LabSupplies.png","images/LifeScience.png","images/MaterialScience.png","images/OrganicChemistry.png","images/pig.png"],"names":["groupByProduct","packItems","result","packItem","product","pack","quantity","price","currency","packRow","id","cpi","find","e","undefined","packs","push","sort","a","b","Cart","cApp","cartStore","disposer","cartItems","count","observable","box","amount","calcSum","cp","$isSelected","$isDeleted","pi","Number","NaN","set","parseFloat","toFixed","add","cartItemExists","createdate","Date","now","splice","packExists","added","index","length","unshift","storeCart","this","data","list","autorun","isLogined","CartRemote","CartLocal","load","cartData","cartDataGrouped","i","productId","packId","v","cpp","findIndex","filter","rows","forEach","pe","cartItemIndex","cartItem","removeFromCart","CartStore","uqs","order","GetCart","page","SetCart","submit","param","map","RemoveFromCart","productTuid","ProductX","packTuid","div","cartstring","localStorage","getItem","JSON","parse","cartDataBoxed","productbox","boxId","packbox","removeItem","setItem","stringify","WebUser","name","nick","icon","guest","token","gender","salutation","departmentName","telephone","email","fax","address","addressString","zipCode","_user","webUserSettings","setUser","user","loadWebUser","currentCustomer","organizationName","invoiceInfo","obj","shippingContact","invoiceContact","firstName","mobile","webuser","webUser","WebUserContact","contact","WebUserSetting","WebUserCustomer","value","Customer","customer","init","WebUserContacts","table","contactId","arr1","Contact","save","newContact","newContactId","addContact","newContactBox","setDefaultShippingContact","del","saveDefaultSettings","invoiceTypeId","invoiceInfoId","invoiceType","webUserContact","computed","customerSettings","CustomerContacts","CustomerSetting","setDefaultSettings","CUqBase","_cApp","_uqs","CBase","VSearchHeader","CSub","onSearch","key","controller","cProduct","topKey","nav","popTo","start","size","className","placeholder","View","VSiteHeader","left","src","logo","alt","style","height","width","right","renderSearchHeader","VHome","observer","header","content","renderCategoryRootList","siteHeader","renderVm","openPage","CHome","PageItems","homeSections","sectionTuid","renderView","cProductCategory","renderRootList","tab","openVPage","VCartLabel","showCart","badge","onClick","pointer","cart","get","classNames","keys","MinusPlusWidget","minusClick","getValue","setValue","plusClick","ref","input","p","parentElement","tagName","disabled","renderContent","renderTemplet","cn","hasError","itemSchema","required","cursorPointer","minusColor","plusColor","hasFocus","hasAction","readOnly","hasValue","minus","invisible","type","defaultValue","onChange","onKeyDown","onFocus","evt","onBlur","maxLength","plus","renderErrors","UpdownWidget","cartSchema","arr","VCart","CheckOutButton","checkOut","renderCartItem","item","onProductClick","renderCartProduct","packsRow","tv","renderDeliveryTime","uiSchema","selectable","deletable","restorable","items","widget","Templet","ArrContainer","label","RowContainer","RowSeperator","WidgetClass","onChanged","onQuantityChanged","cartForm","schema","formData","params","footer","empty","VPage","CCart","selectedCartItems","context","prev","parentData","onRowStateChanged","selected","deleted","alert","loginCallback","currentUser","loginCallBack","closePage","doFirstOrderChecking","isDeleted","showProductDetail","getSelectedItems","showLogin","cMe","allowOrdering","openMeInfoFirstOrder","doCheckOut","cOrder","imagePath","altimagePath","ProductImage","props","chemicalId","substr","altImage","VProduct","productBox","renderProduct","brand","description","descriptionC","CAS","purity","molecularFomula","molecularWeight","origin","imageUrl","productPropItem","renderBrand","arrTemplet","retail","vipPrice","promotionPrice","retailUI","minPrice","renderPack","cHome","cartLabel","cCart","renderCartLabel","viewProduct","ViewMainSubs","model","render","productData","Math","min","Infinity","VProductList","searchKey","onScrollBottom","pageProducts","more","none","before","Loader","entities","schemaLoaded","Promise","all","loadSchemas","initData","loadToData","LoaderProductChemical","ProductChemical","productChemical","chemical","LoaderBrand","brandId","Brand","LoaderProductWithChemical","_","merge","brandLoader","productChemicalLoader","packx","LoaderProductChemicalWithPrices","main","subs","customerDiscount","promotion","productLoader","discount","currentSalesRegion","currentLanguage","hasCustomer","GetDiscount","discountSetting","currentSalesRegionId","PriceX","salesRegion","prices","discountinued","expireDate","element","ret","round","getQuantity","promises","GetPromotionPack","language","results","VProductDelivery","initInventoryAllocation","salesRegionId","inventoryAllocation","getInventoryAllocation","initFutureDeliveryTimeDescription","futureDeliveryTimeDescription","getFutureDeliveryTimeDescription","warehouse","deliveryTimeDescription","values","packObj","owner","VCartProuductView","renderChemicalInfo","VProductPrice","visible","initPrices","getProductPrice","priceUI","SalesRegionId","VChemicalInfo","chemicalInfo","chemicalInfoContainer","getChemicalInfo","PageProducts","searchProductQuery","firstSize","pageSize","pageStart","seq","CProduct","loader","renderProductPrice","GetInventoryAllocation","cacheId","futureDeliveryTimeDescriptionContainer","GetFutureDeliveryTime","futureDeliveryTime","minValue","maxValue","unit","searchByKey","SearchProduct","first","keyWord","category","SearchProductByCategory","productCategoryId","productCategory","caption","captionClass","capClass","valClass","jnkTop","tvAddress","country","province","city","county","tvCountry","chineseName","tvCurrency","tvProduct","tvContact","tvs","common","productx","radiox","radioy","children","title","taxNo","appConfig","appName","version","loginTop","GLOABLE","CHINA","CHINESE","SALESREGION_CN","ROOTCATEGORY","7","OrganicChemistry","labelColor","430","AnalyticalChemistry","986","LifeScience","1214","MaterialScience","1545","LabSupplies","TIPDISPLAYTIME","VCreateOrder","nullContact","renderOrderItem","orderItem","renderOrderItemProduct","orderItemKey","renderCoupon","couponData","offsetUI","remittedUI","noOffsetUI","code","couponOffsetAmount","preferential","validitydate","isValid","couponRemitted","onSubmit","orderData","shippingAddressIsBlank","setTimeout","useShippingAddress","invoiceAddressIsBlank","invoiceIsBlank","submitOrder","onSelectShippingContact","onSelectInvoiceContact","openMeInfo","onInvoiceInfoEdit","onCouponEdit","fillMeInfo","role","fontSize","chevronRight","shippingAddressBlankTip","invoiceAddressBlankTip","divInvoiceContact","invoiceContactUI","defaultChecked","currentTarget","checked","invoiceBlankTip","invoiceInfoUI","freightFeeUI","freightFeeRemittedUI","freightFee","freightFeeRemitted","couponUI","orderItems","productAmount","Order","organization","oi","pk","subAmount","coupon","orderitems","reduce","pv","cv","subListAmount","OrderItem","c","OrderSuccess","orderCreateResult","back","no","VContactList","onContactRender","onEditContact","onContactSelected","onNewContact","userContacts","contactList","telephoneValidation","test","mobileValidation","emailValidation","faxValidation","addressDetailValidation","zipCodeValidation","organizationNameValidation","nameValidation","VContact","userContactData","form","rules","pickId","pickAddress","addressValue","isDefault","onSaveContact","buttonClick","onFormButtonClick","saveContact","onDelContact","vCall","VConfirmDeleteContact","delContact","buttonDel","contactData","clone","defaultOrganizationName","defaultName","defaultMobile","fromOrderCreation","onButtonClick","fieldLabelSize","onConfirm","returnCall","onCancel","top","VAddress","provinceId","cityId","countyId","backLevel","provinces","renderPCC","onProvinceClick","pcc","border","marginRight","marginBottom","getProvinceCities","cities","len","onCityClick","openPageElement","saveAddress","getCityCounties","counties","onCountyClick","getCountryProvince","CAddress","countryId","GetCountryProvinces","GetProvinceCities","GetCityCounties","Address","newAddress","addressId","CSelectContact","userContact","userContactId","getSetting","userSetting","getIsDefault","setDefaultContact","contactTuid","contactBox","backPage","cAddress","newC","call","getContacts","userContactMaps","CSelectShippingContact","CSelectInvoiceContact","setDefaultInvoiceContact","VMyOrders","currentState","renderOrder","openOrderDetail","date","discription","flow","tabs","pendingOrders","isSelected","getMyOrders","processingOrders","completedOrders","tabPosition","VOrderDetail","brief","state","invoiceTypeUI","invoiceTemplate","bank","accountNo","regArr","j","commonRequired","valueAddedRequired","commonVisible","valueAddedVisible","VInvoiceInfo","saveTip","invoiceInfoData","invoice","saveInvoiceInfo","showTip","onSaveInvoice","onInvoiceTypeClick","event","parseInt","frm","buildForm","tipUI","htmlFor","origInvoice","assure","requiredFields","visibleFields","CInvoiceInfo","InvoiceInfo","newInvoiceInfo","newInvoiceInfoId","invoiceBox","InvoiceType","setDefaultInvoice","VCouponEdit","couponInput","applyCoupon","tips","tipsUI","CCoupon","salesTask","IsCanUseCoupon","validationResult","rtn","FREIGHTFEEFIXED","FREIGHTFEEREMITTEDSTARTPOINT","COrder","createOrderFromCart","removeCoupon","getDefaultShippingContact","getDefaultInvoiceContact","getDefaultInvoiceType","getDefaultInvoiceInfo","defaultSetting","contact0","getDataForSave","action","cSelect","cCoupon","getTime","AgentPrice","agentPrices","eachProductAgentPrice","agentPrice","max","openMyOrders","GetPendingPayment","mySheets","cInvoiceInfo","newInvoice","orderId","getSheet","orderItemsGrouped","contactArr","getDefaultSetting","getContact","titleTitle","overflow","textOverflow","whiteSpace","subStyle","VRootCategory","categoryClick","categoryWapper","parent","openMainPage","renderRootCategory","productCategoryID","paddingRight","renderSubCategory","total","renderThirdCategory","categories","categories2","root","console","log","join","VCategory","renderChild","childWapper","breadCrumb","arial-babel","breadCrumbItem","categoryWaper","CProductCategory","GetRootCategory","query","buildCategories","secend","third","parentCategoryId","GetChildrenCategory","firstCategory","secendCategory","getCategoryChildren","searchByCategory","stylePig","backgroundImage","pig","backgroundSize","backgroundColor","opacity","position","VMember","recommendationCodeRef","React","member","recommendationCode","point","im","inviteCode","divPoints","pointThisWeek","pointAll","fansTitle","fansDetail","submitRecommendationCode","current","setReferrer","CMember","referrer","pop","internalStart","currentUserId","MemberAction","MemberRecommender","fans","About","source","escapeHtml","EditMeInfo","onItemChanged","newValue","preValue","userApi","userSetProp","saveLocalUser","onWebUserChanged","webUserData","changeWebUser","onWebUserContactChanged","webUserContactData","changeWebUserContact","webUserSchema","webUserUiSchema","webUserContactSchema","webUserContactUiSchema","AboutThisApp","VMe","about","aboutThisApp","changePassword","openContactList","openInvoice","meInfo","userSpan","String","orderStates","showLogout","aboutRows","component","iconClass","text","logOutRows","bk","exit","EditMeInfoFirstOrder","addContactFromAccount","doCheckout","CMe","pick","color","VMain","cMember","faceTabs","notify","TabCaptionComponent","CApp","SalesRegion","Language","showMain","initTabName","dispose","CAppBase","setSettings","App","onLogined","notLogined","Boolean","window","location","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","module","exports","ViewBase","sub","renderSubs","subsContainer","renderSubItems","subViews"],"mappings":"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","file":"static/js/main.9e3f751b.chunk.js","sourcesContent":["\r\nexport function groupByProduct(packItems: any[]) {\r\n    let result: any[] = [];\r\n    for (let packItem of packItems.sort((a, b) => a.price - b.price)) {\r\n        let { product, pack, quantity, price, currency } = packItem;\r\n        let packRow: any = {\r\n            pack: pack,\r\n            price: price,\r\n            quantity: quantity,\r\n            currency: currency && currency.id\r\n        }\r\n        let cpi = result.find(e => e.product.id === product.id);\r\n        if (cpi === undefined) {\r\n            cpi = { product: product, packs: [] };\r\n            result.push(cpi);\r\n        }\r\n        cpi.packs.push(packRow);\r\n    }\r\n    return result;\r\n}","import { observable, autorun, IReactionDisposer } from 'mobx';\r\nimport { Action, Query, TuidDiv, BoxId, Tuid } from 'tonva';\r\n//import { CCartApp } from '../CCartApp';\r\nimport { PackRow } from 'product/Product';\r\nimport { groupByProduct } from 'tools/groupByProduct';\r\nimport { CApp } from '../CApp';\r\n\r\nexport interface CartItem2 {\r\n    product: BoxId;\r\n    packs: CartPackRow[];\r\n    $isSelected?: boolean;\r\n    $isDeleted?: boolean;\r\n    createdate: number;\r\n}\r\n\r\nexport interface CartPackRow extends PackRow {\r\n    price: number;\r\n    retail?: number;\r\n    currency: any;\r\n}\r\n\r\nexport class Cart {\r\n    cApp: CApp;\r\n\r\n    private cartStore: CartStore;\r\n    private disposer: IReactionDisposer;\r\n\r\n    @observable data: any = {\r\n        list: observable<CartItem2>([]),\r\n    };\r\n    cartItems: CartItem2[];\r\n    count = observable.box<number>(0);\r\n    amount = observable.box<number>(0);\r\n\r\n    constructor(cApp: CApp) {\r\n        this.cApp = cApp;\r\n        this.cartItems = this.data.list;\r\n        this.disposer = autorun(this.calcSum);\r\n    }\r\n\r\n    dispose() {\r\n        this.disposer();\r\n    }\r\n\r\n    protected calcSum = () => {\r\n        let count = 0, amount = 0;\r\n        for (let cp of this.cartItems) {\r\n            let { $isSelected, $isDeleted, packs } = cp;\r\n            if ($isDeleted === true || !($isSelected === true)) continue;\r\n            for (let pi of packs) {\r\n                let { price, quantity } = pi;\r\n                count += quantity;\r\n                if (price === Number.NaN || quantity === Number.NaN) continue;\r\n                amount += quantity * price;\r\n            }\r\n        }\r\n        this.count.set(count);\r\n        this.amount.set(parseFloat(amount.toFixed(2)));\r\n    }\r\n\r\n    async init(): Promise<void> {\r\n        if (this.cApp.isLogined)\r\n            this.cartStore = new CartRemote(this.cApp);\r\n        else\r\n            this.cartStore = new CartLocal(this.cApp);\r\n        let cartData = await this.cartStore.load();\r\n        let cartDataGrouped = groupByProduct(cartData);\r\n        if (cartDataGrouped && cartDataGrouped.length > 0) {\r\n            for (let i = 0; i < cartDataGrouped.length; i++) {\r\n                let { product, packs, createdate } = cartDataGrouped[i];\r\n                this.cartItems.push({\r\n                    product: product,\r\n                    packs: packs,\r\n                    $isSelected: true,\r\n                    $isDeleted: false,\r\n                    createdate: createdate,\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    /*\r\n    private mergeToRemote(localItems: any[]) {\r\n        let originLength = localItems.length;\r\n        let nowLength = this.items.length;\r\n        if (originLength > 0) {\r\n            if (nowLength > 0) {\r\n                // \r\n                for (let i = 0; i < originLength; i++) {\r\n                    let { product: tempProduct, pack: tempPack } = localItems[i];\r\n                    let cartItemExits = this.items.find(v => v.product === tempProduct && v.pack === tempPack);\r\n                    if (cartItemExits) {\r\n                        // \r\n                    } else {\r\n                        this.items.push(localItems[i]);\r\n                    }\r\n                }\r\n            } else {\r\n                this.items.push(...localItems);\r\n            }\r\n            // \r\n        }\r\n    }\r\n    */\r\n\r\n    getQuantity(productId: number, packId: number): number {\r\n        let cp = this.cartItems.find(v => v.$isDeleted !== true && v.product.id === productId);\r\n        if (!cp) return 0;\r\n        let cpp = cp.packs.find(v => v.pack.id === packId);\r\n        return cpp === undefined ? 0 : cpp.quantity;\r\n    }\r\n\r\n    isDeleted(productId: number): boolean {\r\n        let i = this.cartItems.findIndex(v => v.$isDeleted === true && v.product.id === productId);\r\n        return i !== -1;\r\n    }\r\n\r\n    getSelectedItems(): CartItem2[] {\r\n        return this.cartItems.filter(v => {\r\n            let { $isSelected, $isDeleted } = v;\r\n            return $isSelected === true && $isDeleted !== true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    add = async (product: BoxId, pack: BoxId, quantity: number, price: number, currency: any) => {\r\n\r\n        let cartItemExists = this.cartItems.find((e) => e.product.id === product.id);\r\n        if (!cartItemExists) {\r\n            cartItemExists = {\r\n                product: product,\r\n                packs: [{ pack: pack, quantity: quantity, price: price, currency: currency }],\r\n                $isSelected: true,\r\n                $isDeleted: false,\r\n                createdate: Date.now()\r\n            };\r\n            this.cartItems.push(cartItemExists);\r\n        }\r\n        else {\r\n            let { $isDeleted, packs } = cartItemExists;\r\n            if ($isDeleted === true)\r\n                packs.splice(0);\r\n\r\n            let packExists: CartPackRow = packs.find(e => e.pack.id === pack.id);\r\n            if (packExists === undefined) {\r\n                let added = false;\r\n                for (let index = packs.length - 1; index >= 0; index--) {\r\n                    if (packs[index].price < price) {\r\n                        packs.splice(index + 1, 0, { pack: pack, quantity: quantity, price: price, currency: currency });\r\n                        added = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (!added)\r\n                    packs.unshift({ pack: pack, quantity: quantity, price: price, currency: currency })\r\n                // packs.push();\r\n            }\r\n            else {\r\n                packExists.quantity = quantity;\r\n                packExists.price = price;\r\n                packExists.currency = currency;\r\n            }\r\n            cartItemExists.$isSelected = true;\r\n            cartItemExists.$isDeleted = false;\r\n            cartItemExists.createdate = Date.now();\r\n        }\r\n\r\n        await this.cartStore.storeCart(product, pack, quantity, price, currency);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param rows\r\n     */\r\n    async removeFromCart(rows: [{ productId: number, packId: number }]) {\r\n        if (rows && rows.length > 0) {\r\n            rows.forEach(pe => {\r\n                let cartItemIndex = this.cartItems.findIndex(e => e.product.id === pe.productId);\r\n                if (cartItemIndex >= 0) {\r\n                    let cartItem = this.cartItems[cartItemIndex];\r\n                    let i = cartItem.packs.findIndex(e => e.pack.id === pe.packId)\r\n                    if (i >= 0) {\r\n                        cartItem.packs.splice(i, 1);\r\n                        if (cartItem.packs.length === 0) {\r\n                            this.cartItems.splice(cartItemIndex, 1);\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n            this.cartStore.removeFromCart(rows);\r\n        }\r\n    }\r\n\r\n    /*\r\n    setDeletedMark(productId: number, packId: number) {\r\n        let cp = this.items.find(v => v.$isDeleted !== true && v.product === productId && v.pack === packId);\r\n        if (cp !== undefined)\r\n            cp.$isDeleted = true;\r\n    }\r\n\r\n    async removeDeletedItem() {\r\n        let rows: { product: number, packItem: CartPackRow }[] = [];\r\n        for (let cp of this.items) {\r\n            let { quantity, $isDeleted } = cp;\r\n            if ($isDeleted === true || quantity === 0) {\r\n                // TODO:\r\n            }\r\n        }\r\n        if (rows.length === 0) return;\r\n        await this.cartStore.removeFromCart(rows);\r\n\r\n        // \r\n        for (let cp of this.items) {\r\n            let { packs } = cp;\r\n            let packIndexes: number[] = [];\r\n            let len = packs.length;\r\n            for (let i = 0; i < len; i++) {\r\n                if (packs[i].quantity === 0) packIndexes.push(i);\r\n            }\r\n            for (let i = packIndexes.length - 1; i >= 0; i--) packs.splice(packIndexes[i], 1);\r\n        }\r\n\r\n        let itemIndexes: number[] = [];\r\n        let len = this.items.length;\r\n        for (let i = 0; i < len; i++) {\r\n            let { $isDeleted, packs } = this.items[i];\r\n            if ($isDeleted === true || packs.length === 0) itemIndexes.push(i);\r\n        }\r\n        for (let i = itemIndexes.length - 1; i >= 0; i--) this.items.splice(itemIndexes[i], 1);\r\n    }\r\n\r\n    async clear() {\r\n        this.items.forEach(v => v.$isDeleted = true);\r\n        await this.removeDeletedItem();\r\n    }\r\n    */\r\n\r\n}\r\n\r\nabstract class CartStore {\r\n\r\n    protected cApp: CApp;\r\n    constructor(cApp: CApp) {\r\n        this.cApp = cApp;\r\n    }\r\n    abstract get isLocal(): boolean;\r\n    abstract async load(): Promise<CartItem2[]>;\r\n    abstract async storeCart(product: BoxId, pack: BoxId, quantity: number, price: number, currency: any): Promise<void>;\r\n    abstract async removeFromCart(rows: [{ productId: number, packId: number }]): Promise<void>;\r\n}\r\n\r\nclass CartRemote extends CartStore {\r\n    //private getCartQuery: Query;\r\n    //private setCartAction: Action;\r\n    //private removeFromCartAction: Action;\r\n\r\n    get isLocal(): boolean { return false }\r\n\r\n    /*\r\n    constructor(cApp: CApp) {\r\n        super(cApp);\r\n\r\n        let { cUqOrder } = this.cApp;\r\n        this.getCartQuery = cUqOrder.query('getcart')\r\n        this.setCartAction = cUqOrder.action('setcart');\r\n        this.removeFromCartAction = cUqOrder.action('removefromcart');\r\n    }\r\n    */\r\n\r\n    async load(): Promise<CartItem2[]> {\r\n        return await this.cApp.uqs.order.GetCart.page(undefined, 0, 100);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param product\r\n     * @param pack\r\n     * @param quantity\r\n     * @param price\r\n     * @param currency\r\n     */\r\n    async storeCart(product: BoxId, pack: BoxId, quantity: number, price: number, currency: any) {\r\n        await this.cApp.uqs.order.SetCart.submit({\r\n            product: product.id,\r\n            pack: pack.id,\r\n            price: price,\r\n            currency: currency,\r\n            quantity: quantity\r\n        });\r\n    }\r\n\r\n    async removeFromCart(rows: [{ productId: number, packId: number }]) {\r\n        let param = rows.map(e => { return { product: e.productId, pack: e.packId } });\r\n        await this.cApp.uqs.order.RemoveFromCart.submit({ rows: param });\r\n    }\r\n}\r\n\r\nconst LOCALCARTNAME: string = \"cart\";\r\nclass CartLocal extends CartStore {\r\n\r\n    private cartData: any[] = [];\r\n\r\n    get isLocal(): boolean { return true }\r\n\r\n    async load(): Promise<CartItem2[]> {\r\n        try {\r\n            let productTuid = this.cApp.uqs.product.ProductX;\r\n            let packTuid = productTuid.div('packx');\r\n            let cartstring = localStorage.getItem(LOCALCARTNAME);\r\n            if (cartstring === null) return [];\r\n            this.cartData = JSON.parse(cartstring);\r\n            let cartDataBoxed = [];\r\n            for (let i = 0; i < this.cartData.length; i++) {\r\n                let { product, pack, quantity, price, currency } = this.cartData[i];\r\n                let productbox = productTuid.boxId(product);\r\n                let packbox = packTuid.boxId(pack);\r\n                cartDataBoxed.push({\r\n                    product: productbox,\r\n                    pack: packbox,\r\n                    quantity: quantity,\r\n                    price: price,\r\n                    currency: currency\r\n                } as any)\r\n            }\r\n            return cartDataBoxed;\r\n        }\r\n        catch {\r\n            localStorage.removeItem(LOCALCARTNAME);\r\n            this.cartData = [];\r\n            return this.cartData;\r\n        }\r\n    }\r\n\r\n    async storeCart(product: BoxId, pack: BoxId, quantity: number, price: number, currency: any) {\r\n        let cartItemExists = this.cartData.find(e => e.product === product.id && e.pack === pack.id);\r\n        if (cartItemExists !== undefined) {\r\n            cartItemExists.quantity = quantity;\r\n            cartItemExists.price = price;\r\n            cartItemExists.currency = currency && currency.id;\r\n        } else\r\n            this.cartData.push({ product: product.id, pack: pack.id, quantity: quantity, price: price, currency: currency && currency.id });\r\n        localStorage.setItem(LOCALCARTNAME, JSON.stringify(this.cartData));\r\n    }\r\n\r\n    async removeFromCart(rows: [{ productId: number, packId: number }]) {\r\n\r\n        rows.forEach(e => {\r\n            let i = this.cartData.findIndex(v => v.product = e.productId && v.pack === e.packId);\r\n            if (i >= 0)\r\n                this.cartData.splice(i, 1);\r\n        })\r\n        localStorage.setItem(LOCALCARTNAME, JSON.stringify(this.cartData));\r\n    }\r\n}","import { User, loadAppUqs } from 'tonva';\r\nimport { Map, BoxId, CUq, Tuid } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\nimport { UQs } from './uqs';\r\n\r\nexport class WebUser {\r\n\r\n    id: number;\r\n    name: string;\r\n    nick?: string;\r\n    icon?: string;\r\n    guest: number;\r\n    token: string;\r\n\r\n    @observable firstName: string;\r\n    gender: string;\r\n    salutation: string;\r\n    @observable organizationName: string;\r\n    departmentName: string;\r\n\r\n    get defaultOrganizationName(): string {\r\n        return this.organizationName ||\r\n            (this.webUserSettings &&\r\n                ((\r\n                    (this.webUserSettings.invoiceInfo && this.webUserSettings.invoiceInfo.obj['title'])\r\n                    || this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['organizationName'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['organizationName'])\r\n                )\r\n            );\r\n    }\r\n\r\n    get defaultName(): string {\r\n        return this.firstName ||\r\n            (this.webUserSettings &&\r\n                ((\r\n                    this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['name'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['name'])\r\n                )\r\n            );\r\n    }\r\n\r\n    get defaultMobile(): string {\r\n        return this.mobile ||\r\n            (this.webUserSettings &&\r\n                ((\r\n                    this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['mobile'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['mobile'])\r\n                )\r\n            );\r\n    }\r\n\r\n    telephone: string;\r\n    @observable mobile: string;\r\n    email: string;\r\n    fax: string;\r\n    address: BoxId;\r\n    addressString: string;\r\n    zipCode: string;\r\n    @computed get allowOrdering() {\r\n        return this.currentCustomer !== undefined ||\r\n            (this.mobile && this.firstName && this.organizationName);\r\n    }\r\n\r\n    private _user: User;\r\n\r\n    private webUserSettings: any;\r\n\r\n    private uqs: UQs;\r\n\r\n\r\n    constructor(uqs: UQs) {// cUsqWebUser: CUq, cUsqCustomer: CUq) {\r\n        this.uqs = uqs;\r\n    }\r\n\r\n    setUser = async (user: User) => {\r\n        if (user !== undefined) {\r\n            this._user = user;\r\n            this.id = user.id;\r\n            this.name = user.name;\r\n            this.nick = user.nick;\r\n            this.icon = user.icon;\r\n            this.guest = user.guest;\r\n            this.token = user.token;\r\n\r\n            await this.loadWebUser();\r\n        }\r\n    }\r\n\r\n    private async loadWebUser() {\r\n        let { id, _user } = this;\r\n        if (this._user !== undefined) {\r\n            let webUser = await this.uqs.webuser.WebUser.load(this.id);\r\n            if (webUser) {\r\n                let { firstName, gender, salutation, organizationName, departmentName } = webUser;\r\n                this.firstName = firstName;\r\n                this.gender = gender;\r\n                this.salutation = salutation;\r\n                this.organizationName = organizationName;\r\n                this.departmentName = departmentName;\r\n            }\r\n            let contact = await this.uqs.webuser.WebUserContact.obj({ \"webUser\": id });\r\n            if (contact) {\r\n                let { telephone, mobile, email, fax, address, addressString, zipCode } = contact;\r\n                this.telephone = telephone;\r\n                this.mobile = mobile;\r\n                this.email = email;\r\n                this.fax = fax;\r\n                this.address = address;\r\n                this.addressString = addressString;\r\n                this.zipCode = zipCode;\r\n            }\r\n            this.webUserSettings = await this.uqs.webuser.WebUserSetting.obj({ webUser: id }) || { webUser: id };\r\n            let value = await this.uqs.webuser.WebUserCustomer.obj({ webUser: id });\r\n            if (value != undefined) {\r\n                this.currentCustomer = new Customer(value.customer, this.uqs);\r\n                await this.currentCustomer.init();\r\n            }\r\n        }\r\n    }\r\n\r\n    get isLogined(): boolean {\r\n        return this._user !== undefined;\r\n    }\r\n    get hasCustomer(): boolean {\r\n        return this.currentCustomer !== undefined;\r\n    }\r\n    currentCustomer: Customer;\r\n\r\n    async getContacts(): Promise<any[]> {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            return await this.currentCustomer.getContacts()\r\n        }\r\n        */\r\n        return await this.uqs.webuser.WebUserContacts.table({ webUser: this.id });\r\n    }\r\n\r\n    async addContact(contactId: number) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.addContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        await this.uqs.webuser.WebUserContacts.add({ webUser: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async addContactFromAccount() {\r\n        let { firstName, organizationName, mobile, telephone, email, address, addressString } = this;\r\n        if (firstName && organizationName && mobile && address && addressString) {\r\n            let newContact = await this.uqs.customer.Contact.save(undefined, {\r\n                name: firstName,\r\n                organizationName: organizationName,\r\n                mobile: mobile,\r\n                telephone: telephone,\r\n                email: email,\r\n                address: address,\r\n                addressString: addressString\r\n            })\r\n            if (newContact) {\r\n                let { id: newContactId } = newContact;\r\n                await this.addContact(newContactId);\r\n                let newContactBox = this.uqs.customer.Contact.boxId(newContactId);\r\n                this.setDefaultShippingContact(newContactBox);\r\n            }\r\n        }\r\n    }\r\n\r\n    async delContact(contactId: number) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.delContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        await this.uqs.webuser.WebUserContacts.del({ webUser: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async getSetting() {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            return this.currentCustomer.getSetting();\r\n        }\r\n        */\r\n        return this.webUserSettings;\r\n    }\r\n\r\n    async setDefaultShippingContact(contactId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultShippingContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        this.webUserSettings.shippingContact = contactId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoiceContact(contactId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultInvoiceContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        this.webUserSettings.invoiceContact = contactId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoice(invoiceTypeId: BoxId, invoiceInfoId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultInvoice(invoiceTypeId, invoiceInfoId);\r\n            return;\r\n        }\r\n        */\r\n        // await this.webUserSettingMap.add({ webUser: this.id, arr1: [{ invoiceType: invoiceTypeId, invoiceInfo: invoiceInfoId }] });\r\n        this.webUserSettings.invoiceType = invoiceTypeId;\r\n        this.webUserSettings.invoiceInfo = invoiceInfoId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async saveDefaultSettings() {\r\n        await this.uqs.webuser.WebUserSetting.add(this.webUserSettings);\r\n    }\r\n\r\n\r\n    async changeWebUser(webUser: any) {\r\n        await this.uqs.webuser.WebUser.save(this.id, webUser);\r\n        await this.loadWebUser();\r\n    }\r\n\r\n    async changeWebUserContact(webUserContact: any) {\r\n        webUserContact.webUser = this.id;\r\n        await this.uqs.webuser.WebUserContact.add(webUserContact);\r\n        await this.loadWebUser();\r\n    }\r\n};\r\n\r\nexport class Customer {\r\n    private readonly uqs: UQs;\r\n    id: number;\r\n\r\n    private customerSettings: any;\r\n\r\n    constructor(customer: BoxId, uqs: UQs) {\r\n        this.id = customer.id;\r\n        this.uqs = uqs;\r\n    };\r\n\r\n    async getContacts(): Promise<any[]> {\r\n        return await this.uqs.customer.CustomerContacts.table({ customer: this.id });\r\n    }\r\n\r\n    async addContact(contactId: number) {\r\n        await this.uqs.customer.CustomerContacts.add({ customer: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async delContact(contactId: number) {\r\n        await this.uqs.customer.CustomerContacts.del({ customer: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async init() {\r\n        this.customerSettings = await this.uqs.customer.CustomerSetting.obj({ customer: this.id }) || { customer: this.id };\r\n    }\r\n\r\n    getSetting() {\r\n        return this.customerSettings;\r\n    }\r\n\r\n    async setDefaultShippingContact(contactId: BoxId) {\r\n        this.customerSettings.shippingContact = contactId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoiceContact(contactId: BoxId) {\r\n        this.customerSettings.invoiceContact = contactId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoice(invoiceTypeId: BoxId, invoiceInfoId: BoxId) {\r\n        this.customerSettings.invoiceType = invoiceTypeId;\r\n        this.customerSettings.invoiceInfo = invoiceInfoId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultSettings() {\r\n        await this.uqs.customer.CustomerSetting.add(this.customerSettings);\r\n    }\r\n}","import { CSub, CBase } from \"tonva\";\r\nimport { UQs } from \"./uqs\";\r\nimport { CApp } from \"CApp\";\r\n\r\nexport abstract class CUqBase extends CBase {\r\n    get cApp(): CApp { return this._cApp; }\r\n    protected get uqs(): UQs { return this._uqs as UQs };\r\n}\r\n\r\nexport abstract class CUqSub extends CSub {\r\n    get cApp(): CApp { return this._cApp; }\r\n    protected get uqs(): UQs { return this._uqs as UQs };\r\n    protected get owner(): CUqBase { return this._owner as CUqBase; };\r\n}\r\n","import * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { CHome } from './CHome';\r\nimport { SearchBox } from 'tonva';\r\n\r\nexport class VSearchHeader extends View<CHome> {\r\n\r\n    private onSearch = async (key: string, param: 'home' | 'insearch' | 'productdetail') => {\r\n        let { cProduct, topKey } = this.controller.cApp;\r\n        if (param !== 'home') {\r\n            nav.popTo(topKey);\r\n        }\r\n\r\n        cProduct.start(key);\r\n    }\r\n\r\n    render(param: 'home' | 'insearch' | 'productdetail') {\r\n        let size: any = param === 'home' ? \"md\" : 'sm';\r\n        return <SearchBox className=\"w-100\"\r\n            size={size}\r\n            onSearch={(key: string) => this.onSearch(key, param)}\r\n            placeholder=\"CASMDL\" />\r\n    }\r\n}","import * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { LMR, FA, SearchBox } from 'tonva';\r\nimport logo from '../images/logo.png';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSiteHeader extends View<CHome> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{ height: \"3rem\", width: \"3rem\" }} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"px-3 py-4\">\r\n                {this.controller.renderSearchHeader('md')}\r\n            </div>\r\n        </LMR>\r\n        //<div className=\"h4 px-3 mb-0\"></div>\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page, View } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { CHome } from './CHome';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { observable } from 'mobx';\r\n\r\nexport class VHome extends View<CHome> {\r\n\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    render(param: any): JSX.Element {\r\n        return <this.content />\r\n    }\r\n\r\n    private page = observer(() => {\r\n        return <Page header={false}>\r\n            <this.content />\r\n        </Page>;\r\n    })\r\n\r\n    private content = observer(() => {\r\n        let { controller } = this;\r\n        let { renderCategoryRootList } = controller;\r\n        let siteHeader = this.renderVm(VSiteHeader);\r\n        return <>\r\n            {siteHeader}\r\n            {renderCategoryRootList()}\r\n        </>\r\n    });\r\n}","import { Tuid } from 'tonva';\r\n//import { CCartApp } from '../CCartApp';\r\nimport { PageItems, Controller } from 'tonva';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VSearchHeader } from './VSearchHeader';\r\nimport { VHome } from './VHome';\r\n\r\nclass HomeSections extends PageItems<any> {\r\n\r\n    private sectionTuid: Tuid;\r\n\r\n    constructor(sectionTuid: Tuid) {\r\n        super();\r\n        this.firstSize = this.pageSize = 13;\r\n        this.sectionTuid = sectionTuid;\r\n    }\r\n\r\n    protected async load(param: any, pageStart: any, pageSize: number): Promise<any[]> {\r\n        if (pageStart === undefined) pageStart = 0;\r\n        let ret = await this.sectionTuid.search(\"\", pageStart, pageSize);\r\n        return ret;\r\n    }\r\n\r\n    protected setPageStart(item: any): any {\r\n        if (item === undefined) return 0;\r\n        return item.id;\r\n    }\r\n}\r\n\r\nexport class CHome extends CUqBase {\r\n\r\n    //    cApp: CApp;\r\n    homeSections: HomeSections;\r\n    sectionTuid: Tuid;\r\n\r\n    async internalStart(param: any) {\r\n\r\n        let { cProductCategory } = this.cApp;\r\n        await cProductCategory.start();\r\n        this.openVPage(VHome);\r\n    }\r\n\r\n    renderSearchHeader = (size?: string) => {\r\n        return this.renderView(VSearchHeader, size);\r\n    }\r\n\r\n    renderCategoryRootList = () => {\r\n        let { cProductCategory } = this.cApp;\r\n        return cProductCategory.renderRootList();\r\n    }\r\n\r\n    tab = () => this.renderView(VHome);\r\n}","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { View } from 'tonva';\r\nimport { CCart } from './CCart';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VCartLabel extends View<CCart> {\r\n\r\n    private showCart = async () => {\r\n        this.controller.start();\r\n    }\r\n\r\n    render(param: any): JSX.Element {\r\n        return <this.content />\r\n    };\r\n\r\n    private content = observer(() => {\r\n        let { cart } = this.controller.cApp;\r\n        let count: any = cart.count.get();\r\n        let badge, onClick, pointer;\r\n        if (count > 0) {\r\n            onClick = this.showCart;\r\n            pointer = 'cursor-pointer';\r\n            if (count < 100) badge = <u>{count}</u>;\r\n            else badge = <u>99+</u>;\r\n        }\r\n        return <div className={classNames('jk-cart ml-1 mr-2', pointer)} onClick={onClick}>\r\n            <div>\r\n                <span className=\"fa-stack\">\r\n                    <i className=\"fa fa-square fa-stack-2x text-white\"></i>\r\n                    <i className=\"fa fa-shopping-cart fa-stack-1x text-info\"></i>\r\n                </span>\r\n                {badge}\r\n            </div>\r\n        </div>\r\n    });\r\n}","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { UpdownWidget } from 'tonva';\r\n\r\nconst keys = [107, 109, 110, 187, 189];\r\n\r\nexport class MinusPlusWidget extends UpdownWidget {\r\n    @observable protected value: any;\r\n    @observable protected disabled: boolean;\r\n    @observable protected hasFocus: boolean;\r\n\r\n    protected isValidKey(key: number): boolean {\r\n        if (keys.find(v => v === key) !== undefined) return false;\r\n        return super.isValidKey(key);\r\n    }\r\n\r\n    protected onBlur(evt: React.FocusEvent<any>) {\r\n        super.onBlur(evt);\r\n        this.hasFocus = false;\r\n    }\r\n\r\n    protected onFocus(evt: React.FocusEvent<any>) {\r\n        super.onFocus(evt);\r\n        this.hasFocus = true;\r\n    }\r\n\r\n    protected onChange(evt: React.ChangeEvent<any>) {\r\n    }\r\n\r\n    private minusClick = () => {\r\n        let v = this.getValue();\r\n        if (!v) v = 0;\r\n        this.setValue(v - 1);\r\n    }\r\n    private plusClick = () => {\r\n        let v = this.getValue();\r\n        if (!v) v = 0;\r\n        this.setValue(v + 1);\r\n    }\r\n\r\n    private ref = (input: HTMLInputElement) => {\r\n        this.input = input;\r\n        if (this.input === null) return;\r\n        let p: HTMLElement;\r\n        for (p = this.input; ; p = p.parentElement) {\r\n            if (!p) break;\r\n            if (p.tagName !== 'FIELDSET') continue;\r\n            if ((p as any)['disabled'] === true) {\r\n                this.disabled = true;\r\n            }\r\n            break;\r\n        }\r\n    }\r\n\r\n    private renderContent = observer((): JSX.Element => {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn: any = {\r\n            //'form-control': true,\r\n        };\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        let hasFocus = this.hasFocus; // document.hasFocus() && document.activeElement === this.input;\r\n        let hasAction = this.readOnly !== true && this.disabled !== true;\r\n        let hasValue = this.value !== NaN && this.value !== undefined && this.value > 0;\r\n        let cursorPointer: string,\r\n            minusColor: string, minusClick: any,\r\n            plusColor: string, plusClick: any;\r\n        if (this.disabled === true) {\r\n            cursorPointer = 'cursor-pointer';\r\n            minusColor = plusColor = 'text-light';\r\n        }\r\n        else {\r\n            minusClick = this.minusClick;\r\n            plusClick = this.plusClick;\r\n            minusColor = 'text-danger-2'; //'text-black-50';\r\n            plusColor = 'text-danger';\r\n        }\r\n        let minus = <i className={classNames('fa',\r\n            'fa-minus-circle', 'fa-lg', minusColor, cursorPointer,\r\n            { invisible: !(hasFocus === true || hasAction === true && hasValue === true) })}\r\n            onClick={minusClick} />;\r\n        let input = <input ref={this.ref}\r\n            className={classNames(this.className, cn, 'mx-1 w-4c form-control',\r\n                { invisible: !(hasFocus === true || hasValue === true) })}\r\n            type=\"text\"\r\n            defaultValue={this.value}\r\n            onChange={this.onChange}\r\n            placeholder={this.placeholder}\r\n            readOnly={this.readOnly}\r\n            disabled={this.disabled}\r\n            onKeyDown={this.onKeyDown}\r\n            onFocus={(evt: React.FocusEvent<any>) => this.onFocus(evt)}\r\n            onBlur={(evt: React.FocusEvent<any>) => this.onBlur(evt)}\r\n            maxLength={10} />;\r\n\r\n        let plus = <i className={classNames('fa fa-plus-circle fa-lg',\r\n            plusColor, cursorPointer,\r\n            { invisible: !(hasAction === true) })}\r\n            onClick={plusClick} />;\r\n        return <div className=\"d-flex align-items-center\">{minus}{input}{plus}\r\n            {this.renderErrors()}\r\n        </div>;\r\n    });\r\n\r\n    render() {\r\n        return <this.renderContent />;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, Form, ObjectSchema, NumSchema, ArrSchema, UiSchema, UiArr, FormField } from 'tonva';\r\nimport { FA } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { MinusPlusWidget } from '../tools';\r\nimport { CCart } from './CCart';\r\nimport { CartPackRow, CartItem2 } from './Cart';\r\n\r\nconst cartSchema = [\r\n    {\r\n        name: 'list',\r\n        type: 'arr',\r\n        arr: [\r\n            { name: 'checked', type: 'boolean' },\r\n            { name: 'product', type: 'object' } as ObjectSchema,\r\n            {\r\n                name: 'packs', type: 'arr', arr: [\r\n                    { name: 'pack', type: 'object' } as ObjectSchema,\r\n                    { name: 'price', type: 'number' } as NumSchema,\r\n                    { name: 'quantity', type: 'number' } as NumSchema,\r\n                    { name: 'currency', type: 'object' } as ObjectSchema\r\n                ]\r\n            }\r\n        ],\r\n    } as ArrSchema\r\n];\r\n\r\nexport class VCart extends VPage<CCart> {\r\n    async open() {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    protected CheckOutButton = observer(() => {\r\n        let { checkOut, cApp } = this.controller;\r\n        let { cart } = cApp;\r\n        let amount = cart.amount.get();\r\n        let check = \"\";\r\n        let content = amount > 0 ?\r\n            <>{check} ({amount})</> :\r\n            <>{check}</>;\r\n        return <button className=\"btn btn-success w-100\" type=\"button\" onClick={checkOut} disabled={amount <= 0}>\r\n            {content}\r\n        </button>;\r\n    });\r\n\r\n    render(params: any): JSX.Element {\r\n        return <this.tab />;\r\n    }\r\n\r\n    private renderCartItem = (item: CartItem2) => {\r\n        let { product } = item;\r\n        let { controller } = this;\r\n        let { onProductClick, renderCartProduct } = controller;\r\n        return <div className=\"pr-1\">\r\n            <div className=\"row\">\r\n                <div className=\"col-lg-6 pb-3\" onClick={() => onProductClick(product)}>\r\n                    {renderCartProduct(product)}\r\n                </div>\r\n                <div className=\"col-lg-6\"><FormField name=\"packs\" /></div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private packsRow = (item: CartPackRow) => {\r\n        let { pack, price, currency } = item;\r\n\r\n        return <div className=\"px-2\">\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-6c mr-4 text-right\"><span className=\"text-danger h5\">{price}</span></div>\r\n                <FormField name=\"quantity\" />\r\n            </div>\r\n            <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n        </div>;\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        selectable: true,\r\n        deletable: true,\r\n        restorable: true,\r\n        items: {\r\n            list: {\r\n                widget: 'arr',\r\n                Templet: this.renderCartItem,\r\n                ArrContainer: (label: any, content: JSX.Element) => content,\r\n                RowContainer: (content: JSX.Element) => <div className=\"py-3\">{content}</div>,\r\n                items: {\r\n                    packs: {\r\n                        widget: 'arr',\r\n                        Templet: this.packsRow,\r\n                        selectable: false,\r\n                        deletable: false,\r\n                        ArrContainer: (label: any, content: JSX.Element) => content,\r\n                        RowContainer: (content: JSX.Element) => content,\r\n                        RowSeperator: <div className=\"border border-gray border-top my-3\" />,\r\n                        items: {\r\n                            quantity: {\r\n                                widget: 'custom',\r\n                                className: 'text-center',\r\n                                WidgetClass: MinusPlusWidget,\r\n                                onChanged: this.controller.onQuantityChanged as any\r\n                            }\r\n                        },\r\n                    } as UiArr\r\n                }\r\n            } as UiArr\r\n        }\r\n    }\r\n\r\n    protected cartForm = observer(() => {\r\n        let { cart } = this.controller.cApp;\r\n        let { data: cartData } = cart;\r\n        return <Form className=\"bg-white flex-fill overflow-auto\" schema={cartSchema} uiSchema={this.uiSchema} formData={cartData} />\r\n    });\r\n\r\n    private empty() {\r\n        return <div className=\"py-5 text-center bg-white\"></div>\r\n    }\r\n\r\n    private page = observer((params: any): JSX.Element => {\r\n        let { cart } = this.controller.cApp;\r\n        let footer: any, content: any;\r\n        if (cart.count.get() === 0 && cart.cartItems.length === 0) {\r\n            content = this.empty();\r\n            footer = undefined;\r\n        }\r\n        else {\r\n            content = <this.cartForm />;\r\n            footer = <this.CheckOutButton />;\r\n        }\r\n        return <Page header=\"\" footer={footer}>\r\n            {content}\r\n        </Page>;\r\n    })\r\n\r\n    private tab = observer(() => {\r\n        let { cart } = this.controller.cApp;\r\n        let header = <header className=\"py-2 text-center bg-info text-white\">\r\n            <FA className=\"align-middle\" name=\"shopping-cart\" size=\"2x\" /> &nbsp; <span className=\"h5 align-middle\"></span>\r\n        </header>;\r\n        if (cart.count.get() === 0 && cart.cartItems.length === 0) {\r\n            return <>\r\n                {header}\r\n                {this.empty()}\r\n            </>;\r\n        }\r\n        return <div className=\"bg-white d-flex flex-column h-100\">\r\n            {header}\r\n            <this.cartForm />\r\n            <footer className=\"p-3\"><this.CheckOutButton /></footer>\r\n        </div>\r\n    });\r\n}","import { RowContext, nav, User, BoxId } from 'tonva';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VCartLabel } from './VCartLabel';\r\nimport { VCart } from './VCart';\r\nimport { CartPackRow, CartItem2 } from './Cart';\r\n\r\nexport class CCart extends CUqBase {\r\n\r\n    //    cApp: CApp;\r\n    private selectedCartItems: CartItem2[];\r\n\r\n    protected async internalStart(param: any) {\r\n        this.openVPage(VCart);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * \r\n     */\r\n    renderCartLabel() {\r\n        return this.renderView(VCartLabel);\r\n    }\r\n\r\n    onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data, parentData } = context;\r\n        let { product } = parentData;\r\n        let { pack, price, currency } = data as CartPackRow;\r\n        let { cart } = this.cApp;\r\n        if (value > 0)\r\n            await cart.add(product, pack, value, price, currency);\r\n        else\r\n            await cart.removeFromCart([{ productId: product.id, packId: pack.id }]);\r\n    }\r\n\r\n    onRowStateChanged = async (context: RowContext, selected: boolean, deleted: boolean) => {\r\n        alert('onRowStateChanged')\r\n    }\r\n\r\n    private loginCallback = async (user: User): Promise<void> => {\r\n        let { cApp } = this;\r\n        await cApp.currentUser.setUser(user);\r\n        await cApp.loginCallBack(user);\r\n        this.closePage(1);\r\n        await this.doFirstOrderChecking();\r\n    };\r\n\r\n    onProductClick = (product: BoxId) => {\r\n        let { cart, cProduct } = this.cApp;\r\n        if (!cart.isDeleted(product.id)) {\r\n            cProduct.showProductDetail(product);\r\n        }\r\n    }\r\n\r\n    checkOut = async () => {\r\n        let { cart } = this.cApp;\r\n        this.selectedCartItems = cart.getSelectedItems();\r\n        if (this.selectedCartItems === undefined) return;\r\n        if (!this.isLogined) {\r\n            nav.showLogin(this.loginCallback, true);\r\n        } else {\r\n            this.doFirstOrderChecking();\r\n        }\r\n    }\r\n\r\n    private doFirstOrderChecking = async () => {\r\n        let { cMe, currentUser } = this.cApp;\r\n        if (!currentUser.allowOrdering) {\r\n            cMe.openMeInfoFirstOrder();\r\n        } else {\r\n            await this.doCheckOut();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * CheckOut\r\n     */\r\n    doCheckOut = async () => {\r\n\r\n        let { cOrder } = this.cApp;\r\n        if (this.selectedCartItems === undefined) return;\r\n        await cOrder.start(this.selectedCartItems);\r\n    }\r\n\r\n    tab = () => this.renderView(VCart);\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderDeliveryTime(pack);\r\n    }\r\n\r\n    renderCartProduct = (product: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderCartProduct(product);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Image } from 'tonva';\r\n\r\nconst imagePath = \"https://www.jkchemical.com/static/Structure/\";\r\nconst altimagePath = \"https://www.jkchemical.com/static/Structure/999.png\";\r\n\r\ninterface ProductImageProps {\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    chemicalId: string;\r\n}\r\n\r\nexport function ProductImage(props: ProductImageProps) {\r\n\r\n    let { style, className, chemicalId } = props;\r\n    return <Image src={chemicalId && (imagePath + chemicalId.substr(0, 3) + '/' + chemicalId + '.png')}\r\n        style={style} className={className} altImage={altimagePath} />;\r\n}\r\n","import * as React from 'react';\r\nimport { CProduct, renderBrand, productPropItem } from './CProduct';\r\nimport {\r\n    VPage, Page, Form, ItemSchema, NumSchema, UiSchema, Field,\r\n    ObjectSchema, RowContext, UiCustom, FormField, BoxId\r\n} from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { MinusPlusWidget } from '../tools/minusPlusWidget';\r\nimport { ProductPackRow } from './Product';\r\nimport { ViewMainSubs, MainProductChemical } from 'mainSubs';\r\nimport { ProductImage } from 'tools/productImage';\r\n\r\nconst schema: ItemSchema[] = [\r\n    { name: 'pack', type: 'object' } as ObjectSchema,\r\n    { name: 'retail', type: 'number' } as NumSchema,\r\n    { name: 'vipPrice', type: 'number' } as NumSchema,\r\n    { name: 'promotionPrice', type: 'number' } as NumSchema,\r\n    { name: 'currency', type: 'string' },\r\n    { name: 'quantity', type: 'number' } as NumSchema,\r\n    { name: 'inventoryAllocation', type: 'object' } as ObjectSchema,\r\n    { name: 'futureDeliveryTimeDescription', type: 'string' }\r\n];\r\n\r\nexport class VProduct extends VPage<CProduct> {\r\n    private productBox: BoxId;\r\n\r\n    async open(param: any) {\r\n        let { productData, product } = param;\r\n        this.productBox = product;\r\n        this.openPage(this.page, productData);\r\n    }\r\n\r\n    private renderProduct = (product: MainProductChemical) => {\r\n\r\n        let { brand, description, descriptionC, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl } = product;\r\n        return <div className=\"mb-3 px-2\">\r\n            <div className=\"py-2\"><strong>{description}</strong></div>\r\n            <div>{descriptionC}</div>\r\n            <div className=\"row mt-3\">\r\n                <div className=\"col-12 col-sm-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-12 col-sm-9\">\r\n                    <div className=\"row mx-3\">\r\n                        {productPropItem('CAS', CAS, \"font-weight-bold\")}\r\n                        {productPropItem('', origin, \"font-weight-bold\")}\r\n                        {productPropItem('', purity)}\r\n                        {productPropItem('', molecularFomula)}\r\n                        {productPropItem('', molecularWeight)}\r\n                        {renderBrand(brand)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    private arrTemplet = (item: ProductPackRow) => {\r\n        let { pack, retail, vipPrice, promotionPrice } = item;\r\n        let right = null;\r\n        if (retail) {\r\n            let price: number = this.minPrice(vipPrice, promotionPrice);\r\n            let retailUI: any;\r\n            if (price) {\r\n                retailUI = <small className=\"text-muted\"><del>{retail}</del></small>;\r\n            }\r\n            else {\r\n                price = retail;\r\n            }\r\n            right = <div className=\"row\">\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                    <small className=\"text-muted\">{retailUI}</small>&nbsp; &nbsp;\r\n                    <span className=\"text-danger\"> <span className=\"h5\">{price}</span></span>\r\n                </div>\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\"><FormField name=\"quantity\" /></div>\r\n            </div >\r\n        } else {\r\n            right = <small></small>\r\n        }\r\n\r\n        return <div className=\"px-2\">\r\n            <div className=\"row\">\r\n                <div className=\"col-6\">\r\n                    <div><b>{tv(pack)}</b></div>\r\n                    <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n                </div>\r\n                <div className=\"col-6\">\r\n                    {right}\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data } = context;\r\n        let { pack, retail, vipPrice, promotionPrice, currency } = data;\r\n        let price = this.minPrice(vipPrice, promotionPrice) || retail;\r\n        let { cApp } = this.controller;\r\n        let { cart } = cApp;\r\n        if (value > 0)\r\n            await cart.add(this.productBox, pack, value, price, currency);\r\n        else\r\n            await cart.removeFromCart([{ productId: this.productBox.id, packId: pack.id }]);\r\n    }\r\n\r\n    private minPrice(vipPrice: any, promotionPrice: any) {\r\n        if (vipPrice || promotionPrice)\r\n            return Math.min(typeof (vipPrice) === 'number' ? vipPrice : Infinity, typeof (promotionPrice) === 'number' ? promotionPrice : Infinity);\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        Templet: this.arrTemplet,\r\n        items: {\r\n            quantity: {\r\n                widget: 'custom',\r\n                className: 'text-center',\r\n                WidgetClass: MinusPlusWidget as any,\r\n                onChanged: this.onQuantityChanged\r\n            } as UiCustom\r\n        },\r\n    };\r\n\r\n    private renderPack = (pack: ProductPackRow) => {\r\n        return <>\r\n            <div className=\"sep-product-select\" />\r\n            <Form className=\"mx-3\" schema={schema} uiSchema={this.uiSchema} formData={pack} />\r\n        </>;\r\n    }\r\n\r\n    private page = observer((product: any) => {\r\n\r\n        let { cApp } = this.controller;\r\n        let header = cApp.cHome.renderSearchHeader();\r\n        let cartLabel = cApp.cCart.renderCartLabel();\r\n        let viewProduct = new ViewMainSubs<MainProductChemical, ProductPackRow>(this.renderProduct, this.renderPack);\r\n        viewProduct.model = product;\r\n\r\n        return <Page header={header} right={cartLabel}>\r\n            <div className=\"px-2 py-2 bg-white mb-3\">{viewProduct.render()}</div>\r\n        </Page>\r\n\r\n        /*\r\n        observerobservablerender\r\n        ReactReacthtmlDB\r\n        let { controller, productBox } = this;\r\n        let { renderChemicalInfo, renderProductPrice } = controller;\r\n        return <Page header={header} right={cartLabel}>\r\n            {tv(productBox, (value: any) => {\r\n                let { id, brand, description, descriptionC, origin, imageUrl, packx } = value;\r\n                return <div className=\"p-2 bg-white mb-3\">\r\n                    <div className=\"mb-3 px-2\">\r\n                        <div className=\"py-2\"><strong>{description}</strong></div>\r\n                        <div>{descriptionC}</div>\r\n                        <div className=\"row mt-3\">\r\n                            <div className=\"col-12 col-sm-3\">\r\n                                <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                            </div>\r\n                            <div className=\"col-12 col-sm-9\">\r\n                                <div className=\"row mx-3\">\r\n                                    {productPropItem('', origin, \"font-weight-bold\")}\r\n                                    {renderChemicalInfo(productBox)}\r\n                                    {tv(brand, renderBrand)}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        {renderProductPrice(productBox)}\r\n                    </div>\r\n                </div>\r\n            })}\r\n        </Page>\r\n        */\r\n    })\r\n}","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { CProduct, renderProduct } from './CProduct';\r\nimport { List } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\n//import { cCartApp } from 'ui/CCartApp';\r\n\r\nexport class VProductList extends VPage<CProduct> {\r\n\r\n    private searchKey: string;\r\n    async open(key: string) {\r\n        this.searchKey = key;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onProductClick = async (product: any) => {\r\n        this.controller.showProductDetail(product.id);\r\n    }\r\n\r\n    private onScrollBottom = async () => {\r\n\r\n        await this.controller.pageProducts.more();\r\n    }\r\n\r\n    private page = observer(() => {\r\n\r\n        let { pageProducts, cApp } = this.controller;\r\n        let { cHome, cCart } = cApp;\r\n        let header = cHome.renderSearchHeader();\r\n        let cart = cCart.renderCartLabel();\r\n        let none = <div className=\"my-3 mx-2 text-warning\"></div>\r\n        return <Page header={header} right={cart} onScrollBottom={this.onScrollBottom}>\r\n            <div className=\"bg-white p-2 mb-1\">: <strong>{this.searchKey}</strong></div>\r\n            <List before={''} none={none} items={pageProducts} item={{ render: renderProduct, onClick: this.onProductClick }} />\r\n        </Page>\r\n    });\r\n}","import { Entity } from 'tonva';\r\nimport { CApp } from '../CApp';\r\n//import { CCartApp } from 'CCartApp';\r\n\r\nexport abstract class Loader<T> {\r\n    protected cApp: CApp;\r\n    private entities: Entity[] = [];\r\n    private schemaLoaded: boolean = false;\r\n    constructor(cApp: CApp) {\r\n        this.cApp = cApp;\r\n        //this.initEntities();\r\n    }\r\n\r\n    //protected abstract initEntities(): void;\r\n\r\n    protected async loadSchemas() {\r\n        if (this.schemaLoaded === true) return;\r\n        await Promise.all(this.entities);\r\n        this.schemaLoaded = true;\r\n    }\r\n\r\n    async load(param: any): Promise<T> {\r\n        await this.loadSchemas();\r\n        let data = this.initData();\r\n        await this.loadToData(param, data);\r\n        return data;\r\n    }\r\n    protected abstract async loadToData(param: any, data: T): Promise<void>;\r\n    protected abstract initData(): T;\r\n}\r\n","import { Loader } from '../mainSubs/loader';\r\n\r\nexport class LoaderProductChemical extends Loader<any> {\r\n    protected async loadToData(productId: number, data: any): Promise<void> {\r\n\r\n        let productChemical = await this.cApp.uqs.product.ProductChemical.obj({ product: productId });\r\n        if (productChemical) {\r\n            let { chemical, purity, CAS, molecularFomula, molecularWeight } = productChemical;\r\n            data.chemical = chemical;\r\n            data.purity = purity;\r\n            data.CAS = CAS;\r\n            data.molecularFomula = molecularFomula;\r\n            data.molecularWeight = molecularWeight;\r\n        }\r\n    }\r\n\r\n    protected initData(): any {\r\n        return {};\r\n    }\r\n}","import _ from 'lodash';\r\nimport { ProductPackRow } from './Product';\r\nimport { Loader } from '../mainSubs/loader';\r\nimport { MainSubs, MainProductChemical, MainBrand } from '../mainSubs';\r\nimport { LoaderProductChemical } from '../tools/productChemical';\r\n\r\nexport class LoaderBrand extends Loader<MainBrand> {\r\n    protected async loadToData(brandId: number, data: MainBrand): Promise<void> {\r\n        let brand = await this.cApp.uqs.product.Brand.load(brandId);\r\n        data.id = brand.id;\r\n        data.name = brand.name;\r\n    }\r\n\r\n    protected initData(): MainBrand {\r\n        return {} as MainBrand;\r\n    }\r\n}\r\n\r\nexport class LoaderProductWithChemical extends Loader<MainProductChemical> {\r\n\r\n    protected async loadToData(productId: number, data: MainProductChemical): Promise<void> {\r\n\r\n        let product = await this.cApp.uqs.product.ProductX.load(productId);\r\n        if (product === undefined)\r\n            return;\r\n        _.merge(data, product);\r\n\r\n        let brandLoader = new LoaderBrand(this.cApp);\r\n        data.brand = await brandLoader.load(data.brand.id);\r\n\r\n        let productChemicalLoader = new LoaderProductChemical(this.cApp);\r\n        let productChemical: any = await productChemicalLoader.load(productId);\r\n        if (productChemical) {\r\n            let { chemical, purity, CAS, molecularFomula, molecularWeight } = productChemical;\r\n            data.chemical = chemical;\r\n            data.purity = purity;\r\n            data.CAS = CAS;\r\n            data.molecularFomula = molecularFomula;\r\n            data.molecularWeight = molecularWeight;\r\n        }\r\n\r\n        data.packs = [];\r\n        product.packx.forEach((e: any) => {\r\n            data.packs.push(e);\r\n        });\r\n    }\r\n\r\n    protected initData(): MainProductChemical {\r\n        return {} as MainProductChemical;\r\n    }\r\n}\r\n\r\nexport class LoaderProductChemicalWithPrices extends Loader<MainSubs<MainProductChemical, ProductPackRow>> {\r\n\r\n    protected initData(): MainSubs<MainProductChemical, ProductPackRow> {\r\n        return { main: {} as MainProductChemical, subs: [] as ProductPackRow[] };\r\n    }\r\n\r\n    protected async loadToData(productId: any, data: MainSubs<MainProductChemical, ProductPackRow>): Promise<void> {\r\n        let { customerDiscount, product, promotion } = this.cApp.uqs;\r\n        let productLoader = new LoaderProductWithChemical(this.cApp);\r\n        data.main = await productLoader.load(productId);\r\n\r\n        let discount = 0;\r\n        let { currentUser, currentSalesRegion, cart, currentLanguage } = this.cApp;\r\n        if (currentUser.hasCustomer) {\r\n            let discountSetting = await customerDiscount.GetDiscount.obj({ brand: data.main.brand.id, customer: currentUser.currentCustomer });\r\n            discount = discountSetting && discountSetting.discount;\r\n        }\r\n\r\n        let { id: currentSalesRegionId } = currentSalesRegion;\r\n        let prices = await product.PriceX.table({ product: productId, salesRegion: currentSalesRegionId });\r\n        data.subs = prices.filter(e => e.discountinued === 0 && e.expireDate > Date.now()).sort((a, b) => a.retail - b.retail).map(element => {\r\n            let ret: any = {};\r\n            ret.pack = element.pack;\r\n            ret.retail = element.retail;\r\n            if (discount !== 0)\r\n                ret.vipPrice = Math.round(element.retail * (1 - discount));\r\n            ret.currency = currentSalesRegion.currency;\r\n            ret.quantity = cart.getQuantity(productId, element.pack.id)\r\n            return ret;\r\n        });\r\n\r\n        let promises: PromiseLike<any>[] = [];\r\n        data.subs.forEach(v => {\r\n            promises.push(promotion.GetPromotionPack.obj({ product: productId, pack: v.pack, salesRegion: currentSalesRegion, language: currentLanguage }));\r\n        })\r\n        let results = await Promise.all(promises);\r\n\r\n        for (let i = 0; i < data.subs.length; i++) {\r\n            let promotion = results[i];\r\n            let discount = promotion && promotion.discount;\r\n            if (discount)\r\n                data.subs[i].promotionPrice = Math.round((1 - discount) * data.subs[i].retail);\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { tv, View } from 'tonva';\r\nimport { CProduct } from './CProduct';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\n\r\nexport class VProductDelivery extends View<CProduct> {\r\n\r\n    @observable private inventoryAllocation: any[];\r\n    @observable private futureDeliveryTimeDescription: string;\r\n\r\n    render(param: any): JSX.Element {\r\n        let { obj: packObj, id: packId } = param;\r\n        let { owner: productId } = packObj;\r\n        let { controller } = this;\r\n        let { currentSalesRegion } = controller.cApp;\r\n        return <this.content packId={packId} productId={productId} currentSalesRegion={currentSalesRegion} />;\r\n    }\r\n\r\n    private initInventoryAllocation = async (productId: number, packId: number, salesRegionId: number) => {\r\n        if (this.inventoryAllocation === undefined)\r\n            this.inventoryAllocation = await this.controller.getInventoryAllocation(productId, packId, salesRegionId);\r\n    }\r\n\r\n    private initFutureDeliveryTimeDescription = async (productId: number, salesRegionId: number) => {\r\n        if (this.futureDeliveryTimeDescription === undefined)\r\n            this.futureDeliveryTimeDescription = await this.controller.getFutureDeliveryTimeDescription(productId, salesRegionId);\r\n    }\r\n\r\n    private content = observer((param: any): any => {\r\n\r\n        let deliveryTimeUI;\r\n        let { packId, productId, currentSalesRegion } = param;\r\n        this.initInventoryAllocation(productId, packId, currentSalesRegion);\r\n        this.initFutureDeliveryTimeDescription(productId, currentSalesRegion);\r\n        if (this.inventoryAllocation === undefined || this.futureDeliveryTimeDescription === undefined)\r\n            return null;\r\n        if (this.inventoryAllocation && this.inventoryAllocation.length > 0) {\r\n            deliveryTimeUI = this.inventoryAllocation.map((v, index) => {\r\n                let { warehouse, quantity, deliveryTimeDescription } = v;\r\n                if (quantity > 0) {\r\n                    return <div key={index} className=\"text-success\">\r\n                        {tv(warehouse, (values: any) => <span className=\"small\">{values.name}</span>)}: {(quantity > 10 ? '>10' : quantity)}\r\n                        {deliveryTimeDescription}\r\n                    </div>\r\n                } else {\r\n                    return undefined;\r\n                }\r\n            });\r\n        } else {\r\n            deliveryTimeUI = <div>{this.futureDeliveryTimeDescription && ': ' + this.futureDeliveryTimeDescription}</div>;\r\n        }\r\n        return deliveryTimeUI;\r\n    })\r\n}","import * as React from 'react';\r\nimport { View, tv, FormField, ObjectSchema, NumSchema, UiSchema, UiCustom, RowContext, BoxId, Form } from 'tonva';\r\nimport { CProduct, productPropItem, renderBrand } from './CProduct';\r\nimport { ProductImage } from 'tools/productImage';\r\nimport { observer } from 'mobx-react';\r\nimport { MinusPlusWidget } from 'tools';\r\nimport { observable } from 'mobx';\r\n\r\nexport class VCartProuductView extends View<CProduct> {\r\n\r\n    render(param: any): JSX.Element {\r\n        return <>{tv(param, this.renderCartProduct)}</>;\r\n    }\r\n\r\n\r\n    private renderCartProduct = (product: any) => {\r\n        let { id, brand, description, descriptionC, origin, imageUrl } = product;\r\n\r\n        return <div className=\"row d-flex mb-3 px-2\">\r\n            <div className=\"col-12\">\r\n                <div className=\"py-2\">\r\n                    <strong>{description}</strong>\r\n                </div>\r\n                <div className=\"pb-2\">\r\n                    <strong>{descriptionC}</strong>\r\n                </div>\r\n                <div className=\"row\">\r\n                    <div className=\"col-3\">\r\n                        <ProductImage chemicalId={imageUrl} className=\"w-4c h-4c\" />\r\n                    </div>\r\n                    <div className=\"col-9\">\r\n                        <div className=\"row\">\r\n                            {this.controller.renderChemicalInfo(product)}\r\n                            {productPropItem('', origin)}\r\n                            {tv(brand, renderBrand)}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    };\r\n}\r\n\r\n\r\nexport class VProuductView extends View<CProduct> {\r\n\r\n    render(param: any): JSX.Element {\r\n        return <>{tv(param, this.renderProduct)}</>;\r\n    }\r\n\r\n    private renderProduct = (product: any) => {\r\n        let { brand, description, descriptionC, origin, imageUrl } = product;\r\n        return <div className=\"d-block mb-4 px-3\">\r\n            <div className=\"py-2\">\r\n                <div><strong>{description}</strong></div>\r\n                <div>{descriptionC}</div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-9\">\r\n                    <div className=\"row\">\r\n                        {productPropItem('', origin)}\r\n                        {tv(brand, renderBrand)}\r\n                        {this.controller.renderChemicalInfo(product)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n\r\nexport class VProductPrice extends View<CProduct> {\r\n\r\n    private schema = [\r\n        { name: 'pack', type: 'object' } as ObjectSchema,\r\n        { name: 'quantity', type: 'number' } as NumSchema,\r\n    ];\r\n\r\n    private onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data } = context;\r\n        let { pack, retail, vipPrice, promotionPrice, currency } = data;\r\n        let price = 0; //this.minPrice(vipPrice, promotionPrice) || retail;\r\n        let { cApp } = this.controller;\r\n        let { cart } = cApp;\r\n        if (value > 0)\r\n            await cart.add(this.product, pack, value, price, currency);\r\n        else\r\n            await cart.removeFromCart([{ productId: this.product.id, packId: pack.id }]);\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            pack: { visible: false },\r\n            quantity: {\r\n                widget: 'custom',\r\n                label: null,\r\n                className: 'text-center',\r\n                WidgetClass: MinusPlusWidget,\r\n                onChanged: this.onQuantityChanged as any\r\n            } as UiCustom\r\n        }\r\n    }\r\n\r\n    @observable private prices: any;\r\n    private initPrices = async (productId: number, salesRegionId: number) => {\r\n        if (this.prices === undefined)\r\n            this.prices = this.controller.getProductPrice(productId, salesRegionId);\r\n    }\r\n\r\n    private product: BoxId;\r\n    render(param: any): JSX.Element {\r\n        this.product = param;\r\n        let productId = param.id;\r\n        let { currentSalesRegion } = this.controller.cApp;\r\n        this.controller.getProductPrice(productId, currentSalesRegion);\r\n        return <this.content productId={productId} SalesRegionId={currentSalesRegion} />;\r\n    }\r\n\r\n    private content = observer((param?: any) => {\r\n        let priceUI;\r\n        let { productId, SalesRegionId } = param;\r\n\r\n        let { renderDeliveryTime } = this.controller;\r\n        // let prices = productPriceContainer[productSalesRegion];\r\n        this.initPrices(productId, SalesRegionId);\r\n        if (this.prices && this.prices.length > 0) {\r\n            priceUI = this.prices.filter((e: any) => e.discountinued === 0 && e.expireDate > Date.now()).map((v: any, index: number) => {\r\n                let { pack, retail } = v;\r\n                if (retail) {\r\n                    return <div className=\"px-2\" key={pack.id}>\r\n                        <div className=\"row\">\r\n                            <div className=\"col-6\">\r\n                                <div><b>{tv(pack)}</b></div>\r\n                                <div>{renderDeliveryTime(pack)}</div>\r\n                            </div>\r\n                            <div className=\"col-6\">\r\n                                <div className=\"row\">\r\n                                    <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                                        <span className=\"text-danger\"> <span className=\"h5\">{retail}</span></span>\r\n                                    </div>\r\n                                    <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                                        <Form schema={this.schema} uiSchema={this.uiSchema} formData={v} />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>;\r\n                } else {\r\n                    return <small></small>\r\n                }\r\n            });\r\n        }\r\n        return priceUI || <div>none</div>;\r\n    })\r\n}","import * as React from 'react';\r\nimport { tv, View } from 'tonva';\r\nimport { CProduct, productPropItem } from './CProduct';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VChemicalInfo extends View<CProduct> {\r\n\r\n    render(param: any): JSX.Element {\r\n        let { id: productId } = param;\r\n        let { controller } = this;\r\n        controller.getChemicalInfo(productId);\r\n        return <this.content productId={productId} />;\r\n    }\r\n\r\n    private content = observer((param: any) => {\r\n\r\n        let { productId } = param;\r\n        let { chemicalInfoContainer } = this.controller;\r\n        let chemicalInfo = chemicalInfoContainer[productId];\r\n        if (chemicalInfo !== undefined) {\r\n            let { chemical, purity, CAS, molecularFomula, molecularWeight } = chemicalInfo;\r\n            return <>\r\n                {productPropItem('CAS', CAS)}\r\n                {productPropItem('', purity)}\r\n            </>\r\n        }\r\n        return <></>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport * as _ from 'lodash';\r\nimport { observable } from 'mobx';\r\nimport { Query, tv, BoxId, Map } from 'tonva';\r\nimport { PageItems, Controller, nav, Page, Image } from 'tonva';\r\nimport classNames from 'classnames';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\n//import { CCartApp } from '../CCartApp';\r\nimport { VProduct } from './VProduct';\r\nimport { VProductList } from './VProductList';\r\nimport { LoaderProductChemicalWithPrices } from './itemLoader';\r\nimport { ProductImage } from '../tools/productImage';\r\nimport { VProductDelivery } from './VProductDelivery';\r\nimport { VCartProuductView, VProductPrice } from './VProductView';\r\nimport { VChemicalInfo } from './VChemicalInfo';\r\n\r\nclass PageProducts extends PageItems<any> {\r\n\r\n    private searchProductQuery: Query;\r\n\r\n    constructor(searchProductQuery: Query) {\r\n        super();\r\n        this.firstSize = this.pageSize = 10;\r\n        this.searchProductQuery = searchProductQuery;\r\n    }\r\n\r\n    protected async load(param: any, pageStart: any, pageSize: number): Promise<any[]> {\r\n        if (pageStart === undefined) pageStart = 0;\r\n        let ret = await this.searchProductQuery.page(param, pageStart, pageSize);\r\n        return ret;\r\n    }\r\n\r\n    protected setPageStart(item: any): any {\r\n        this.pageStart = item === undefined ? 0 : item.seq;\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport class CProduct extends CUqBase {\r\n    //    cApp: CApp;\r\n    pageProducts: PageProducts;\r\n\r\n    @observable futureDeliveryTimeDescriptionContainer: { [cacheId: string]: string } = {};\r\n    @observable chemicalInfoContainer: { [productId: number]: any } = {};\r\n\r\n    protected async internalStart(param: any) {\r\n        this.searchByKey(param);\r\n    }\r\n\r\n    searchByKey(key: string) {\r\n        let { currentSalesRegion } = this.cApp;\r\n        //let searchProductQuery = cUqProduct.query(\"searchProduct\");\r\n        this.pageProducts = new PageProducts(this.uqs.product.SearchProduct);\r\n        this.pageProducts.first({ keyWord: key, salesRegion: currentSalesRegion.id });\r\n        this.openVPage(VProductList, key);\r\n    }\r\n\r\n    async searchByCategory(category: any) {\r\n        let { currentSalesRegion } = this.cApp;\r\n        //let searchProductQuery = .query(\"searchProductByCategory\");\r\n        this.pageProducts = new PageProducts(this.uqs.product.SearchProductByCategory);\r\n        let { productCategoryId, name } = category;\r\n        this.pageProducts.first({ productCategory: productCategoryId, salesRegion: currentSalesRegion.id });\r\n        this.openVPage(VProductList, name);\r\n    }\r\n\r\n    showProductDetail = async (product: BoxId) => {\r\n\r\n        let loader = new LoaderProductChemicalWithPrices(this.cApp);\r\n        let productData = await loader.load(product.id);\r\n        this.openVPage(VProduct, { productData, product });\r\n    }\r\n\r\n    renderProductPrice = (product: BoxId) => {\r\n        return this.renderView(VProductPrice, product);\r\n    }\r\n\r\n    getProductPrice = async (productId: number, salesRegionId: number) => {\r\n        return await this.uqs.product.PriceX.table({ product: productId, salesRegion: salesRegionId });\r\n    }\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        return this.renderView(VProductDelivery, pack);\r\n    }\r\n\r\n    getInventoryAllocation = async (productId: number, packId: number, salesRegionId: number) => {\r\n        return await this.uqs.warehouse.GetInventoryAllocation.table({ product: productId, pack: packId, salesRegion: this.cApp.currentSalesRegion });\r\n    }\r\n\r\n    getFutureDeliveryTimeDescription = async (productId: number, salesRegionId: number) => {\r\n        let cacheId = productId + '_' + salesRegionId;\r\n        if (this.futureDeliveryTimeDescriptionContainer[cacheId] === undefined) {\r\n            let futureDeliveryTime = await this.uqs.product.GetFutureDeliveryTime.table({ product: productId, salesRegion: salesRegionId });\r\n            if (futureDeliveryTime.length > 0) {\r\n                let { minValue, maxValue, unit, deliveryTimeDescription } = futureDeliveryTime[0];\r\n                this.futureDeliveryTimeDescriptionContainer[cacheId] = minValue + (maxValue > minValue ? '~' + maxValue : '') + ' ' + unit;\r\n            } else {\r\n                this.futureDeliveryTimeDescriptionContainer[cacheId] = null;\r\n            }\r\n        }\r\n        return this.futureDeliveryTimeDescriptionContainer[cacheId];\r\n    }\r\n\r\n    renderChemicalInfo = (product: BoxId) => {\r\n        return this.renderView(VChemicalInfo, product);\r\n    }\r\n\r\n    getChemicalInfo = async (productId: number) => {\r\n        if (this.chemicalInfoContainer[productId] === undefined) {\r\n            this.chemicalInfoContainer[productId] = await this.uqs.product.ProductChemical.obj({ product: productId });\r\n        }\r\n    }\r\n\r\n    renderCartProduct = (product: BoxId) => {\r\n        return this.renderView(VCartProuductView, product);\r\n    }\r\n}\r\n\r\nexport function renderBrand(brand: any) {\r\n    return productPropItem('', brand.name);\r\n}\r\n\r\nexport function productPropItem(caption: string, value: any, captionClass?: string) {\r\n    if (value === null || value === undefined || value === '0') return null;\r\n    let capClass = captionClass ? classNames(captionClass) : classNames(\"text-muted\");\r\n    let valClass = captionClass ? classNames(captionClass) : \"\";\r\n    return <>\r\n        <div className={classNames(\"col-6 col-sm-2 pr-0 small\", capClass)}> {caption}</div>\r\n        <div className={classNames(\"col-6 col-sm-4\", valClass)}>{value}</div>\r\n    </>;\r\n}\r\n\r\nexport function renderProduct(product: any) {\r\n    let { brand, description, descriptionC, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl } = product;\r\n    return <div className=\"d-block mb-4 px-3\">\r\n        <div className=\"py-2\">\r\n            <div><strong>{description}</strong></div>\r\n            <div>{descriptionC}</div>\r\n        </div>\r\n        <div className=\"row\">\r\n            <div className=\"col-3\">\r\n                <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n            </div>\r\n            <div className=\"col-9\">\r\n                <div className=\"row\">\r\n                    {productPropItem('CAS', CAS)}\r\n                    {productPropItem('', origin)}\r\n                    {productPropItem('', purity)}\r\n                    {productPropItem('', molecularFomula)}\r\n                    {productPropItem('', molecularWeight)}\r\n                    {tv(brand, renderBrand)}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n}","import * as React from 'react';\r\nimport logo from '../images/logo.png';\r\n\r\nexport const jnkTop = <div className=\"d-flex align-items-center\">\r\n    <img className=\"h-3c position-absolute\" src={logo} />\r\n    <div className=\"h3 flex-fill text-center\">\r\n        <span className=\"text-primary mr-3\"></span>\r\n    </div>\r\n</div>;\r\n","import * as React from 'react';\r\nimport { tv } from 'tonva';\r\n\r\nexport const tvAddress = (values: any) => {\r\n    let { country, province, city, county } = values;\r\n    return <>\r\n        {tv(country)}{tv(province, undefined, undefined, () => <></>)}{tv(city, undefined, undefined, () => <></>)}{tv(county, undefined, undefined, () => <></>)}\r\n    </>\r\n}\r\n\r\nexport const tvCountry = (values: any) => {\r\n    return <> {values.chineseName} </>;\r\n}\r\n\r\nexport const tvCurrency = (values: any) => {\r\n    return <> {values.name} </>;\r\n}\r\n\r\nexport const common = {\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    currency: tvCurrency,\r\n};\r\n","import * as React from 'react';\r\nimport { tv } from 'tonva';\r\nimport { ProductImage } from 'tools/productImage';\r\n\r\nexport const tvProduct = (values: any) => {\r\n    let product = values;\r\n    let { brand, description, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl } = product;\r\n    return <div className=\"row d-flex\">\r\n        <div className=\"col-12\">\r\n            <div className=\"row py-2\">\r\n                <div className=\"col-12\"><strong>{description}</strong></div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-9\">\r\n                    <div className=\"row\">\r\n                        {item('CAS', CAS)}\r\n                        {item('', purity)}\r\n                        {item('', molecularFomula)}\r\n                        {item('', molecularWeight)}\r\n                        {item('', origin)}\r\n                        {tv(brand, (values: any) => <>{item(\"\", values.name)}</>)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n};\r\n\r\nconst tvPackx = (values: any) => {\r\n    let { radiox, radioy, unit } = values;\r\n    if (radiox !== 1) return <>{radiox} * {radioy}{unit}</>;\r\n    return <>{radioy}{unit}</>;\r\n}\r\n\r\nfunction item(caption: string, value: any) {\r\n    if (value === null || value === undefined) return null;\r\n    return <>\r\n        <div className=\"col-4 text-muted pr-0\">{caption}:</div>\r\n        <div className=\"col-8\">{value}</div>\r\n    </>;\r\n}\r\n\r\nconst tvProductCategory = (values: any) => {\r\n    let { children } = values;\r\n    return <>\r\n        aaa\r\n    </>\r\n};\r\n\r\nexport const product = {\r\n    productx: tvProduct,\r\n    packx: tvPackx,\r\n    productCategory: tvProductCategory,\r\n}\r\n","import * as React from 'react';\r\nimport { tv } from 'tonva';\r\nimport { tvAddress, tvCountry } from './common';\r\n\r\nexport const tvContact = (values: any) => {\r\n    let { name, mobile, organizationName, address, addressString } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        <b>\r\n            {name}\r\n        </b>\r\n        &nbsp; {mobile} &nbsp; {organizationName}<br />\r\n        <small>{tv(address)} {addressString}</small>\r\n    </div>\r\n}\r\n\r\nexport const tvInvoiceType = (values: any) => {\r\n    let { id, description } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        {description}\r\n    </div>\r\n}\r\n\r\nexport const tvInvoiceInfo = (values: any) => {\r\n    let { title, taxNo } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        <b>\r\n            {title}\r\n        </b>\r\n        &nbsp; {taxNo}\r\n    </div>\r\n}\r\n\r\nexport const customer = {\r\n    contact: tvContact,\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    invoiceInfo: tvInvoiceInfo,\r\n    invoiceType: tvInvoiceType\r\n}\r\n","import { TVs } from \"tonva\";\r\nimport { common } from \"./common\";\r\nimport { warehouse } from \"./warehouse\";\r\nimport { product } from \"./product\";\r\nimport { order } from \"./order\";\r\nimport { customer } from './customer';\r\n\r\nexport const tvs:TVs = {\r\n    common: common,\r\n    warehouse: warehouse,\r\n    product: product,\r\n    order: order,\r\n    customer: customer,\r\n}","import * as React from 'react';\r\n\r\nconst tvWarehouse = (values: any) => {\r\n    let { name } = values;\r\n    return <div>\r\n        {name}\r\n    </div>\r\n}\r\n\r\nexport const warehouse = {\r\n    warehouse: tvWarehouse,\r\n}\r\n","import { tvProduct } from \"./product\";\r\nimport { tvAddress, tvCountry, tvCurrency } from \"./common\";\r\nimport { tvContact } from \"./customer\";\r\n\r\nexport const order = {\r\n    productx: tvProduct,\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    contact: tvContact,\r\n    currency: tvCurrency,\r\n}\r\n","import { AppConfig } from \"tonva\";\r\nimport { jnkTop } from \"./me/loginTop\";\r\nimport { tvs } from \"./tvs\";\r\nimport AnalyticalChemistry from './images/AnalyticalChemistry.png';\r\nimport LabSupplies from './images/LabSupplies.png';\r\nimport LifeScience from './images/LifeScience.png';\r\nimport MaterialScience from './images/MaterialScience.png';\r\nimport OrganicChemistry from './images/OrganicChemistry.png';\r\n\r\nexport { CApp } from './CApp';\r\n\r\nexport const appConfig: AppConfig = {\r\n    appName: \"/cart\",\r\n    version: \"1.0.15\",                   // uqs\r\n    tvs: tvs,\r\n    loginTop: jnkTop,\r\n};\r\n\r\n/*\r\n// \r\nexport const GLOABLE = {\r\n    CHINA: 44,\r\n    CHINESE: 196,\r\n    SALESREGION_CN: 1,\r\n    ROOTCATEGORY: {\r\n        47: {\r\n            src: OrganicChemistry,\r\n            labelColor: 'text-info',\r\n        },\r\n        470: {\r\n            src: AnalyticalChemistry,\r\n            labelColor: 'text-success',\r\n        },\r\n        1013: {\r\n            src: LifeScience,\r\n            labelColor: 'text-danger',\r\n        },\r\n        1219: {\r\n            src: MaterialScience,\r\n            labelColor: 'text-warning',\r\n        },\r\n        1545: {\r\n            src: LabSupplies,\r\n            labelColor: 'text-primary',\r\n        },\r\n    } as any,\r\n    TIPDISPLAYTIME: 2000\r\n}\r\n*/\r\n\r\n// \r\nexport const GLOABLE = {\r\n    CHINA: 43,\r\n    CHINESE: 197,\r\n    SALESREGION_CN: 4,\r\n    ROOTCATEGORY: {\r\n        7: {\r\n            src: OrganicChemistry,\r\n            labelColor: 'text-info',\r\n        },\r\n        430: {\r\n            src: AnalyticalChemistry,\r\n            labelColor: 'text-success',\r\n        },\r\n        986: {\r\n            src: LifeScience,\r\n            labelColor: 'text-danger',\r\n        },\r\n        1214: {\r\n            src: MaterialScience,\r\n            labelColor: 'text-warning',\r\n        },\r\n        1545: {\r\n            src: LabSupplies,\r\n            labelColor: 'text-primary',\r\n        },\r\n    } as any,\r\n    TIPDISPLAYTIME: 2000\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, tv, List, LMR, FA } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { OrderItem } from './Order';\r\nimport { CartPackRow } from '../cart/Cart';\r\nimport classNames from 'classnames';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class VCreateOrder extends VPage<COrder> {\r\n    @observable private useShippingAddress: boolean = true;\r\n    @observable private shippingAddressIsBlank: boolean = false;\r\n    @observable private invoiceAddressIsBlank: boolean = false;\r\n    @observable private invoiceIsBlank: boolean = false;\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private nullContact = () => {\r\n        return <span className=\"text-primary\"></span>;\r\n    }\r\n\r\n    private packsRow = (item: CartPackRow, index: number) => {\r\n        let { pack, quantity, price, retail, currency } = item;\r\n\r\n        return <div key={index} className=\"px-2 py-2 border-top\">\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-12c mr-4 text-right\">\r\n                    <span className=\"text-danger h5\"><small></small>{parseFloat((retail * quantity).toFixed(2))}</span>\r\n                    <small className=\"text-muted\">({parseFloat(retail.toFixed(2))}  {quantity})</small>\r\n                </div>\r\n            </div>\r\n            <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n        </div>;\r\n    }\r\n\r\n    private renderOrderItem = (orderItem: OrderItem) => {\r\n        let { product, packs } = orderItem;\r\n        let { controller, packsRow } = this;\r\n        return <div>\r\n            <div className=\"row\">\r\n                <div className=\"col-lg-6 pb-3\">{controller.renderOrderItemProduct(product)}</div>\r\n                <div className=\"col-lg-6\">{\r\n                    packs.map((p, index) => {\r\n                        return packsRow(p, index);\r\n                    })\r\n                }</div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private orderItemKey = (orderItem: OrderItem) => {\r\n        return orderItem.product.id;\r\n    }\r\n\r\n    private renderCoupon = observer((param: any) => {\r\n        let { couponData } = this.controller;\r\n        if (couponData['id'] === undefined) {\r\n            return <span className=\"text-primary\"></span>;\r\n        } else {\r\n            let { id, code, discount, preferential, validitydate, isValid } = couponData;\r\n            let { couponOffsetAmount, couponRemitted } = param;\r\n            let offsetUI, remittedUI, noOffsetUI;\r\n            if (couponOffsetAmount || couponRemitted) {\r\n                if (couponOffsetAmount) {\r\n                    offsetUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                        <div className=\"text-muted\">:</div>\r\n                        <div className=\"text-right text-danger\"><small></small>{couponOffsetAmount.toFixed(2)}</div>\r\n                    </div>\r\n                }\r\n                if (couponRemitted) {\r\n                    remittedUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                        <div className=\"text-muted\">:</div>\r\n                        <div className=\"text-right text-danger\"><small></small>{couponRemitted.toFixed(2)}</div>\r\n                    </div>\r\n                }\r\n            } else {\r\n                noOffsetUI = <div></div>;\r\n            }\r\n            return <div className=\"mr-2\">\r\n                <div className=\"text-success\">{code.substr(0, 4)} {code.substr(4)}</div>\r\n                {offsetUI}\r\n                {remittedUI}\r\n                {noOffsetUI}\r\n            </div>\r\n        }\r\n    });\r\n\r\n    private onSubmit = async () => {\r\n        let { orderData } = this.controller;\r\n        // \r\n        let { shippingContact, invoiceContact, invoiceType, invoiceInfo } = orderData;\r\n        if (!shippingContact) {\r\n            this.shippingAddressIsBlank = true;\r\n            setTimeout(() => this.shippingAddressIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n        if (!invoiceContact) {\r\n            if (this.useShippingAddress) {\r\n                orderData.invoiceContact = shippingContact; //contactBox;\r\n                this.invoiceAddressIsBlank = false;\r\n            } else {\r\n                this.invoiceAddressIsBlank = true;\r\n                setTimeout(() => this.invoiceAddressIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n                return;\r\n            }\r\n        }\r\n        if (!invoiceType || !invoiceInfo) {\r\n            this.invoiceIsBlank = true;\r\n            setTimeout(() => this.invoiceIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n\r\n        this.controller.submitOrder();\r\n    }\r\n\r\n    private page = observer(() => {\r\n\r\n        let { cApp, orderData, onSelectShippingContact, onSelectInvoiceContact, openMeInfo, onInvoiceInfoEdit, onCouponEdit } = this.controller;\r\n        let { currentUser } = cApp;\r\n        let fillMeInfo = <div onClick={openMeInfo} className=\"alert alert-warning text-primary py-1\" role=\"alert\">\r\n            \r\n        </div>\r\n        if (currentUser.allowOrdering) {\r\n            fillMeInfo = null;\r\n        }\r\n        let footer = <div className=\"d-block\">\r\n            {fillMeInfo}\r\n            <div className=\"w-100 px-3\">\r\n                <div className=\"d-flex justify-content-left flex-grow-1\">\r\n                    <span className=\"text-danger\" style={{ fontSize: '1.8rem' }}><small></small>{orderData.amount}</span>\r\n                </div>\r\n                <button type=\"button\"\r\n                    className={classNames('btn', 'w-30', { 'btn-danger': currentUser.allowOrdering, 'btn-secondary': !currentUser.allowOrdering })}\r\n                    onClick={this.onSubmit} disabled={!currentUser.allowOrdering}>\r\n                </button>\r\n            </div>\r\n        </div >;\r\n\r\n        let chevronRight = <FA name=\"chevron-right\" className=\"cursor-pointer\" />\r\n        let shippingAddressBlankTip = this.shippingAddressIsBlank ?\r\n            <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> </div>\r\n            : null;\r\n        let invoiceAddressBlankTip = this.invoiceAddressIsBlank ? <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> </div> : null;\r\n        let divInvoiceContact: any = null;\r\n        if (this.useShippingAddress === false) {\r\n            if (orderData.invoiceContact !== undefined) {\r\n                divInvoiceContact = <div className=\"col-8 col-sm-10 offset-4 offset-sm-2 d-flex\">\r\n                    {tv(orderData.invoiceContact, undefined, undefined, this.nullContact)}\r\n                    <div>{chevronRight}</div>\r\n                </div>\r\n            } else {\r\n                divInvoiceContact = <div className=\"col-8 offset-4 offset-sm-2\">\r\n                    <button className=\"btn btn-outline-primary\"\r\n                        onClick={onSelectInvoiceContact}></button>\r\n                    {invoiceAddressBlankTip}\r\n                </div>\r\n            }\r\n        }\r\n\r\n        let invoiceContactUI = <div className=\"row py-3 bg-white mb-1\">\r\n            <div className=\"col-4 col-sm-2 pb-2 text-muted\">:</div>\r\n            <div className=\"col-8 col-sm-10\">\r\n                <div>\r\n                    <label className=\"cursor-pointer\">\r\n                        <input type=\"checkbox\"\r\n                            defaultChecked={this.useShippingAddress}\r\n                            onChange={e => {\r\n                                this.useShippingAddress = e.currentTarget.checked;\r\n                                orderData.invoiceContact = undefined;\r\n                                this.invoiceAddressIsBlank = false;\r\n                            }} /> \r\n                    </label>\r\n                </div>\r\n            </div>\r\n            {divInvoiceContact}\r\n        </div>\r\n\r\n        let invoiceBlankTip = this.invoiceIsBlank ? <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> </div> : null;\r\n        let invoiceInfoUI = <div className=\"row py-3 bg-white mb-1\" onClick={onInvoiceInfoEdit}>\r\n            <div className=\"col-4 col-sm-2 pb-2 text-muted\">:</div>\r\n            <div className=\"col-8 col-sm-10\">\r\n                <LMR className=\"w-100 align-items-center\" right={chevronRight}>\r\n                    {tv(orderData.invoiceType, (v) => <>{v.description}</>, undefined, () => <span className=\"text-primary\"></span>)}\r\n                    {tv(orderData.invoiceInfo, (v) => <> -- {v.title}</>, undefined, () => <></>)}\r\n                    {invoiceBlankTip}\r\n                </LMR>\r\n            </div>\r\n        </div>\r\n\r\n        let freightFeeUI = <></>;\r\n        let freightFeeRemittedUI = <></>;\r\n        if (orderData.freightFee) {\r\n            freightFeeUI = <>\r\n                <div className=\"col-4 col-sm-2 pb-2 text-muted\">:</div>\r\n                <div className=\"col-8 col-sm-10 text-right text-danger\"><small></small>{orderData.freightFee}</div>\r\n            </>\r\n            if (orderData.freightFeeRemitted) {\r\n                freightFeeRemittedUI = <>\r\n                    <div className=\"col-4 col-sm-2 pb-2 text-muted\">:</div>\r\n                    <div className=\"col-8 col-sm-10 text-right text-danger\"><small></small>{orderData.freightFeeRemitted}</div>\r\n                </>\r\n            }\r\n        }\r\n\r\n        let couponUI = <></>;\r\n        if (1 === 1) {\r\n            couponUI = <div className=\"row py-3 bg-white mb-1\" onClick={onCouponEdit}>\r\n                <div className=\"col-4 col-sm-2 pb-2 text-muted\">:</div>\r\n                <div className=\"col-8 col-sm-10\">\r\n                    <LMR className=\"w-100 align-items-center\" right={chevronRight}>\r\n                        <this.renderCoupon couponOffsetAmount={orderData.couponOffsetAmount} couponRemitted={orderData.couponRemitted} />\r\n                    </LMR>\r\n                </div>\r\n            </div>\r\n        }\r\n\r\n        return <Page header=\"\" footer={footer}>\r\n            <div className=\"px-2\">\r\n                <div className=\"row py-3 bg-white mb-1\" onClick={onSelectShippingContact}>\r\n                    <div className=\"col-4 col-sm-2 pb-2 text-muted\">:</div>\r\n                    <div className=\"col-8 col-sm-10\">\r\n                        <LMR className=\"w-100 align-items-center\" right={chevronRight}>{tv(orderData.shippingContact, undefined, undefined, this.nullContact)}</LMR>\r\n                        {shippingAddressBlankTip}\r\n                    </div>\r\n                </div>\r\n                {invoiceContactUI}\r\n                {invoiceInfoUI}\r\n            </div>\r\n            <List items={orderData.orderItems} item={{ render: this.renderOrderItem, key: this.orderItemKey as any }} />\r\n            <div className=\"px-2\">\r\n                <div className=\"row py-3 pr-3 bg-white my-1\">\r\n                    <div className=\"col-4 col-sm-2 pb-2 text-muted\">:</div>\r\n                    <div className=\"col-8 col-sm-10 text-right\"><small></small>{orderData.productAmount}</div>\r\n                    {freightFeeUI}\r\n                    {freightFeeRemittedUI}\r\n                </div >\r\n                {couponUI}\r\n            </div>\r\n        </Page >\r\n    })\r\n}","import { BoxId } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\nimport { CartPackRow } from 'cart/Cart';\r\n\r\nexport class Order {\r\n\r\n    webUser: any;\r\n    organization: BoxId;\r\n    customer: any;\r\n\r\n    @observable shippingContact: BoxId;\r\n    @observable invoiceContact: BoxId;\r\n    @observable invoiceType: BoxId;\r\n    @observable invoiceInfo: BoxId;\r\n    @observable orderItems: OrderItem[] = [];\r\n\r\n    @observable freightFee: number;\r\n    @observable freightFeeRemitted: number;\r\n\r\n    /*\r\n    @computed get amount() {\r\n        return parseFloat((this.orderItems.reduce((pv, cv) => (pv + cv.subAmount), 0) +\r\n            (this.freightFee ? this.freightFee : 0) +\r\n            (this.freightFeeRemitted ? this.freightFeeRemitted : 0) +\r\n            (this.couponOffsetAmount ? this.couponOffsetAmount : 0) +\r\n            (this.couponRemitted ? this.couponRemitted : 0)).toFixed(2));\r\n    };\r\n    */\r\n    @computed get amount() {\r\n        return parseFloat((this.orderItems.reduce((pv, cv) => (pv + cv.subAmount), 0) +\r\n            (this.freightFee ? this.freightFee : 0) +\r\n            (this.freightFeeRemitted ? this.freightFeeRemitted : 0)).toFixed(2));\r\n    };\r\n    // @computed get productAmount() {\r\n    //     return parseFloat(this.orderItems.reduce((pv, cv) => pv + cv.subAmount, 0).toFixed(2));\r\n    // };\r\n    @computed get productAmount() {\r\n        return parseFloat(this.orderItems.reduce((pv, cv) => pv + cv.subListAmount, 0).toFixed(2));\r\n    };\r\n    currency: BoxId;\r\n    @observable coupon: BoxId;\r\n    @observable couponOffsetAmount: number;\r\n    @observable couponRemitted: number;\r\n    salesRegion: BoxId;\r\n\r\n    getDataForSave() {\r\n        let orderItems: any[] = [];\r\n        this.orderItems.forEach(oi => {\r\n            oi.packs.forEach(pk => {\r\n                this.currency = pk.currency;\r\n                orderItems.push({\r\n                    product: oi.product, pack: pk.pack, price: pk.price, quantity: pk.quantity\r\n                    , subAmount: pk.quantity * pk.price\r\n                })\r\n            })\r\n        });\r\n        return {\r\n            webUser: this.webUser,\r\n            organization: this.organization,\r\n            customer: this.customer,\r\n            shippingContact: this.shippingContact,\r\n            invoiceContact: this.invoiceContact,\r\n            invoiceType: this.invoiceType,\r\n            invoiceInfo: this.invoiceInfo,\r\n            amount: this.amount,\r\n            currency: this.currency,\r\n            freightFee: this.freightFee,\r\n            freightFeeRemitted: this.freightFeeRemitted,\r\n            coupon: this.coupon,\r\n            couponOffsetAmount: this.couponOffsetAmount,\r\n            couponRemitted: this.couponRemitted,\r\n            orderitems: orderItems, // orderitems\r\n            salesRegion: this.salesRegion,\r\n        }\r\n    }\r\n}\r\n\r\nexport class OrderItem {\r\n\r\n    product: BoxId;\r\n    @observable packs: CartPackRow[];\r\n    @computed get subAmount() {\r\n        return this.packs.reduce((p, c) => {\r\n            return p + c.price * c.quantity\r\n        }, 0);\r\n    }\r\n    @computed get subListAmount() {\r\n        return this.packs.reduce((p, c) => {\r\n            return p + c.retail * c.quantity\r\n        }, 0);\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { COrder } from './COrder';\r\n\r\nexport class OrderSuccess extends VPage<COrder> {\r\n\r\n    async open(orderCreateResult: any) {\r\n\r\n        this.openPage(this.page, orderCreateResult);\r\n    }\r\n\r\n    private page = (orderCreateResult: any) => {\r\n        return <Page header=\"\" back=\"close\">\r\n            <div className=\"p-3 bg-white mb-3\">\r\n                <div className=\"mb-3\"></div>\r\n                <p className=\"\">\r\n                    : <span className=\"h5 text-info\">{orderCreateResult.no}</span><br /><br />\r\n                    \r\n                </p>\r\n            </div>\r\n        </Page>\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { CSelectContact } from './CSelectContact';\r\nimport { List, LMR, FA } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VContactList extends VPage<CSelectContact> {\r\n\r\n    async open() {\r\n\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onContactRender = (contact: any) => {\r\n        let { onEditContact, onContactSelected } = this.controller;\r\n        let right = <div className=\"p-2 cursor-pointer text-info\" onClick={() => onEditContact(contact)}>\r\n            <FA name=\"edit\" />\r\n        </div>\r\n        return <LMR right={right} className=\"px-3 py-2\">\r\n            <div onClick={() => onContactSelected(contact)}>\r\n                {tv(contact)}\r\n            </div>\r\n        </LMR>\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { onNewContact, userContacts } = this.controller;\r\n        let footer = <button type=\"button\" className=\"btn btn-primary w-100\" onClick={() => onNewContact()} ></button>;\r\n        let contactList = <List items={userContacts} item={{ render: this.onContactRender }} none=\"\" />;\r\n        return <Page footer={footer} header=\"\">\r\n            {contactList}\r\n        </Page>\r\n    })\r\n}","\r\nexport function telephoneValidation(value: string) {\r\n    if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n        return \"\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function mobileValidation(value: string) {\r\n    if (value && !/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(value))\r\n        return \"\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function emailValidation(value: string) {\r\n    if (value && !/\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/.test(value))\r\n        return \"Email\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function faxValidation(value: string) {\r\n    if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n        return \"\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function addressDetailValidation(value: string) {\r\n    return (value && value.length > 200) ? \"200\" : undefined;\r\n}\r\n\r\nexport function zipCodeValidation(value: string) {\r\n    return (value && value.length > 15) ? \"\" : undefined;\r\n}\r\n\r\n\r\nexport function organizationNameValidation(value: string) {\r\n    return (value && value.length > 100) ? \"100\" : undefined;\r\n}\r\n\r\nexport function departmentNameValidation(value: string) {\r\n    return (value && value.length > 100) ? \"100\" : undefined;\r\n}\r\n\r\nexport function salutationValidation(value: string) {\r\n    return (value && value.length > 100) ? \"100\" : undefined;\r\n}\r\n\r\nexport function nameValidation(value: string) {\r\n    return (value && value.length > 50) ? \"50\" : undefined;\r\n}","import * as React from 'react';\r\nimport _ from 'lodash';\r\nimport { VPage, Page, Form, Schema, UiSchema, Context, UiInputItem, UiIdItem, BoxId } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { CSelectContact } from './CSelectContact';\r\nimport { addressDetailValidation, emailValidation, telephoneValidation, mobileValidation, organizationNameValidation, nameValidation } from 'tools/inputValidations';\r\n\r\nconst schema: Schema = [\r\n    { name: 'id', type: 'id', required: false },\r\n    { name: 'name', type: 'string', required: true },\r\n    { name: 'organizationName', type: 'string', required: true },\r\n    { name: 'mobile', type: 'string', required: true },\r\n    { name: 'telephone', type: 'string', required: false },\r\n    { name: 'email', type: 'string', required: false },\r\n    { name: 'address', type: 'id', required: true },\r\n    { name: 'addressString', type: 'string', required: true },\r\n    { name: 'isDefault', type: 'boolean', required: false },\r\n];\r\n\r\nexport class VContact extends VPage<CSelectContact> {\r\n\r\n    private userContactData: any;\r\n    private form: Form;\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            id: { visible: false },\r\n            name: { widget: 'text', label: '', placeholder: '', rules: nameValidation } as UiInputItem,\r\n            organizationName: { widget: 'text', label: '', placeholder: '', rules: organizationNameValidation } as UiInputItem,\r\n            mobile: { widget: 'text', label: '', placeholder: '', rules: mobileValidation } as UiInputItem, telephone: { widget: 'text', label: '', placeholder: '', rules: telephoneValidation } as UiInputItem,\r\n            email: { widget: 'email', label: 'Email', rules: emailValidation, placeholder: 'Email' } as UiInputItem, address: {\r\n                widget: 'id', label: '', placeholder: '',\r\n                pickId: async (context: Context, name: string, value: number) => await this.controller.pickAddress(context, name, value),\r\n                Templet: (address: BoxId) => {\r\n                    return tv(address, (addressValue) => {\r\n                        let { country, province, city, county } = addressValue;\r\n                        /* tvtvbug, Henry */\r\n                        return <>\r\n                            {country && country.id && tv(country, v => <>{v.chineseName}</>)}\r\n                            {province && province.id && tv(province, (v) => <>{v.chineseName}</>)}\r\n                            {city && city.id && tv(city, (v) => <>{v.chineseName}</>)}\r\n                            {county && county.id && tv(county, (v) => <>{v.chineseName}</>)}\r\n                        </>;\r\n                    }, () => {\r\n                        return <small className=\"text-muted\"></small>;\r\n                    })\r\n                }\r\n            } as UiIdItem,\r\n            addressString: { widget: 'text', label: '', placeholder: '', rules: addressDetailValidation } as UiInputItem,\r\n            isDefault: { widget: 'checkbox', label: '' },\r\n            submit: { widget: 'button', label: '' },\r\n        }\r\n    }\r\n\r\n    async open(userContactData: any) {\r\n        this.userContactData = userContactData;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onSaveContact = async () => {\r\n        if (!this.form) return;\r\n        await this.form.buttonClick(\"submit\");\r\n    }\r\n\r\n    private onFormButtonClick = async (name: string, context: Context) => {\r\n        await this.controller.saveContact(context.form.data);\r\n    }\r\n\r\n    private onDelContact = async () => {\r\n        let { contact } = this.userContactData;\r\n        if (await this.vCall(VConfirmDeleteContact, contact) === true) {\r\n            await this.controller.delContact(contact);\r\n            this.closePage();\r\n        };\r\n    }\r\n\r\n    private page = () => {\r\n        let contactData = _.clone(this.userContactData.contact);\r\n\r\n        let buttonDel: any;\r\n        if (contactData !== undefined) {\r\n            buttonDel = <button className=\"btn btn-sm btn-info\" onClick={this.onDelContact}></button>;\r\n        } else {\r\n            let { defaultOrganizationName, defaultName, defaultMobile, address, addressString } = this.controller.cApp.currentUser;\r\n            contactData = {\r\n                'organizationName': defaultOrganizationName,\r\n                'name': defaultName,\r\n                'mobile': defaultMobile,\r\n                'address': address,\r\n                'addressString': addressString\r\n            };\r\n        }\r\n        let { fromOrderCreation } = this.controller;\r\n        let footer = <button type=\"button\"\r\n            className=\"btn btn-primary w-100\"\r\n            onClick={this.onSaveContact}>{fromOrderCreation ? '' : ''}</button>;\r\n        return <Page header=\"\" footer={footer} right={buttonDel}>\r\n            <div className=\"App-container container text-left\">\r\n                <Form ref={v => this.form = v} className=\"my-3\"\r\n                    schema={schema}\r\n                    uiSchema={this.uiSchema}\r\n                    formData={contactData}\r\n                    onButtonClick={this.onFormButtonClick}\r\n                    fieldLabelSize={3} />\r\n            </div>\r\n        </Page>\r\n    }\r\n}\r\n\r\nclass VConfirmDeleteContact extends VPage<CSelectContact> {\r\n    async open(contact: any) {\r\n        this.openPage(this.page, contact);\r\n    }\r\n\r\n    private onConfirm = async () => {\r\n        await this.returnCall(true);\r\n        this.closePage();\r\n    }\r\n\r\n    private onCancel = async () => {\r\n        await this.returnCall(false);\r\n        this.closePage();\r\n    }\r\n\r\n    private page = (contact: any) => {\r\n        return <Page header=\"\" back=\"close\">\r\n            <div className=\"w-75 mx-auto border border-primary rounded my-3 p-3 bg-white\">\r\n                <div className=\"p-4 position-relative\">\r\n                    <i className=\"fa fa-question-circle position-absolute fa-2x text-warning\" style={{ left: 0, top: 0 }} />\r\n                    <b className=\"\"></b>\r\n                </div>\r\n                <div className=\"d-flex mt-3 justify-content-end\">\r\n                    <button className=\"btn btn-danger mr-3\" onClick={this.onConfirm}></button>\r\n                    <button className=\"btn btn-outline-info mr-3\" onClick={this.onCancel}></button>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page, BoxId } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { List, FA } from 'tonva';\r\nimport { CAddress } from './CAddress';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class VAddress extends VPage<CAddress> {\r\n    private provinceId: number;\r\n    private cityId: number;\r\n    private countyId: number;\r\n    private backLevel = 0;\r\n\r\n    async open(param: any) {\r\n        let provinces = await this.controller.getCountryProvince(GLOABLE.CHINA);\r\n        this.openPage(this.page, { provinces: provinces });\r\n    }\r\n\r\n    private page = (param: any) => {\r\n        this.backLevel++;\r\n        return <Page header=\"\">\r\n            <div className=\"row no-gutters\">\r\n                {param.provinces.map((v: any) => this.renderPCC(v.province, this.onProvinceClick))}\r\n            </div>\r\n        </Page>\r\n    }\r\n\r\n    private renderPCC = (pcc: BoxId, onClick: any) => {\r\n        return <div key={pcc.id} className=\"col-6 col-md-4 col-lg-3 cursor-pointer\">\r\n            {tv(pcc, (value) => {\r\n                let { id, chineseName } = value;\r\n                return <>\r\n                    <div className=\"pt-1 pb-1 px-2\" onClick={() => onClick(id)}\r\n                        style={{ border: '1px solid #eeeeee', marginRight: '-1px', marginBottom: '-1px' }}\r\n                    >\r\n                        <span className=\"ml-1 align-middle\">\r\n                            <FA name=\"chevron-right\" className=\"text-info small\" />\r\n                            &nbsp; {chineseName}\r\n                        </span>\r\n                    </div>\r\n                </>;\r\n            })}\r\n        </div>\r\n    }\r\n\r\n    private onProvinceClick = async (provinceId: any) => {\r\n        this.provinceId = provinceId;\r\n        let cities = await this.controller.getProvinceCities(provinceId);\r\n        if (cities) {\r\n            let len = cities.length;\r\n            if (len === 1) {\r\n                await this.onCityClick(cities[0].id);\r\n                return;\r\n            }\r\n            if (len > 0) {\r\n                this.backLevel++;\r\n                this.openPageElement(<Page header=\"\">\r\n                    <div className=\"row no-gutters\">\r\n                        {cities.map(v => this.renderPCC(v.city, this.onCityClick))}\r\n                    </div>\r\n                </Page>);\r\n                return;\r\n            }\r\n        } else {\r\n            this.closePage(this.backLevel);\r\n            this.saveAddress();\r\n        }\r\n    }\r\n\r\n    private onCityClick = async (cityId: any) => {\r\n        this.cityId = cityId;\r\n        let counties = await this.controller.getCityCounties(cityId);\r\n        if (counties && counties.length > 0) {\r\n            this.backLevel++;\r\n            this.openPageElement(<Page header=\"\">\r\n                <div className=\"row no-gutters\">\r\n                    {counties.map(v => this.renderPCC(v.county, this.onCountyClick))}\r\n                </div>\r\n            </Page>);\r\n        } else {\r\n            this.closePage(this.backLevel);\r\n            this.saveAddress();\r\n        }\r\n    }\r\n\r\n    private onCountyClick = async (countyId: any) => {\r\n        this.countyId = countyId;\r\n        this.closePage(this.backLevel);\r\n        this.saveAddress();\r\n    }\r\n\r\n    private saveAddress = async () => {\r\n        await this.controller.saveAddress(GLOABLE.CHINA, this.provinceId, this.cityId, this.countyId);\r\n    }\r\n}\r\n","import { VAddress } from './VAddress';\r\nimport { CUqBase } from '../CBase';\r\n\r\nexport class CAddress extends CUqBase {\r\n    protected async internalStart() {\r\n        this.openVPage(VAddress);\r\n    }\r\n\r\n    getCountryProvince = async (countryId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetCountryProvinces.table({ country: countryId });\r\n    }\r\n\r\n    getProvinceCities = async (provinceId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetProvinceCities.table({ province: provinceId });\r\n    }\r\n\r\n    getCityCounties = async (cityId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetCityCounties.table({ city: cityId });\r\n    }\r\n\r\n    saveAddress = async (countryId: number, provinceId: number, cityId?: number, countyId?: number): Promise<any> => {\r\n        let { Address } = this.uqs.common;\r\n        let newAddress = await Address.save(undefined, { country: countryId, province: provinceId, city: cityId, county: countyId });\r\n        let addressId = newAddress && Address.boxId(newAddress.id);\r\n        this.returnCall(addressId);\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport _ from 'lodash';\r\nimport { Context, BoxId } from 'tonva';\r\nimport { CUqBase } from '../CBase';\r\nimport { VContactList } from './VContactList';\r\n//import { CCartApp } from 'CCartApp';\r\nimport { VContact } from './VContact';\r\nimport { CAddress } from './CAddress';\r\n\r\nexport abstract class CSelectContact extends CUqBase {\r\n    fromOrderCreation: boolean;\r\n\r\n    @observable userContacts: BoxId[] = [];\r\n\r\n    async internalStart(fromOrderCreation: boolean/*contactType: ContactType*/) {\r\n        this.fromOrderCreation = fromOrderCreation;\r\n        let userContactMaps = await this.cApp.currentUser.getContacts();\r\n        this.userContacts = userContactMaps.map((v: any) => v.contact);\r\n        this.openVPage(VContactList);\r\n        if (this.fromOrderCreation && (!this.userContacts || this.userContacts.length === 0)) {\r\n            this.onNewContact();\r\n        }\r\n    }\r\n\r\n    protected abstract async getIsDefault(userSetting: any, userContactId: number): Promise<boolean>;\r\n\r\n    /**\r\n     * \r\n     */\r\n    onNewContact = async () => {\r\n        this.openVPage(VContact, { contact: undefined });\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    onEditContact = async (userContact: BoxId) => {\r\n        let userContactId = userContact.id;\r\n        let contact = await this.uqs.customer.Contact.load(userContactId);\r\n        let userSetting = await this.cApp.currentUser.getSetting();\r\n        contact.isDefault = await this.getIsDefault(userSetting, userContactId);\r\n        let userContactData: any = { contact: contact };\r\n        this.openVPage(VContact, userContactData);\r\n    }\r\n\r\n    delContact = async (contact: any) => {\r\n        let { id } = contact;\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.delContact(id);\r\n        if (contact.isDefault) {\r\n            this.setDefaultContact(undefined);\r\n        }\r\n        let index = this.userContacts.findIndex(v => v.id === id);\r\n        if (index > -1)\r\n            this.userContacts.splice(index, 1);\r\n    }\r\n\r\n    saveContact = async (contact: any) => {\r\n        let { Contact: contactTuid } = this.uqs.customer;\r\n        let newContact = await contactTuid.save(undefined, contact);\r\n        let { id: newContactId } = newContact;\r\n        let contactBox = contactTuid.boxId(newContactId);\r\n\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.addContact(newContactId);\r\n        this.userContacts.push(contactBox);\r\n        let { id, isDefault } = contact;\r\n        if (isDefault === true || this.userContacts.length === 1) {\r\n            await this.setDefaultContact(contactBox);\r\n        }\r\n        // contact.id !== undefinedcontact(contact)\r\n        if (id !== undefined) {\r\n            await currentUser.delContact(id);\r\n            let index = this.userContacts.findIndex(v => v.id === id);\r\n            if (index > -1)\r\n                this.userContacts.splice(index, 1);\r\n        }\r\n        this.backPage();\r\n        if (this.fromOrderCreation) {\r\n            this.onContactSelected(contactBox);\r\n        }\r\n    }\r\n\r\n    protected abstract async setDefaultContact(contactId: BoxId): Promise<any>;\r\n\r\n    onContactSelected = (contact: BoxId) => {\r\n        if (this.fromOrderCreation) {\r\n            this.backPage();\r\n            this.returnCall(contact);\r\n        }\r\n    }\r\n\r\n    pickAddress = async (context: Context, name: string, value: number): Promise<number> => {\r\n        let cAddress = this.newC(CAddress); // new CAddress(this.cApp, undefined);\r\n        return await cAddress.call<number>();\r\n    }\r\n}\r\n\r\nexport class CSelectShippingContact extends CSelectContact {\r\n    protected async getIsDefault(userSetting: any, userContactId: number): Promise<boolean> {\r\n        if (userSetting !== undefined) {\r\n            let { shippingContact } = userSetting;\r\n            return shippingContact && shippingContact.id === userContactId;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected async setDefaultContact(contactId: BoxId) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultShippingContact(contactId);\r\n    }\r\n}\r\n\r\nexport class CSelectInvoiceContact extends CSelectContact {\r\n    protected async getIsDefault(userSetting: any, userContactId: number): Promise<boolean> {\r\n        if (userSetting !== undefined) {\r\n            let { invoiceContact } = userSetting;\r\n            return invoiceContact && invoiceContact.id === userContactId;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected async setDefaultContact(contactId: BoxId) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultInvoiceContact(contactId);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { List, EasyDate } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { async } from 'q';\r\n\r\nexport class VMyOrders extends VPage<COrder> {\r\n\r\n    @observable private pendingOrders: any[];\r\n    @observable private processingOrders: any[];\r\n    @observable private completedOrders: any[];\r\n    private currentState: string;\r\n    async open(param: any) {\r\n        this.currentState = param;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderOrder = (order: any, index: number) => {\r\n        let { openOrderDetail } = this.controller;\r\n        let { id, no, date, discription, flow } = order;\r\n        return <div className=\"m-3 justify-content-between cursor-pointer\" onClick={() => openOrderDetail(id)}>\r\n            <div><span className=\"small text-muted\">: </span><strong>{no}</strong></div>\r\n            <div className=\"small text-muted\"><EasyDate date={date} /></div>\r\n        </div>;\r\n    }\r\n\r\n    private page = () => {\r\n\r\n        let tabs = [{\r\n            title: '',\r\n            content: () => {\r\n                return <List items={this.pendingOrders} item={{ render: this.renderOrder }} none=\"\" />\r\n            },\r\n            isSelected: this.currentState === 'pendingpayment',\r\n            load: async () => {\r\n                this.currentState = 'pendingpayment';\r\n                this.pendingOrders = await this.controller.getMyOrders(this.currentState);\r\n            }\r\n        }, {\r\n            title: '',\r\n            content: () => {\r\n                return <List items={this.processingOrders} item={{ render: this.renderOrder }} none=\"\" />\r\n            },\r\n            isSelected: this.currentState === 'processing',\r\n            load: async () => {\r\n                this.currentState = 'processing';\r\n                this.processingOrders = await this.controller.getMyOrders(this.currentState);\r\n            }\r\n        }, {\r\n            title: '',\r\n            content: () => {\r\n                return <List items={this.completedOrders} item={{ render: this.renderOrder }} none=\"\" />\r\n            },\r\n            isSelected: this.currentState === 'completed',\r\n            load: async () => {\r\n                this.currentState = 'completed';\r\n                this.completedOrders = await this.controller.getMyOrders(this.currentState);\r\n            }\r\n        }];\r\n        return <Page header=\"\" tabs={tabs} tabPosition=\"top\" />\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, BoxId, EasyTime, EasyDate } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { tv } from 'tonva';\r\nimport { List } from 'tonva';\r\nimport { OrderItem } from './Order';\r\n\r\nexport class VOrderDetail extends VPage<COrder> {\r\n\r\n    async open(order: any) {\r\n\r\n        this.openPage(this.page, order);\r\n    }\r\n\r\n\r\n    private packsRow = (item: any, index: number) => {\r\n        let { pack, quantity, price, currency } = item;\r\n\r\n        return <div key={index} className=\"px-2 py-2 border-top\">\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-12c mr-4 text-right\">\r\n                    <span className=\"text-danger h5\"><small></small>{parseFloat((price * quantity).toFixed(2))}</span>\r\n                    <small className=\"text-muted\">({parseFloat(price.toFixed(2))}  {quantity})</small>\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private renderOrderItem = (orderItem: OrderItem) => {\r\n        let { product, packs } = orderItem;\r\n        let { controller, packsRow } = this;\r\n        return <div>\r\n            <div className=\"row p-1 my-1\">\r\n                <div className=\"col-lg-6 pb-3\">{controller.renderOrderItemProduct(product)}</div>\r\n                <div className=\"col-lg-6\">{\r\n                    packs.map((p, index) => {\r\n                        return packsRow(p, index);\r\n                    })\r\n                }</div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private page = (order: any) => {\r\n\r\n        let { brief, data } = order;\r\n        let { id, no, state, description, date } = brief;\r\n        let { orderItems, currency, shippingContact, invoiceContact, invoiceType, invoiceInfo, amount, couponOffsetAmount, couponRemitted\r\n            , freightFee, freightFeeRemitted } = data;\r\n        let couponUI;\r\n        if (couponOffsetAmount || couponRemitted) {\r\n            let offsetUI, remittedUI;\r\n            if (couponOffsetAmount) {\r\n                offsetUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                    <div className=\"text-muted\">:</div>\r\n                    <div className=\"text-right text-danger\"><small></small>{couponOffsetAmount}</div>\r\n                </div>\r\n            }\r\n            if (couponRemitted) {\r\n                remittedUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                    <div className=\"text-muted\">:</div>\r\n                    <div className=\"text-right text-danger\"><small></small>{couponRemitted}</div>\r\n                </div>\r\n            }\r\n            couponUI = <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">:</div>\r\n                <div className=\"col-9\">\r\n                    {offsetUI}\r\n                    {remittedUI}\r\n                </div>\r\n            </div>\r\n        }\r\n\r\n        let freightFeeUI, freightFeeRemittedUI;\r\n        if (freightFee) {\r\n            freightFeeUI = <>\r\n                <div className=\"text-right text-danger\"><small></small>{freightFee}</div>\r\n            </>\r\n            if (freightFeeRemitted) {\r\n                freightFeeRemittedUI = <>\r\n                    <div className=\"text-right text-danger\"><small></small>{freightFeeRemitted}()</div>\r\n                </>\r\n            }\r\n        }\r\n\r\n        let header = <>: {no}</>\r\n        return <Page header={header}>\r\n            <List items={orderItems} item={{ render: this.renderOrderItem }} />\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">:</div>\r\n                <div className=\"col-9\">{tv(shippingContact)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">:</div>\r\n                <div className=\"col-9\">{tv(invoiceContact)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">:</div>\r\n                <div className=\"col-9\">{invoiceTemplate(invoiceType, invoiceInfo)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">:</div>\r\n                <div className=\"col-9\">{freightFeeUI}{freightFeeRemittedUI}</div>\r\n            </div>\r\n            {couponUI}\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">:</div>\r\n                <div className=\"col-9 text-right\"><EasyDate date={date} /></div>\r\n            </div>\r\n            <div className=\"bg-white p-3 my-1 text-right\">\r\n                <span className=\"text-danger font-weight-bold\">: {amount}{tv(currency)}</span>\r\n            </div>\r\n        </Page>\r\n    }\r\n}\r\n\r\nfunction invoiceTemplate(invoiceType: BoxId, invoiceInfo: BoxId): JSX.Element {\r\n    return <>\r\n        {tv(invoiceType, invoiceTypeUI, undefined, () => <></>)}<br />\r\n        {tv(invoiceInfo, invoiceInfoUI, undefined, () => <></>)}\r\n    </>\r\n}\r\n\r\nfunction invoiceTypeUI(values: any) {\r\n    let { id, description } = values;\r\n    return <>{description}</>;\r\n}\r\n\r\nfunction invoiceInfoUI(values: any) {\r\n    let { id, title, taxNo, address, telephone, bank, accountNo } = values;\r\n    return <>{title}</>;\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, UiSchema, UiInputItem, Form, Context, tv, BoxId, FA } from 'tonva';\r\nimport { Schema } from 'tonva';\r\nimport { CInvoiceInfo } from './CInvoiceInfo';\r\n\r\nconst schema: Schema = [\r\n    { name: 'id', type: 'id', required: false },\r\n    { name: 'title', type: 'string', required: false },\r\n    { name: 'taxNo', type: 'string', required: false },\r\n    { name: 'address', type: 'id', required: false },\r\n    { name: 'telephone', type: 'string', required: false },\r\n    { name: 'bank', type: 'string', required: false },\r\n    { name: 'accountNo', type: 'string', required: false },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n    items: {\r\n        id: { visible: false },\r\n        title: {\r\n            widget: 'text', label: '', placeholder: '',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 200) ? '200' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        taxNo: {\r\n            widget: 'text', label: '', placeholder: '',\r\n            rules: (value: string) => {\r\n                if (value) {\r\n                    var regArr = [/^[\\da-z]{10,15}$/i, /^\\d{6}[\\da-z]{10,12}$/i, /^[a-z]\\d{6}[\\da-z]{9,11}$/i, /^[a-z]{2}\\d{6}[\\da-z]{8,10}$/i, /^\\d{14}[\\dx][\\da-z]{4,5}$/i, /^\\d{17}[\\dx][\\da-z]{1,2}$/i, /^[a-z]\\d{14}[\\dx][\\da-z]{3,4}$/i, /^[a-z]\\d{17}[\\dx][\\da-z]{0,1}$/i, /^[\\d]{6}[\\da-z]{13,14}$/i],\r\n                        j = regArr.length;\r\n                    for (var i = 0; i < j; i++) {\r\n                        if (regArr[i].test(value)) {\r\n                            return undefined;\r\n                        }\r\n                    }\r\n                    return '';\r\n                }\r\n            }\r\n        } as UiInputItem,\r\n        address: {\r\n            widget: 'text', label: '', placeholder: '',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 200) ? '200' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        telephone: {\r\n            widget: 'text', label: '', placeholder: '',\r\n            rules: (value: string) => {\r\n                if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n                    return \"\";\r\n                else\r\n                    return undefined;\r\n            }\r\n        } as UiInputItem,\r\n        bank: {\r\n            widget: 'text', label: '', placeholder: '',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 100) ? '100' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        accountNo: {\r\n            widget: 'text', label: '', placeholder: '',\r\n            rules: (value: string) => {\r\n                if (value && !/^([1-9]{1})(\\d{14}|\\d{18}|\\d{15})$/.test(value))\r\n                    return \"\";\r\n                else\r\n                    return undefined;\r\n            }\r\n        } as UiInputItem,\r\n        submit: { widget: 'button', label: '' },\r\n    }\r\n}\r\n\r\nconst commonRequired = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: true,\r\n    address: false,\r\n    telephone: false,\r\n    bank: false,\r\n    accountNo: false,\r\n    isDefault: false,\r\n};\r\n\r\nconst valueAddedRequired = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: true,\r\n    address: true,\r\n    telephone: true,\r\n    bank: true,\r\n    accountNo: true,\r\n    isDefault: false,\r\n}\r\n\r\nconst commonVisible = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: true,\r\n    address: false,\r\n    telephone: false,\r\n    bank: false,\r\n    accountNo: false,\r\n    isDefault: true,\r\n};\r\n\r\nconst valueAddedVisible = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: true,\r\n    address: true,\r\n    telephone: true,\r\n    bank: true,\r\n    accountNo: true,\r\n    isDefault: true,\r\n}\r\n\r\nexport class VInvoiceInfo extends VPage<CInvoiceInfo> {\r\n    private form: Form;\r\n    @observable showTip: boolean = false;\r\n    saveTip: string = \"\";\r\n    private invoiceInfoData: any;\r\n\r\n    async open(origInvoice?: any) {\r\n        let { invoiceType, invoiceInfo } = origInvoice;\r\n        this.invoiceType = (invoiceType && invoiceType.id) || 1;\r\n        if (invoiceInfo) {\r\n            invoiceInfo.assure();\r\n            this.invoiceInfoData = { ...invoiceInfo.obj };\r\n        } else {\r\n            this.invoiceInfoData = { 'title': this.controller.cApp.currentUser.defaultOrganizationName };\r\n        }\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onFormButtonClick = async (name: string, context: Context) => {\r\n        let { form } = context;\r\n        let { data } = form;\r\n        let invoice = {\r\n            invoiceType: this.invoiceType,\r\n            invoiceInfo: data,\r\n        };\r\n        this.invoiceInfoData = data;\r\n\r\n        try {\r\n            await this.controller.saveInvoiceInfo(invoice);\r\n            this.saveTip = \"\";\r\n        } catch (error) {\r\n            this.saveTip = \"\";\r\n        }\r\n        this.showTip = true;\r\n        setTimeout(() => { this.showTip = false; }, 2000);\r\n    }\r\n\r\n    private onSaveInvoice = async () => {\r\n        if (!this.form) return;\r\n        await this.form.buttonClick(\"submit\");\r\n    }\r\n\r\n    @observable invoiceType: number;\r\n\r\n    private buildForm(): JSX.Element {\r\n        let requiredFields: any = this.invoiceType === 1 ? commonRequired : valueAddedRequired;\r\n        let visibleFields: any = this.invoiceType === 1 ? commonVisible : valueAddedVisible;\r\n        schema.forEach(e => {\r\n            let { items } = uiSchema;\r\n            e.required = requiredFields[e.name];\r\n            items[e.name].visible = visibleFields[e.name];\r\n        });\r\n        return <Form ref={v => this.form = v} className=\"my-3\"\r\n            schema={schema}\r\n            uiSchema={uiSchema}\r\n            formData={this.invoiceInfoData}\r\n            onButtonClick={this.onFormButtonClick}\r\n            fieldLabelSize={3} />\r\n    }\r\n\r\n    private onInvoiceTypeClick = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.invoiceType = parseInt(event.currentTarget.value);\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let frm = this.buildForm();\r\n\r\n        let tipUI = this.showTip ? (<div className=\"alert alert-primary\" role=\"alert\">\r\n            <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n            {this.saveTip}\r\n        </div>) : null;\r\n        return <Page header=\"\">\r\n            <div className=\"px-3\">\r\n                <div className=\"form-group row py-3 mb-1 bg-white\">\r\n                    <div className=\"col-12 col-sm-3 pb-2 text-muted\">:</div>\r\n                    <div className=\"col-12 col-sm-9\">\r\n                        <div className=\"form-check form-check-inline\">\r\n                            <input className=\"form-check-input\" type=\"radio\" name=\"invoiceType\" id=\"common\" value=\"1\"\r\n                                onChange={(event) => this.onInvoiceTypeClick(event)} checked={this.invoiceType === 1}></input>\r\n                            <label className=\"form-check-label\" htmlFor=\"common\"></label>\r\n                        </div>\r\n                        <div className=\"form-check form-check-inline\">\r\n                            <input className=\"form-check-input\" type=\"radio\" name=\"invoiceType\" id=\"valueAdded\" value=\"2\"\r\n                                onChange={(event) => this.onInvoiceTypeClick(event)} checked={this.invoiceType === 2}></input>\r\n                            <label className=\"form-check-label\" htmlFor=\"valueAdded\"></label>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"p-3 bg-white\">\r\n                {frm}\r\n                <button type=\"button\"\r\n                    className=\"btn btn-primary w-100\"\r\n                    onClick={this.onSaveInvoice}></button>\r\n                {tipUI}\r\n            </div>\r\n        </Page>\r\n    });\r\n}","//import { Controller } from 'tonva';\r\nimport { CUqBase } from '../CBase';\r\nimport { VInvoiceInfo } from './VInvoiceInfo';\r\n//import { CCartApp } from 'CCartApp';\r\n//import { Tuid } from 'tonva';\r\n\r\nexport class CInvoiceInfo extends CUqBase {\r\n    fromOrderCreation: boolean;\r\n\r\n    async internalStart(origInvoice: any, fromOrderCreation: boolean) {\r\n        this.fromOrderCreation = fromOrderCreation;\r\n        this.openVPage(VInvoiceInfo, origInvoice);\r\n    }\r\n\r\n    async saveInvoiceInfo(invoice: any) {\r\n        let { invoiceType, invoiceInfo, isDefault } = invoice;\r\n        let newInvoiceInfo = await this.uqs.customer.InvoiceInfo.save(undefined, invoiceInfo);\r\n\r\n        let { id: newInvoiceInfoId } = newInvoiceInfo;\r\n        let invoiceBox = {\r\n            invoiceType: this.uqs.common.InvoiceType.boxId(invoiceType),\r\n            invoiceInfo: this.uqs.customer.InvoiceInfo.boxId(newInvoiceInfoId),\r\n        }\r\n        // if (isDefault === true || !this.fromOrderCreation) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultInvoice(invoiceBox.invoiceType, invoiceBox.invoiceInfo);\r\n        // }\r\n        if (this.fromOrderCreation) {\r\n            this.backPage();\r\n            this.returnCall(invoiceBox);\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, FA, Page } from 'tonva';\r\nimport { CCoupon } from './CCoupon';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class VCouponEdit extends VPage<CCoupon> {\r\n\r\n    private couponInput: HTMLInputElement;\r\n    @observable tips: string;\r\n    async open(param: any) {\r\n        if (param !== undefined) {\r\n\r\n        }\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private applyCoupon = async () => {\r\n        let coupon = this.couponInput.value;\r\n        if (!coupon)\r\n            return;\r\n        let ret = await this.controller.applyCoupon(coupon);\r\n        switch (ret) {\r\n            case -1:\r\n                this.tips = '';\r\n                break;\r\n            case 1:\r\n                this.tips = '';\r\n                break;\r\n            case 0:\r\n            case 2:\r\n            case 3:\r\n            case 5:\r\n                this.tips = '';\r\n                break;\r\n            case 6:\r\n                this.tips = '';\r\n                break;\r\n            case 4:\r\n                this.tips = '';\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        if (this.tips)\r\n            setTimeout(() => this.tips = undefined, GLOABLE.TIPDISPLAYTIME);\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let tipsUI = <></>;\r\n        if (this.tips) {\r\n            tipsUI = <div className=\"alert alert-primary\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {this.tips}\r\n            </div>\r\n        }\r\n        return <Page header=\"\">\r\n            <div className=\"px-2 bg-white\">\r\n                <div className=\"row py-3 pr-3 my-1\">\r\n                    <div className=\"col-4 col-sm-2 pb-2 text-muted\">:</div>\r\n                    <div className=\"col-8 col-sm-10 d-flex\">\r\n                        <input ref={v => this.couponInput = v} type=\"number\" className=\"form-control\"></input>\r\n                    </div>\r\n                </div>\r\n                <div className=\"row my-1\">\r\n                    <div className=\"col-12\">\r\n                        <button className=\"btn btn-primary w-100\" onClick={this.applyCoupon}></button>\r\n                    </div>\r\n                </div>\r\n                {tipsUI}\r\n            </div>\r\n        </Page>\r\n    })\r\n}","//import { Controller, Action } from 'tonva';\r\n//import { CCartApp } from 'CCartApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VCouponEdit } from './VCouponEdit';\r\n\r\nexport class CCoupon extends CUqBase {\r\n\r\n    applyCoupon = async (coupon: string) => {\r\n\r\n        let { currentCustomer } = this.cApp.currentUser;\r\n        let validationResult = await this.uqs.salesTask.IsCanUseCoupon.submit({ code: coupon, customer: currentCustomer && currentCustomer.id });\r\n        let rtn = validationResult.result;\r\n        if (rtn === 1) {\r\n            this.returnCall(validationResult);\r\n            this.closePage();\r\n        }\r\n        return rtn;\r\n    }\r\n\r\n    protected async internalStart(param: any) {\r\n        this.openVPage(VCouponEdit);\r\n    }\r\n}","import { observable } from 'mobx';\r\nimport { BoxId } from 'tonva';\r\nimport { nav } from 'tonva';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VCreateOrder } from './VCreateOrder';\r\nimport { Order, OrderItem } from './Order';\r\nimport { OrderSuccess } from './OrderSuccess';\r\nimport { CSelectShippingContact, CSelectInvoiceContact } from '../customer/CSelectContact';\r\nimport { VMyOrders } from './VMyOrders';\r\nimport { VOrderDetail } from './VOrderDetail';\r\nimport { CInvoiceInfo } from '../customer/CInvoiceInfo';\r\nimport { groupByProduct } from '../tools/groupByProduct';\r\nimport { CCoupon } from './CCoupon';\r\nimport { CartItem2 } from '../cart/Cart';\r\n\r\nconst FREIGHTFEEFIXED = 12;\r\nconst FREIGHTFEEREMITTEDSTARTPOINT = 100;\r\n\r\nexport class COrder extends CUqBase {\r\n    //    cApp: CApp;\r\n    @observable orderData: Order = new Order();\r\n    @observable couponData: any = {};\r\n\r\n    protected async internalStart(param: any) {\r\n        let cart = param;\r\n        await this.createOrderFromCart(cart);\r\n        this.openVPage(VCreateOrder);\r\n    }\r\n\r\n    private createOrderFromCart = async (cartItems: CartItem2[]) => {\r\n        let { currentUser, currentSalesRegion } = this.cApp;\r\n        this.orderData.webUser = currentUser.id;\r\n        this.orderData.salesRegion = currentSalesRegion.id;\r\n        this.removeCoupon();\r\n        if (currentUser.currentCustomer !== undefined) {\r\n            this.orderData.customer = currentUser.currentCustomer.id;\r\n        }\r\n\r\n        if (this.orderData.shippingContact === undefined) {\r\n            this.orderData.shippingContact = await this.getDefaultShippingContact();\r\n        }\r\n\r\n        if (this.orderData.invoiceContact === undefined) {\r\n            this.orderData.invoiceContact = await this.getDefaultInvoiceContact();\r\n        }\r\n\r\n        if (this.orderData.invoiceType === undefined) {\r\n            this.orderData.invoiceType = await this.getDefaultInvoiceType();\r\n        }\r\n\r\n        if (this.orderData.invoiceInfo === undefined) {\r\n            this.orderData.invoiceInfo = await this.getDefaultInvoiceInfo();\r\n        }\r\n\r\n        if (cartItems !== undefined && cartItems.length > 0) {\r\n            this.orderData.currency = cartItems[0].packs[0].currency;\r\n            this.orderData.orderItems = cartItems.map((e: any) => {\r\n                var item = new OrderItem();\r\n                item.product = e.product;\r\n                item.packs = e.packs.map((v: any) => { return { ...v } }).filter((v: any) => v.quantity > 0 && v.price);\r\n                item.packs.forEach((pk) => {\r\n                    pk.retail = pk.price;\r\n                })\r\n                return item;\r\n            });\r\n\r\n            // \r\n            this.orderData.freightFee = FREIGHTFEEFIXED;\r\n            if (this.orderData.productAmount > FREIGHTFEEREMITTEDSTARTPOINT)\r\n                this.orderData.freightFeeRemitted = FREIGHTFEEFIXED * -1;\r\n        }\r\n    }\r\n\r\n    private defaultSetting: any;\r\n    private async getDefaultSetting() {\r\n        if (this.defaultSetting) return this.defaultSetting;\r\n        let { currentUser } = this.cApp;\r\n        return this.defaultSetting = await currentUser.getSetting() || {};\r\n    }\r\n\r\n    private contact0: BoxId;\r\n    private async getContact(): Promise<BoxId> {\r\n        if (this.contact0 === null) return;\r\n        if (this.contact0 !== undefined) return this.contact0;\r\n        let { currentUser } = this.cApp;\r\n        let contactArr = await currentUser.getContacts();\r\n        if (contactArr === undefined || contactArr.length === 0) {\r\n            this.contact0 = null;\r\n            return;\r\n        }\r\n        return this.contact0 = contactArr[0].contact;\r\n    }\r\n\r\n    private async getDefaultShippingContact() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.shippingContact || await this.getContact();\r\n    }\r\n\r\n    private async getDefaultInvoiceContact() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceContact || await this.getContact();\r\n    }\r\n\r\n    private async getDefaultInvoiceType() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceType;\r\n    }\r\n\r\n    private async getDefaultInvoiceInfo() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceInfo;\r\n    }\r\n\r\n    submitOrder = async () => {\r\n        let { orderItems } = this.orderData;\r\n\r\n        let result: any = await this.uqs.order.Order.save(\"order\", this.orderData.getDataForSave());\r\n        await this.uqs.order.Order.action(result.id, result.flow, result.state, \"submit\");\r\n\r\n        let param: [{ productId: number, packId: number }] = [] as any;\r\n        orderItems.forEach(e => {\r\n            e.packs.forEach(v => {\r\n                param.push({ productId: e.product.id, packId: v.pack.id })\r\n            })\r\n        });\r\n        let { cart } = this.cApp;\r\n        cart.removeFromCart(param);\r\n\r\n        // \r\n        nav.popTo(this.cApp.topKey);\r\n        this.openVPage(OrderSuccess, result);\r\n    }\r\n\r\n    onSelectShippingContact = async () => {\r\n        let cSelect = this.newC(CSelectShippingContact);\r\n        let contactBox = await cSelect.call<BoxId>(true);\r\n        this.orderData.shippingContact = contactBox;\r\n    }\r\n\r\n    onSelectInvoiceContact = async () => {\r\n        let cSelect = this.newC(CSelectInvoiceContact);\r\n        let contactBox = await cSelect.call<BoxId>(true);\r\n        this.orderData.invoiceContact = contactBox;\r\n    }\r\n\r\n    onCouponEdit = async () => {\r\n        let cCoupon = this.newC(CCoupon); // new CCoupon(this.cApp, undefined);\r\n        let coupon = await cCoupon.call<any>(this.orderData.coupon);\r\n        if (coupon) {\r\n            await this.applyCoupon(coupon);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    applyCoupon = async (coupon: any) => {\r\n\r\n        let { id, code, discount, preferential, validitydate, isValid } = coupon;\r\n        if (code !== undefined && isValid === 1 && new Date(validitydate).getTime() > Date.now()) {\r\n            this.orderData.coupon = id;\r\n            this.couponData = coupon;\r\n            if (discount) {\r\n                // this.orderData.couponOffsetAmount = Math.round(this.orderData.productAmount * discount) * -1;\r\n                let { orderItems } = this.orderData;\r\n                if (orderItems !== undefined && orderItems.length > 0) {\r\n                    let promises: PromiseLike<any>[] = [];\r\n                    orderItems.forEach(e => {\r\n                        promises.push(this.uqs.product.AgentPrice.table({ product: e.product.id, salesRegion: this.cApp.currentSalesRegion.id }));\r\n                    });\r\n                    let agentPrices = await Promise.all(promises);\r\n                    if (agentPrices && agentPrices.length > 0) {\r\n                        let couponOffsetAmount = 0;\r\n                        for (let i = 0; i < orderItems.length; i++) {\r\n                            let oi = orderItems[i];\r\n                            let { product, packs } = oi;\r\n                            let eachProductAgentPrice = agentPrices[i];\r\n                            for (let j = 0; j < packs.length; j++) {\r\n                                let pk = packs[j];\r\n                                let agentPrice: any = eachProductAgentPrice.find(\r\n                                    (p: any) => p.product.id === product.id &&\r\n                                        p.pack.id === pk.pack.id &&\r\n                                        p.discountinued === 0 &&\r\n                                        p.expireDate > Date.now());\r\n                                if (!agentPrice) break;\r\n                                pk.price = Math.round(Math.max(agentPrice.agentPrice, pk.retail * (1 - discount)));\r\n                                couponOffsetAmount += Math.round(pk.quantity * (pk.retail - pk.price) * -1);\r\n                                /*\r\n                                if (agentPrice) {\r\n                                    pk.price = Math.round(agentPrice.retail * (1 - discount));\r\n                                }\r\n                                */\r\n                            };\r\n                        };\r\n                        this.orderData.couponOffsetAmount = Math.round(couponOffsetAmount);\r\n                    };\r\n                }\r\n            }\r\n            if (preferential) {\r\n                this.orderData.couponRemitted = preferential * -1;\r\n            }\r\n            // \r\n            this.orderData.freightFee = FREIGHTFEEFIXED;\r\n            if (this.orderData.productAmount > FREIGHTFEEREMITTEDSTARTPOINT)\r\n                this.orderData.freightFeeRemitted = FREIGHTFEEFIXED * -1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    removeCoupon = () => {\r\n        this.orderData.coupon = undefined;\r\n        this.couponData = {};\r\n        this.orderData.couponOffsetAmount = 0;\r\n        this.orderData.couponRemitted = 0;\r\n    }\r\n\r\n\r\n    /*\r\n    * \r\n    */\r\n    openMyOrders = async (state: string) => {\r\n\r\n        this.openVPage(VMyOrders, state);\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    getMyOrders = async (state: string) => {\r\n\r\n        switch (state) {\r\n            case 'pendingpayment':\r\n                return await this.uqs.order.GetPendingPayment.table(undefined);\r\n                break;\r\n            case 'processing':\r\n                return await this.uqs.order.Order.mySheets(undefined, 1, -20);\r\n                break;\r\n            default:\r\n                return await this.uqs.order.Order.mySheets(\"#\", 1, -20)\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    onInvoiceInfoEdit = async () => {\r\n        let cInvoiceInfo = this.newC(CInvoiceInfo); // new CInvoiceInfo(this.cApp, undefined, true);\r\n        let { invoiceType, invoiceInfo } = this.orderData;\r\n        let origInvoice = {\r\n            invoiceType: invoiceType,\r\n            invoiceInfo: invoiceInfo,\r\n        }\r\n        let newInvoice = await cInvoiceInfo.call<any>(origInvoice, true);\r\n        this.orderData.invoiceType = newInvoice.invoiceType;\r\n        this.orderData.invoiceInfo = newInvoice.invoiceInfo;\r\n    }\r\n\r\n    openOrderDetail = async (orderId: number) => {\r\n\r\n        let order = await this.uqs.order.Order.getSheet(orderId);\r\n        let { data } = order;\r\n        let { orderitems } = data;\r\n        let orderItemsGrouped = groupByProduct(orderitems);\r\n        data.orderItems = orderItemsGrouped;\r\n        this.openVPage(VOrderDetail, order);\r\n    }\r\n\r\n    openMeInfo = async () => {\r\n        let { cMe } = this.cApp;\r\n        await cMe.openMeInfoFirstOrder();\r\n    }\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderDeliveryTime(pack);\r\n    }\r\n\r\n    renderOrderItemProduct = (product: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderCartProduct(product);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { View, tv } from 'tonva';\r\nimport { CProductCategory } from './CProductCategory';\r\nimport { FA } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nconst imgStyle: React.CSSProperties = {\r\n    height: '1.5rem', width: '1.5rem',\r\n    marginLeft: '0.1rem',\r\n    marginRight: '0.3rem'\r\n}\r\n\r\nexport const titleTitle: React.CSSProperties = {\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n    whiteSpace: 'nowrap',\r\n}\r\n\r\nexport const subStyle: React.CSSProperties = {\r\n    fontSize: '0.75rem',\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n    whiteSpace: 'nowrap',\r\n}\r\n\r\nexport class VRootCategory extends View<CProductCategory> {\r\n\r\n    private categoryClick = async (categoryWapper: any, parent: any, labelColor: string) => {\r\n        await this.controller.openMainPage(categoryWapper, parent, labelColor);\r\n    }\r\n\r\n    private renderRootCategory = (item: any, parent: any) => {\r\n        let { name, children, productCategory } = item;\r\n        let { id: productCategoryID } = productCategory;\r\n        let { src, labelColor } = GLOABLE.ROOTCATEGORY[productCategoryID];\r\n        return <div className=\"bg-white mb-3\" key={name}>\r\n            <div className=\"py-2 px-3 cursor-pointer\" onClick={() => this.categoryClick(item, undefined, labelColor)}>\r\n                <img className=\"mr-5\" src={src} alt={name} style={{ height: \"2.5rem\", width: \"2.5rem\" }} />\r\n                <b>{name}</b>\r\n            </div>\r\n            <div className=\"\"\r\n                style={{ paddingRight: '1px' }}\r\n            >\r\n                <div className=\"row no-gutters\">\r\n                    {children.map((v: any) => this.renderSubCategory(v, item, labelColor))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    private renderSubCategory = (item: any, parent: any, labelColor: string) => {\r\n        let { name, children, total } = item;\r\n        return <div key={name}\r\n            className=\"col-6 col-md-4 col-lg-3 cursor-pointer\"\r\n            onClick={() => this.categoryClick(item, parent, labelColor)}>\r\n            <div className=\"py-2 px-2\"\r\n                style={{ border: '1px solid #eeeeee', marginRight: '-1px', marginBottom: '-1px' }}\r\n            >\r\n                <div style={titleTitle}>\r\n                    <span className=\"ml-1 align-middle\">\r\n                        <FA name=\"chevron-circle-right\" className={labelColor} />\r\n                        &nbsp; {name}\r\n                    </span>\r\n                </div>\r\n                {renderThirdCategory(children, total)}\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    render(param: any): JSX.Element {\r\n        return <this.content />\r\n    }\r\n\r\n    private content = observer(() => {\r\n        let { categories, categories2 } = this.controller;\r\n        return <>{categories.map((v: any) => this.renderRootCategory(v, undefined))}</>;\r\n        // return <>{categories2.map(v => <div key={v.productCategory.id}>{tv(v, e => this.renderRoot(e))}</div>)}</>;\r\n    });\r\n\r\n    private renderRoot(root: any) {\r\n        let { productCategory } = root;\r\n        let { id } = productCategory;\r\n        console.log(id);\r\n        return <div key={id}>{id}</div>\r\n    }\r\n}\r\n\r\n\r\nexport function renderThirdCategory(items: any, total: number) {\r\n    return <div className=\"py-1 px-1 text-muted small\" style={subStyle}>\r\n        {items.length === 0 ? <>: {total > 1000 ? '>1000' : total}</> : items.map((v: any) => v.name).join(' / ')}\r\n    </div>\r\n}","import * as React from 'react';\r\nimport { CProductCategory } from './CProductCategory';\r\nimport { VPage, Page } from 'tonva';\r\nimport { List, FA } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { titleTitle, subStyle, renderThirdCategory } from './VRootCategory';\r\n\r\nexport class VCategory extends VPage<CProductCategory> {\r\n\r\n    async open(categoryWaper: any) {\r\n\r\n        this.openPage(this.page, categoryWaper);\r\n    }\r\n\r\n    private renderChild = (childWapper: any) => {\r\n\r\n        return <div className=\"py-2\"><FA name=\"hand-o-right mr-2\"></FA>{childWapper.name}</div>\r\n    }\r\n\r\n    private categoryClick = async (childWapper: any, parent: any, labelColor: string) => {\r\n        await this.controller.openMainPage(childWapper, parent, labelColor);\r\n    }\r\n\r\n    private breadCrumb = (item: any, parent: any) => {\r\n        return <nav arial-babel=\"breadcrumb\">\r\n            <ol className=\"breadcrumb\">\r\n                {tv(item, this.breadCrumbItem)}\r\n            </ol>\r\n        </nav>\r\n\r\n    }\r\n\r\n    private breadCrumbItem = (values: any, parent: any) => {\r\n        if (values === undefined || values.productCategory === undefined)\r\n            return <></>;\r\n        return <>\r\n            {tv(values.productCategory.parent, this.breadCrumbItem)}\r\n            <li className=\"breadcrumb-item\" onClick={() => this.categoryClick(values, undefined, \"\")}>{values.name}</li>\r\n        </>\r\n    }\r\n\r\n    private renderRootCategory = (item: any, parent: any, labelColor: string) => {\r\n        let { productCategory, name, children } = item;\r\n        return <div className=\"bg-white mb-3\" key={name}>\r\n            <div className=\"py-2 px-3 cursor-pointer\" onClick={() => this.categoryClick(item, parent, labelColor)}>\r\n                <b>{name}</b>\r\n            </div>\r\n            <div className=\"\"\r\n                style={{ paddingRight: '1px' }}\r\n            >\r\n                <div className=\"row no-gutters\">\r\n                    {children.map((v: any) => this.renderSubCategory(v, item, labelColor))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    private renderSubCategory = (item: any, parent: any, labelColor: string) => {\r\n        let { name, children, total } = item;\r\n        return <div key={name}\r\n            className=\"col-6 col-md-4 col-lg-3 cursor-pointer\"\r\n            onClick={() => this.categoryClick(item, parent, labelColor)}>\r\n            <div className=\"py-2 px-2\"\r\n                style={{ border: '1px solid #eeeeee', marginRight: '-1px', marginBottom: '-1px' }}\r\n            >\r\n                <div style={titleTitle}>\r\n                    <span className=\"ml-1 align-middle\">\r\n                        <FA name=\"chevron-circle-right\" className={labelColor} />\r\n                        &nbsp; {name}\r\n                    </span>\r\n                </div>\r\n                {renderThirdCategory(children, total)}\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private page = (categoryWaper: any) => {\r\n\r\n        let { cHome } = this.controller.cApp;\r\n        let header = cHome.renderSearchHeader();\r\n        let cartLabel = this.controller.cApp.cCart.renderCartLabel();\r\n\r\n        let { categoryWaper: item, parent, labelColor } = categoryWaper;\r\n        return <Page header={header} right={cartLabel}>\r\n            {this.renderRootCategory(item, parent, labelColor)}\r\n        </Page>\r\n    }\r\n}","import { observable } from 'mobx';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VRootCategory } from './VRootCategory';\r\nimport { VCategory } from './VCategory';\r\n\r\nexport class CProductCategory extends CUqBase {\r\n\r\n    //    cApp: CApp;\r\n    @observable categories: any[] = [];\r\n    @observable categories2: any[] = [];\r\n\r\n    async internalStart(param: any) {\r\n        let { currentSalesRegion, currentLanguage } = this.cApp;\r\n        let results = await this.uqs.product.GetRootCategory.query({ salesRegion: currentSalesRegion.id, language: currentLanguage.id });\r\n        this.categories = results.first;\r\n        this.categories.forEach(element => {\r\n            this.buildCategories(element, results.secend, results.third);\r\n        })\r\n        /*\r\n        let result2 = await this.getRootCategoriesQuery.query({ salesRegion: currentSalesRegion.id, language: currentLanguage.id });\r\n        if (result2)\r\n            this.categories2 = result2.ret;\r\n        */\r\n    }\r\n\r\n    renderRootList = () => {\r\n        return this.renderView(VRootCategory);\r\n    };\r\n\r\n    async getCategoryChildren(parentCategoryId: number) {\r\n        let { currentSalesRegion, currentLanguage } = this.cApp;\r\n        return await this.uqs.product.GetChildrenCategory.query({ parent: parentCategoryId, salesRegion: currentSalesRegion.id, language: currentLanguage.id });\r\n    }\r\n\r\n    async buildCategories(categoryWapper: any, firstCategory: any, secendCategory: any) {\r\n        firstCategory.forEach(async (element: any) => {\r\n            element.children = secendCategory.filter((v: any) => v.parent === element.productCategory.id);\r\n        });\r\n        categoryWapper.children = firstCategory.filter((v: any) => v.parent === categoryWapper.productCategory.id);\r\n    }\r\n\r\n    async openMainPage(categoryWaper: any, parent: any, labelColor: string) {\r\n\r\n        let { productCategory, name } = categoryWaper;\r\n        let { id: productCategoryId } = productCategory;\r\n        let results = await this.getCategoryChildren(productCategoryId);\r\n        if (results.first.length !== 0) {\r\n            this.buildCategories(categoryWaper, results.first, results.secend);\r\n            this.openVPage(VCategory, { categoryWaper, parent, labelColor });\r\n        } else {\r\n            let { cProduct } = this.cApp;\r\n            await cProduct.searchByCategory({ productCategoryId, name });\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Image } from 'tonva';\r\nimport { CMember } from './CMember';\r\nimport { LMR, Muted, FA, Media } from 'tonva';\r\nimport pig from '../images/pig.png';\r\nimport { observer } from 'mobx-react';\r\n\r\nconst stylePig: React.CSSProperties = {\r\n    width: '100%',\r\n    height: '20rem',\r\n    backgroundImage: `url(${pig})`,\r\n    backgroundSize: 'contain',\r\n    backgroundColor: 'rgba(255,255,255,0.1)',\r\n    opacity: 0.09,\r\n    position: 'absolute',\r\n}\r\n\r\nexport class VMember extends VPage<CMember> {\r\n    private recommendationCodeRef = React.createRef<HTMLInputElement>();\r\n\r\n    async open(param: any) {\r\n\r\n    }\r\n\r\n    render(member: any): JSX.Element {\r\n\r\n        return <this.content />;\r\n    }\r\n\r\n    private submitRecommendationCode() {\r\n        let code = this.recommendationCodeRef.current.value;\r\n        if (code) {\r\n            let { setReferrer: submit } = this.controller;\r\n            submit(code);\r\n        }\r\n    }\r\n\r\n    private content = observer(() => {\r\n        let { cApp, member } = this.controller;\r\n        if (member === undefined)\r\n            return <></>;\r\n        let { currentUser } = cApp;\r\n        let { recommendationCode, point } = member;\r\n        if (!point) point = 0;\r\n\r\n        let im = <Image className=\"mr-3 w-3c h-3c\" src={currentUser.icon} />;\r\n        let inviteCode = <div className=\"small\">: {recommendationCode}</div>;\r\n\r\n        let divPoints = <div className=\"my-3 text-center bg-white h-25\" style={{ position: 'relative' }}>\r\n            <div className=\"w-100 bg-white h-20c\" style={{ position: 'absolute' }} />\r\n            <div className=\"d-flex align-items-center justify-content-center\" style={stylePig} />\r\n            <div className=\"w-100 d-flex align-items-center justify-content-center h-20c\" style={{ position: 'absolute' }}>\r\n                <div className=\"muted mr-3 small\">: </div>\r\n                <div className=\"text-danger\" style={{ fontSize: '2rem' }}>{point}</div>\r\n            </div>\r\n        </div>\r\n\r\n        let pointTitle = <p className=\"h4\"></p>\r\n        let pointDetail = <p className=\"small align-self-end\"> <FA name=\"angle-right\"></FA></p>\r\n        let pointThisWeek = <><p className=\"h5 mb-0\">0</p><Muted></Muted></>\r\n        let pointAll = <><p className=\"h5 mb-0\">{point}</p><Muted></Muted></>\r\n\r\n        let fansTitle = <p></p>\r\n        let fansDetail = <p className=\"small align-self-end\"> <FA name=\"angle-right\"></FA></p>;\r\n        let detail = <div className=\"shadow bg-white rounded p-3 mb-1\">\r\n            <LMR left={fansTitle} right={fansDetail}></LMR>\r\n            <LMR className=\"pb-2\">\r\n                <p className=\"h4 mb-0\">0</p>\r\n                <Muted></Muted>\r\n            </LMR>\r\n            <LMR left={pointThisWeek} right={pointAll} />\r\n            <LMR>\r\n                <input type=\"text\" className=\"form-control\" ref={this.recommendationCodeRef} />\r\n                <button type=\"button\" className=\"btn btn-primary\" onClick={() => this.submitRecommendationCode()}></button>\r\n            </LMR>\r\n        </div>;\r\n\r\n        return <div>\r\n            <LMR className=\"bg-white p-3 mb-1 align-items-center\"\r\n                left={im} right={inviteCode}>\r\n                <b>{currentUser.name}</b>\r\n            </LMR>\r\n            {divPoints}\r\n            {/*detail*/}\r\n        </div>\r\n    })\r\n}\r\n/*\r\n<div className=\"shadow bg-white rounded p-3 mb-1\">\r\n<LMR left={pointTitle} right={pointDetail}></LMR>\r\n<LMR className=\"pb-2\">\r\n    <p className=\"h4 mb-0\">0</p>\r\n    <Muted></Muted>\r\n</LMR>\r\n<LMR left={pointThisWeek} right={pointAll} />\r\n</div>\r\n*/","import * as React from 'react';\r\n//import Loadable from 'react-loadable';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { FA } from 'tonva';\r\nimport { Controller, Loading, nav } from 'tonva';\r\nimport { Action, Map, BoxId } from 'tonva';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VMember } from './VMember';\r\n//import { CCartApp } from 'CCartApp';\r\n//import { jnkTop } from 'me/loginTop';\r\n\r\nexport class CMember extends CUqBase {\r\n\r\n    //cApp: CCartApp;\r\n    //    cApp: CApp;\r\n    @observable member: any;\r\n    private referrer: BoxId;\r\n\r\n    protected async internalStart(param: any) {\r\n\r\n        if (this.isLogined) {\r\n            let { member } = this.uqs;\r\n            let { id: currentUserId } = this.user;\r\n            let promises: PromiseLike<any>[] = [];\r\n            promises.push(member.MemberAction.submit({}));\r\n            promises.push(member.MemberRecommender.table({ referrer: currentUserId }));\r\n            promises.push(member.MemberRecommender.table({ member: currentUserId }));\r\n            let result = await Promise.all(promises);\r\n            let { code, point } = result[0];\r\n            this.referrer = result[2];\r\n            this.member = { recommendationCode: code, point: point, fans: result[1], referrer: result[2] };\r\n        }\r\n    }\r\n\r\n    private loginCallback = async () => {\r\n        nav.pop();\r\n        await this.internalStart(undefined);\r\n    }\r\n\r\n    render = observer(() => {\r\n        if (this.isLogined) {\r\n            return this.member === undefined ? <Loading /> : this.renderView(VMember);\r\n        } else {\r\n            return <div\r\n                className=\"d-flex h-100 flex-column align-items-center justify-content-center\">\r\n                <div className=\"flex-fill\" />\r\n                <button className=\"btn btn-success w-20c\"\r\n                    onClick={() => nav.showLogin(this.loginCallback, true)}>\r\n                    <FA name=\"sign-out\" size=\"lg\" /> \r\n                </button>\r\n                <div className=\"flex-fill\" />\r\n                <div className=\"flex-fill\" />\r\n            </div>;\r\n        }\r\n    })\r\n\r\n    tab = () => {\r\n        this.start();\r\n        return <this.render />;\r\n    }\r\n\r\n    setReferrer(code: string) {\r\n        if (code) {\r\n            // mapadd\r\n            // \r\n            // idACTION\r\n            if (!this.referrer) {\r\n                let { id: currentUserId } = this.user;\r\n            }\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page, nav } from 'tonva';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport logo from '../images/logo.png';\r\n\r\nconst content = `<p>\r\n\r\n200,000 </p>\r\n<p>J&KAmethystJ&K Scientific \r\n30,000 \r\n600,000 \r\n\r\n</p>\r\n<p>\r\n\r\n\r\n</p>\r\n`\r\n\r\nexport class About extends React.Component {\r\n    render() {\r\n        let right = null;\r\n        return <Page header=\"\" right={right}>\r\n            <div className='bg-white p-3'>\r\n                <img className=\"h-3c position-absolute\" src={logo} />\r\n                <div className=\"h3 flex-fill text-center\">\r\n                    <span className=\"text-primary mr-3\"></span>\r\n                </div>\r\n                <ReactMarkdown className=\"mt-5\" source={content} escapeHtml={false} />\r\n            </div>\r\n        </Page>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport {\r\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema,\r\n    VPage, UiRadio, IdSchema, UiIdItem, Context, BoxId, tv\r\n} from 'tonva';\r\nimport { CMe } from './CMe';\r\nimport {\r\n    faxValidation, emailValidation, mobileValidation, telephoneValidation,\r\n    addressDetailValidation, zipCodeValidation,\r\n    organizationNameValidation, departmentNameValidation,\r\n    salutationValidation, nameValidation\r\n} from '../tools/inputValidations';\r\n\r\nexport class EditMeInfo extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '', placeholder: '' } as UiTextItem,\r\n            icon: { widget: 'image', label: '' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    @observable private webUserData: any;\r\n\r\n    @observable private webUserContactData: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n\r\n        let { cApp } = this.controller;\r\n        let { firstName, gender, salutation, organizationName, departmentName, telephone\r\n            , mobile, email, fax, zipCode, address, addressString } = cApp.currentUser;\r\n        this.webUserData = {\r\n            firstName: firstName,\r\n            gender: gender,\r\n            salutation: salutation,\r\n            organizationName: organizationName,\r\n            departmentName: departmentName,\r\n        };\r\n\r\n        this.webUserContactData = {\r\n            telephone: telephone,\r\n            mobile: mobile,\r\n            email: email,\r\n            fax: fax,\r\n            address: address,\r\n            addressString: addressString,\r\n            zipCode: zipCode,\r\n        }\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        (nav.user as any)[name] = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n    private onWebUserChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserData[name] = newValue;\r\n        await this.controller.changeWebUser(this.webUserData);\r\n    }\r\n\r\n    private onWebUserContactChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserContactData[name] = newValue;\r\n        await this.controller.changeWebUserContact(this.webUserContactData);\r\n    }\r\n\r\n    private page = () => {\r\n        let { schema, uiSchema, data, onItemChanged, webUserData, onWebUserChanged, webUserContactData, onWebUserContactChanged, controller } = this;\r\n        return <Page header=\"\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n            <Edit schema={webUserSchema} uiSchema={webUserUiSchema}\r\n                data={webUserData}\r\n                onItemChanged={onWebUserChanged} />\r\n            <Edit schema={webUserContactSchema} uiSchema={webUserContactUiSchema(controller.pickAddress)}\r\n                data={webUserContactData}\r\n                onItemChanged={onWebUserContactChanged} />\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\nexport const webUserUiSchema: UiSchema = {\r\n    items: {\r\n        firstName: {\r\n            widget: 'text', label: '',\r\n            placeholder: '',\r\n            rules: nameValidation\r\n        } as UiTextItem,\r\n        gender: { widget: 'radio', label: '', list: [{ value: '1', title: '' }, { value: '0', title: '' }] } as UiRadio,\r\n        salutation: { widget: 'text', label: '', rules: salutationValidation } as UiTextItem,\r\n        organizationName: { widget: 'text', label: '', rules: organizationNameValidation } as UiTextItem,\r\n        departmentName: { widget: 'text', label: '', rules: departmentNameValidation } as UiTextItem,\r\n    }\r\n}\r\n\r\n// \r\nexport const webUserContactSchema: ItemSchema[] = [\r\n    { name: 'telephone', type: 'string' } as StringSchema,\r\n    { name: 'mobile', type: 'string', required: true } as StringSchema,\r\n    { name: 'email', type: 'string' } as StringSchema,\r\n    { name: 'fax', type: 'string', required: false } as StringSchema,\r\n    { name: 'address', type: 'id', required: false } as IdSchema,\r\n    { name: 'addressString', type: 'string', required: false } as StringSchema,\r\n    { name: 'zipCode', type: 'string', required: false } as StringSchema,\r\n];\r\n\r\nexport function webUserContactUiSchema(pickAddress: any) {\r\n    return {\r\n        items: {\r\n            telephone: { widget: 'text', label: '', rules: telephoneValidation } as UiTextItem,\r\n            mobile: { widget: 'text', label: '', rules: mobileValidation } as UiTextItem,\r\n            email: { widget: 'text', label: 'Email', rules: emailValidation, placeholder: 'Email' } as UiTextItem,\r\n            fax: { widget: 'text', label: '', rules: faxValidation } as UiTextItem,\r\n            address: {\r\n                widget: 'id', label: '',\r\n                pickId: async (context: Context, name: string, value: number) => await pickAddress(context, name, value),\r\n                Templet: (address: BoxId) => {\r\n                    if (!address) return <small className=\"text-muted\">()</small>;\r\n                    return tv(address, (addressValue) => {\r\n                        let { country, province, city, county } = addressValue;\r\n                        /* tvtvbug, Henry */\r\n                        return <>\r\n                            {country !== undefined && country.id !== undefined && tv(country, v => <>{v.chineseName}</>)}\r\n                            {province !== undefined && province.id !== undefined && tv(province, (v) => <>{v.chineseName}</>)}\r\n                            {city !== undefined && city.id !== undefined && tv(city, (v) => <>{v.chineseName}</>)}\r\n                            {county !== undefined && county.id !== undefined && tv(county, (v) => <>{v.chineseName}</>)}\r\n                        </>;\r\n                    }, () => {\r\n                        return <small className=\"text-muted\"></small>;\r\n                    })\r\n                }\r\n            } as UiIdItem,\r\n            addressString: { widget: 'text', label: '', rules: addressDetailValidation } as UiTextItem,\r\n            zipCode: { widget: 'text', label: '', rules: zipCodeValidation } as UiTextItem,\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page } from 'tonva';\r\nimport logo from '../images/logo.png';\r\nimport { appConfig } from 'configuration';\r\n\r\nexport class AboutThisApp extends React.Component {\r\n    render() {\r\n        let right = null;\r\n        return <Page header=\"APP\" right={right}>\r\n            <div className='bg-white p-3'>\r\n                <div className=\"h3 flex-fill text-center\">\r\n                    <img src={logo} />\r\n                </div>\r\n                <div className=\"h3 flex-fill text-center\">\r\n                    <span className=\"text-primary mr-3\">APP</span>\r\n                </div>\r\n                <div className=\"h3 flex-fill text-center small\">\r\n                    <span className=\"text-muted mr-3\">V{appConfig.version}</span>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { nav, User, Page, Image, VPage } from 'tonva';\r\nimport { Prop, Media, IconText, FA, PropGrid, LMR } from 'tonva';\r\nimport { About } from './about';\r\nimport { observer } from 'mobx-react';\r\nimport { EditMeInfo } from './EditMeInfo';\r\nimport { CMe } from './CMe';\r\nimport { AboutThisApp } from './aboutThisApp';\r\nimport { appConfig } from 'configuration';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\r\n    async open(param?: any) {\r\n\r\n    }\r\n\r\n    private exit() {\r\n        nav.showLogout();\r\n    }\r\n\r\n    private about = () => nav.push(<About />);\r\n    private aboutThisApp = () => nav.push(<AboutThisApp />);\r\n\r\n    private changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private openContactList = async () => {\r\n        this.controller.openContactList();\r\n    }\r\n\r\n    private openInvoice = async () => {\r\n        this.controller.openInvoice();\r\n    }\r\n\r\n    private meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) return null;\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={() => {\r\n                this.openVPage(EditMeInfo);\r\n            }}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n    private orderStates = () => {\r\n\r\n        let { openMyOrders } = this.controller;\r\n        return <div className=\"d-flex justify-content-around w-100 my-3\">\r\n            <div className=\"d-flex flex-column align-items-center\" onClick={() => openMyOrders('pendingpayment')}>\r\n                <FA name=\"file-text-o\" className=\"text-info fa-2x\" />\r\n                <small></small>\r\n            </div>\r\n            <div className=\"d-flex flex-column align-items-center\" onClick={() => openMyOrders('processing')}>\r\n                <FA name=\"file-text-o\" className=\"text-info fa-2x\" />\r\n                <small></small>\r\n            </div>\r\n            <div className=\"d-flex flex-column align-items-center\" onClick={() => openMyOrders('completed')}>\r\n                <FA name=\"file-text-o\" className=\"text-info fa-2x\" />\r\n                <small></small>\r\n            </div>\r\n        </div>\r\n    };\r\n\r\n    render() {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text=\"\" />,\r\n                onClick: this.about\r\n            },\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <div className=\"w-100 d-flex justify-content-between\" onClick={this.aboutThisApp}>\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text=\"APP\" />\r\n                    <div className=\"py-2 small\">V{appConfig.version}</div>\r\n                </div>,\r\n            },\r\n            ''\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.showLogin(undefined, true)}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> \r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    bk: '',\r\n                    component: <button className=\"btn btn-danger w-100\" onClick={this.exit}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> \r\n                </button>\r\n                },\r\n            ];\r\n\r\n            rows = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.orderStates />,\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"\" />,\r\n                    onClick: this.openContactList\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"\" />,\r\n                    onClick: this.openInvoice\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text=\"\" />,\r\n                    onClick: this.changePassword\r\n                },\r\n            ]\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n        return <PropGrid rows={rows} values={{}} />;\r\n    }\r\n}\r\n\r\n\r\nfunction userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { ItemSchema, Page, Edit, VPage, FA } from 'tonva';\r\nimport { CMe } from './CMe';\r\nimport { webUserSchema, webUserUiSchema, webUserContactSchema, webUserContactUiSchema } from './EditMeInfo';\r\nimport { observer } from 'mobx-react';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class EditMeInfoFirstOrder extends VPage<CMe>{\r\n\r\n    @observable tips: JSX.Element;\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    @observable private webUserData: any;\r\n    @observable private webUserContactData: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n\r\n        let { cApp } = this.controller;\r\n        let { firstName, gender, salutation, organizationName, departmentName, telephone\r\n            , mobile, email, fax, address, addressString, zipCode } = cApp.currentUser;\r\n        this.webUserData = {\r\n            firstName: firstName,\r\n            gender: gender,\r\n            salutation: salutation,\r\n            organizationName: organizationName,\r\n            departmentName: departmentName\r\n        };\r\n\r\n        this.webUserContactData = {\r\n            telephone: telephone,\r\n            mobile: mobile,\r\n            email: email,\r\n            fax: fax,\r\n            address: address,\r\n            addressString: addressString,\r\n            zipCode: zipCode\r\n        }\r\n    }\r\n\r\n    private onWebUserChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserData[name] = newValue;\r\n        await this.controller.changeWebUser(this.webUserData);\r\n    }\r\n\r\n    private onWebUserContactChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserContactData[name] = newValue;\r\n        await this.controller.changeWebUserContact(this.webUserContactData);\r\n    }\r\n\r\n    private checkOut = async () => {\r\n        let { currentUser } = this.controller.cApp;\r\n        if (currentUser.allowOrdering) {\r\n            this.closePage();\r\n            await currentUser.addContactFromAccount();\r\n            await this.controller.doCheckout();\r\n        } else {\r\n            this.tips = <> <span className='text-danger'>*</span> </>;\r\n            setTimeout(() => {\r\n                this.tips = undefined;\r\n            }, GLOABLE.TIPDISPLAYTIME);\r\n        }\r\n    }\r\n\r\n    private page = observer(() => {\r\n\r\n        let tipsUI = <></>;\r\n        if (this.tips) {\r\n            tipsUI = <div className=\"alert alert-primary\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {this.tips}\r\n            </div>\r\n        }\r\n        return <Page header=\"\">\r\n            <div className=\"alert alert-primary small\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning mr-3 my-1 float-left\" size=\"3x\" />\r\n                \r\n                 <span className=\"text-danger\">*</span> \r\n            </div>\r\n            <Edit schema={webUserSchema} uiSchema={webUserUiSchema}\r\n                data={this.webUserData}\r\n                onItemChanged={this.onWebUserChanged} />\r\n            <Edit schema={webUserContactSchema} uiSchema={webUserContactUiSchema(this.controller.pickAddress)}\r\n                data={this.webUserContactData}\r\n                onItemChanged={this.onWebUserContactChanged} />\r\n            <div className=\"p-3 bg-white\">\r\n                {tipsUI}\r\n                <button type=\"button\" className=\"btn btn-primary w-100\" onClick={() => this.checkOut()}></button>\r\n            </div>\r\n        </Page>;\r\n    });\r\n}\r\n","import _ from 'lodash';\r\nimport { Context } from 'tonva';\r\nimport { CApp } from '../CApp';\r\nimport { CUqBase } from '../CBase';\r\nimport { VMe } from './VMe';\r\nimport { CSelectShippingContact } from '../customer/CSelectContact';\r\nimport { EditMeInfoFirstOrder } from './EditMeInfoFirstOrder';\r\nimport { CInvoiceInfo } from '../customer/CInvoiceInfo';\r\nimport { CAddress } from '../customer/CAddress';\r\n\r\nexport class CMe extends CUqBase {\r\n    //    cApp: CApp;\r\n    protected async internalStart() {\r\n\r\n    }\r\n\r\n    async changeWebUser(webUser: any) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.changeWebUser(webUser);\r\n    }\r\n\r\n    async changeWebUserContact(webUserContact: any) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.changeWebUserContact(webUserContact);\r\n    }\r\n\r\n    tab = () => this.renderView(VMe);\r\n\r\n    openMyOrders = async (state: string) => {\r\n        let { cOrder } = this.cApp;\r\n        await cOrder.openMyOrders(state);\r\n    }\r\n\r\n    openContactList = async () => {\r\n        let contactList = this.newC(CSelectShippingContact); // new CSelectShippingContact(this.cApp, undefined, false);\r\n        await contactList.start(false);\r\n    }\r\n\r\n    openInvoice = async () => {\r\n        let cInvoiceInfo = this.newC(CInvoiceInfo); // new CInvoiceInfo(this.cApp, undefined, false);\r\n        let { currentUser } = this.cApp;\r\n        let defaultSetting = await currentUser.getSetting();\r\n\r\n        let origInvoice = _.pick(defaultSetting, ['invoiceType', 'invoiceInfo']);\r\n        cInvoiceInfo.start(origInvoice);\r\n    }\r\n\r\n    openMeInfoFirstOrder = async () => {\r\n        await this.openVPage(EditMeInfoFirstOrder);\r\n    }\r\n\r\n    doCheckout = async () => {\r\n        let { cCart } = this.cApp;\r\n        await cCart.doCheckOut();\r\n    }\r\n\r\n    pickAddress = async (context: Context, name: string, value: number): Promise<number> => {\r\n        let cAddress = this.newC(CAddress); // new CAddress(this.cApp, undefined);\r\n        return await cAddress.call<number>();\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, TabCaptionComponent, Page, Tabs } from 'tonva';\r\nimport { CApp } from '../CApp';\r\n//import { CCartApp } from 'CCartApp';\r\n\r\nexport const store = {\r\n    //homeCount: observable.box<number>(-1),\r\n    //cartCount: observable.box<number>(101),\r\n};\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VMain extends VPage<CApp> {\r\n    async open(param?: any) {\r\n        this.openPage(this.render);\r\n    }\r\n    render = (param?: any): JSX.Element => {\r\n        let { cHome, cMember, cCart, cMe, cart } = this.controller;\r\n        let faceTabs = [\r\n            { name: 'home', label: '', icon: 'home', content: cHome.tab, notify: undefined/*store.homeCount*/ },\r\n            // { name: 'member', label: '', icon: 'vcard', content: cMember.tab },\r\n            { name: 'cart', label: '', icon: 'shopping-cart', content: cCart.tab, notify: cart.count },\r\n            { name: 'me', label: '', icon: 'user', content: cMe.tab }\r\n        ].map(v => {\r\n            let { name, label, icon, content, notify } = v;\r\n            return {\r\n                name: name,\r\n                caption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n                content: content,\r\n                notify: notify,\r\n            }\r\n        });\r\n        return <Page header={false}>\r\n            <Tabs tabs={faceTabs} />\r\n        </Page>;\r\n    }\r\n}\r\n","import { CAppBase, IConstructor, User, nav } from \"tonva\";\r\nimport { UQs } from \"./uqs\";\r\nimport { Cart } from \"./cart/Cart\";\r\nimport { WebUser } from \"./CurrentUser\";\r\nimport { CHome } from \"./home\";\r\nimport { CCart } from \"./cart\";\r\nimport { CProduct } from \"./product\";\r\nimport { COrder } from \"./order/COrder\";\r\nimport { CProductCategory } from \"./productCategory/CProductCategory\";\r\nimport { CMember } from \"./member\";\r\nimport { CMe } from \"./me/CMe\";\r\nimport { CUqBase } from \"./CBase\";\r\nimport { VMain } from 'ui/main';\r\nimport { GLOABLE } from 'configuration';\r\n\r\nexport class CApp extends CAppBase {\r\n    get uqs(): UQs { return this._uqs as UQs };\r\n\r\n    cart: Cart;\r\n    topKey: any;\r\n\r\n    currentSalesRegion: any;\r\n    currentLanguage: any;\r\n    currentUser: WebUser;\r\n\r\n    cHome: CHome;\r\n    cCart: CCart;\r\n    cProduct: CProduct;\r\n    cOrder: COrder;\r\n    cProductCategory: CProductCategory;\r\n    cMember: CMember;\r\n    cMe: CMe;\r\n\r\n    protected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n        return new type(this);\r\n    }\r\n\r\n    protected async internalStart() {\r\n        this.currentSalesRegion = await this.uqs.common.SalesRegion.load(GLOABLE.SALESREGION_CN);\r\n\r\n        this.currentLanguage = await this.uqs.common.Language.load(GLOABLE.CHINESE);\r\n\r\n        this.currentUser = new WebUser(this.uqs); //this.cUqWebUser, this.cUqCustomer);\r\n        if (this.isLogined) {\r\n            this.currentUser.setUser(this.user);\r\n        }\r\n\r\n        this.cart = new Cart(this);\r\n        await this.cart.init();\r\n\r\n        this.cProductCategory = this.newC(CProductCategory); // new CProductCategory(this, undefined);\r\n        this.cCart = this.newC(CCart); // new CCart(this, undefined);\r\n        this.cHome = this.newC(CHome); // new CHome(this, undefined);\r\n        this.cProduct = this.newC(CProduct); // new CProduct(this, undefined);\r\n        this.cOrder = this.newC(COrder); // new COrder(this, undefined);\r\n        //this.cSelectContact = new CSelectContact(this, undefined);\r\n        this.cMember = this.newC(CMember); // new CMember(this, undefined);\r\n        this.cMe = this.newC(CMe); // new CMe(this, undefined);\r\n\r\n        let promises: PromiseLike<void>[] = [];\r\n        promises.push(this.cProductCategory.start());\r\n        await Promise.all(promises);\r\n        this.showMain();\r\n        this.topKey = nav.topKey();\r\n    }\r\n\r\n    showMain(initTabName?: string) {\r\n        this.openVPage(VMain, initTabName);\r\n    }\r\n\r\n    async loginCallBack(user: User) {\r\n        /*\r\n        if (this.cartService.isLocal) {\r\n            let cartLocal = { ...this.cartViewModel } as CartViewModel;\r\n            // this.cartService.clear(this.cartViewModel);\r\n            this.cartService = CartServiceFactory.getCartService(this);\r\n            this.cartViewModel = await this.cartService.load();\r\n            // this.cartViewModel = await this.cartService.merge(cartLocal);\r\n        }\r\n        */\r\n    }\r\n\r\n    protected onDispose() {\r\n        this.cart.dispose();\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport './App.css';\r\nimport { NavView, nav, Page, Tabs, start } from 'tonva';\r\nimport { CApp } from 'CApp';\r\nimport { appConfig } from 'configuration';\r\n\r\n//const tonvaApp = \"bruce/TestApp\";\r\nnav.setSettings(appConfig);\r\n\r\nclass App extends React.Component {\r\n\r\n  private onLogined = async () => {\r\n    await start(CApp, appConfig);\r\n  }\r\n  public render() {\r\n    return <NavView onLogined={this.onLogined} notLogined={this.onLogined} />\r\n  }\r\n}\r\n\r\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = \"data:image/png;base64,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\"","import * as React from 'react';\r\nimport { Render } from './render';\r\n\r\nexport interface MainSubs<M, S> {\r\n    main: M;\r\n    subs: S[];\r\n}\r\n\r\nexport abstract class ViewBase<T> {\r\n    model: T;\r\n    abstract render(): JSX.Element;\r\n}\r\n\r\nexport class ViewMainSubs<M, S> extends ViewBase<MainSubs<M, S>> {\r\n    protected main: Render<M>;\r\n    protected sub: Render<S>;\r\n    constructor(main: Render<M>, sub: Render<S>) {\r\n        super();\r\n        this.main = main;\r\n        this.sub = sub;\r\n    }\r\n    protected subsContainer(subViews: JSX.Element[]): JSX.Element {\r\n        return <div>{subViews}</div>\r\n    }\r\n\r\n    protected renderSubItems(): JSX.Element[] {\r\n        let { subs } = this.model;\r\n        if (!subs) return null;\r\n        let subViews: JSX.Element[] = subs.map((v, index) => {\r\n            return <this.sub key={index} {...v} />;\r\n        });\r\n        return subViews;\r\n    }\r\n\r\n    protected renderSubs = (): JSX.Element => {\r\n        return this.subsContainer(this.renderSubItems());\r\n    }\r\n\r\n    render(): JSX.Element {\r\n        let { main } = this.model;\r\n        return <>\r\n            <this.main {...main} />\r\n            <this.renderSubs />\r\n        </>;\r\n    }\r\n}\r\n\r\nexport class ViewListMainSubs<M, S> extends ViewBase<MainSubs<M, S>[]> {\r\n    private row: new (main: Render<M>, sub: Render<S>) => ViewMainSubs<M, S>;\r\n    private main: Render<M>;\r\n    private sub: Render<S>;\r\n    constructor(\r\n        row: new (main: Render<M>, sub: Render<S>) => ViewMainSubs<M, S>,\r\n        main: Render<M>,\r\n        sub: Render<S>) {\r\n        super();\r\n        this.row = row;\r\n        this.main = main;\r\n        this.sub = sub;\r\n    }\r\n    render(): JSX.Element {\r\n        return <>\r\n            {this.model.map((v, index) => {\r\n                let view = new this.row(this.main, this.sub);\r\n                view.model = v;\r\n                return <React.Fragment key={index}>{view.render()}</React.Fragment>;\r\n            })}\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { MainProduct, SubPack } from './model';\r\n\r\nexport type Render<T> = (model: T) => JSX.Element;\r\n\r\nexport function renderMainProduct(model: MainProduct): JSX.Element {\r\n    return <div>\r\n        {model.description}\r\n    </div>\r\n}\r\n\r\nexport function renderSubPack(model: SubPack): JSX.Element {\r\n    let { pack, vipPrice, price, quantity, amount } = model;\r\n    return <div>\r\n        {pack.unit}, {vipPrice}, {price}, {quantity}, {amount}\r\n    </div>\r\n}\r\n","export * from './mainSubs';\r\nexport * from './model';\r\nexport * from './render';\r\n","module.exports = __webpack_public_path__ + \"static/media/AnalyticalChemistry.f85ff3e0.png\";","module.exports = __webpack_public_path__ + \"static/media/LabSupplies.3f6ce00f.png\";","module.exports = __webpack_public_path__ + \"static/media/LifeScience.5c2e6ff5.png\";","module.exports = __webpack_public_path__ + \"static/media/MaterialScience.f2439aa0.png\";","module.exports = __webpack_public_path__ + \"static/media/OrganicChemistry.6d56971c.png\";","module.exports = __webpack_public_path__ + \"static/media/pig.772a31a6.png\";"],"sourceRoot":""}