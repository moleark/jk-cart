{"version":3,"sources":["tonva/index.ts","tonva/components/index.ts","tonva/components/nav.tsx","tonva/net/netToken.ts","tonva/components/fetchErrorView.tsx","tonva/components/reloadPage.tsx","tonva/net/guestApi.ts","tonva/net/caller.ts","tonva/tool/cacheIds.ts","tonva/tool/local.ts","tonva/tool/getObjPropIgnoreCase.ts","tonva/components/page/page.tsx","tonva/net/appBridge.ts","tonva/uq/entity.ts","tonva/components/edit/itemEdit.tsx","tonva/uq/caller.ts","tonva/net/httpChannel.ts","tonva/net/httpChannelUI.ts","tonva/net/uqApi.ts","tonva/uq/index.ts","tonva/res/res.ts","tonva/vm/controller.tsx","tonva/vm/vpage.tsx","tonva/vm/components/CStringEdit.tsx","tonva/tool/uid.ts","tonva/uq/query.ts","images/logo.png","tonva/net/wsChannel.ts","tonva/uq/tuid/reactBoxId.tsx","tonva/components/image.tsx","tonva/tool/user.ts","tonva/net/host.ts","tonva/components/page/scrollView.tsx","tonva/uq/action.ts","tonva/components/simple/LMR.tsx","tonva/components/simple/Badge.tsx","tonva/components/simple/FA.tsx","tonva/components/simple/IconText.tsx","tonva/components/simple/Muted.tsx","tonva/tool/localDb.ts","tonva/components/loading.tsx","tonva/vm/view.tsx","tonva/tool/env.ts","tonva/uq/tuid/index.ts","tonva/net/apiBase.ts","tonva/components/edit/imageItemEdit.tsx","tonva/res/formRes.ts","tonva/res/listRes.ts","tonva/res/entry/login.ts","tonva/res/entry/register.ts","tonva/tool/pageItems.ts","tonva/net/messageHub.ts","tonva/components/navigo.ts","tonva/components/page/pageHeader.tsx","tonva/components/page/tabs.tsx","tonva/components/resUploader.tsx","tonva/components/ax/index.tsx","tonva/uq/uqMan.ts","tonva/uq/sheet.ts","tonva/uq/book.ts","tonva/uq/history.ts","tonva/uq/map.ts","tonva/uq/pending.ts","tonva/uq/enum.ts","tonva/uq/tag/tagView.tsx","tonva/uq/tag/tag.ts","images/setting.svg","images/number-01.svg","images/order-01.svg","tonva/components/page/index.ts","tonva/components/schema/index.ts","tonva/components/rules/index.ts","tonva/components/dropDownActions/index.tsx","tonva/components/easyDate/index.tsx","tonva/components/media.tsx","tonva/components/searchBox.tsx","tonva/components/userIcon.tsx","tonva/components/autoHideTips.tsx","tonva/uq/tuid/tuidsCache.ts","tonva/uq/uqsMan.ts","tonva/uq/buildUqApp.ts","images/logo_pointShop.png","images/signInIcon.png","images/exChangeIcon.png","images/homeTopicMap.jpg","images/TriangleShadingO.png","images/TriangleShadingT.png","images/signTopicMap.png","images/signViceMap.png","images/Homemadelogo.png","images/point.png","images/pdf.png","../node_modules/pdfh5/js sync","model/Product.ts","css/style.css","tonva/components/form/rules/index.ts","tonva/components/form/widgets/widget.tsx","tonva/components/form/widgets/textWidget.tsx","tonva/components/form/widgets/textareaWidget.tsx","tonva/components/form/widgets/passwordWidget.tsx","tonva/components/form/widgets/numberWidget.tsx","tonva/components/form/widgets/updownWidget.tsx","tonva/components/form/widgets/dateWidget.tsx","tonva/components/form/widgets/checkBoxWidget.tsx","tonva/components/form/widgets/selectWidget.tsx","tonva/components/form/widgets/radioWidget.tsx","tonva/components/form/widgets/rangeWidget.tsx","tonva/components/form/widgets/idWidget.tsx","tonva/components/form/widgets/unknown.tsx","tonva/components/form/widgets/buttonWidget.tsx","tonva/components/form/context.tsx","tonva/components/form/widgets/arrComponent.tsx","tonva/components/form/widgets/imageWidget.tsx","tonva/components/form/widgets/tagWidget.tsx","tonva/components/form/widgets/factory.tsx","tonva/components/form/form.tsx","tonva/components/form/field.tsx","tonva/components/edit/stringItemEdit.tsx","tonva/components/edit/radioItemEdit.tsx","tonva/components/edit/selectItemEdit.tsx","tonva/components/edit/idItemEdit.tsx","tonva/components/edit/tagItemEdit.tsx","tonva/components/edit/textAreaItemEdit.tsx","tonva/components/edit/checkBoxItemEdit.tsx","tonva/components/edit/rangeItemEdit.tsx","tonva/components/edit/numberItemEdit.tsx","tonva/components/edit/edit.tsx","tonva/app/centerApi.ts","tonva/app/vMain.tsx","tonva/app/CAppBase.ts","tonva/app/start.ts","tonva/app/CBase.ts","tonva/app/startPage.tsx","tonva/components/list/base.tsx","tonva/components/list/clickable.tsx","tonva/components/list/static.tsx","tonva/components/list/selectable.tsx","tonva/components/list/index.tsx","tonva/components/propGrid/row.tsx","tonva/components/propGrid/propView.tsx","tonva/components/propGrid/PropGrid.tsx","tonva/entry/meInfo.tsx","tonva/uq/tuid/idCache.ts","tonva/uq/tuid/tuid.ts","images/AnalyticalChemistry.png","images/LabSupplies.png","images/LifeScience.png","images/MaterialScience.png","images/OrganicChemistry.png","images/triangle.svg","images/giftPlate.png","images/已下架.png","images/infb.jpg","images/pig.png","images/welcome.png","images/积分图标P.png","images/已签到.png","model/index.ts","css/rst.css","serviceWorker.ts","me/loginTop.tsx","tvs/common.tsx","tools/productImage.tsx","tvs/product.tsx","global.ts","tvs/customer.tsx","tvs/index.tsx","tvs/warehouse.tsx","tvs/order.tsx","configuration.ts","tools/groupByProduct.ts","cart/Cart.ts","tapp/CBase.ts","home/VSearchHeader.tsx","home/VSiteHeader.tsx","home/VSlider.tsx","tools/browser.ts","home/VHome.tsx","tools/CustomHeaderTemplate.tsx","home/VScanCode.tsx","home/CHome.tsx","cart/VCartLabel.tsx","tools/minusPlusWidget.tsx","tools/elasticSearchPager.ts","cart/VCart.tsx","cart/CCart.tsx","product/renders.tsx","product/views/VChemicalInfo.tsx","product/views/VFavorite.tsx","product/views/VDelivery.tsx","product/views/VProductView.tsx","product/views/VInCart.tsx","product/views/VPrice.tsx","product/views/VProductView2.tsx","product/views/VWithPrice.tsx","tools/randomColor.ts","pointMarket/VExchangeOrder.tsx","tools/pageHeaderTitle.tsx","pointMarket/VPointRule.tsx","pointMarket/basicRefer.ts","pointMarket/VMyPoint.tsx","customer/VContactList.tsx","tools/inputValidations.ts","customer/VContact.tsx","customer/VAddress.tsx","customer/CAddress.tsx","customer/CSelectContact.tsx","pointMarket/OrderSuccess.tsx","pointMarket/pointOrder.ts","pointMarket/VExchangeHistoryDetail.tsx","tools/listTable.tsx","pointMarket/VExchangeHistory.tsx","pointMarket/VRevenueExpenditure.tsx","pointMarket/VPointProductDetail.tsx","pointMarket/VSelectedLable.tsx","pointMarket/VDefaultPost.tsx","pointMarket/CPointProduct.tsx","pointMarket/VPointProduct.tsx","product/VPageProduct.tsx","product/VPageList.tsx","product/VPagePDF.tsx","product/VPageVerifyCode.tsx","product/CProduct.ts","order/VModelByCreateOrder.tsx","order/VCreateOrder.tsx","order/Order.ts","order/OrderSuccess.tsx","order/VMyOrders.tsx","order/VOrderDetail.tsx","customer/VInvoiceInfo.tsx","customer/CInvoiceInfo.tsx","coupon/Coupon.ts","coupon/VVIPCard.tsx","coupon/VCouponAvailable.tsx","order/COrder.tsx","productCategory/VRootCategory.tsx","productCategory/VRootCategorySideBar.tsx","productCategory/VCategoryPage.tsx","productCategory/CProductCategory.tsx","member/VMember.tsx","member/CMember.tsx","me/contactUs.tsx","me/EditMeInfo.tsx","me/aboutThisApp.tsx","me/VMe.tsx","me/EditMeInfoFirstOrder.tsx","customer/VFavorites.tsx","customer/CFavorites.tsx","me/VLoginState.tsx","me/about.tsx","me/VMeSideBar.tsx","me/CMe.tsx","tapp/main.tsx","coupon/VSharedCoupon.tsx","coupon/VVIPCardDiscount.tsx","coupon/VCouponManage.tsx","coupon/VModelCardDiscount.tsx","coupon/CCoupon.tsx","ync/VYncProjects.tsx","ync/CYncProjects.tsx","pointMarket/VLottery.tsx","pointMarket/VMyLotteryPrize.tsx","pointMarket/prizeOrder.ts","pointMarket/CLottery.tsx","pointMarket/VPointSign.tsx","pointMarket/CSignIn.tsx","CurrentUser.ts","tapp/CApp.ts","tapp/webNav.tsx","tapp/CWeb.tsx","index.tsx"],"names":["logMark","netToken","userId","token","setCenterToken","WSChannel","FetchErrorView","reApi","a","props","clearError","channel","url","options","resolve","reject","refetchApi","close","errContent","this","error","err","i","push","key","style","wordWrap","className","type","onClick","React","SystemNotifyPage","message","header","ReloadPage","timerHandler","reload","clearInterval","nav","seconds","undefined","state","setInterval","setState","title","msg","ConfirmReloadPage","back","confirm","isMobile","RegExp","test","navigator","userAgent","logs","stackKey","NavView","stack","waitCount","waitTimeHandler","upgradeUq","start","isHistoryBack","navBack","tick","Date","now","console","log","length","len","window","self","top","postMessage","confirmClose","pop","fetchError","wait","set","addEventListener","init","env","setTimeout","clearTimeout","unauthorized","showLogin","uq","version","show","view","disposer","clear","removeCeased","history","pushState","ceased","refresh","item","dispose","level","p","backLevel","popAndDispose","find","v","elWait","elError","testing","left","zIndex","name","map","index","visibility","position","navView","wsHost","local","LocalData","navigo","navSettings","language","culture","resUrl","hashParam","centerHost","arrs","windowOnError","event","source","lineno","colno","windowOnUnhandledRejection","ev","reason","windowOnClick","windowOnMouseMove","x","y","windowOnScroll","forceDevelopment","navLogin","params","user","navLogout","showLogout","navRegister","showRegister","navForget","showForget","navPageRoutes","doneSysRoutes","sysRoutes","isWebNav","backIcon","closeIcon","pageWebNav","showPrivacyPage","privacy","getPrivacyContent","privacyPage","htmlString","content","__html","dangerouslySetInnerHTML","waiting","Promise","race","serviceWorker","ready","registration","unregister","document","location","plus","webview","webView","resetAll","ok","showReloadPage","localStorage","lang","resOptions","district","messageHub","dispatch","unitJsonPath","fetch","unitRes","json","res","unit","remove","el","getElementById","innerText","loadUnitJson","innerHTML","JSON","parse","envUnit","process","REACT_APP_UNIT","Number","get","isDevelopment","id","getPredefinedUnitName","unitName","guestApi","unitFromName","unitId","settings","origin","pathname","toLowerCase","endsWith","substr","host","hash","pos","getExHashPos","substring","ws","resHost","resUrlFromHost","setCenterUrl","guest","Error","setGuest","exHash","getExHash","appInFrame","setAppInFrame","parent","loadPredefinedUnit","predefinedUnit","onerror","onunhandledrejection","onselectstart","oncontextmenu","startWait","notLogined","logined","endWait","Navigo","historyAPIUpdateMethod","on","navigate","navPage","alert","queryStr","routeFromNavPage","internalOnNavRoutes","_","merge","navOns","route","absolute","showPage","isUserLogin","onLogined","userApi","me","icon","nick","callback","logoutApis","stringify","saveLocalUser","showAppView","internalLogined","defaultTop","loginTop","withBack","lv","loginView","default","footer","logout","c","RegisterController","ForgetController","logoutClear","cp","ChangePasswordPage","onError","showUpgradeUq","replace","topKey","popTo","ceaseTop","regConfirmClose","confirmBox","apiId","sheetType","sheetId","sheet","includes","uh","appUrl","src","String","open","date","getTime","toTimeString","step","href","indexOf","ret","text","r","parser","DOMParser","htmlDoc","parseFromString","elHtml","getElementsByTagName","newVersion","getAttribute","g","oem","observable","decodeGuestToken","CenterApiBase","Caller","_params","method","maxCount","arr","ids","dict","loadId","shift","delete","_loadIds","items","_loadId","setItem","e","Map","localDb","child","_user","_guest","_unit","forEach","d","getObjPropIgnoreCase","obj","prop","keys","Object","Page","observer","tabsView","tabsProps","TabsView","webNav","right","headerClassName","afterBack","inWebNav","pageHeaderProps","center","rph","renderPageHeader","elFooter","errorInfo","onScroll","onScrollTop","onScrollBottom","children","renderHeader","renderFooter","uqTokens","logoutUqTokens","appsInFrame","page","param","val","isBridged","subFrameStarted","evt","data","subWin","setSubAppWindow","hidden","hideFrameBack","clone","initSubWin","onReceiveAppApiMessage","apiName","db","parts","split","uqOwner","uqName","appOwner","appName","uqTokenApi","onAppApiReturn","urlTest","action","uqTokenActions","realUrl","getUrlOrTest","appHash","slice","lastIndexOf","u","uid","getUnit","realUnit","onReceive","callCenterApiFromMessage","bridgeCenterApiReturn","startsWith","buildAppUq","uqToken","centerToken","at","opener","appUq","brideCenterApis","bridgeCenterApi","body","callId","from","callCenterapi","directCall","result","bca","chars","codeBackSlash","charCodeAt","codeN","codeT","codeB","codeF","codeV","codeR","codes","codeBN","codeBT","codeBB","codeBF","codeBV","codeBR","Entity","typeId","jName","schema","ver","sys","cache","uqApi","fields","arrFields","returns","face","fieldMaps","localMap","f","loadEntitySchema","buildSchema","loadValues","setSchema","buildFieldsTuid","setJName","buildFieldTuid","buildArrFieldsTuid","value","fieldName","arrName","entities","fn","getTuid","an","fieldArr","tuid","buildFieldsParams","arrResult","pa","rowResult","field","buildDateTimeParam","getFullYear","getMonth","getDate","_tuid","getIdFromObj","dt","Math","floor","toISOString","packRow","arrData","packArr","join","row","ch","escape","values","boxId","ln","unpackRow","unpackArr","ch0","fLen","to","reverseNT","n","isNaN","p0","vals","ItemEdit","edit","itemSchema","uiItem","label","_itemSchema","_uiItem","newValue","internalStart","internalEnd","divValue","labelHide","templet","Templet","widget","list","rules","nv","Array","isArray","verifyRule","rule","EntityCaller","entity","tries","_entity","loadSchema","innerRequest","xcall","innerCall","jsonResult","$uq","$modify","pullModify","xresult","retry","rebuildSchema","buildEntities","uqVersion","en","ActionCaller","QueryQueryCaller","unpackReturns","buildParams","QueryPageCaller","pageStart","pageSize","methodsWithBody","HttpChannel","hostUrl","apiToken","ui","timeout","showError","post","urlPrefix","caller","buildOptions","headers","path","h","encodeURI","innerFetch","k","innerFetchResult","buildError","ex","retErr","that","timeOutHandler","statusText","ct","then","retJson","retError","catch","buildHeaders","CenterHttpChannel","UqHttpChannel","HttpChannelNavUI","channelUIs","channelNoUIs","channels","UqApi","basePath","access","showWaiting","channelUI","acc","ApiBase","UnitxApi","buildChannel","centerAppApi","CenterAppApi","unitxUq","centerChannel","centerChannelUI","loginedUserId","t","un","localCache","nowTick","appUqParams","call","loadAppUqs","uqs","decodeUserToken","account","verify","password","$lang","$district","resLang","l","languages","toUpperCase","setResOptions","resGlobal","setRes","target","str","setGlobalRes","Controller","_t","isDev","receiveHandlerId","unregisterReceiveHandler","onDispose","onMessageReceive","onMessage","_resolve_$","topPageKey","internalT","beforeInit","getPageWebNav","afterInit","vp","replaceOpen","render","onEvent","openPage","registerReceiveHandler","beforeStart","afterStart","onClosePage","go","caption","yes","no","classNames","closePage","buttons","VPage","retOnClosePage","_onClosePage","openPageElement","renderPage","replacePageElement","onPageScroll","scroller","onPageScrollTop","onPageScrollBottom","controller","View","onChange","preValue","isChanged","onBlur","verifyValue","onFocus","onEdit","maxLength","placeholder","onValueChange","onSave","createElement","disabled","onKeyDown","keyCode","defaultValue","renderValue","renderPencil","ALPHABET","rtn","charAt","random","QueryPager","query","firstSize","itemObservable","$page","idFieldName","appendPosition","sortOrder","order","_items","startIndex","getPageId","load","splice","newItem","newId","oldItem","oldId","PageItems","Query","more","startField","isPaged","size","array","deep","pageCaller","request","queryCaller","table","module","exports","subAppWindow","postWsToSubApp","win","WsBase","wsBaseSeed","wsBaseId","WebSocket","onopen","onmessage","wsMessage","onclose","receive","netThis","connect","send","TuidContent","tuidName","s","uqStringify","ReactBoxId","isUndefined","boxName","assureBox","valueFromId","Tv","tuidValue","nullUI","ttv","divObj","bi","logContent","boxIdContent","tv","Image","altImage","alt","currentTarget","jwtDecode","hosts","centerhost","reshost","uqhost","unitxhost","httpArr","urlFromHost","isAbsoluteUrl","centerUrlFromHost","centerWsFromHost","fetchOptions","mode","tryLocal","getCenterHost","getResHost","promises","hostArr","findIndex","fetchUrl","debugHostUrl","localCheck","all","results","j","hostValue","debugHost","getUrlOrDebug","urlDebug","fetchLocalCheck","Scroller","scrollTo","scrollTop","offsetHeight","ScrollViewBase","bottomTime","topTime","div","refDiv","onResize","removeEventListener","sh","scrollHeight","direct","Children","_$scroll","toString","eachChild","Component","ScrollView","ref","WebNavScrollView","vHeader","vFooter","navHeader","navRawHeader","navFooter","navRawFooter","Action","ActionSubmitCaller","SubmitReturnsCaller","SubmitConvertCaller","pack","LMR","b","badge","color","badgeAlign","badgeVertical","cn","cursor","FA","spin","fixWidth","border","pull","pulse","rotate","flip","inverse","IconText","iconClass","textClass","Muted","__ls","getItem","removeItem","LocalCache","removeLocal","Local","caches","locals","keyForGet","keyForSet","sk","LocalArr","LocalMap","keyForRemove","removeAll","ks","unshift","saveIndex","max","ls","Loading","isMe","vm","vCall","returnCall","imageClassName","textClassName","renderUser","replacePage","backPage","ceasePage","popToTopPage","tag","ms","args","global","handle","getHttpChannel","callFetch","put","ImageItemEdit","resId","onSaved","formRes","required","number","integer","min","zh","listRes","none","loginRes","registerRes","isFirst","pageItemAction","itemConverter","scrollToTop","scrollIntoView","topDiv","scrollToBottom","bottomDiv","changing","divId","loadResults","pageList","beforeLoad","loaded","allLoaded","reset","isAsc","endItem","scrollToEnd","pushItem","endIndex","startId","pid","sum","setLoaded","loading","onLoad","setPageStart","onLoaded","reverse","computed","handlerSeed","anyHandlers","msgHandlers","handler","seed","args0","handlerId","$type","useHash","root","_routes","_useHash","_hash","_paused","_destroyed","_lastRouteResolved","_notFoundHandler","_defaultHandler","_usePushState","_genericHooks","_historyUpdateMethod","timout","_onLocationChange","isPushStateAvailable","_cLoc","_listen","updatePageLinks","cleanUrl","match","names","reduce","decodeURIComponent","paramNames","regexp","PARAMETER_REGEXP","full","dots","REPLACE_VARIABLE_REGEXP","WILDCARD_REGEXP","REPLACE_WILDCARD","FOLLOWED_BY_SLASH_REGEXP","MATCH_REGEXP_FLAGS","urlA","urlB","getUrlDepth","routes","replaceDynamicURLParts","clean","regExpResultToParams","filter","m","findMatchedRoutes","colonExp","matched","routeExp","fallbackURL","matched0","cleanGETParam","hooks","exHooks","before","shouldRoute","after","_getRoot","_historyUpdate","arg0","arg1","orderedRoutes","sort","compareUrlDepth","uses","_add","current","GETParameters","extractGETParameters","onlyURL","getOnlyURL","already","manageHooks","_callLeave","isHashedRoot","_findLinks","link","hasListenerAttached","ctrlKey","metaKey","tagName","getLinkPath","preventDefault","status","pause","destroy","as","replaceState","cLocRoot","isHashChangeAPIAvailable","cached","check","querySelectorAll","lastRouteResolved","leave","onBack","vBack","debugLogout","role","rightView","Tab","contentBuilder","notify","onShown","_content","selected","TabCaptionComponent","tabBg","sep","tabClick","tab","selectedTab","tabArr","shown","tabs","bsCur","bsTab","tabPosition","borderColor","borderStyle","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","notifyCircle","num","displayNone","pageHeader","pageFooter","tabBack","isSelected","display","Tabs","ResUploader","fileInput","upload","formData","buildFormData","Headers","append","onFilesChange","files","fileName","maxSize","FormData","file","multiple","formatSize","pointLength","units","toFixed","ImageUploader","imgBaseSize","imageTypes","suffix","resUploader","onFileChange","fileError","uploaded","enableUploadButton","reader","FileReader","readAsDataURL","onload","srcImage","setSize","desImgSize","desImage","compress","img","width","height","srcImgWidth","srcImgHeight","w","scale","desImgWidth","round","desImgHeight","canvas","ctx","getContext","anw","createAttribute","nodeValue","anh","setAttributeNode","drawImage","base64","toDataURL","blob","convertBase64UrlToBlob","showOrgImage","maxWidth","urlData","mime","bstr","atob","u8arr","Uint8Array","Blob","defaultChecked","levelDiv","padding","AudioUploader","audioTypes","fileSize","uploading","Ax","axProps","aClassName","naClassName","openSysPage","A","UqMan","uqData","createBoxId","tvs","enums","actions","sheets","queries","books","maps","histories","pendings","tags","tuidsCache","localAccess","localModifyMax","tuids","createBoxIdFromTVs","tuidArr","actionArr","enumArr","sheetArr","queryArr","bookArr","mapArr","historyArr","pendingArr","tagArr","trim","TuidsCache","accesses","loadAccess","buildTuids","buildAccess","newTuid","entityName","allSchemas","fromType","fromObj","defer","cacheTuids","enm","UqEnum","TuidImport","TuidInner","book","Book","Tag","History","pending","Pending","Sheet","newAction","newQuery","newBook","newMap","newHistory","newSheet","newPending","newTag","newEnum","buildSheet","build","mainFields","buildTuidBox","owner","ownerField","buildTuidDivBox","modifyMax","states","ops","op","discription","app","SaveCaller","SaveDirectCaller","flow","ActionDirectCaller","brief","unpackSheet","flows","GetSheetCaller","getArchive","unpack","SheetArchiveCaller","SheetArchivesCaller","StateSheetsCaller","PageStateItems","StateSheetCountCaller","UserSheetsCaller","MySheetsCaller","SheetCaller","resVerify","count","getStateSheets","queryApiName","BookQueryCaller","schemaFrom","actionSchema","querySchema","AddCaller","DelCaller","AllCaller","PageCaller","qc","QueryCaller","MapCaller","getCaller","MapAddCaller","add","MapDelCaller","MapAllCaller","MapPageCaller","MapQueryCaller","radioStyle","TagView","nameFromId","namesFromIds","renderRadio","renderView","checked","renderCheck","wrapClassName","inputs","inputName","onInputChange","input","coll","_view","lines","line","ext","mobileRegex","emailRegex","DropdownActions","menu","button","handleDocumentClick","dropdownOpen","contains","toggle","isRight","itemIconClass","itemCaptionClass","hasIcon","some","data-toggle","aria-expanded","captionClass","aria-hidden","onTouchStart","timeRes","md","month","ymd","year","yesterday","today","tomorrow","$zh","$en","tt","renderDate","vDate","withTime","always","nDate","_date","nowYear","hour","getHours","minute","getMinutes","appendTime","dPart","hm","EasyDate","SearchBox","allowEmptySearch","onSubmit","initKey","onSearch","inputSize","inputClassName","buttonText","userCache","loader","UserView","noneImage","getValue","idProp","useUser","use","autoHideTips","tips","timer","cacheTimer","loadIds","clearCacheTimer","cacheIds","tuidCached","innerPullModify","tuidLists","queueModify","group","queue","modify","modifyIds","UQsMan","tonvaAppName","collection","localData","buildTVs","uqsMan","uqAppData","retErrors","setTuidImportsLocal","_uqs","buildUQs","errors","uqTVs","lj","uqsData","promiseInits","uqFullName","lower","loadEntities","uqMan","uqKey","proxy","Proxy","receiver","showReload","isImport","setInner","tuidImport","fromName","iName","setFrom","webpackEmptyContext","req","code","Product","shallow","cApp","favoriteOrCancel","assureLogin","loadFavorite","favorite","delProductFavorites","addProductFavorites","getProductAndDiscount","productId","product","ProductX","discount","currentUser","hasCustomer","customerDiscount","GetDiscount","brand","customer","currentCustomer","discountSetting","getPDFFileUrl","captcha","getVerifyCode","packId","loadBase","loadBrand","loadChemical","loadPrices","loadMSDSFile","loadSpecFile","loadFDTimeDescription","Brand","chemical","ProductChemical","webuser","myFavorites","webUser","MSDSFiles","ProductMSDSFile","productMSDSFiles","specFiles","ProductSpecFile","promotion","warehouse","currentSalesRegion","cart","currentLanguage","webUserVIPCard","brandDiscounts","VIPDiscount","brandDiscount","currentSalesRegionId","PriceX","salesRegion","prices","discountinued","expireDate","retail","element","vipPrice","currency","quantity","getQuantity","promises1","GetPromotionPack","GetInventoryAllocation","results2","newPacks","inventoryAllocation","price","promotionPrice","packs","createDate","moment","format","arr1","del","GetFutureDeliveryTime","futureDeliveryTime","minValue","maxValue","deliveryTimeDescription","futureDeliveryTimeDescription","transform","Rule","RuleCustom","func","defy","RulePredefined","RuleRequired","RuleNum","minMsg","maxMsg","template","checkMore","RuleInt","isInteger","Widget","context","fieldProps","_ui","readOnly","isChanging","changeValue","container","visible","form","inNode","requiredFlag","FieldContainer","renderBody","getUiItem","contextErrors","buildRules","removeErrorWidget","addErrorWidget","initData","fromElement","onChanging","onChanged","prev","allowChange","setDataValue","setElementValue","elDiscription","hasError","discriptionClassName","errorList","fieldClass","FieldClass","uiLabel","TextWidget","inputType","internalOnKeyDown","onEnter","blur","setError","checkRules","checkContextRules","hasFocus","clearErrors","renderTemplet","renderErrors","TextAreaWidget","setValue","rows","PasswordWidget","UrlWidget","EmailWidget","NumberWidget","UpdownWidget","returnValue","isValidKey","DateWidget","DateTimeWidget","TimeWidget","MonthWidget","CheckBoxWidget","trueValue","falseValue","SelectWidget","select","option","RadioWidget","rowKey","isRow","RangeWidget","IdWidget","pickId","clearContextError","Unknown","dataType","uiType","dataTypes","ButtonWidget","submit","observerRender","widgetType","ButtonClass","Context","uiSchema","subContexts","widgets","arrRowContexts","itemName","getDisabled","setDisabled","getReadOnly","setReadOnly","getVisible","setVisible","buttonName","errorWidgets","ew","onButtonClick","checkFieldRules","rowContext","setContextError","clearWidgetsErrors","clearContextErrors","checkHasError","rowKeySeed","RowContext","parentContext","arrSchema","uiArr","itemSchemas","FormContext","ContextContainer","ArrComponent","selectable","deletable","restorable","getArrRowContexts","onDeleted","onRestored","arrLabel","ArrContainer","RowContainer","RowSeperator","formSelectable","formDeletable","formRestorable","arrSelectable","arrDeletable","arrRestorable","ac","rc","rs","first","rowContent","typeofTemplet","factory","selectCheck","deleteIcon","$isSelected","$source","isDeleted","$isDeleted","editContainer","Provider","ImageWidget","imageSrc","end","TagWidget","widgetsFactory","textarea","datetime","time","email","updown","checkbox","image","checkboxes","radio","tagSingle","valuesView","renderRadios","tagMulti","defaultArr","def","renderChecks","range","typeWidget","getItemSchema","getTypeWidget","WidgetClass","Form","formContext","Container","watch","calcSelectOrDelete","DefaultContainer","DefaultFieldContainer","fieldLabelSize","labelView","fieldCol","DefaultFieldClass","DefaultButtonClass","DefaultRes","autorun","dv","initDataItem","arrItem","arrItems","arrDict","arrItemOperated","formArrVal","beforeShow","renderContent","FormField","contextType","StringItemEdit","inputOptions","RadioItemEdit","SelectItemEdit","IdItemEdit","TagItemEdit","renderInputs","TagSingleItemEdit","TagMultiItemEdit","TextAreaItemEdit","CheckBoxItemEdit","onItemChanged","RangeItemEdit","NumberItemEdit","Edit","defaultSepClassName","defaultRowContainerClassName","topBorder","bottomBorder","rowContainerClassName","rowClick","itemEdit","editInRow","onItemClick","stopEdit","topBorderClassName","bottomBorderClassName","sepClassName","ie","createItemEdit","divLabel","requireFlag","centerApi","userName","VUnsupportedUnit","VUnitSelect","renderRow","onRowClick","appUnit","setAppUnit","appUnits","VErrorsPage","VStartError","CAppBase","config","appConfig","noUnit","roleDefines","nRole","roles","roleDefs","onNavRoutes","userAppUnits","showUnsupport","appUnitId","openVPage","resolveRoute","userFromId","CApp","htmlTitle","html","html0","CBase","_cApp","hasRole","wn","getWebNav","CSub","_owner","ownerWNs","own","startPage","setSettings","ListBase","pageItems","Clickable","Static","Selectable","inputItems","buildItems","itemsArray","isItemSelected","selectedItems","compare","retItems","labelId","comp","selectItem","si","obItem","onSelect","flex","marginBottom","htmlFor","listenArraySplice","isObservableArray","observe","change","removedCount","added","_added","checkAll","anySelected","List","listBase","buildBase","prevProps","prevState","isEqual","forceUpdate","selectAll","unselectAll","waitingMore","tabIndex","isLoading","staticRow","PropRow","PropBorder","borderTop","PropGap","LabeledPropRow","gridProps","_prop","col","labelFixLeft","bk","renderLabel","renderProp","align","vAlign","alignValue","renderPropBody","renderPropContent","StringPropRow","NumberPropRow","ListPropRow","borderBottom","ComponentPropRow","component","PropView","buildRows","isGap","setValues","PropGrid","propView","userSetProp","IdCache","tuidLocal","localArr","waitingIds","tuidInner","divName","initLocalArr","isNumber","has","moveToHead","_id","useId","tuidValues","cacheIdValues","unpackTuidIds","cacheValue","cacheTuidFieldValues","loadTuidIdsOrLocal","localedValues","netIds","loadTuidIds","netRet","IdDivCache","Tuid","noCache","typeName","idName","unique","TuidBox","id1","id2","idValue","divs","cacheFields","idCache","tuidDiv","TuidDiv","resetCache","assureObj","IdsCaller","GetCaller","cacheFieldsInValue","arrValues","$create","$update","stampOnMain","unpackTuidIdsOfFields","SavePropCaller","searchArr","SearchCaller","LoadArrCaller","SaveArrCaller","ArrPosCaller","TuidNoCaller","TuidCaller","$id","transParams","arrParams","arrValue","buildDateParam","bid","$order","loadMain","save","saveProp","search","loadArr","saveArr","posArr","hasDiv","TuidBoxDiv","Boolean","hostname","jnkTop","logo","tvAddress","country","province","city","county","tvCountry","chineseName","tvCurrency","altimagePath","ProductImage","chemicalId","PointProductImage","pointProductImagePath","tvProduct","description","CAS","purity","molecularFomula","molecularWeight","imageUrl","EnumCategory","tvContact","mobile","organizationName","address","addressString","common","productx","packx","radiox","radioy","productCategory","contact","invoiceInfo","taxNo","invoiceType","categoryIdRes","CategoryIds_Production","47","OrganicChemistry","470","AnalyticalChemistry","1013","LifeScience","1219","MaterialScience","1545","LabSupplies","CategoryIds_Test","7","430","986","1214","RootCategoryRes","labelColor","GLOABLE","CHINA","CHINESE","SALESREGION_CN","ANDROIDAPPADDRESS","PIRVACYURL","CONTENTSITE","rootCategroyResFromId","categoryId","categoryIds","groupByProduct","packItems","packItem","cpi","Cart","cartData","cartStore","box","amount","editButton","calcSum","cartItems","pi","NaN","parseFloat","cartItemExists","equ","packExists","createdate","storeCart","removeStrike","isLogined","CartRemote","CartLocal","cd","priceMap","productPromises","getProduct","loadListItem","cps","cpp","pe","cartItemIndex","cartItem","removeFromCart","CartStore","GetCart","SetCart","RemoveFromCart","productTuid","packTuid","cartstring","cartDataBoxed","productbox","packbox","CUqBase","CUqApp","VSearchHeader","cProduct","VSiteHeader","renderSearchHeader","VSlider","banners","browser","versions","appVersion","trident","presto","webKit","gecko","ios","android","uc","iPhone","iPad","webApp","html5Plus","xs","innerWidth","innerHeight","compatMode","documentElement","clientWidth","clientHeight","getViewportSize","xsOrIpad","VHome","downloadApp","pageContent","renderCategoryRootList","siteHeader","renderVm","CustomHeaderTemplate","bg","textC","background","minHeight","minWidth","VScanCode","scan","media","barcode","Barcode","onmarked","QR","EAN13","EAN8","reg","verArr","Ver","shiftArr","scanCodetoProductDetail","scanClose","CHome","homeSections","sectionTuid","openScanCode","cProductCategory","renderRootList","getSlideShow","webBuilder","GetSlideShow","GetProductByOrigin","productByOrigin","showProductDetail","VCartLabel","showCart","pointer","MinusPlusWidget","minusClick","plusClick","parentElement","cursorPointer","minusColor","plusColor","hasAction","hasValue","minus","invisible","ElasticSearchPager","searchUrl","pageNumber","keyWord","salesregion","resp","hits","cartSchema","VCart","CheckOutButton","checkOut","strikeOut","renderCartItem","renderCartProduct","packsRow","onQuantityChanged","onRemoveCartItem","cartForm","textIndent","whetherToEdit","empty","CCart","selectedCartItems","parentData","packsToDeleted","each","onRowStateChanged","deleted","getSelectedItems","doFirstOrderChecking","cMe","allowOrdering","toPersonalAccountInfo","doCheckOut","cOrder","createOrderFromCart","renderDeliveryTime","tabPage","renderBrand","renderPropItem","capClass","valClass","VChemicalInfoInCart","VFavorite","curPack","stopPropagation","VDelivery","getInventoryAllocation","VInCart","cName","descriptionC","VPrice","isShowTable","minPrice","retailUI","Infinity","renderPrice","VPriceWithTr","VProuductView2","eName","maxHeight","showFavorites","aria-controls","VProductWithPrice","randomColor","VExchangeOrder","shippingAddressIsBlank","pageDesc","OrderSource","EXCHANGEORDER","nullContact","renderPointProduct","pointProduct","pointIcon","point","onSubmitOwn","submitOrder","orderData","cLottery","prizeOrderData","shippingContact","renderContact","onSelectShippingContact","pointProductsSelected","pointsSum","pointToExchanging","VMyPrizeExchangeOrder","PRIZEORDER","myPrizeLib","pageHTitle","CrPageHeaderTitle","VPointRule","RevenueExpenditure","VMyPoint","pointRules","pointblock","recommendOrHot","toWhere","theme","imgArr","clm","PointProductDetailLevel","DIRECT","myEffectivePoints","myPointTobeExpired","myTotalPoints","pointProductGenre","newPointProducts","hotPointProducts","openExchangeHistory","openRevenueExpenditure","openPointProduct","openPointProductDetail","openPointSign","cSignIn","dateYear","nowPoint","nowPointTip","renderMeSideBar","renderDropdownActions","homeTopicMap","backgroundSize","logo_pointShop","signInIcon","exChangeIcon","renderGenreItem","triangleShadingO","triangleShadingT","topicClump","newRecommend","hotProduct","renderPointRecord","comments","Modal","VContactList","onContactRender","onEditContact","onContactSelected","delContact","onDelContact","okText","okType","cancelText","onOk","onCancel","onNewContact","userContacts","contactList","cSelectShippingContact","modalTitle","editContact","telephoneValidation","mobileValidation","emailValidation","faxValidation","addressDetailValidation","zipCodeValidation","organizationNameValidation","nameValidation","VContact","userContactData","telephone","pickAddress","addressValue","isDefault","onSaveContact","buttonClick","onFormButtonClick","saveContact","VConfirmDeleteContact","ContactDataP","defaultOrganizationName","defaultName","defaultMobile","saveButton","isSave","btnContent","fromOrderCreation","buttonDel","contactData","titleH","triangle","onConfirm","VAddress","provinceId","cityId","countyId","titleHeader","provinces","renderPCC","onProvinceClick","pcc","marginRight","getProvinceCities","cities","onCityClick","saveAddress","getCityCounties","counties","onCountyClick","getCountryProvince","VAddressRW","cAddress","modalTitleS","preLevel","VProvince","VCity","VCounty","CAddress","countryId","GetCountryProvinces","GetProvinceCities","GetCityCounties","Address","newAddress","addressId","CSelectContact","userContact","userContactId","Contact","getSetting","userSetting","getIsDefault","setDefaultContact","saveContactData","contactBox","contactTuid","newContact","newContactId","addContact","newC","getContactList","getContacts","userContactMaps","CSelectShippingContact","contactId","setDefaultShippingContact","CSelectInvoiceContact","invoiceContact","setDefaultInvoiceContact","OrderSuccess","orderCreateResult","pointOrder","organization","exchangeItems","oi","subAmount","exchangeitems","pv","cv","OrderItem","VExchangeHistoryDetail","renderexchangeItem","orderItem","grade","ListTable","columns","VExchangeHistory","exchangeHistory","renderExchangeHistory","openOrderDetail","historyListTable","data-title","VRevenueExpenditure","showList","tipNone","matchData","pagePointHistory","signinPageHistory","headerT","VPointProductDetail","renderVDefaultPost","OffShelf","OffShelfTip","已下架","pointProductsDetail","availablePoints","pointsInsuffTip","renderSelectedLable","DetailSource","giftPlate","VSelectedLable","openSelectedPointProduct","VDefaultPost","infb","productGenre","INDIRECT","CPointProduct","pointInterval","startPoint","endPoint","refreshMypoint","getPoints","myPoints","effectiveLeftPoint","totalLeftPoint","pointYear","initPointProducts","pointProducts","clearSelectedPointsProducts","openMyPoint","getPointProductGenre","getNewPointProducts","getHotPointProducts","VPointProduct","DetailLevel","navCloseByOrderSuccess","fm","getPointProductLibLoad","findProduct","endDate","setPointProductVisits","积分商城","PointProductLib","getPointProductDetailFragment","topic","getPointHistory","PointExchangeSheet","mySheets","presult","concat","orderId","getSheet","VSelectedPointProduct","openExchangeOrder","getDefaultShippingContact","SetPointProductVisits","Genre","GetPointHistory","getPointProductByDifferentPlot","plot","filterByProductGenre","currentGenre","GetPointProductByGenre","genre","pointProductFromGenre","getProductsFromGenre","PointProductGenre","pointproduct","GetNewPointProducts","GetHotPointProducts","getPointsIntervalProducts","getPointsProducts","GetPointProduct","getProductSources","PointProductSource","sourceId","IsContain","nowQuantity","getDataForSave","IsCouponCanUse","couponCode","couponId","salesTask","IsCanUseCoupon","validationResult","types","openMeInfoOptions","userInfoCompletedChecking","openMeInfoFirstOrder","addUsedCoupon","AddUsedCoupon","defaultSetting","contact0","selectContact","cSelect","contactArr","getDefaultSetting","getContact","renderHr","HRCL","HRST","styleObj","backgroundColor","productIsNull","pointIsEnough","currentInterval","themeName","rankInterval","borderC","getTabs","renderList","isToDetail","isShowSelectForm","getRelatedUI","languageCaptions","VPageProduct","material","openMaterial","renderProduct","arrTemplet","renderPack","dealWithPDF","renderPDF","ToVerifyPdf","pdfIcon","renderProductMaterial","MaterialArr","Material","cartLabel","CL","ST","cHome","cCart","renderCartLabel","lineHeight","VPageList","searchKey","onProductClick","productsPager","esproductsPager","esProductsPagerMore","esProductsTotal","currentPage","renderRootSideBar","behavior","block","inline","defaultCurrent","total","showSizeChanger","VPagePDF","parsRenderPDF","fileUrl","isFoundFile","pdfh5","Pdfh5","overflowY","currentFileName","materialCaptions","CName","EName","defLangs","VPageVerifyCode","productOrigin","productLot","captchaInput","selectVal","productOriginTip","productLotTip","captchaTip","materialType","assistContent","captchaUI","lots","tip","langUI","productMsdsVersions","getCaptcha","langArr","currtCaptcha","lot","CProduct","productConverter","queryResults","JumpSource","loadDetail","renderProductWithPrice","fileInfo","toLocaleUpperCase","currentProduct","fetchPdf","arrayBuffer","Type","searchByKey","setItemConverter","SearchProduct","VModelByCreateOrder","renderModelContent","showBack","overflowX","VCreateOrder","shippingAddressTip","invoiceAddressTip","invoiceTip","renderOrderItem","renderOrderItemProduct","orderItemKey","packID","renderCoupon","couponAppliedData","hasAnyCoupon","removeCoupon","offsetUI","remittedUI","noOffsetUI","couponOffsetAmount","couponRemitted","cancelCouponUI","onBuyerAccountChanged","renderBuyerAccount","buyerAccount","o","renderBuyerAccounts","buyerAccounts","renderTip","useShippingAddress","saveShowModal","replyToContactType","onSelectInvoiceContact","onInvoiceInfoEdit","onCouponEdit","getValidCardForWebUser","fontSize","chevronRight","divInvoiceContact","labeled","contentClass","invoiceContactUI","invoiceInfoUI","freightFeeUI","freightFeeRemittedUI","freightFee","freightFeeRemitted","couponUI","orderItems","productAmount","Order","pk","coupon","orderitems","subListAmount","textAlign","paddingTop","VMyOrders","currentState","orderListTable","os","OState","renderOrder","getMyOrders","VOrderDetail","invoiceTemplate","invoiceTypeUI","bank","accountNo","regArr","commonRequired","valueAddedRequired","commonVisible","valueAddedVisible","VInvoiceInfo","saveTip","invoiceInfoData","origInvoice","assure","invoice","saveInvoiceInfo","onSaveInvoice","onInvoiceTypeClick","parseInt","buildForm","renderInvoiceContent","frm","requiredFields","visibleFields","InvoiceTypeChecked","CInvoiceInfo","saveInvoiceInfoData","invoiceBox","InvoiceInfo","newInvoiceInfo","newInvoiceInfoId","InvoiceType","setDefaultInvoice","activityTime","CouponBase","expiredDate","isValid","codeShow","createOrderPriceStrategy","couponData","preferential","validitydate","VIPCard","Coupon","CouponSale","Credits","isAvaliable","BottomDiscount","brandDiscountMap","lastDiscount","discountPrice","thisDiscountSetting","priceInit","IsInActivePeriod","startDate","newDate","getTips","invalidTip","COUPONBASE","VCoupon","renderRight","showDiscountSetting","vipCardId","renderCardDescription","cardDescription","discountShow","renderActivityDescription","renderCardReveal","CardReveal","isOpenMyCouponManage","useddate","expireddate","getEasyDate","getCodeShow","p1","p2","couponUi","tipUI","showModelCardDiscount","VVIPCard","VCredits","VCouponUsed","VCoupleAvailable","couponInput","vipCardForWebUser","coupons","applyCoupon","applySelectedCoupon","vipCardUI","renderModelCardDiscount","couponsForWebUser","creditsForWebUser","cCoupon","COrder","hasCoupons","WebUserBuyerAccount","buyerAccountQResult","getDefaultInvoiceContact","getDefaultInvoiceType","getDefaultInvoiceInfo","FREIGHTFEEFIXED","getCouponValidationResult","vipCardCode","getValidDiscounts","orderAgain","nowDate","usedDate","WebUserCoupon","couponType","WebUserCouponUsed","WebUserCredits","credits","WebUserCreditsUsed","currentUserId","getValidCreditsForWebUser","getValidCouponsForWebUser","validCoupons","applyTo","openMyOrders","GetPendingPayment","valueOf","cInvoiceInfo","newInvoice","orderItemsGrouped","renderContentList","pickProvince","pickCity","pickCounty","renderInvoice","renderValidCard","validCardForWebUser","vipCard","applyCoupon1","couponRet","applyTip","TIT","cSelectInvoiceContact","VRootCategory","renderRootCategory","renderSubCategory","renderThirdCategory","rootCategories","VRootCategorySideBar","pcId","menuId","renderChildren","renderCategoryItem","VCategoryPage","main","breadcrumbs","instruction","instructionUi","instr","$","addClass","renderSubcategory","jL","productcategorylanguage","jl","vL","vl","findRootParent","vs","vItem","renderCategory","CProductCategory","getCategoryInstruction","onClickCategory","pc","productCategoryId","showCategoryPage","loadRoot","ProductCategory","stopCache","GetRootCategory","secend","third","buildChildren","getCategoryChildren","pcTuid","parentS","isM","ProductCategoryLoad","pcCurrentLanguage","GetChildrenCategory","subCategories","secendSubCategory","sub","subProductCategory","subParent","subName","subTotal","VP","searchByCategory","stylePig","backgroundImage","pig","opacity","VMember","recommendationCodeRef","member","recommendationCode","im","inviteCode","divPoints","pointThisWeek","pointAll","fansTitle","fansDetail","setReferrer","CMember","referrer","loginCallback","MemberAction","MemberRecommender","fans","sections","phones","fax","Row","ContactUs","phone","phoneIndex","eIndex","EditMeInfo","onWebUserChanged","webUserData","changeWebUser","onWebUserContactChanged","webUserContactData","changeWebUserContact","webUserSchema","webUserUiSchema","webUserContactSchema","webUserContactUiSchema","firstName","gender","salutation","departmentName","zipCode","AboutThisApp","links","margin","checkVersion","VMe","contactUs","openPrivacy","aboutThisApp","changePassword","openContactList","openInvoice","openCouponManage","openFavorites","meInfo","userSpan","orderStates","aboutRows","openAbout","logOutRows","exit","welcome","meLib","setting","belongs","number1","order1","EditMeInfoFirstOrder","webUserContacts","addContactFromAccount","actionButton","onCompleted","onlyRequired","note","schemaArr","VFavorites","productsFavorites","CFavorites","searchByFavorites","getMyFavirates","VLoginState","renderCarLabel","imgStyle","VAbout","VMeSideBar","CMe","openMeInfo","pick","cPointProduct","openMyCouponManage","cMyFavorites","getCommonText","textId","CommonText","showLoginOut","webUserContact","VMain","faceTabs","VSharedCoupon","products","drawCouponUI","sharedCouponValidationResult","couponDrawed","loginWhenDrawCoupon","countDown","showTips","waitingSeconds","tipsAfterDawed","renderCouponBase","VVIPCardDiscount","renderVIPCardDiscountSetting","VCouponManage","currentStatus","oss","toolTip","getCoupons","receiveCoupon","drawCoupon","conductReveal","CouponViewOrUse","tipsUI","VModelCardDiscount","CardDiscount","renderCardDiscount","couponTips","CCoupon","couponPager","getCouponDiscountSetting","getValidMusterForWebUser","getMyUsedCoupon","getMyExpiredCoupon","getValidVipCardForWebUser","validVIPCardForWebUser","validCouponsForWebUser","validCreditsForWebUser","creditsCode","WebUserVIPCard","curCardDiscount","VIPCardDiscount","showSharedVIPCard","vipcard","productids","autoDrawCouponBase","getProducts","showSharedCoupon","showSharedCredits","couponBaseCode","allowCurrentUser","creditsId","vipCardType","VYncProjects","YncProjectsItems","renderItem","model","returnYncProject","ProjectName","CYncProjects","OrganCode","UserId","YncProjectsResponse","getYncProjects","response","VLottery","prize","lottery","lotteryProducts","productsLib","decreasingNumberOfDraws","winningProduct","speed","currIndex","isLottery","indexMR","mR","roll","lotterySuccess","winning","totalCount","renderLotteryBtn","remainingNumOfDraws","renderPrizesBlock","borderRight","borderLeft","transformOrigin","openMyLotteryPrize","borderRadius","bottom","VMyLotteryPrize","renderMyPrize","myPrize","openMyPrizeOrder","prizeOrder","CLottery","openLotteryProduct","getLotteryProducts","getLotteryNumOfDraws","basedChanceHandlePrizes","getMyPrizes","addMyPrize","PR","base","totalNumPrizes","flat","VPointSign","rulesNum","renderRule","ruleContent","boxShadow","padStart","demandBlock","isSignin","signinval","signTopicMap","积分图标P","已签到","Homemadelogo","CSignIn","isSignined","addSigninSheet","getSigninConsecutiveDays","getSigninHistory","checkIsSignin","Signin","GetPointSigninHistory","WebUser","webUserSettings","setUser","loadWebUser","webUserTuid","WebUserContact","WebUserSetting","WebUserCustomer","RecordLogin","ip","Customer","accountValue","WebUserContacts","newContactBox","saveDefaultSettings","invoiceTypeId","invoiceInfoId","customerSettings","Contractor","CustomerContacts","CustomerSetting","customerContactorMap","contractor","setDefaultSettings","cMember","cFavorites","cYncProjects","navHome","showMain","navSearch","navProduct","navProductMSCU","navCart","navProductCategory","navPointShop","navAbout","navMe","navContactList","navInvoice","navMyOrders","navOrderDetail","navCouponManage","navFavorites","navPassword","navMeInfo","qs","prouductBoxId","VNavHeader","VNavRawHeader","VNavFooter","VNavRawFooter","initTabName","renderLoginState","onNavRoute","loginCallBack","VMainWebNav","NavHeaderView","vLogin","Avatar","vCartLabel","vCount","data-target","aria-label","aria-haspopup","aria-labelledby","NavFooterView","CWeb","setIsWebNav","require","App","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.be483eea.chunk.js","sourcesContent":["export * from './tool';\r\nexport * from './net';\r\nexport * from './components';\r\nexport * from './entry';\r\nexport * from './uq';\r\nexport * from './app';\r\nexport * from './vm';\r\n","export * from './navigo';\r\nexport * from './nav';\r\nexport * from './page';\r\nexport * from './schema';\r\nexport * from './form';\r\nexport * from './edit';\r\nexport * from '../res/res';\r\nexport * from './loading';\r\nexport * from './image';\r\nexport * from './resUploader';\r\nexport * from './rules';\r\nexport * from './list';\r\nexport * from './dropDownActions';\r\nexport * from './easyDate';\r\nexport * from './propGrid';\r\nexport * from './simple';\r\nexport * from './media';\r\nexport * from './searchBox';\r\nexport * from './userIcon';\r\nexport * from './ax';\r\nexport * from './autoHideTips';\r\n","import * as React from 'react';\r\nimport {observable} from 'mobx';\r\nimport _ from 'lodash';\r\nimport {User, Guest/*, UserInNav*/} from '../tool/user';\r\nimport {Page} from './page/page';\r\nimport {netToken} from '../net/netToken';\r\nimport FetchErrorView, { SystemNotifyPage } from './fetchErrorView';\r\nimport {FetchError} from '../net/fetchError';\r\nimport {appUrl, setAppInFrame, getExHash, getExHashPos} from '../net/appBridge';\r\nimport {LocalData, env} from '../tool';\r\nimport {guestApi, logoutApis, setCenterUrl, setCenterToken, appInFrame, host, resUrlFromHost, messageHub} from '../net';\r\n//import { WsBase, wsBridge } from '../net/wsChannel';\r\nimport { resOptions } from '../res/res';\r\nimport { Loading } from './loading';\r\nimport { Navigo, RouteFunc, Hooks, NamedRoute } from './navigo';\r\n\r\nimport 'font-awesome/css/font-awesome.min.css';\r\nimport '../css/va-form.css';\r\nimport '../css/va.css';\r\nimport '../css/animation.css';\r\nimport { FA } from './simple';\r\nimport { userApi } from '../net';\r\nimport { ReloadPage, ConfirmReloadPage } from './reloadPage';\r\nimport { PageWebNav } from './page';\r\n\r\nconst regEx = new RegExp('Android|webOS|iPhone|iPad|' +\r\n    'BlackBerry|Windows Phone|'  +\r\n    'Opera Mini|IEMobile|Mobile' , \r\n    'i');\r\nconst isMobile = regEx.test(navigator.userAgent);\r\n\r\n/*\r\nexport const mobileHeaderStyle = isMobile? {\r\n    minHeight:  '3em'\r\n} : undefined;\r\n*/\r\n//const logo = require('../img/logo.svg');\r\nlet logMark: number;\r\nconst logs:string[] = [];\r\n\r\nexport type NavPage = (params:any) => Promise<void>;\r\n\r\nexport interface Props //extends React.Props<Nav>\r\n{\r\n    onLogined: (isUserLogin?:boolean)=>Promise<void>;\r\n    notLogined?: ()=>Promise<void>;\r\n};\r\nlet stackKey = 1;\r\nexport interface StackItem {\r\n    key: number;\r\n    view: JSX.Element;\r\n    ceased: boolean;\r\n    confirmClose?: ()=>Promise<boolean>;\r\n    disposer?: ()=>void;\r\n}\r\nexport interface NavViewState {\r\n    stack: StackItem[];\r\n    wait: 0|1|2;\r\n    fetchError: FetchError\r\n}\r\n\r\nexport class NavView extends React.Component<Props, NavViewState> {\r\n    private stack: StackItem[];\r\n    private waitCount: number = 0;\r\n    private waitTimeHandler?: NodeJS.Timer;\r\n\r\n    constructor(props:Props) {\r\n        super(props);\r\n        this.stack = [];\r\n        this.state = {\r\n            stack: this.stack,\r\n            wait: 0,\r\n            fetchError: undefined\r\n        };\r\n        nav.set(this);\r\n    }\r\n    async componentDidMount()\r\n    {\r\n\t\twindow.addEventListener('popstate', this.navBack);\r\n\t\t//if (nav.isRouting === false) {\r\n\t\tawait nav.init();\r\n\t\t//}\r\n        await nav.start();\r\n    }\r\n\r\n    get level(): number {\r\n        return this.stack.length;\r\n    }\r\n\r\n    startWait() {\r\n        if (this.waitCount === 0) {\r\n            this.setState({wait: 1});\r\n            this.waitTimeHandler = env.setTimeout(\r\n                'NavView.startWait',\r\n                () => {\r\n                    this.waitTimeHandler = undefined;\r\n                    this.setState({wait: 2});\r\n                },\r\n                1000) as NodeJS.Timer;\r\n        }\r\n        ++this.waitCount;\r\n        this.setState({\r\n            fetchError: undefined,\r\n        });\r\n    }\r\n\r\n    endWait() {\r\n        env.setTimeout(\r\n            undefined, //'NavView.endWait',\r\n            () => {\r\n            /*\r\n            this.setState({\r\n                fetchError: undefined,\r\n            });*/\r\n            --this.waitCount;\r\n            if (this.waitCount === 0) {\r\n                if (this.waitTimeHandler !== undefined) {\r\n                    env.clearTimeout(this.waitTimeHandler);\r\n                    this.waitTimeHandler = undefined;\r\n                }\r\n                this.setState({wait: 0});\r\n            }\r\n        },100);\r\n    }\r\n\r\n    async onError(fetchError: FetchError)\r\n    {\r\n        let err = fetchError.error;\r\n        if (err !== undefined) {\r\n            if (err.unauthorized === true) {\r\n\t\t\t\tawait nav.showLogin(undefined);\r\n\t\t\t\t//nav.navigateToLogin();\r\n                return;\r\n            }\r\n            switch (err.type) {\r\n                case 'unauthorized':\r\n                    await nav.showLogin(undefined);\r\n\t\t\t\t\t//nav.navigateToLogin();\r\n                    return;\r\n                case 'sheet-processing':\r\n                    nav.push(<SystemNotifyPage message=\"单据正在处理中。请重新操作！\" />);\r\n                    return;\r\n            }\r\n        }\r\n        this.setState({\r\n            fetchError: fetchError,\r\n        });\r\n    }\r\n\r\n    private upgradeUq = () => {\r\n        nav.start();\r\n    }\r\n\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        this.show(<Page header={false}>\r\n            <div>\r\n                UQ升级了，请点击按钮升级 <br />\r\n                <small className=\"text-muted\">{uq} ver-{version}</small>\r\n                <button className=\"btn btn-primary\" onClick={this.upgradeUq}>升级</button>\r\n            </div>\r\n        </Page>)\r\n    }\r\n\r\n    show(view: JSX.Element, disposer?: ()=>void): number {\r\n        this.clear();\r\n        return this.push(view, disposer);\r\n    }\r\n\r\n    push(view: JSX.Element, disposer?: ()=>void): number {\r\n        this.removeCeased();\r\n        if (this.stack.length > 0) {\r\n            window.history.pushState('forward', null, null);\r\n        }\r\n        let key = stackKey++;\r\n        this.stack.push({\r\n            key: key,\r\n            view: view, \r\n            ceased: false,\r\n            disposer: disposer\r\n        });\r\n        this.refresh();\r\n        //console.log('push: %s pages', this.stack.length);\r\n        return key;\r\n    }\r\n\r\n    replace(view: JSX.Element, disposer?: ()=>void): number {\r\n        let item:StackItem = undefined;\r\n        let stack = this.stack;\r\n        if (stack.length > 0) {\r\n            item = stack.pop();\r\n            //this.popAndDispose();\r\n        }\r\n        let key = stackKey++;\r\n        this.stack.push({\r\n            key: key, \r\n            view: view, \r\n            ceased: false,\r\n            disposer: disposer\r\n        });\r\n        if (item !== undefined) this.dispose(item.disposer);\r\n        this.refresh();\r\n        //console.log('replace: %s pages', this.stack.length);\r\n        return key;\r\n    }\r\n\r\n    ceaseTop(level:number = 1) {\r\n        let p = this.stack.length - 1;\r\n        for (let i=0; i<level; i++, p--) {\r\n            if (p < 0) break;\r\n            let item = this.stack[p];\r\n            item.ceased = true;\r\n        }\r\n    }\r\n\r\n    pop(level:number = 1) {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        //console.log('pop start: %s pages level=%s', len, level);\r\n        if (level <= 0 || len <= 1) return;\r\n        if (len < level) level = len;\r\n        let backLevel = 0;\r\n        for (let i = 0; i < level; i++) {\r\n            if (stack.length === 0) break;\r\n            //stack.pop();\r\n            this.popAndDispose();\r\n            ++backLevel;\r\n        }\r\n        if (backLevel >= len) backLevel--;\r\n        this.refresh();\r\n        if (this.isHistoryBack !== true) {\r\n            //window.removeEventListener('popstate', this.navBack);\r\n            //window.history.back(backLevel);\r\n            //window.addEventListener('popstate', this.navBack);\r\n        }\r\n        //console.log('pop: %s pages', stack.length);\r\n    }\r\n\r\n    popTo(key: number) {\r\n        if (key === undefined) return;\r\n        if (this.stack.find(v => v.key === key) === undefined) return;\r\n        while (this.stack.length >0) {\r\n            let len = this.stack.length;\r\n            let top = this.stack[len-1];\r\n            if (top.key === key) break;\r\n            this.pop();\r\n        }\r\n    }\r\n\r\n    topKey():number {\r\n        let len = this.stack.length;\r\n        if (len === 0) return undefined;\r\n        return this.stack[len-1].key;\r\n    }\r\n\r\n    removeCeased() {\r\n        for (;;) {\r\n            let p=this.stack.length-1;\r\n            if (p < 0) break;\r\n            let top = this.stack[p];\r\n            if (top.ceased === false) break;\r\n            let item = this.stack.pop();\r\n            let {disposer} = item;\r\n            this.dispose(disposer);\r\n        }\r\n        this.refresh();\r\n    }\r\n\r\n    private popAndDispose() {\r\n        this.removeCeased();\r\n        let item = this.stack.pop();\r\n\t\tif (item === undefined) return;\r\n\t\t//if (nav.isRouting) {\r\n\t\t//\twindow.history.back();\r\n\t\t//}\r\n        let {disposer} = item;\r\n        this.dispose(disposer);\r\n        this.removeCeased();\r\n        return item;\r\n    }\r\n\r\n    private dispose(disposer:()=>void) {\r\n        if (disposer === undefined) return;\r\n        let item = this.stack.find(v => v.disposer === disposer);\r\n        if (item === undefined) disposer();\r\n    }\r\n\r\n    clear() {\r\n        let len = this.stack.length;\r\n        while (this.stack.length > 0) this.popAndDispose();\r\n        //this.refresh();\r\n        if (len > 1) {\r\n            //window.removeEventListener('popstate', this.navBack);\r\n            //window.history.back(len-1);\r\n            //window.addEventListener('popstate', this.navBack);\r\n        }\r\n    }\r\n\r\n    regConfirmClose(confirmClose:()=>Promise<boolean>) {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        if (len === 0) return;\r\n        let top = stack[len-1];\r\n        top.confirmClose = confirmClose;\r\n    }\r\n\r\n    private isHistoryBack:boolean = false;\r\n    navBack = () => {\r\n        //nav.log('backbutton pressed - nav level: ' + this.stack.length);\r\n        let tick = Date.now();\r\n        this.isHistoryBack = true;\r\n        this.back(true);\r\n        this.isHistoryBack = false;\r\n        console.log(`///\\\\\\\\ ${Date.now()-tick}ms backbutton pressed - nav level: ${this.stack.length}`);\r\n    }\r\n\r\n    back = async (confirm:boolean = true) => {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        if (len === 0) return;\r\n        if (len === 1) {\r\n            if (window.self !== window.top) {\r\n                window.top.postMessage({type:'pop-app'}, '*');\r\n            }\r\n            return;\r\n        }\r\n        let top = stack[len-1];\r\n        if (confirm===true && top.confirmClose) {\r\n            if (await top.confirmClose()===true) this.pop();\r\n        }\r\n        else {\r\n            this.pop();\r\n        }\r\n    }\r\n\r\n    confirmBox(message?:string): boolean {\r\n        return window.confirm(message);\r\n    }\r\n    clearError = () => {\r\n        this.setState({fetchError: undefined});\r\n    }\r\n    render() {\r\n        const {wait, fetchError} = this.state;\r\n        let {stack} = this.state;\r\n        let top = stack.length - 1;\r\n        let elWait = null, elError = null;\r\n        switch (wait) {\r\n            case 1:\r\n                elWait = <div className=\"va-wait va-wait1\">\r\n                </div>;\r\n                break;\r\n            case 2:\r\n                elWait = <div className=\"va-wait va-wait2\">\r\n                    <Loading />\r\n                </div>;\r\n                break;\r\n        }\r\n        if (fetchError)\r\n            elError = <FetchErrorView clearError={this.clearError} {...fetchError} />;\r\n        let test = nav.testing===true && \r\n\t\t\t<span className=\"cursor-pointer position-fixed\" style={{top:0,left:'0.2rem',zIndex:90001}}>\r\n                <FA className=\"text-warning\" name=\"info-circle\" />\r\n\t\t\t</span>;\r\n        return <>\r\n\t\t\t{stack.map((item, index) => {\r\n\t\t\t\tlet {key, view} = item;\r\n\t\t\t\treturn <div key={key} style={index<top? {visibility: 'hidden', position: 'absolute'}:undefined}>\r\n\t\t\t\t\t{view}\r\n\t\t\t\t</div>\r\n\t\t\t})}\r\n\t\t\t{elWait}\r\n\t\t\t{elError}\r\n\t\t\t{test}\r\n\t\t</>;\r\n    }\r\n\r\n    private refresh() {\r\n        this.setState({stack: this.stack });\r\n    }\r\n}\r\n\r\nexport interface NavSettings {\r\n    oem?: string;\r\n    loginTop?: JSX.Element;\r\n    privacy?: string;\r\n}\r\n\r\nexport class Nav {\r\n    private navView:NavView;\r\n    //private ws: WsBase;\r\n    private wsHost: string;\r\n    private local: LocalData = new LocalData();\r\n\tprivate navigo: Navigo;\r\n\t//isRouting: boolean = false;\r\n\tnavSettings: NavSettings;\r\n    @observable user: User/*InNav*/ = undefined;\r\n    testing: boolean;\r\n    language: string;\r\n    culture: string;\r\n    resUrl: string;\r\n\r\n    constructor() {\r\n        let {lang, district} = resOptions;\r\n        this.language = lang;\r\n        this.culture = district;\r\n\t\tthis.testing = false;\r\n    }\r\n\r\n    get guest(): number {\r\n        let guest = this.local.guest;\r\n        if (guest === undefined) return 0;\r\n        let g = guest.get();\r\n        if (g === undefined) return 0;\r\n        return g.guest;\r\n    }\r\n\r\n    set(navView:NavView) {\r\n        //this.logo = logo;\r\n        this.navView = navView;\r\n\t}\r\n\t/*\r\n    registerReceiveHandler(handler: (message:any)=>Promise<void>):number {\r\n        //if (this.ws === undefined) return;\r\n        return messageHub.onReceiveAny(handler);\r\n    }\r\n\r\n    unregisterReceiveHandler(handlerId:number) {\r\n        //if (this.ws === undefined) return;\r\n        if (handlerId === undefined) return;\r\n        messageHub.endReceive(handlerId);\r\n    }\r\n\t*/\r\n    async onReceive(msg:any) {\r\n        //if (this.ws === undefined) return;\r\n        await messageHub.dispatch(msg);\r\n    }\r\n\r\n\tprivate async loadUnitJson() {\r\n\t\ttry {\r\n\t\t\tlet unitJsonPath = this.unitJsonPath();\r\n\t\t\tlet unitRes = await fetch(unitJsonPath, {});\r\n\t\t\tlet res = await unitRes.json();\r\n\t\t\treturn res.unit;\r\n\t\t}\r\n\t\tcatch (err1) {\r\n\t\t\tthis.local.unit.remove();\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n    private async getPredefinedUnitName() {\t\t\r\n\t\tlet el = document.getElementById('unit');\r\n\t\tif (el) {\r\n\t\t\treturn el.innerText;\r\n\t\t}\r\n\t\tel = document.getElementById('unit.json');\r\n\t\tif (!el) {\r\n\t\t\treturn await this.loadUnitJson();\r\n\t\t}\r\n\t\ttry {\r\n            let json = el.innerHTML;\r\n            let res = JSON.parse(json);\r\n            return res.unit;\r\n        }\r\n        catch (err) {\r\n\t\t\treturn await this.loadUnitJson();\r\n        }\r\n    }\r\n\r\n    private async loadPredefinedUnit() {\r\n        let envUnit = process.env.REACT_APP_UNIT;\r\n        if (envUnit !== undefined) {\r\n            return Number(envUnit);\r\n        }\r\n        let unitName:string;\r\n        let unit = this.local.unit.get();\r\n        if (unit !== undefined) {\r\n            if (env.isDevelopment !== true) return unit.id;\r\n            unitName = await this.getPredefinedUnitName();\r\n            if (unitName === undefined) return;\r\n            if (unit.name === unitName) return unit.id;\r\n        }\r\n        else {\r\n            unitName = await this.getPredefinedUnitName();\r\n            if (unitName === undefined) return;\r\n        }\r\n        let unitId = await guestApi.unitFromName(unitName);\r\n        if (unitId !== undefined) {\r\n            this.local.unit.set({id: unitId, name: unitName});\r\n        }\r\n        return unitId;\r\n    }\r\n\r\n    setSettings(settings?: NavSettings) {\r\n        this.navSettings = settings;\r\n    }\r\n\r\n    get oem():string {\r\n        return this.navSettings && this.navSettings.oem;\r\n    }\r\n\r\n    hashParam: string;\r\n    private centerHost: string;\r\n    private arrs = ['/test', '/test/'];\r\n    private unitJsonPath():string {\r\n        let {origin, pathname} = document.location;\r\n\t\tpathname = pathname.toLowerCase();\r\n        for (let item of this.arrs) {\r\n            if (pathname.endsWith(item) === true) {\r\n                pathname = pathname.substr(0, pathname.length - item.length);\r\n                break;\r\n            }\r\n        }\r\n        if (pathname.endsWith('/') === true || pathname.endsWith('\\\\') === true) {\r\n            pathname = pathname.substr(0, pathname.length-1);\r\n        }\r\n        return origin + pathname + '/unit.json';\r\n    }\r\n    private windowOnError = (event: Event | string, source?: string, lineno?: number, colno?: number, error?: Error) => {\r\n\t\tdebugger;\r\n        console.error('windowOnError');\r\n        console.error(error);\r\n    }\r\n    private windowOnUnhandledRejection = (ev: PromiseRejectionEvent) => {\r\n\t\tdebugger;\r\n        console.error('windowOnUnhandledRejection');\r\n        console.error(ev.reason);\r\n    }\r\n    private windowOnClick = (ev: MouseEvent) => {\r\n        console.error('windowOnClick');\r\n    }\r\n    private windowOnMouseMove = (ev: MouseEvent) => {\r\n        console.log('navigator.userAgent: ' + navigator.userAgent);\r\n        console.log('mouse move (%s, %s)', ev.x, ev.y);\r\n    }\r\n    private windowOnScroll = (ev: Event) => {\r\n        console.log('scroll event');\r\n\t}\r\n\r\n\tforceDevelopment:boolean;\r\n\t\r\n\tasync init() {\r\n\t\tthis.testing = env.testing;\r\n\t\tif (this.forceDevelopment === true) {\r\n\t\t\tenv.isDevelopment = true;\r\n\t\t}\r\n\t\tawait host.start(this.testing);\r\n\t\tlet hash = document.location.hash;\r\n\t\tif (hash !== undefined && hash.length > 0) {\r\n\t\t\tlet pos = getExHashPos();\r\n\t\t\tif (pos < 0) pos = undefined;\r\n\t\t\tthis.hashParam = hash.substring(1, pos);\r\n\t\t}\r\n\t\tlet {url, ws, resHost} = host;\r\n\t\tthis.centerHost = url;\r\n\t\tthis.resUrl = resUrlFromHost( resHost);\r\n\t\tthis.wsHost = ws;\r\n\t\tsetCenterUrl(url);\r\n\r\n\t\tlet guest:Guest = this.local.guest.get();\r\n\t\tif (guest === undefined) {\r\n\t\t\tguest = await guestApi.guest();\r\n\t\t}\r\n\t\tif (!guest) {\r\n\t\t\tdebugger;\r\n\t\t\tthrow Error('guest can not be undefined');\r\n\t\t}\r\n\t\tnav.setGuest(guest);\r\n\r\n\t\tlet exHash = getExHash();\r\n\t\tlet appInFrame = setAppInFrame(exHash);\r\n\t\tif (exHash !== undefined && window !== window.parent) {\r\n\t\t\t// is in frame\r\n\t\t\tif (appInFrame !== undefined) {\r\n\t\t\t\t//this.ws = wsBridge;\r\n\t\t\t\tconsole.log('this.ws = wsBridge in sub frame');\r\n\t\t\t\t//nav.user = {id:0} as User;\r\n\t\t\t\tif (window.self !== window.parent) {\r\n\t\t\t\t\twindow.parent.postMessage({type:'sub-frame-started', hash: appInFrame.hash}, '*');\r\n\t\t\t\t}\r\n\t\t\t\t// 下面这一句，已经移到 appBridge.ts 里面的 initSubWin，也就是响应从main frame获得user之后开始。\r\n\t\t\t\t//await this.showAppView();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet predefinedUnit = await this.loadPredefinedUnit();\r\n\t\tappInFrame.predefinedUnit = predefinedUnit;\r\n\t}\r\n\r\n    async start() {\r\n        try {\r\n\t\t\twindow.onerror = this.windowOnError;\r\n            window.onunhandledrejection = this.windowOnUnhandledRejection;\r\n            //window.addEventListener('click', this.windowOnClick);\r\n            //window.addEventListener('mousemove', this.windowOnMouseMove);\r\n            //window.addEventListener('touchmove', this.windowOnMouseMove);\r\n            //window.addEventListener('scroll', this.windowOnScroll);\r\n            if (isMobile === true) {\r\n                document.onselectstart = function() {return false;}\r\n                document.oncontextmenu = function() {return false;}\r\n            }\r\n            //window.setInterval(()=>console.error('tick every 5 seconds'), 5000);\r\n\t\t\tnav.clear();\r\n\t\t\t//nav.onSysNavRoutes();\r\n\t\t\tthis.startWait();\r\n            \r\n            let user: User = this.local.user.get();\r\n            if (user === undefined) {\r\n                let {notLogined} = this.navView.props;\r\n                if (notLogined !== undefined) {\r\n                    await notLogined();\r\n                }\r\n                else {\r\n                    await nav.showLogin(undefined);\r\n\t\t\t\t\t//nav.navigateToLogin();\r\n                }\r\n                return;\r\n            }\r\n\r\n            await nav.logined(user);\r\n        }\r\n        catch (err) {\r\n\t\t\tconsole.error(err);\r\n\t\t\tdebugger;\r\n        }\r\n        finally {\r\n            this.endWait();\r\n        }\r\n\t}\r\n\r\n\tresolveRoute() {\r\n\t\t//if (this.isRouting === false) return;\r\n\t\tif (this.navigo === undefined) return;\r\n\t\tthis.navigo.resolve();\r\n\t}\r\n\r\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\ton(...args:any[]):Navigo {\r\n\t\tif (this.navigo === undefined) {\r\n\t\t\tthis.navigo = new Navigo();\r\n\t\t\tif (this.isWebNav !== true) this.navigo.historyAPIUpdateMethod('replaceState');\r\n\t\t}\r\n\t\treturn this.navigo.on(args[0], args[1], args[2]);\r\n\t}\r\n\r\n\tprivate navLogin:NavPage = async (params:any) => {\r\n\t\tnav.showLogin(async (user: User) => window.history.back(), false);\r\n\t}\r\n\r\n\tprivate navLogout:NavPage = async (params:any) => {\r\n\t\tnav.showLogout(async () => window.history.back());\r\n\t}\r\n\r\n\tprivate navRegister:NavPage = async (params:any) => {\r\n\t\tnav.showRegister();\r\n\t}\r\n\r\n\tprivate navForget:NavPage = async (params:any) => {\r\n\t\tnav.showForget();\r\n\t}\r\n\r\n\tnavigateToLogin() {\r\n\t\tnav.navigate('/login');\r\n\t}\r\n\r\n\topenSysPage(url: string) {\r\n\t\tlet navPage: NavPage = this.sysRoutes[url];\r\n\t\tif (navPage === undefined) {\r\n\t\t\talert(url + ' is not defined in sysRoutes');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnavPage(undefined);\r\n\t}\r\n\r\n\tprivate navPageRoutes: {[url:string]: NavPage};\r\n\tprivate routeFromNavPage(navPage: NavPage) {\r\n\t\treturn (params: any, queryStr: any) => {\r\n\t\t\tif (navPage) {\r\n\t\t\t\tif (this.isWebNav) nav.clear();\r\n\t\t\t\tnavPage(params);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tonNavRoute(navPage: NavPage) {\r\n\t\tthis.on(this.routeFromNavPage(navPage));\r\n\t}\r\n\tprivate doneSysRoutes:boolean = false;\r\n\tprivate sysRoutes: { [route: string]: NavPage } = {\r\n\t\t'/login': this.navLogin,\r\n\t\t'/logout': this.navLogout,\r\n\t\t'/register': this.navRegister,\r\n\t\t'/forget': this.navForget,\r\n\t}\r\n\t/*\r\n\tonSysNavRoutes() {\r\n\t\tthis.onNavRoutes(this.sysRoutes);\r\n\t}\r\n\t*/\r\n\tonNavRoutes(navPageRoutes: {[url:string]: NavPage}) {\r\n\t\tif (this.doneSysRoutes === false) {\r\n\t\t\tthis.doneSysRoutes = true;\r\n\t\t\tthis.internalOnNavRoutes(this.sysRoutes);\r\n\t\t}\r\n\t\tthis.internalOnNavRoutes(navPageRoutes);\r\n\t}\r\n\r\n\tprivate internalOnNavRoutes(navPageRoutes: {[url:string]: NavPage}) {\r\n\t\tif (!navPageRoutes) return;\r\n\t\tthis.navPageRoutes = _.merge(this.navPageRoutes, navPageRoutes);\r\n\t\tlet navOns: { [route: string]: (params: any, queryStr: any) => void } = {};\r\n\t\tfor (let route in navPageRoutes) {\r\n\t\t\tlet navPage = navPageRoutes[route];\r\n\t\t\tnavOns[route] = this.routeFromNavPage(navPage);\r\n\t\t}\r\n\t\tthis.on(navOns);\r\n\t}\r\n\r\n\t/*\r\n\tget isWebNav():boolean { \r\n\t\tif (!this.navigo) return false;\r\n\t\treturn !isMobile;\r\n\t}\r\n\t*/\r\n\tisWebNav:boolean = false;\r\n\tbackIcon = <i className=\"fa fa-angle-left\" />;\r\n\tcloseIcon = <i className=\"fa fa-close\" />;\r\n\tsetIsWebNav() {\r\n\t\tthis.isWebNav = true;\r\n\t\tthis.backIcon = <i className=\"fa fa-arrow-left\" />;\r\n\t\tthis.closeIcon = <i className=\"fa fa-close\" />;\r\n\t}\r\n\r\n\tpageWebNav: PageWebNav;\r\n\r\n\tget isMobile():boolean {return isMobile;}\r\n\r\n\tnavigate(url:string, absolute?:boolean) {\r\n\t\tif (!this.navigo) {\r\n\t\t\talert('Is not in webnav state, cannot navigate to url \"' + url + '\"');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.testing === true) url += '#test';\r\n\t\treturn this.navigo.navigate(url, absolute);\r\n\t}\r\n\r\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tif (this.navigo !== undefined) {\r\n\t\t\tthis.navigate(url, absolute);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tshowPage();\r\n\t\t}\r\n\t}\r\n\r\n    async showAppView(isUserLogin?: boolean) {\r\n        let {onLogined} = this.navView.props;\r\n        if (onLogined === undefined) {\r\n            nav.push(<div>NavView has no prop onLogined</div>);\r\n            return;\r\n        }\r\n        nav.clear();\r\n        await onLogined(isUserLogin);\r\n    }\r\n\r\n    setGuest(guest: Guest) {\r\n        this.local.guest.set(guest);\r\n        netToken.set(0, guest.token);\r\n    }\r\n\r\n    saveLocalUser() {\r\n        this.local.user.set(this.user);\r\n    }\r\n\r\n    async loadMe() {\r\n        let me = await userApi.me();\r\n        this.user.icon = me.icon;\r\n        this.user.nick = me.nick;\r\n    }\r\n\r\n\tprivate async internalLogined(user: User, callback: (user:User)=>Promise<void>, isUserLogin:boolean) {\r\n        logoutApis();\r\n        console.log(\"logined: %s\", JSON.stringify(user));\r\n        this.user = user;\r\n        this.saveLocalUser();\r\n\t\tnetToken.set(user.id, user.token);\r\n\t\tnav.clear();\r\n\r\n        if (callback !== undefined) //this.loginCallbacks.has)\r\n            callback(user);\r\n            //this.loginCallbacks.call(user);\r\n        else {\r\n            await this.showAppView(isUserLogin);\r\n        }\r\n\t}\r\n\r\n\t// 缓冲登录\r\n    async logined(user: User, callback?: (user:User)=>Promise<void>) {\r\n\t\tawait this.internalLogined(user, callback, false);\r\n    }\r\n\r\n\t// 用户操作之后登录\r\n    async userLogined(user: User, callback?: (user:User)=>Promise<void>) {\r\n\t\tawait this.internalLogined(user, callback, true);\r\n    }\r\n\r\n    //wsConnect() {\r\n        //let ws:WSChannel = this.ws = new WSChannel(this.wsHost, this.user.token);\r\n        //ws.connect();\r\n    //}\r\n\r\n    loginTop(defaultTop:JSX.Element) {\r\n        return (this.navSettings && this.navSettings.loginTop) || defaultTop;\r\n    }\r\n\r\n    privacyEntry() {\r\n        if (!this.getPrivacyContent()) return;\r\n        return <div className=\"text-center\">\r\n            <button className=\"btn btn-sm btn-link\"\r\n                onClick={this.showPrivacyPage}>\r\n                <small className=\"text-muted\">隐私政策</small>\r\n            </button>\r\n        </div>;\r\n    }\r\n\r\n    private getPrivacyContent():string {\r\n        if (!this.navSettings) return;\r\n        let {privacy} = this.navSettings;\r\n        return privacy;\r\n    }\r\n\r\n    showPrivacyPage = () => {\r\n        let privacy = this.getPrivacyContent();\r\n        if (privacy) {\r\n            this.privacyPage(privacy);\r\n        }\r\n        else {\r\n            nav.push(<Page header=\"隐私政策\">\r\n                <div className=\"p-3\">AppConfig 中没有定义 privacy。可以定义为字符串，或者url。markdown格式</div>\r\n            </Page>);\r\n        }\r\n    }\r\n\r\n    private privacyPage = async (htmlString: string) => {\r\n        //let html = await this.getPrivacy(privacy);\r\n\t\t//let content = {__html: marked(html)};\r\n\t\tlet content = {__html: htmlString};\r\n        nav.push(<Page header=\"隐私政策\">\r\n            <div className=\"p-3\" dangerouslySetInnerHTML={content} />\r\n        </Page>);\r\n    }\r\n/*\r\n    private async getPrivacy(privacy:string):Promise<string> {\r\n        const headers = new  Headers({\r\n            \"Content-Type\":'text/plain'\r\n       })\r\n        let pos = privacy.indexOf('://');\r\n        if (pos > 0) {\r\n            let http = privacy.substring(0, pos).toLowerCase();\r\n            if (http === 'http' || http === 'https') {\r\n                try {\r\n                    let res = await fetch(privacy, {\r\n                        method:'GET',\r\n                        headers: headers,\r\n                    });\r\n                    let text = await res.text();\r\n                    return text;\r\n                }\r\n                catch (err) {\r\n                    return err.message;\r\n                }\r\n            }\r\n        }\r\n        return privacy;\r\n    }\r\n*/\r\n    async showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean) {\r\n        let lv = await import('../entry/login');\r\n        let loginView = React.createElement(\r\n\t\t\tlv.default, \r\n\t\t\t{withBack, callback}\r\n\t\t);\r\n        if (withBack !== true) {\r\n            this.navView.clear();\r\n            this.pop();\r\n        }\r\n        this.navView.push(loginView);\r\n    }\r\n\r\n    async showLogout(callback?: ()=>Promise<void>) {\r\n        let footer = <div className=\"text-center justify-content-center\">\r\n            <button className=\"btn btn-outline-danger\" onClick={this.resetAll}>升级软件</button>\r\n        </div>;\r\n        nav.push(<Page header=\"安全退出\" back=\"close\" footer={footer}>\r\n            <div className=\"my-5 mx-1 border border-info bg-white rounded p-3 text-center\">\r\n                <div>退出当前账号不会删除任何历史数据，下次登录依然可以使用本账号</div>\r\n                <div className=\"mt-3 text-center\">\r\n                        <button className=\"btn btn-danger\" onClick={()=>this.logout(callback)}>安全退出</button>\r\n                </div>\r\n            </div>\r\n        </Page>);\r\n\t}\r\n\t\r\n\tasync showRegister() {\r\n\t\tlet lv = await import('../entry/register');\r\n\t\tlet c = new lv.RegisterController(undefined);\r\n\t\tawait c.start();\r\n\t}\r\n\r\n\tasync showForget() {\r\n\t\tlet lv = await import('../entry/register');\r\n\t\tlet c = new lv.ForgetController(undefined);\r\n\t\tawait c.start();\r\n\t}\r\n\r\n    async logout(callback?:()=>Promise<void>) { //notShowLogin?:boolean) {\r\n        appInFrame.unit = undefined;\r\n        this.local.logoutClear();\r\n        this.user = undefined; //{} as User;\r\n        logoutApis();\r\n        let guest = this.local.guest.get();\r\n        setCenterToken(0, guest && guest.token);\r\n\t\t//this.ws = undefined;\r\n\t\tthis.clear();\r\n        if (callback === undefined)\r\n            await nav.start();\r\n        else\r\n            await callback();\r\n    }\r\n\r\n    async changePassword() {\r\n        let cp = await import('../entry/changePassword');\r\n        nav.push(<cp.ChangePasswordPage />);\r\n    }\r\n\r\n    get level(): number {\r\n        return this.navView.level;\r\n    }\r\n    startWait() {\r\n        this.navView?.startWait();\r\n    }\r\n    endWait() {\r\n        this.navView?.endWait();\r\n    }\r\n    async onError(error: FetchError) {\r\n        await this.navView.onError(error);\r\n    }\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        await this.navView.showUpgradeUq(uq, version);\r\n    }\r\n\r\n    show (view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.show(view, disposer);\r\n    }\r\n    push(view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.push(view, disposer);\r\n    }\r\n    replace(view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.replace(view, disposer);\r\n    }\r\n    pop(level:number = 1) {\r\n        this.navView.pop(level);\r\n    }\r\n    topKey():number {\r\n        return this.navView.topKey();\r\n    }\r\n    popTo(key:number) {\r\n        this.navView.popTo(key);\r\n    }\r\n    clear() {\r\n        this.navView?.clear();\r\n    }\r\n    navBack() {\r\n        this.navView.navBack();\r\n    }\r\n    ceaseTop(level?:number) {\r\n        this.navView.ceaseTop(level);\r\n    }\r\n    removeCeased() {\r\n        this.navView.removeCeased();\r\n    }\r\n    async back(confirm:boolean = true) {\r\n        await this.navView.back(confirm);\r\n    }\r\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        this.navView.regConfirmClose(confirmClose);\r\n    }\r\n    confirmBox(message?:string): boolean {\r\n        return this.navView.confirmBox(message);\r\n    }\r\n    async navToApp(url: string, unitId: number, apiId?:number, sheetType?:number, sheetId?:number):Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            let sheet = this.centerHost.includes('http://localhost:') === true? 'sheet_debug':'sheet'\r\n            let uh = sheetId === undefined?\r\n                    appUrl(url, unitId) :\r\n                    appUrl(url, unitId, sheet, [apiId, sheetType, sheetId]);\r\n            console.log('navToApp: %s', JSON.stringify(uh));\r\n            nav.push(<article className='app-container'>\r\n                <span id={uh.hash} onClick={()=>this.back()} /*style={mobileHeaderStyle}*/>\r\n                    <i className=\"fa fa-arrow-left\" />\r\n                </span>\r\n                {\r\n                    // eslint-disable-next-line \r\n                    <iframe src={uh.url} title={String(sheetId)} />\r\n                }\r\n            </article>, \r\n            ()=> {\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n\r\n    navToSite(url: string) {\r\n        // show in new window\r\n        window.open(url);\r\n    }\r\n\r\n    get logs() {return logs};\r\n    log(msg:string) {\r\n        logs.push(msg);\r\n    }\r\n    logMark() {\r\n        let date = new Date();\r\n        logMark = date.getTime();\r\n        logs.push('log-mark: ' + date.toTimeString());\r\n    }\r\n    logStep(step:string) {\r\n        logs.push(step + ': ' + (new Date().getTime() - logMark));\r\n    }\r\n\r\n    showReloadPage(msg: string) {\r\n        let seconds = -1;\r\n\t\tthis.push(<ReloadPage message={msg} seconds={seconds} />);\r\n\t\t/*\r\n\t\tif (seconds > 0) {\r\n\t\t\tenv.setTimeout(undefined, this.reload, seconds*1000);\r\n\t\t}\r\n\t\t*/\r\n    }\r\n\r\n    reload = async () => {\r\n        let waiting:Promise<void> = new Promise<void>((resolve, reject) => {\r\n            setTimeout(resolve, 100);\r\n        });\r\n\r\n        if ('serviceWorker' in navigator) {\r\n            let registration =await Promise.race([waiting, navigator.serviceWorker.ready]);\r\n            if (registration) registration.unregister();\r\n        }\r\n\t\twindow.document.location.reload();\r\n\t\t// dcloud hbuilder里面的app自动升级，需要清webview的缓存\r\n\t\tlet plus = (window as any).plus;\r\n\t\tif (plus) {\r\n\t\t\tlet webview = plus.webview;\r\n\t\t\tif (webview) {\r\n\t\t\t\tif (webview.reload) webview.reload(true);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet webView = plus.webView;\r\n\t\t\t\tif (webView) {\r\n\t\t\t\t\tif (webView.reload) webView.reload(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//plus.webview.reload(true)\r\n\t\t}\r\n    }\r\n\r\n    resetAll = () => {\r\n        this.push(<ConfirmReloadPage confirm={(ok:boolean):Promise<void> => {\r\n            if (ok === true) {\r\n                this.showReloadPage('彻底升级');\r\n\t\t\t\tlocalStorage.clear();\r\n\t\t\t\t/*\r\n                this.local.readToMemory();\r\n                env.localDb.removeAll();\r\n\t\t\t\tthis.local.saveToLocalStorage();\r\n\t\t\t\t*/\r\n            }\r\n            else {\r\n                this.pop();\r\n            }\r\n            return;\r\n        }} />);\r\n    }\r\n\r\n    async checkVersion():Promise<string> {\r\n        let {href} = document.location;\r\n        href += (href.indexOf('?')>=0? '&':'?') + '_t_t_=' + new Date().getTime();\r\n        let ret = await fetch(href);\r\n        let r = await ret.text();\r\n        let parser = new DOMParser();\r\n        let htmlDoc = parser.parseFromString(r, 'text/html');\r\n        let elHtml = htmlDoc.getElementsByTagName('html');\r\n        let newVersion = elHtml[0].getAttribute('data-version');\r\n        return newVersion;\r\n    }\r\n}\r\nexport const nav: Nav = new Nav();\r\n\r\nexport class TonvaView extends NavView {\r\n\r\n}\r\n","\r\nimport {setCenterToken} from './uqApi';\r\nimport {WSChannel} from './wsChannel';\r\n\r\nexport const netToken = {\r\n    set(userId:number, token:string) {\r\n        setCenterToken(userId, token);\r\n        WSChannel.setCenterToken(token);\r\n    },\r\n    clear() {\r\n        setCenterToken(0, undefined);\r\n        WSChannel.setCenterToken(undefined);\r\n    }\r\n};\r\n","import * as React from 'react';\r\nimport {FetchError} from '../net/fetchError';\r\nimport { refetchApi } from '../net';\r\nimport { Page } from './page/page';\r\n\r\nexport interface FetchErrorProps extends FetchError {\r\n    clearError: ()=>void\r\n}\r\n\r\nexport default class FetchErrorView extends React.Component<FetchErrorProps, null> {\r\n    private reApi = async () => {\r\n        this.props.clearError();\r\n        const {channel, url, options, resolve, reject} = this.props;\r\n        await refetchApi(channel, url, options, resolve, reject);\r\n    }\r\n    private close = async () => {\r\n        this.props.clearError();\r\n    }\r\n    render() {\r\n        let {error, url} = this.props;\r\n        let errContent:any;\r\n        if (typeof error === 'object') {\r\n            let err = [];\r\n            for (let i in error) {\r\n                err.push(<li key={i}><label>{i}</label><div style={{wordWrap:\"break-word\"}}>{error[i]}</div></li>);\r\n            }\r\n            errContent = <ul>{err}</ul>;\r\n        }\r\n        else {\r\n            errContent = <div>{error}</div>;\r\n        }\r\n        return <div>\r\n            <article>\r\n\t\t\t\t<main className=\"va-error\">\r\n\t\t\t\t\t<div>网络出现问题</div>\r\n\t\t\t\t\t<div>点击重新访问</div>\r\n\t\t\t\t\t<div style={{wordWrap:\"break-word\"}}>url: {url}</div>\r\n\t\t\t\t\t{errContent}\r\n\t\t\t\t\t<div className=\"p-3\">\r\n\t\t\t\t\t\t<button type='button' onClick={this.reApi}>重新API</button>\r\n\t\t\t\t\t\t<button type='button' onClick={this.close}>关闭</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</main>\r\n            </article>\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport const SystemNotifyPage = ({message}:{message:string}):JSX.Element => {\r\n    return <Page header=\"系统提醒\">\r\n        <div className=\"px-3\">{message}</div>\r\n    </Page>;\r\n}","import * as React from 'react';\r\nimport { nav } from './nav';\r\nimport { Page } from './page/page';\r\n\r\ninterface Props {\r\n    message: string,\r\n    seconds: number\r\n}\r\n\r\ninterface State {\r\n    seconds: number\r\n}\r\n\r\nexport class ReloadPage extends React.Component<Props, State> {\r\n    private timerHandler:any;\r\n    constructor(props:Props) {\r\n\t\tsuper(props);\r\n\t\tlet {seconds} = props;\r\n\t\tif (seconds===undefined) return;\r\n        this.state = {seconds};\r\n\t\tif (seconds <= 0) return;\r\n        this.timerHandler = setInterval(() => {\r\n\t\t\tlet {seconds} = this.state;\r\n            seconds--;\r\n            if (seconds <= 0) {\r\n                this.reload();\r\n            }\r\n            else {\r\n                this.setState({seconds: seconds});\r\n            }\r\n        }, 1000);\r\n    }\r\n    private reload = () => {\r\n        clearInterval(this.timerHandler);\r\n        nav.reload();\r\n    }\r\n    render() {\r\n\t\tlet {seconds} = this.state;\r\n\t\tlet title:string, msg:string;\t\t\r\n\t\tif (seconds > 0) {\r\n\t\t\ttitle = '程序升级中...';\r\n\t\t\tmsg = this.state.seconds + '秒钟之后自动重启动';\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttitle = '程序需要升级';\r\n\t\t\tmsg = '请点击下面按钮重启';\r\n\t\t}\r\n        return <Page header={false}>\r\n            <div className=\"text-center p-5\">\r\n                <div className=\"text-info py-5\">\r\n\t\t\t\t\t<span className=\"text-danger\">{title}</span>\r\n\t\t\t\t\t<br/>\r\n\t\t\t\t\t{msg}\r\n                    <br/>\r\n                    <span className=\"small text-muted\">{this.props.message}</span>\r\n                </div>\r\n                <button className=\"btn btn-danger\" onClick={this.reload}>立刻重启</button>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\ninterface ConfirmReloadPageProps {\r\n    confirm: (ok: boolean)=>Promise<void>;\r\n}\r\nexport const ConfirmReloadPage = (props: ConfirmReloadPageProps):JSX.Element => {\r\n    return <Page header=\"升级软件\" back=\"close\">\r\n        <div className=\"py-5 px-3 my-5 mx-2 border bg-white rounded\">\r\n            <div className=\"text-center text-info\">\r\n                升级将清除所有本机缓冲区内容，并从服务器重新安装程序！\r\n            </div>\r\n            <div className=\"text-center mt-5\">\r\n                <button className=\"btn btn-danger mr-3\" onClick={()=>props.confirm(true)}>确认升级</button>\r\n            </div>\r\n        </div>\r\n    </Page>;\r\n    // <button className=\"btn btn-outline-danger\" onClick={()=>props.confirm(false)}>暂不</button>\r\n}\r\n","import { decodeGuestToken } from '../tool/user';\r\nimport { CenterApiBase } from './uqApi';\r\n\r\nexport class GuestApi extends CenterApiBase {\r\n    async guest(): Promise<any> {\r\n        //let guest = nav.local.guest.get();\r\n        let ret = await this.get('', {});\r\n        switch (typeof ret) {\r\n            default: return;\r\n            case 'string': return decodeGuestToken(ret);\r\n            case 'object':\r\n                let guest = decodeGuestToken(ret.token);\r\n                return guest;\r\n        }\r\n    }\r\n\r\n    async unitFromName(unitName:string): Promise<number> {\r\n        let ret = await this.get(unitName);\r\n        return ret && ret.unit;\r\n    }\r\n}\r\n\r\nexport const guestApi = new GuestApi('tv/guest/', undefined);\r\n","export abstract class Caller<T> {\r\n    protected readonly _params: T;\r\n    constructor(params: T, waiting: boolean) {\r\n        this._params = params;\r\n        this.waiting = waiting;\r\n    }\r\n    protected get params():any {return this._params;}\r\n    buildParams():any {return this.params;}\r\n    method: string  = 'POST';\r\n    abstract get path(): string;\r\n    get headers(): {[header:string]: string} {return undefined}\r\n    waiting: boolean;\r\n}\r\n","import {observable} from 'mobx';\r\n\r\nexport interface Id {\r\n    id: number;\r\n}\r\n\r\nexport abstract class CacheIds<T extends Id> {\r\n    constructor(maxCount:number = 100) {\r\n        this.maxCount = maxCount;\r\n    }\r\n    private maxCount:number;\r\n    private arr:T[] = [];\r\n    @observable dict = new Map<number, T>();\r\n\r\n    loadIds(ids:number[]) {\r\n        let arr:number[] = [];\r\n        for (let id of ids) {\r\n            if (id === null) continue;\r\n            let item = this.dict.get(id);\r\n            if (item === undefined) {\r\n                arr.push(id);\r\n                item = {id:id} as T;\r\n                this.dict.set(id, item);\r\n            }\r\n        }                \r\n        this.loadId(arr);\r\n    }\r\n\r\n    get(id:number):T {\r\n        if (id === undefined || id === null) return null;\r\n        let item = this.dict.get(id);\r\n        if (item === undefined) {\r\n            this.dict.set(id, {id:id} as T);\r\n            this.loadId([id]);\r\n            item = this.dict.get(id);\r\n        }\r\n        return item;\r\n    }\r\n    private setItem(id:number, item:T) {\r\n        if (item === undefined) {\r\n            this.dict.set(id, null);\r\n            this.arr.push({id: id} as T);\r\n        }\r\n        else {\r\n            this.dict.set(id, item);\r\n            this.arr.push(item);\r\n        }\r\n        if (this.arr.length > this.maxCount) {\r\n            item = this.arr.shift();\r\n            this.dict.delete(item.id);\r\n        }\r\n    }\r\n    private async loadId(ids:number[]) {\r\n        let items = await this._loadIds(ids);\r\n        if (items === undefined) {\r\n            for (let id of ids) {\r\n                if (id === null) continue;\r\n                let item = await this._loadId(id);\r\n                this.setItem(id, item);\r\n            }\r\n        }\r\n        else {\r\n            for (let id of ids) {\r\n                let item = items.find(v => v.id === id);\r\n                this.setItem(id, item);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected abstract _loadIds(ids:number[]):Promise<T[]>;\r\n    protected abstract _loadId(id:number):Promise<T>;\r\n}\r\n","import { env } from './env';\r\n\r\nexport class LocalData {\r\n    user = env.localDb.child('user');\r\n    guest = env.localDb.child('guest');\r\n    unit = env.localDb.child('unit');\r\n\r\n    private _user:string;\r\n    private _guest:string;\r\n    private _unit:string;\r\n    readToMemory() {\r\n        this._user = this.user.get();\r\n        this._guest = this.guest.get();\r\n        this._unit = this.unit.get();\r\n    }\r\n    saveToLocalStorage() {\r\n        this.user.set(this._user);\r\n        this.guest.set(this._guest);\r\n        this.unit.set(this._unit);\r\n    }\r\n\r\n    logoutClear() {\r\n        [\r\n            this.user,\r\n            this.unit,\r\n        ].forEach(d => d.remove());\r\n    }\r\n}\r\n","export function getObjPropIgnoreCase(obj:any, prop:string):any {\r\n\tif (!obj) return;\r\n\tif (!prop) return;\r\n\tlet keys = Object.keys(obj);\r\n\tprop = prop.toLowerCase();\r\n\tfor (let key of keys) {\r\n\t\tif (key.toLowerCase() === prop) return obj[key];\r\n\t}\r\n\treturn;\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport {PageHeaderProps, renderPageHeader} from './pageHeader';\r\nimport { TabsProps, TabsView } from './tabs';\r\nimport { ScrollProps, ScrollView, PageWebNav, WebNavScrollView } from './scrollView';\r\nimport { nav } from '../nav';\r\n\r\nexport interface IVPage {\r\n\tcontent():JSX.Element;\r\n\theader():JSX.Element|string;\r\n\tfooter():JSX.Element;\r\n}\r\n\r\nexport interface PageProps extends ScrollProps {\r\n    back?: 'close' | 'back' | 'none';\r\n    header?: boolean | string | JSX.Element;\r\n    right?: JSX.Element;\r\n    footer?: JSX.Element;\r\n    logout?: boolean | (()=>Promise<void>);\r\n\theaderClassName?: string;\r\n\tclassName?: string;\r\n\tafterBack?: () => void;\r\n\ttabsProps?: TabsProps;\r\n\twebNav?: PageWebNav;\r\n}\r\n\r\n@observer\r\nexport class Page extends React.Component<PageProps> {\r\n\tprivate tabsView: TabsView;\r\n    constructor(props: PageProps) {\r\n\t\tsuper(props);\r\n\t\tlet {tabsProps} = props;\r\n\t\tif (tabsProps) {\r\n\t\t\tthis.tabsView = new TabsView(tabsProps);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate renderHeader(webNav?: PageWebNav) {\r\n\t\tconst {back, header, right, headerClassName, afterBack, logout} = this.props;\r\n\t\tif (header === false) return;\r\n\t\t//const {webNav} = this.props;\r\n\t\tlet inWebNav = false;\r\n\t\tlet pageHeaderProps:PageHeaderProps = {\r\n\t\t\tback,\r\n\t\t\tcenter: header as any,\r\n\t\t\tright,\r\n\t\t\tlogout,\r\n\t\t\tclassName: headerClassName,\r\n\t\t\tafterBack,\r\n\t\t};\r\n\t\tif (webNav !== undefined) {\r\n\t\t\tinWebNav = true;\r\n\t\t\tlet {renderPageHeader: rph} = webNav;\r\n\t\t\tif (rph) return rph(pageHeaderProps);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinWebNav = false;\r\n\t\t}\r\n\t\treturn renderPageHeader(pageHeaderProps, inWebNav);\r\n\t\t/*\r\n\t\tlet pageHeader = header !== false && <PageHeader \r\n\t\t\tback={back} \r\n\t\t\tcenter={header as any}\r\n\t\t\tright={right}\r\n\t\t\tlogout={this.props.logout}\r\n\t\t\tclassName={headerClassName}\r\n\t\t\tafterBack={afterBack}\r\n\t\t\t/>;\r\n\t\treturn pageHeader;\r\n\t\t*/\r\n\t}\r\n\r\n\tprivate renderFooter(webNav?: PageWebNav) {\r\n\t\tconst {footer} = this.props;\r\n\t\tif (!footer) return;\r\n\t\tlet elFooter = <footer>{footer}</footer>;\r\n\t\tif (webNav) return elFooter;\r\n\t\treturn <>\r\n\t\t\t<section className=\"tv-page-footer\">{elFooter}</section>\r\n\t\t\t{elFooter}\r\n\t\t</>;\r\n\t}\r\n\r\n\tcomponentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n\t\t// You can also log the error to an error reporting service\r\n\t\t//logErrorToMyService(error, errorInfo);\r\n\t\tdebugger;\r\n\t}\r\n\t\r\n    render() {\r\n\t\tif (this.tabsView) {\r\n\t\t\treturn React.createElement(this.tabsView.content);\r\n\t\t}\r\n\t\tconst {onScroll, onScrollTop, onScrollBottom, children, className, webNav} = this.props;\r\n\t\tlet pageWebNav:PageWebNav;\r\n\t\tif (!webNav) {\r\n\t\t\tpageWebNav = nav.pageWebNav;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpageWebNav = webNav;\r\n\t\t}\r\n\t\tlet content = <>\r\n\t\t\t{this.renderHeader(pageWebNav)}\r\n\t\t\t<main>{children}</main>\r\n\t\t\t{this.renderFooter(pageWebNav)}\r\n\t\t</>;\r\n\t\tif (pageWebNav) {\r\n\t\t\treturn <WebNavScrollView\r\n\t\t\t\tonScroll={onScroll}\r\n\t\t\t\tonScrollTop={onScrollTop}\r\n\t\t\t\tonScrollBottom={onScrollBottom}\r\n\t\t\t\tclassName={className}\r\n\t\t\t\twebNav={pageWebNav}\r\n\t\t\t>\r\n\t\t\t\t{content}\r\n\t\t\t</WebNavScrollView>;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn <ScrollView\r\n\t\t\t\tonScroll={onScroll}\r\n\t\t\t\tonScrollTop={onScrollTop}\r\n\t\t\t\tonScrollBottom={onScrollBottom}\r\n\t\t\t\tclassName={className}\r\n\t\t\t>\r\n\t\t\t\t{content}\r\n\t\t\t</ScrollView>;\r\n\t\t}\r\n\t}\r\n}\r\n","import _ from 'lodash';\r\nimport {nav} from '../components';\r\nimport {uid} from '../tool/uid';\r\nimport {uqTokenApi, callCenterapi, centerToken, setCenterToken} from './uqApi';\r\nimport {setSubAppWindow} from './wsChannel';\r\nimport { host } from './host';\r\n\r\nexport interface UqToken {\r\n    name: string;\r\n    db: string;\r\n    url: string;\r\n    token: string;\r\n}\r\nconst uqTokens:{[uqName:string]: UqToken}  = {};\r\nexport function logoutUqTokens() {\r\n    for (let i in uqTokens) {\r\n        uqTokens[i] = undefined;\r\n    }\r\n}\r\n\r\nexport interface AppInFrame {\r\n    hash: string;\r\n    unit: number;       // unit id\r\n    page?: string;\r\n    param?: string[];\r\n    predefinedUnit?: number;  // 比如像Cart这样的应用，直接让用户访问的，就需要在unit.json里面定义unitName\r\n}\r\nconst appsInFrame:{[key:string]:AppInFrame} = {};\r\n\r\nclass AppInFrameClass implements AppInFrame {\r\n    hash: string;\r\n    private _unit: number;\r\n    get unit(): number {return this._unit;}       // unit id\r\n    set unit(val:number) { this._unit=val;}\r\n    page?: string;\r\n    param?: string[];\r\n}\r\n\r\nexport let appInFrame:AppInFrame = new AppInFrameClass();\r\n/* {\r\n    hash: undefined,\r\n    get unit():number {return } undefined, //debugUnitId,\r\n    page: undefined;\r\n    param: undefined,\r\n}*/\r\n\r\nexport function isBridged():boolean {\r\n    return window.self !== window.parent;\r\n}\r\n\r\nwindow.addEventListener('message', async function(evt) {\r\n    var message = evt.data;\r\n    switch (message.type) {\r\n        case 'sub-frame-started':\r\n            subFrameStarted(evt);\r\n            break;\r\n        case 'ws':\r\n            //wsBridge.receive(message.msg);\r\n            await nav.onReceive(message.msg);\r\n            break;\r\n        case 'init-sub-win':\r\n            await initSubWin(message);\r\n            break;\r\n        case 'pop-app':\r\n            window.console.log('///\\\\\\\\\\\\ pop-app');\r\n            nav.navBack();\r\n            break;\r\n        case 'center-api':\r\n            await callCenterApiFromMessage(evt.source as Window, message);\r\n            break;\r\n        case 'center-api-return':\r\n            bridgeCenterApiReturn(message);\r\n            break;\r\n        case 'app-api':\r\n            let ret = await onReceiveAppApiMessage(message.hash, message.apiName);\r\n            (evt.source as Window).postMessage({\r\n                type: 'app-api-return', \r\n                apiName: message.apiName,\r\n                db: ret.db,\r\n                url: ret.url,\r\n                token: ret.token} as any, \"*\");\r\n            break;\r\n        case 'app-api-return':\r\n            console.log(\"app-api-return: %s\", JSON.stringify(message));\r\n            console.log('await onAppApiReturn(message);');\r\n            await onAppApiReturn(message);\r\n            break;\r\n        default:\r\n\t\t\tif ((message.source as string)?.startsWith('react-devtools') === true) break;\r\n            window.console.log('message: %s', JSON.stringify(message));\r\n            break;\r\n    }\r\n});\r\n\r\nfunction subFrameStarted(evt:any) {\r\n    var message = evt.data;\r\n    let subWin = evt.source as Window;\r\n    setSubAppWindow(subWin);\r\n    hideFrameBack(message.hash);\r\n    let msg:any = _.clone(nav.user);\r\n    msg.type = 'init-sub-win';\r\n    subWin.postMessage(msg, '*');\r\n}\r\nfunction hideFrameBack(hash:string) {\r\n    let el = document.getElementById(hash);\r\n    if (el !== undefined) el.hidden = true;\r\n}\r\nasync function initSubWin(message:any) {\r\n    console.log('initSubWin: set nav.user', message);\r\n    let user = nav.user = message; // message.user;\r\n    setCenterToken(user.id, user.token);\r\n    await nav.showAppView();\r\n}\r\nasync function onReceiveAppApiMessage(hash: string, apiName: string): Promise<UqToken> {\r\n    let appInFrame = appsInFrame[hash];\r\n    if (appInFrame === undefined) return {name:apiName, db:undefined, url:undefined, token:undefined};\r\n    //let unit = getUnit();\r\n    let {unit, predefinedUnit} = appInFrame;\r\n    unit = unit || predefinedUnit;\r\n    if (!unit) {\r\n        console.error('no unit defined in unit.json or in index.html, or not logined in', unit);\r\n    }\r\n    let parts = apiName.split('/');\r\n    let param = {unit: unit, uqOwner: parts[0], uqName: parts[1], appOwner: parts[2], appName:parts[3]};\r\n    console.log('uqTokenApi.uq onReceiveAppApiMessage', param);\r\n    let ret = await uqTokenApi.uq(param);\r\n    let {db, url, token} = ret;\r\n    return {name: apiName, db:db, url: url, token: token};\r\n}\r\n\r\nasync function onAppApiReturn(message:any) {\r\n    let {apiName, db, url, urlTest, token} = message;\r\n    let action = uqTokenActions[apiName];\r\n    if (action === undefined) {\r\n        throw new Error('error app api return');\r\n        //return;\r\n    }\r\n    let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n    console.log('onAppApiReturn(message:any): url=' + url + ', real=' + realUrl);\r\n    //action.url = realUrl;\r\n    //action.token = token;\r\n    action.resolve({\r\n        name: apiName,\r\n        db: db,\r\n        url: realUrl,\r\n        token: token,\r\n    } as UqToken);\r\n}\r\n\r\nexport function setAppInFrame(appHash: string):AppInFrame {\r\n    if (appHash) {\r\n        let parts = appHash.split('-');\r\n        let len = parts.length;\r\n        if (len > 0) {\r\n            let p = 1;\r\n            appInFrame.hash = parts[p++];\r\n            if (len>0) appInFrame.unit = Number(parts[p++]);\r\n            if (len>1) appInFrame.page = parts[p++];\r\n            if (len>2) appInFrame.param = parts.slice(p++);\r\n        }\r\n    }\r\n    return appInFrame;\r\n}\r\n\r\nexport function getExHashPos():number {\r\n    let hash = document.location.hash;\r\n    if (hash !== undefined && hash.length > 0) {\r\n        let pos = hash.lastIndexOf('#tv-');\r\n        if (pos < 0) pos = hash.lastIndexOf('#tvdebug-');\r\n        return pos;\r\n    }\r\n    return -1;\r\n}\r\n\r\nexport function getExHash():string {\r\n    let pos = getExHashPos();\r\n    if (pos < 0) return undefined;\r\n    return document.location.hash.substring(pos);\r\n}\r\n\r\nexport function appUrl(url: string, unitId: number, page?:string, param?:any[]):{url:string; hash:string} {\r\n    let u:string;\r\n    for (;;) {\r\n        u = uid();\r\n        let a = appsInFrame[u];\r\n        if (a === undefined) {\r\n            appsInFrame[u] = {hash:u, unit:unitId};\r\n            break;\r\n        }\r\n    }\r\n    url += '#tv-' + u + '-' + unitId;\r\n    if (page !== undefined) {\r\n        url += '-' + page;\r\n        if (param !== undefined) {\r\n            for (let i=0; i<param.length; i++) {\r\n                url += '-' + param[i];\r\n            }\r\n        }\r\n    }\r\n    return {url: url, hash: u};\r\n}\r\n\r\nfunction getUnit():number {\r\n\tlet {unit, predefinedUnit} = appInFrame;\r\n    let realUnit = unit || predefinedUnit;\r\n    if (realUnit === undefined) {\r\n        throw new Error('no unit defined in unit.json or not logined in');\r\n\t}\r\n    return realUnit;\r\n}\r\n\r\ninterface UqTokenAction {\r\n    resolve: (value?: UqToken | PromiseLike<UqToken>) => void;\r\n    reject: (reason?: any) => void;\r\n}\r\nconst uqTokenActions:{[uq:string]: UqTokenAction} = {};\r\nexport async function buildAppUq(uq:string, uqOwner:string, uqName:string, appOwner:string, appName:string):Promise<void> {\r\n    if (!isBridged()) {\r\n        let unit = getUnit();\r\n        let uqToken = await uqTokenApi.uq({unit,  uqOwner, uqName, appOwner, appName});\r\n        if (uqToken.token === undefined) uqToken.token = centerToken;\r\n        let {db, url, urlTest} = uqToken;\r\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n        console.log('realUrl: %s', realUrl);\r\n        uqToken.url = realUrl;\r\n        uqTokens[uq] = uqToken;\r\n        return uqToken;\r\n    }\r\n    console.log(\"**** before buildAppUq ****\", appInFrame);\r\n    let bp = uqTokenActions[uq];\r\n    if (bp !== undefined) return;\r\n    return new Promise<void>((resolve, reject) => {\r\n        uqTokenActions[uq] = {\r\n            resolve: async (at:any) => {\r\n                let {db, url, token} = await at;\r\n                uqTokens[uq] = {\r\n                    name: uq,\r\n                    db: db,\r\n                    url: url,\r\n                    token: token,\r\n                };\r\n                uqTokenActions[uq] = undefined;\r\n                console.log(\"**** after buildAppUq ****\", appInFrame);\r\n                resolve();\r\n            },\r\n            reject: reject,\r\n        };\r\n        (window.opener || window.parent).postMessage({\r\n            type: 'app-api',\r\n            apiName: uq,\r\n            hash: appInFrame.hash,\r\n        }, \"*\");\r\n    });\r\n}\r\n\r\nexport function appUq(uq:string):UqToken {\r\n    let uts = uqTokens;\r\n    return uts[uq];\r\n}\r\n\r\ninterface BridgeCenterApi {\r\n    id: string;\r\n    resolve: (value?:any)=>any;\r\n    reject: (reason?:any)=>void;\r\n}\r\nconst brideCenterApis:{[id:string]: BridgeCenterApi} = {};\r\nexport async function bridgeCenterApi(url:string, method:string, body:any):Promise<any> {\r\n    console.log('bridgeCenterApi: url=%s, method=%s', url, method);\r\n    return await new Promise<any>(async (resolve, reject) => {\r\n        let callId:string;\r\n        for (;;) {\r\n            callId = uid();\r\n            let bca = brideCenterApis[callId];\r\n            if (bca === undefined) {\r\n                brideCenterApis[callId] = {\r\n                    id: callId,\r\n                    resolve: resolve,\r\n                    reject: reject,\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        (window.opener || window.parent).postMessage({\r\n            type: 'center-api',\r\n            callId: callId,\r\n            url: url,\r\n            method: method,\r\n            body: body\r\n        }, '*');\r\n    });\r\n}\r\n\r\nasync function callCenterApiFromMessage(from:Window, message:any):Promise<void> {\r\n    let {callId, url, method, body} = message;\r\n    let result = await callCenterapi.directCall(url, method, body);\r\n    from.postMessage({\r\n        type: 'center-api-return',\r\n        callId: callId,\r\n        result: result,\r\n    }, '*');\r\n}\r\n\r\nfunction bridgeCenterApiReturn(message:any) {\r\n    let {callId, result} = message;\r\n    let bca = brideCenterApis[callId];\r\n    if (bca === undefined) return;\r\n    brideCenterApis[callId] = undefined;\r\n    bca.resolve(result);\r\n}\r\n","import { UqApi } from '../net';\r\nimport { LocalCache } from '../tool';\r\nimport { UqMan, Field, ArrFields, FieldMap } from './uqMan';\r\nimport { Tuid } from './tuid';\r\nimport { getObjPropIgnoreCase } from '../tool';\r\n\r\nconst tab = '\\t';\r\nconst ln = '\\n';\r\nconst chars = '\\\\ntbfvr';\r\nconst codeBackSlash = chars.charCodeAt(0);\r\nconst codeN = chars.charCodeAt(1);\r\nconst codeT = chars.charCodeAt(2);\r\nconst codeB = chars.charCodeAt(3);\r\nconst codeF = chars.charCodeAt(4);\r\nconst codeV = chars.charCodeAt(5);\r\nconst codeR = chars.charCodeAt(6);\r\n\r\nconst codes = '\\n\\t\\b\\f\\v\\r';\r\nconst codeBN = codes.charCodeAt(0);\r\nconst codeBT = codes.charCodeAt(1);\r\nconst codeBB = codes.charCodeAt(2);\r\nconst codeBF = codes.charCodeAt(3);\r\nconst codeBV = codes.charCodeAt(4);\r\nconst codeBR = codes.charCodeAt(5);\r\n\r\nexport abstract class Entity {\r\n    private jName: string;\r\n    schema: any;\r\n    ver: number = 0;\r\n    sys?: boolean;\r\n    readonly uq: UqMan;\r\n    readonly name: string;\r\n    readonly typeId: number;\r\n    readonly cache: LocalCache;\r\n    readonly uqApi: UqApi;\r\n    abstract get typeName(): string;\r\n    get sName():string {return this.jName || this.name}\r\n    fields: Field[];\r\n    arrFields: ArrFields[];\r\n    returns: ArrFields[];\r\n\r\n    constructor(uq:UqMan, name:string, typeId:number) {\r\n        this.uq = uq;\r\n        this.name = name;\r\n        this.typeId = typeId;\r\n        this.sys = this.name.indexOf('$') >= 0;\r\n        this.cache = this.uq.localMap.item(this.name); // new EntityCache(this);\r\n        this.uqApi = this.uq.uqApi;\r\n    }\r\n\r\n    public face: any;           // 对应字段的label, placeHolder等等的中文，或者语言的翻译\r\n\r\n    //getApiFrom() {return this.entities.uqApi;}\r\n\r\n    private fieldMaps: {[arr:string]: FieldMap} = {};\r\n    fieldMap(arr?:string): FieldMap {\r\n        if (arr === undefined) arr = '$';\r\n        let ret = this.fieldMaps[arr];\r\n        if (ret === undefined) {\r\n            let fields:Field[];\r\n            if (arr === '$') fields = this.fields;\r\n            else if (this.arrFields !== undefined) {\r\n                let arrFields = this.arrFields.find(v => v.name === arr);\r\n                if (arrFields !== undefined) fields = arrFields.fields;\r\n            }\r\n            else if (this.returns !== undefined) {\r\n                let arrFields = this.returns.find(v => v.name === arr);\r\n                if (arrFields !== undefined) fields = arrFields.fields;\r\n            }\r\n            if (fields === undefined) return {};\r\n            ret = {};\r\n            for (let f of fields) ret[f.name] = f;\r\n            this.fieldMaps[arr] = ret;\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    public async loadSchema():Promise<void> {\r\n        if (this.schema !== undefined) return;\r\n        let schema = this.cache.get();\r\n        if (!schema) {\r\n            schema = await this.uq.loadEntitySchema(this.name);\r\n        }\r\n        //this.setSchema(schema);\r\n\t\t//this.buildFieldsTuid();\r\n\t\tthis.buildSchema(schema);\r\n\t\tawait this.loadValues();\r\n\t}\r\n\r\n\tbuildSchema(schema: any) {\r\n        this.setSchema(schema);\r\n\t\tthis.buildFieldsTuid();\r\n\t\t//await this.loadValues();\r\n\t}\r\n\t\r\n\tprotected async loadValues():Promise<any> {}\r\n\r\n    // 如果要在setSchema里面保存cache，必须先调用clearSchema\r\n    public clearSchema() {\r\n        this.schema = undefined;\r\n    }\r\n\r\n    public setSchema(schema:any) {\r\n        if (schema === undefined) return;\r\n        let {name, version} = schema;\r\n        this.ver = version || 0;\r\n\t\tthis.setJName(name);\r\n        this.cache.set(schema);\r\n\t\tthis.schema = schema;\r\n\t\tthis.buildFieldsTuid();\r\n\t}\r\n\t\r\n\tprotected setJName(name:string) {\r\n        if (name !== this.name) this.jName = name;\r\n\t}\r\n\r\n    public buildFieldsTuid() {\r\n        let {fields, arrs, returns} = this.schema;\r\n        this.uq.buildFieldTuid(this.fields = fields);\r\n        this.uq.buildArrFieldsTuid(this.arrFields = arrs, fields);\r\n        this.uq.buildArrFieldsTuid(this.returns = returns, fields);\r\n    }\r\n\r\n    schemaStringify():string {\r\n        return JSON.stringify(this.schema, (key:string, value:any) => {\r\n            if (key === '_tuid') return undefined;\r\n            return value;\r\n        }, 4);\r\n    }\r\n\r\n    tuidFromName(fieldName:string, arrName?:string):Tuid {\r\n        if (this.schema === undefined) return;\r\n        let {fields, arrs} = this.schema;\r\n        let entities = this.uq;\r\n        function getTuid(fn:string, fieldArr:Field[]) {\r\n            if (fieldArr === undefined) return;\r\n            let f = fieldArr.find(v => v.name === fn);\r\n            if (f === undefined) return;\r\n            return entities.getTuid(f.tuid);\r\n        }\r\n        let fn = fieldName.toLowerCase();\r\n        if (arrName === undefined) return getTuid(fn, fields);\r\n        if (arrs === undefined) return;\r\n        let an = arrName.toLowerCase();\r\n        let arr = (arrs as ArrFields[]).find(v => v.name === an);\r\n        if (arr === undefined) return;\r\n        return getTuid(fn, arr.fields);\r\n    }\r\n\r\n    buildParams(params:any):any {\r\n        let result:any = {};\r\n        let fields = this.fields;\r\n        if (fields !== undefined) this.buildFieldsParams(result, fields, params);\r\n        let arrs = this.arrFields;\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                let {name, fields} = arr;\r\n                let paramsArr:any[] = params[name];\r\n                if (paramsArr === undefined) continue;\r\n                let arrResult:any[] = [];\r\n                result[name] = arrResult;\r\n                for (let pa of params) {\r\n                    let rowResult = {};\r\n                    this.buildFieldsParams(rowResult, fields, pa);\r\n                    arrResult.push(rowResult);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private buildFieldsParams(result:any, fields:Field[], params:any) {\r\n        for (let field of fields) {\r\n            let {name, type} = field;            \r\n            let d = params[name];\r\n            let val:any;\r\n            switch (type) {\r\n\t\t\t\tcase 'datetime':\r\n                \tval = this.buildDateTimeParam(d);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'date':\r\n\t\t\t\t\tif (d instanceof Date) {\r\n\t\t\t\t\t\tval = `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tval = d;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tswitch (typeof d) {\r\n\t\t\t\t\t\tdefault: val = d; break;\r\n\t\t\t\t\t\tcase 'object':\r\n\t\t\t\t\t\t\tif (d instanceof Date) {\r\n\t\t\t\t\t\t\t\tval = d;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet tuid = field._tuid;\r\n\t\t\t\t\t\t\tif (tuid === undefined) val = d.id;\r\n\t\t\t\t\t\t\telse val = tuid.getIdFromObj(d);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n            }\r\n            result[name] = val;\r\n        }\r\n    }\r\n\r\n    buildDateTimeParam(val:any) {\r\n        let dt: Date;\r\n        switch (typeof val) {\r\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\r\n            case 'undefined': return undefined;\r\n            case 'object': dt = (val as Date); break;\r\n            case 'string':\r\n            case 'number': dt = new Date(val); break;\r\n        }\r\n        return Math.floor(dt.getTime()/1000);\r\n    }\r\n\r\n    buildDateParam(val:any) {\r\n        let dt: Date;\r\n        switch (typeof val) {\r\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\r\n            case 'undefined': return '';\r\n            case 'string': return val;\r\n            case 'object': dt = (val as Date); break;\r\n            case 'number': dt = new Date(val); break;\r\n        }\r\n        let ret = dt.toISOString();\r\n        let p = ret.indexOf('T');\r\n        return p>0? ret.substr(0, p) : ret;\r\n    }\r\n\r\n    pack(data:any):string {\r\n        let ret:string[] = [];\r\n        let fields = this.fields;\r\n        if (fields !== undefined) this.packRow(ret, fields, data);\r\n        let arrs = this.arrFields; \r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n\t\t\t\tlet {name, fields} = arr;\r\n\t\t\t\tlet arrData = getObjPropIgnoreCase(data, name);\r\n\t\t\t\t//if (!arrData) arrData = data[name.toLowerCase()];\r\n                this.packArr(ret, fields, arrData);\r\n            }\r\n        }\r\n        return ret.join('');\r\n    }\r\n\r\n    private escape(row:any, field:Field):any {\r\n        let d = row[field.name];\r\n        switch (field.type) {\r\n            case 'datetime':\r\n                return this.buildDateTimeParam(d);\r\n            default:\r\n                switch (typeof d) {\r\n                    default: return d;\r\n                    case 'object':\r\n                        let tuid = field._tuid;\r\n                        if (tuid === undefined) return d.id;\r\n                        return tuid.getIdFromObj(d);\r\n                    case 'string':\r\n                        let len = d.length;\r\n                        let r = '', p = 0;\r\n                        for (let i=0;i<len;i++) {\r\n                            let c:number = d.charCodeAt(i), ch:string;\r\n                            switch(c) {\r\n\t\t\t\t\t\t\t\tdefault: continue;\r\n\t\t\t\t\t\t\t\tcase codeBackSlash: ch = '\\\\\\\\'; break;\r\n                                case codeBT: ch = '\\\\t'; break;\r\n\t\t\t\t\t\t\t\tcase codeBN: ch = '\\\\n'; break;\r\n\t\t\t\t\t\t\t\tcase codeBF: ch = '\\\\f'; break;\r\n\t\t\t\t\t\t\t\tcase codeBV: ch = '\\\\v'; break;\r\n\t\t\t\t\t\t\t\tcase codeBB: ch = '\\\\b'; break;\r\n\t\t\t\t\t\t\t\tcase codeBR: ch = '\\\\r'; break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tr += d.substring(p, i) + ch;\r\n\t\t\t\t\t\t\tp = i+1;\r\n                        }\r\n                        return r + d.substring(p);\r\n                    case 'undefined': return '';\r\n                }\r\n        }\r\n    }\r\n\r\n    private packRow(result:string[], fields:Field[], data:any) {\r\n        let len = fields.length;\r\n        if (len === 0) return;\r\n        let ret = '';\r\n        ret += this.escape(data, fields[0]);\r\n        for (let i=1;i<len;i++) {\r\n            let f = fields[i];\r\n            ret += tab + this.escape(data, f);\r\n        }\r\n        result.push(ret + ln);\r\n    }\r\n\r\n    private packArr(result:string[], fields:Field[], data:any[]) {\r\n        if (data !== undefined) {\r\n\t\t\tif (data.length === 0) {\r\n\t\t\t\tresult.push(ln);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (let row of data) {\r\n\t\t\t\t\tthis.packRow(result, fields, row);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tresult.push(ln);\r\n\t\t}\r\n        result.push(ln);\r\n    }\r\n    protected cacheFieldsInValue(values:any, fields:Field[]) {\r\n        for (let f of fields as Field[]) {\r\n            let {name, _tuid} = f;\r\n            if (_tuid === undefined) continue;\r\n            let id = values[name];\r\n            //_tuid.useId(id);\r\n            values[name] = _tuid.boxId(id);\r\n        }\r\n    }\r\n\r\n    protected unpackTuidIdsOfFields(values:string[], fields: Field[]):any[] {\r\n        if (fields === undefined) return values as any[];\r\n        //if (this.fields === undefined) return values as any[];\r\n        let ret:any[] = []\r\n        for (let ln of values) {\r\n            if (!ln) continue;\r\n            let len = ln.length;\r\n            let p = 0;\r\n            while (p<len) {\r\n                let ch = ln.charCodeAt(p);\r\n                if (ch === 10) {\r\n                    ++p;\r\n                    break;\r\n                }\r\n                let row = {};\r\n                p = this.unpackRow(row, fields, ln, p);\r\n                ret.push(row);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    unpackSheet(data:string):any {\r\n        let ret = {} as any; //new this.newMain();\r\n        //if (schema === undefined || data === undefined) return;\r\n        let fields = this.fields;\r\n        let p = 0;\r\n        if (fields !== undefined) p = this.unpackRow(ret, fields, data, p);\r\n        let arrs = this.arrFields; //schema['arrs'];\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                p = this.unpackArr(ret, arr, data, p);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n\tunpackReturns(data:string, returns?:ArrFields[]):{[name:string]:any[]} {\r\n\t\tif (data === undefined) debugger;\r\n\t\tlet ret = {} as any;\r\n\t\tlet p = 0;\r\n\t\tlet arrs = returns || this.returns;\r\n\t\tif (arrs !== undefined) {\r\n\t\t\tfor (let arr of arrs) {\r\n\t\t\t\tp = this.unpackArr(ret, arr, data, p);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n    protected unpackRow(ret:any, fields:Field[], data:string, p:number):number {\r\n        let ch0 = 0, ch = 0, c = p, i = 0, len = data.length, fLen = fields.length;\r\n        for (;p<len;p++) {\r\n            ch0 = ch;\r\n            ch = data.charCodeAt(p);\r\n            if (ch === 9) {\r\n                let f = fields[i];\r\n                let {name} = f;\r\n                if (ch0 !== 8) {\r\n                    if (p>c) {\r\n                        let v = data.substring(c, p);\r\n                        ret[name] = this.to(ret, v, f);\r\n                    }\r\n                }\r\n                else {\r\n                    ret[name] = null;\r\n                }\r\n                c = p+1;\r\n                ++i;\r\n                if (i>=fLen) {\r\n                    p = data.indexOf('\\n', c);\r\n                    if (p >= 0) ++p;\r\n                    else p = len;\r\n                    return p;\r\n                }\r\n            }\r\n            else if (ch === 10) {\r\n                let f = fields[i];\r\n                let {name} = f;\r\n                if (ch0 !== 8) {\r\n                    if (p>c) {\r\n                        let v = data.substring(c, p);\r\n                        ret[name] = this.to(ret, v, f);\r\n                    }\r\n                }\r\n                else {\r\n                    ret[name] = null;\r\n                }\r\n                ++p;\r\n                ++i;\r\n                return p;\r\n            }\r\n        }\r\n        let f = fields[i];\r\n        let {name} = f;\r\n        if (ch0 !== 8) {\r\n            let v = data.substring(c);\r\n            ret[name] = this.to(ret, v, f);\r\n        }\r\n        return len;\r\n    }\r\n\r\n    private to(ret:any, v:string, f:Field):any {\r\n        switch (f.type) {\r\n\t\t\tdefault: return v;\r\n\t\t\tcase 'text':\r\n\t\t\tcase 'char':\r\n\t\t\t\treturn this.reverseNT(v);\r\n            case 'datetime':\r\n            case 'time':\r\n\t\t\tcase 'timestamp':\r\n                let n = Number(v);\r\n                let date = isNaN(n) === true? new Date(v) : new Date(n*1000);\r\n                return date;\r\n            case 'date':\r\n                let parts = v.split('-');\r\n                return new Date(Number(parts[0]), Number(parts[1])-1, Number(parts[2]));\r\n            case 'tinyint':\r\n            case 'smallint':\r\n            case 'int':\r\n            case 'bigint':\r\n            case 'dec':\r\n                return Number(v);\r\n            case 'id':\r\n                let id = Number(v);\r\n                let {_tuid} = f;\r\n                if (_tuid === undefined) return id;\r\n                return _tuid.boxId(id);\r\n        }\r\n\t}\r\n\t\r\n\tprivate reverseNT(text:string):string {\r\n\t\tif (text === undefined) return;\r\n\t\tif (text === null) return;\r\n\t\tlet len = text.length;\r\n\t\tlet r = '';\r\n\t\tlet p = 0;\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet c = text.charCodeAt(i);\r\n\t\t\tif (c === codeBackSlash) {\r\n\t\t\t\tif (i===len-1) break;\r\n\t\t\t\tlet c1 = text.charCodeAt(i+1);\r\n\t\t\t\tlet ch:string;\r\n\t\t\t\tswitch (c1) {\r\n\t\t\t\t\tdefault: continue;\r\n\t\t\t\t\tcase codeBackSlash: ch = '\\\\'; break;\r\n\t\t\t\t\tcase codeN: ch = '\\n'; break;\r\n\t\t\t\t\tcase codeT: ch = '\\t'; break;\r\n\t\t\t\t\tcase codeB: ch = '\\b'; break;\r\n\t\t\t\t\tcase codeF: ch = '\\f'; break;\r\n\t\t\t\t\tcase codeV: ch = '\\v'; break;\r\n\t\t\t\t\tcase codeR: ch = '\\r'; break;\r\n\t\t\t\t}\r\n\t\t\t\tr += text.substring(p, i) + ch;\r\n\t\t\t\tp = i+2;\r\n\t\t\t\t++i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tr += text.substring(p, len);\r\n\t\treturn r;\r\n\t}\r\n\r\n    private unpackArr(ret:any, arr:ArrFields, data:string, p:number):number {\r\n\t\tlet p0 = p;\r\n        let vals:any[] = [], len = data.length;\r\n        let {name, fields} = arr;\r\n        while (p<len) {\r\n            let ch = data.charCodeAt(p);\r\n            if (ch === 10) {\r\n\t\t\t\tif (p === p0) {\r\n\t\t\t\t\tch = data.charCodeAt(p);\r\n\t\t\t\t\tif (ch !== 10) {\r\n\t\t\t\t\t\tthrow new Error('upackArr: arr第一个字符是10，则必须紧跟一个10，表示整个arr的结束')\r\n\t\t\t\t\t}\r\n\t\t\t\t\t++p;\r\n\t\t\t\t}\r\n                ++p;\r\n                break;\r\n            }\r\n            let val = {} as any; //new creater();\r\n            vals.push(val);\r\n            p = this.unpackRow(val, fields, data, p);\r\n        }\r\n        ret[name] = vals;\r\n        return p;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { ItemSchema, UiItem, UiSelectBase } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { observable } from 'mobx';\r\nimport { FieldRule } from '../form/rules';\r\nimport { Image } from '../image';\r\nimport { Edit } from './edit';\r\n\r\nexport abstract class ItemEdit {\r\n\tprotected edit: Edit;\r\n\tprotected name: string;\r\n\tprotected _itemSchema: ItemSchema;\r\n    get itemSchema(): ItemSchema {return this._itemSchema}\r\n    protected _uiItem:UiItem;\r\n    get uiItem():UiItem {return this._uiItem}\r\n    value: any;\r\n\tlabel: string;\r\n\tget editInRow(): boolean {return false;}\r\n\r\n    @observable protected error: string;\r\n    @observable protected isChanged: boolean = false;\r\n    protected newValue: any;\r\n\r\n    constructor(edit:Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) {\r\n\t\tthis.edit = edit;\r\n        this._itemSchema = itemSchema;\r\n        this._uiItem = uiItem\r\n        this.value = value;\r\n        let {name} = itemSchema;\r\n        this.name = name;\r\n        this.label = label;\r\n\t}\r\n\t\r\n\tinit() {\t\t\r\n\t}\r\n\r\n    async start():Promise<any> {\r\n        return await this.internalStart();\r\n    }\r\n\r\n    protected abstract internalStart():Promise<any>;\r\n\r\n    async end():Promise<any> {\r\n        await this.internalEnd()\r\n    }\r\n\r\n\trenderContent() {\r\n        let {name, type} = this._itemSchema;\r\n        let divValue:any;\r\n        let uiItem = this._uiItem;\r\n        let label:string, labelHide:boolean;\r\n        if (uiItem === undefined) {\r\n            label = name;\r\n        }\r\n        else {\r\n\t\t\tlabel = uiItem.label;\r\n\t\t\tlabelHide = uiItem.labelHide;\r\n            let templet = uiItem.Templet;\r\n            if (templet !== undefined) {\r\n                if (typeof templet === 'function') {\r\n\t\t\t\t\tif (this.value !== undefined) divValue = templet(this.value);\r\n\t\t\t\t}\r\n                else {\r\n\t\t\t\t\tdivValue = {templet};\r\n\t\t\t\t}\r\n            }\r\n            else if (this.value !== undefined) {\r\n                switch (uiItem.widget) {\r\n                    case 'radio':\r\n                    case 'select':\r\n                        let {list} = uiItem as UiSelectBase;\r\n                        divValue = <b>{list.find(v => v.value === this.value).title}</b>;\r\n                        break;\r\n                    case 'id':\r\n                        divValue = <b>no templet for {name}={this.value}</b>\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        if (divValue === undefined) {\r\n            switch (type) {\r\n                default:\r\n                    divValue = this.value? \r\n\t\t\t\t\t\t<b>{this.value}</b> \r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<small className=\"text-muted\">[{labelHide===true? label:'无'}]</small>;\r\n                    break;\r\n                case 'image':\r\n                    divValue = <Image className=\"w-4c h-4c\" src={this.value} />;\r\n                    break;\r\n            }\r\n\t\t}\r\n\t\treturn divValue;\r\n\t}\r\n\r\n    protected async internalEnd():Promise<void> {nav.pop()}\r\n\r\n    protected verifyValue() {\r\n        if (this.uiItem === undefined) return;\r\n        let {rules} = this.uiItem;\r\n        if (rules === undefined) return;\r\n        let nv = this.newValue;\r\n        function verifyRule(rule:FieldRule, value: any):string {\r\n            let error = rule(nv);\r\n            if (error !== undefined) {\r\n                if (typeof error !== 'object')\r\n                    return error;\r\n                else\r\n                    return JSON.stringify(error);\r\n            }\r\n        }\r\n        if (Array.isArray(rules)) {\r\n            for (let rule of rules) {\r\n                let error = verifyRule(rule as FieldRule, nv);\r\n                if (error !== undefined) {\r\n                    this.error = error;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this.error = verifyRule(rules as FieldRule, nv);\r\n        }\r\n    }\r\n}\r\n","//import _ from 'lodash';\r\nimport { Caller } from '../net';\r\nimport { Entity } from './entity';\r\nimport { Action } from './action';\r\nimport { Query } from './query';\r\n\r\ninterface UqResponseSchema {\r\n    uq: any;\r\n    entity: any;\r\n}\r\n\r\nexport abstract class EntityCaller<T> extends Caller<T> {\r\n    private tries: number;\r\n    protected _entity: Entity;\r\n\r\n    constructor(entity: Entity, params:T, waiting: boolean = true) {\r\n        super(params, waiting);\r\n        this.tries = 0;\r\n        this._entity = entity;\r\n    }\r\n\r\n    protected get entity(): Entity {return this._entity;}\r\n\r\n    //大多的entityCaller都不需要这个\r\n    //buildParams() {return this.entity.buildParams(this.params);}\r\n    \r\n    async request(): Promise<any> {\r\n        await this.entity.loadSchema();\r\n        let ret = await this.innerRequest();\r\n        return ret;\r\n    }\r\n\r\n    protected async innerCall(): Promise<any> {\r\n        return await this.entity.uqApi.xcall(this);\r\n    }\r\n\r\n    async innerRequest(): Promise<any> {\r\n        let jsonResult = await this.innerCall();\r\n        let {$uq, $modify, res} = jsonResult;\r\n        this.entity.uq.pullModify($modify);\r\n        if ($uq === undefined) {\r\n            //if (res === undefined) debugger;\r\n            let ret = this.xresult(res);\r\n            //if (ret === undefined) debugger;\r\n            return ret;\r\n        }\r\n        return await this.retry($uq);\r\n    }\r\n\r\n    xresult(res:any):any {return res}\r\n\r\n    get headers(): {[header:string]: string} {\r\n        let {ver, uq} = this.entity;\r\n        let {uqVersion} = uq;\r\n        return {\r\n            uq: `${uqVersion}`,\r\n            en: `${ver}`,\r\n        }\r\n    }\r\n\r\n    private async retry(schema: UqResponseSchema) {\r\n        ++this.tries;\r\n        if (this.tries > 5) throw new Error('can not get right uq response schema, 5 tries');\r\n        this.rebuildSchema(schema);\r\n        return await this.innerRequest();\r\n    }\r\n\r\n    private rebuildSchema(schema: UqResponseSchema) {\r\n        let {uq, entity} = schema;\r\n        if (uq !== undefined) {\r\n\t\t\tthis.entity.uq.buildEntities(uq);\r\n\t\t}\r\n        if (entity !== undefined) {\r\n\t\t\tthis.entity.setSchema(entity);\r\n\t\t}\r\n    }\r\n}\r\n\r\nexport abstract class ActionCaller extends EntityCaller<any> {\r\n    protected get entity(): Action {return this._entity as Action;}\r\n}\r\n\r\nexport class QueryQueryCaller extends EntityCaller<any> {\r\n    protected get entity(): Query {return this._entity as Query};\r\n    get path():string {return `query/${this.entity.name}`;}\r\n    xresult(res:any) {\r\n        let data = this.entity.unpackReturns(res);\r\n        return data;\r\n    }\r\n    buildParams() {return this.entity.buildParams(this.params);}\r\n}\r\n\r\nexport class QueryPageCaller extends EntityCaller<any> {\r\n    protected get params(): {pageStart:any; pageSize:number, params:any} {return this._params};\r\n\tprotected get entity(): Query {return this._entity as Query};\r\n\t//results: {[name:string]:any[]};\r\n\tget path():string {return `query-page/${this.entity.name}`;}\t\r\n    buildParams() {\r\n        let {pageStart, pageSize, params} = this.params;\r\n        let p:any;\r\n        if (params === undefined) {\r\n            p = {key: ''};\r\n        }\r\n        else {\r\n            p = this.entity.buildParams(params);\r\n        }\r\n        /*\r\n        switch (typeof params) {\r\n            case 'undefined': p = {key: ''}; break;\r\n            default: p = _.clone(params); break;\r\n        }\r\n        */\r\n        p['$pageStart'] = pageStart;\r\n        p['$pageSize'] = pageSize;\r\n        return p;\r\n    };\r\n    xresult(res:any): {[name:string]:any[]} {\r\n        let ret = this.entity.unpackReturns(res);\r\n\t\t//return this.results.$page;// as any[];\r\n\t\treturn ret;\r\n    }\r\n}\r\n","import {bridgeCenterApi, isBridged} from './appBridge';\r\nimport {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\nimport {nav} from '../components/nav';\r\nimport { Caller } from './caller';\r\nimport { env } from '../tool';\r\n\r\n/*\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(false, url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(false, url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n*/\r\n\r\nconst methodsWithBody = ['POST', 'PUT'];\r\n\r\nexport abstract class HttpChannel {\r\n    private timeout: number;\r\n    protected ui?: HttpChannelUI;\r\n    protected hostUrl: string;\r\n    protected apiToken: string;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = env.isDevelopment === true? 500000:50000;\r\n    }\r\n\r\n    private startWait = (waiting: boolean) => {\r\n        if (waiting === true) {\r\n            if (this.ui !== undefined) this.ui.startWait();\r\n        }\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async xcall(urlPrefix:string, caller:Caller<any>): Promise<void> {\r\n        let options = this.buildOptions();\r\n        let {headers, path, method} = caller;\r\n        if (headers !== undefined) {\r\n            let h = options.headers;\r\n            for (let i in headers) {\r\n\t\t\t\t//h.append(i, encodeURI(headers[i]));\r\n\t\t\t\th[i] = encodeURI(headers[i]);\r\n            }\r\n        }\r\n        options.method = method;\r\n        let p = caller.buildParams();\r\n        if (methodsWithBody.indexOf(method) >= 0 && p !== undefined) {\r\n            options.body = JSON.stringify(p)\r\n        }\r\n        return await this.innerFetch(urlPrefix + path, options, caller.waiting);\r\n    }\r\n\r\n    private async innerFetchResult(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let ret = await this.innerFetch(url, options, waiting);\r\n        return ret.res;\r\n    }\r\n\r\n    async get(url: string, params: any = undefined, waiting?: boolean): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async post(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async put(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async delete(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n    async fetch(url: string, options: any, waiting: boolean, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait(waiting);\r\n        let path = url;\r\n        function buildError(err: any, ex?: string) {\r\n            switch (typeof err) {\r\n                case 'string':\r\n                    if (ex !== undefined) err += ' ' + ex;\r\n                    break;\r\n                case 'object':\r\n                    let keys = Object.keys(err);\r\n                    let retErr:any = {\r\n                        ex: ex,\r\n                    };\r\n                    for (let key of keys) {\r\n                        retErr[key] = err[key];\r\n                    }\r\n                    err = retErr;\r\n                    break;\r\n            }\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s-%s %s', options.method, path, options.body || '');\r\n            let now = Date.now();\r\n            let timeOutHandler = env.setTimeout(\r\n                undefined, //'httpChannel.fetch',\r\n                () => {\r\n                    that.endWait(url + ' timeout endWait: ' + (Date.now() - now) + 'ms', reject);\r\n                },\r\n                this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                env.clearTimeout(timeOutHandler);\r\n                console.log('ok false endWait');       \r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    env.clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        if (typeof retJson !== 'object') {\r\n                            debugger;\r\n                        }\r\n                        else if (Array.isArray(retJson) === true) {\r\n                            debugger;\r\n                        }\r\n                        return resolve(retJson);\r\n                    }\r\n                    let retError = retJson.error;\r\n                    if (retError === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retError, 'retJson.error'));\r\n                        reject(retError);\r\n                    }\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error, 'catch res.json()'));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                env.clearTimeout(timeOutHandler);\r\n                console.log('text endWait');\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            this.endWait(url, reject);\r\n            if (typeof error === 'string') {\r\n                let err = error.toLowerCase();\r\n                if (err.startsWith('unauthorized') === true) {\r\n                    nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            console.error('fecth error (no nav.showError): ' + url);\r\n            // await this.showError(buildError(error, 'catch outmost'));\r\n        };\r\n    }\r\n\r\n    protected abstract innerFetch(url: string, options: any, waiting: boolean): Promise<any>;\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, true, resolve, reject);\r\n        });\r\n    }\r\n\r\n    //private buildOptions(): {method:string; headers:Headers; body:any} {\r\n\t\tprivate buildOptions(): {method:string; headers:{[name:string]: string}; body:any} {\r\n        let headers = this.buildHeaders();\r\n        let options = {\r\n            headers: headers,\r\n            method: undefined as any,\r\n            body: undefined as any,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n\r\n\t/*\r\n    protected buildHeaders():Headers {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        return headers;\r\n\t}\r\n\t*/\r\n\tprotected buildHeaders():{[name:string]: string} { \r\n        let {language, culture} = nav;\r\n        let headers:{[name:string]: string} = {}; //new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n\t\t//headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n\t\theaders['Content-Type'] = 'application/json;charset=UTF-8';\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n\t\t//headers.append('Accept-Language', lang);\r\n\t\theaders['Accept-Language'] = lang;\r\n        if (this.apiToken) { \r\n\t\t\t//headers.append('Authorization', this.apiToken); \r\n\t\t\theaders['Authorization'] = this.apiToken;\r\n        }\r\n        return headers;\r\n\t}\r\n}\r\n\r\nexport class CenterHttpChannel extends HttpChannel {\r\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        if (this.apiToken === undefined && isBridged())\r\n            return await bridgeCenterApi(u, options.method, options.body);\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, waiting, resolve, reject);\r\n        });\r\n    }\r\n}\r\n\r\nexport class UqHttpChannel extends HttpChannel {\r\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, waiting, resolve, reject);\r\n        });\r\n    }\r\n}\r\n","import {nav} from '../components/nav';\r\nimport {FetchError} from './fetchError';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:FetchError):Promise<void>;\r\n    showUpgradeUq(uq:string, version:number):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        nav.startWait();\r\n    }\r\n    endWait() {\r\n        nav.endWait();\r\n    }\r\n    async showError(error:FetchError):Promise<void> {\r\n        nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await nav.onError(error);\r\n    }\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        await nav.showUpgradeUq(uq, version);\r\n    }\r\n}\r\n\r\n","import _ from 'lodash';\r\nimport {HttpChannel, CenterHttpChannel, UqHttpChannel} from './httpChannel';\r\nimport {HttpChannelNavUI} from './httpChannelUI';\r\nimport {appUq, logoutUqTokens, buildAppUq} from './appBridge';\r\nimport {ApiBase} from './apiBase';\r\nimport { host } from './host';\r\nimport { LocalMap, env } from '../tool';\r\nimport {decodeUserToken} from '../tool/user';\r\n\r\ninterface PromiseValue<T> {\r\n\tresolve: (value?: T | PromiseLike<T>) => void;\r\n\treject: (reason?: any) => void;\r\n}\r\nlet channelUIs:{[name:string]: HttpChannel|(PromiseValue<any>[])} = {};\r\nlet channelNoUIs:{[name:string]: HttpChannel|(PromiseValue<any>[])} = {};\r\n\r\nexport function logoutApis() {\r\n    channelUIs = {};\r\n    channelNoUIs = {};\r\n    logoutUnitxApis();\r\n    logoutUqTokens();\r\n}\r\n\r\ninterface UqLocal {\r\n    user: number;\r\n    unit: number;\r\n    value: any;\r\n    tick?: number;\r\n    isNet?: boolean;\r\n}\r\n/*\r\ninterface UqLocals {\r\n    user: number;\r\n    unit: number;\r\n    uqs: {[uq:string]: UqLocal};\r\n}\r\n*/\r\n/*\r\nconst uqLocalEntities = 'uqLocalEntities';\r\nclass CacheUqLocals {\r\n    private local:UqLocals;\r\n\r\n    async loadAccess(uqApi: UqApi):Promise<any> {\r\n        try {\r\n            let {uqOwner, uqName} = uqApi;\r\n            if (this.local === undefined) {\r\n                let ls = null; // localStorage.getItem(uqLocalEntities);\r\n                if (ls !== null) {\r\n                    this.local = JSON.parse(ls);\r\n                }\r\n            }\r\n            if (this.local !== undefined) {\r\n                let {user, uqs} = this.local;\r\n                if (user !== loginedUserId || uqs === undefined) {\r\n                    this.local = undefined;\r\n                }\r\n                else {\r\n                    for (let i in uqs) {\r\n                        let ul = uqs[i];\r\n                        ul.isNet = undefined;\r\n                    }\r\n                }\r\n            }\r\n            if (this.local === undefined) {\r\n                this.local = {\r\n                    user: loginedUserId,\r\n                    unit: undefined,\r\n                    uqs: {}\r\n                };\r\n            }\r\n\r\n            let ret: any;\r\n            let un = uqOwner+'/'+uqName;\r\n            let uq = this.local.uqs[un];\r\n            if (uq !== undefined) {\r\n                let {value} = uq;\r\n                ret = value;\r\n            }\r\n            if (ret === undefined) {\r\n                ret = await uqApi.__loadAccess();\r\n                //this.saveLocal(un, ret);\r\n            }\r\n            return _.cloneDeep(ret);\r\n        }\r\n        catch (err) {\r\n            this.local = undefined;\r\n            localStorage.removeItem(uqLocalEntities);\r\n            throw err;\r\n        }\r\n    }\r\n\r\n    private saveLocal(uqName:string, accessValue: any) {\r\n        this.local.uqs[uqName] = {\r\n            value: accessValue,\r\n            isNet: true,\r\n        }\r\n        let str = JSON.stringify(this.local);\r\n        localStorage.setItem(uqLocalEntities, str);\r\n    }\r\n\r\n    async checkAccess(uqApi: UqApi):Promise<boolean> {\r\n        if (this.local === undefined) return false;\r\n        let {uqOwner, uqName} = uqApi;\r\n        let un = uqOwner+'/'+uqName;\r\n        let uq = this.local.uqs[un];\r\n        if (uq === undefined) return false;\r\n        let {isNet, value} = uq;\r\n        if (isNet === true) return true;\r\n        let ret = await uqApi.__loadAccess();\r\n        let isMatch = _.isMatch(value, ret);\r\n        if (isMatch === false) {\r\n            this.saveLocal(un, ret);\r\n            return false;\r\n        }\r\n        uq.isNet = true;\r\n        return true;\r\n    }\r\n}\r\n\r\nconst localUqs = new CacheUqLocals;\r\n*/\r\nexport class UqApi extends ApiBase {\r\n    private access:string[];\r\n    appOwner:string;\r\n    appName:string;\r\n    uqOwner: string;\r\n    uqName: string;\r\n    uq: string;\r\n\r\n    constructor(basePath:string, appOwner:string, appName:string, uqOwner:string, uqName:string, access:string[], showWaiting?: boolean) {\r\n        super(basePath, showWaiting);\r\n        this.appOwner = appOwner;\r\n        this.appName = appName;\r\n        if (uqName) {\r\n            this.uqOwner = uqOwner;\r\n            this.uqName = uqName;\r\n            this.uq = uqOwner + '/' + uqName;\r\n        }\r\n        this.access = access;\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    //setUqVersion(uqVersion:number) {this.uqVersion = undefined}\r\n\r\n    async init() {\r\n        await buildAppUq(this.uq, this.uqOwner, this.uqName, this.appOwner, this.appName);\r\n    }\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        let channels: {[name:string]: HttpChannel|(PromiseValue<any>[])};\r\n        let channelUI: HttpChannelNavUI;\r\n        if (this.showWaiting === true || this.showWaiting === undefined) {\r\n            channels = channelUIs;\r\n            channelUI = new HttpChannelNavUI();\r\n        }\r\n        else {\r\n            channels = channelNoUIs;\r\n        }\r\n        let channel = channels[this.uq];\r\n\t\tif (channel !== undefined) {\r\n\t\t\tif (Array.isArray(channel) === false) return channel as HttpChannel;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tchannel = channels[this.uq] = [];\r\n\t\t}\r\n\t\tlet arr = channel as PromiseValue<any>[];\r\n\t\treturn new Promise(async (resolve, reject) => {\r\n\t\t\tarr.push({resolve, reject});\r\n\t\t\tif (arr.length !== 1) return;\r\n\t\t\tlet uqToken = appUq(this.uq); //, this.uqOwner, this.uqName);\r\n\t\t\tif (!uqToken) {\r\n\t\t\t\t//debugger;\r\n\t\t\t\tawait this.init();\r\n\t\t\t\tuqToken = appUq(this.uq);\r\n\t\t\t}\r\n\t\t\tlet {url, token} = uqToken;\r\n\t\t\tthis.token = token;\r\n\t\t\tchannel = new UqHttpChannel(url, token, channelUI);\r\n\t\t\tchannels[this.uq] = channel;\r\n\t\t\tfor (let pv of arr) {\r\n\t\t\t\tpv.resolve(channel);\r\n\t\t\t}\r\n\r\n\t\t});\r\n    }\r\n\r\n    /*async update():Promise<string> {\r\n        return await this.get('update');\r\n    }*/\r\n\r\n    /*\r\n    async __loadAccess():Promise<any> {\r\n        let acc = this.access === undefined?\r\n            '' :\r\n            this.access.join('|');\r\n        let ret = await this.get('access', {acc:acc});\r\n        return ret;\r\n    }\r\n    */\r\n    async loadAccess():Promise<any> {\r\n        //return await localUqs.loadAccess(this);\r\n        let acc = this.access === undefined?\r\n            '' :\r\n            this.access.join('|');\r\n        let ret = await this.get('access', {acc:acc});\r\n        return ret;\r\n    }\r\n\r\n    /*async loadEntities():Promise<any> {\r\n        return await this.get('entities');\r\n    }*/\r\n\r\n    /*\r\n    async checkAccess():Promise<boolean> {\r\n        return await localUqs.checkAccess(this);\r\n    }\r\n    */\r\n\r\n\tasync allSchemas(): Promise<any> {\r\n\t\treturn await this.get('all-schemas');\r\n\t}\r\n\r\n    async schema(name:string):Promise<any> {\r\n        return await this.get('schema/' + name);\r\n    }\r\n\r\n    async queueModify(start:number, page:number, entities:string) {\r\n        return await this.post('queue-modify', {start:start, page:page, entities:entities});\r\n    }\r\n\r\n    /*async schemas(names:string[]):Promise<any[]> {\r\n        return await this.post('schema', names);\r\n    }*/\r\n\r\n    /*\r\n    async tuidGet(name:string, id:number):Promise<any> {\r\n        return await this.get('tuid/' + name + '/' + id);\r\n    }\r\n\r\n    async tuidGetAll(name:string):Promise<any[]> {\r\n        return await this.get('tuid-all/' + name + '/');\r\n    }\r\n\r\n    async tuidSave(name:string, params:any):Promise<any> {\r\n        return await this.post('tuid/' + name, params);\r\n    }\r\n\r\n    async tuidSearch(name:string, arr:string, owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        let ret = await this.post('tuids/' + name, {\r\n            arr: arr,\r\n            owner: owner,\r\n            key: key,\r\n            pageStart: pageStart,\r\n            pageSize: pageSize\r\n        });\r\n        return ret;\r\n    }\r\n    async tuidArrGet(name:string, arr:string, owner:number, id:number):Promise<any> {\r\n        return await this.get('tuid-arr/' + name + '/' + owner + '/' + arr + '/' + id);\r\n    }\r\n    async tuidArrGetAll(name:string, arr:string, owner:number):Promise<any[]> {\r\n        return await this.get('tuid-arr-all/' + name + '/' + owner + '/' + arr + '/');\r\n    }\r\n    async tuidArrSave(name:string, arr:string, owner:number, params:any):Promise<any> {\r\n        return await this.post('tuid-arr/' + name + '/' + owner + '/' + arr + '/', params);\r\n    }\r\n    async tuidArrPos(name:string, arr:string, owner:number, id:number, order:number):Promise<any> {\r\n        return await this.post('tuid-arr-pos/' + name + '/' + owner + '/' + arr + '/', {\r\n            id: id,\r\n            $order: order\r\n        });\r\n    }\r\n\r\n    async tuidIds(name:string, arr:string, ids:number[]):Promise<any[]> {\r\n        try {\r\n            let url = 'tuidids/' + name + '/';\r\n            if (arr !== undefined) url += arr;\r\n            else url += '$';\r\n            let ret = await this.post(url, ids);\r\n            return ret;\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n    */\r\n    /*async sheetSave(name:string, data:object):Promise<any> {\r\n        return await this.post('sheet/' + name, data);\r\n    }*/\r\n\r\n    /*async sheetAction(name:string, data:object) {\r\n        return await this.put('sheet/' + name, data);\r\n    }*/\r\n\r\n    /*async stateSheets(name:string, data:object) {\r\n        return await this.post('sheet/' + name + '/states', data);\r\n    }*/\r\n\r\n    /*async stateSheetCount(name:string):Promise<any> {\r\n        return await this.get('sheet/' + name + '/statecount');\r\n    }*/\r\n\r\n    /*async mySheets(name:string, data:object) {\r\n        return await this.post('sheet/' + name + '/my-sheets', data);\r\n    }*/\r\n\r\n    /*async getSheet(name:string, id:number):Promise<any> {\r\n        return await this.get('sheet/' + name + '/get/' + id);\r\n    }*/\r\n\r\n    /*async sheetArchives(name:string, data:object):Promise<any> {\r\n        return await this.post('sheet/' + name + '/archives', data);\r\n    }\r\n\r\n    async sheetArchive(name:string, id:number):Promise<any> {\r\n        return await this.get('sheet/' + name + '/archive/' + id);\r\n    }*/\r\n\r\n    /*async action(name:string, data:object):Promise<any> {\r\n        return await this.post('action/' + name, data);\r\n    }\r\n\r\n    async actionReturns(name:string, data:object):Promise<any[][]> {\r\n        return await this.post('action/' + name + '/returns', data);\r\n    }\r\n\r\n    async page(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\r\n        let p:any;\r\n        switch (typeof params) {\r\n            case 'undefined': p = {key: ''}; break;\r\n            default: p = _.clone(params); break;\r\n        }\r\n        p['$pageStart'] = pageStart;\r\n        p['$pageSize'] = pageSize;\r\n        return await this.post('query-page/' + name, p);\r\n    }\r\n\r\n    async query(name:string, params:any):Promise<any> {\r\n        let ret = await this.post('query/' + name, params);\r\n        return ret;\r\n    }\r\n    */\r\n/*\r\n    async history(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\r\n        let p = _.clone(params);\r\n        p['$pageStart'] = pageStart;\r\n        p['$pageSize'] = pageSize;\r\n        let ret = await this.post('history/' + name, p);\r\n        return ret;\r\n    }\r\n\r\n    async book(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\r\n        let p = _.clone(params);\r\n        p['$pageStart'] = pageStart;\r\n        p['$pageSize'] = pageSize;\r\n        let ret = await this.post('history/' + name, p);\r\n        return ret;\r\n    }\r\n*/\r\n    /*async user():Promise<any> {\r\n        return await this.get('user');\r\n    }*/\r\n}\r\n\r\nlet channels:{[unitId:number]: HttpChannel} = {};\r\n\r\nexport function logoutUnitxApis() {\r\n    channels = {};\r\n}\r\n\r\nexport class UnitxApi extends UqApi {\r\n    private unitId:number;\r\n    constructor(unitId:number) {\r\n        super('tv/', undefined, undefined, undefined, undefined, undefined, true);\r\n        this.unitId = unitId;\r\n    }\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        let channel = channels[this.unitId];\r\n        if (channel !== undefined) return channel;\r\n        return channels[this.unitId] = await this.buildChannel();\r\n    }\r\n\r\n    private async buildChannel():Promise<HttpChannel> {\r\n        let channelUI = new HttpChannelNavUI();\r\n        let centerAppApi = new CenterAppApi('tv/', undefined);\r\n        let ret = await centerAppApi.unitxUq(this.unitId);\r\n        let {token, db, url, urlTest} = ret;\r\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n        this.token = token;\r\n        return new UqHttpChannel(realUrl, token, channelUI);\r\n    }\r\n}\r\n\r\nlet centerHost:string;\r\n\r\nexport function setCenterUrl(url:string) {\r\n    console.log('setCenterUrl %s', url);\r\n    centerHost = url;\r\n    //centerToken = undefined;\r\n    centerChannel = undefined;\r\n    centerChannelUI = undefined;\r\n}\r\n\r\nexport let centerToken:string|undefined = undefined;\r\n\r\nlet loginedUserId:number = 0;\r\nexport function setCenterToken(userId:number, t?:string) {\r\n    loginedUserId = userId;\r\n    centerToken = t;\r\n    console.log('setCenterToken %s', t);\r\n    centerChannel = undefined;\r\n    centerChannelUI = undefined;\r\n}\r\n\r\nlet centerChannelUI:HttpChannel;\r\nlet centerChannel:HttpChannel;\r\nfunction getCenterChannelUI():HttpChannel {\r\n    if (centerChannelUI !== undefined) return centerChannelUI;\r\n    return centerChannelUI = new CenterHttpChannel(centerHost, centerToken, new HttpChannelNavUI());\r\n}\r\nfunction getCenterChannel():HttpChannel {\r\n    if (centerChannel !== undefined) return centerChannel;\r\n    return centerChannel = new CenterHttpChannel(centerHost, centerToken);\r\n}\r\n\r\nexport abstract class CenterApiBase extends ApiBase {\r\n    /*\r\n    constructor(path: string, showWaiting?: boolean) {\r\n        super(path, showWaiting);\r\n    }*/\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        return (this.showWaiting === true || this.showWaiting === undefined)?\r\n            getCenterChannelUI():\r\n            getCenterChannel();\r\n    }\r\n}\r\n\r\nconst uqTokensName = 'uqTokens';\r\nexport class UqTokenApi extends CenterApiBase {\r\n    private localMap: LocalMap = env.localDb.map(uqTokensName);\r\n\r\n    async uq(params: {unit:number, uqOwner:string, uqName:string, appOwner:string, appName:string}):Promise<any> {\r\n        let {uqOwner, uqName} = params;\r\n        let un = uqOwner+'/'+uqName;\r\n        let localCache = this.localMap.child(un);\r\n        try {\r\n            let uqToken:UqLocal = localCache.get();\r\n            if (uqToken !== undefined) {\r\n                let {unit, user} = uqToken;\r\n                if (unit !== params.unit || user !== loginedUserId) {\r\n                    localCache.remove();\r\n                    uqToken = undefined;\r\n                }\r\n            }\r\n            let nowTick = Math.floor(Date.now() / 1000);\r\n            if (uqToken !== undefined) {\r\n                let {tick, value} = uqToken;\r\n                if (value !== undefined && (nowTick - tick) < 24*3600) {\r\n                    return _.clone(value);\r\n                }\r\n            }\r\n            let appUqParams:any = _.clone(params);\r\n            appUqParams.testing = host.testing;\r\n            let ret = await this.get('app-uq', appUqParams);\r\n            if (ret === undefined) {\r\n                let {unit, uqOwner, uqName} = params;\r\n                let err = `center get app-uq(unit=${unit}, '${uqOwner}/${uqName}') - not exists or no unit-service`;\r\n                throw err;\r\n            }\r\n\r\n            uqToken = {\r\n                unit: params.unit,\r\n                user: loginedUserId,\r\n                tick: nowTick,\r\n                value: ret,\r\n            }\r\n            localCache.set(uqToken);\r\n            return _.clone(ret);\r\n        }\r\n        catch (err) {\r\n            localCache.remove();\r\n            throw err;\r\n        }\r\n    }\r\n}\r\n\r\nexport const uqTokenApi = new UqTokenApi('tv/tie/', undefined);\r\n\r\nexport class CallCenterApi extends CenterApiBase {\r\n    directCall(url:string, method:string, body:any):Promise<any> {\r\n        return this.call(url, method, body);\r\n    }\r\n}\r\nexport const callCenterapi = new CallCenterApi('', undefined);\r\n\r\nexport interface UqAppData {\r\n    appName: string;\r\n    appOwner: string;\r\n    id: number;\r\n    version: string;        // AppUI version\r\n    uqs: UqData[];\r\n}\r\n\r\nexport interface UqData {\r\n    id: number;\r\n    uqOwner: string;\r\n    uqName: string;\r\n    access: string;\r\n    newVersion: boolean;\r\n}\r\n\r\nexport interface UqServiceData {\r\n    id: number;\r\n    db: string;\r\n    url: string;\r\n    urlTest: string;\r\n    token: string;\r\n}\r\n\r\n//const appUqsName = 'appUqs';\r\n\r\nexport class CenterAppApi extends CenterApiBase {\r\n    //private local: LocalCache = env.localDb.item(appUqsName);\r\n    //private cachedUqs: UqAppData;\r\n    async uqs(appOwner:string, appName:string):Promise<UqAppData> {\r\n        let ret:UqAppData = await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\r\n        return ret;\r\n        /*\r\n        let ret:UqAppData;\r\n        let appUqs = this.local.get();\r\n        if (appUqs) {\r\n            let {appOwner:rAppOwner, appName:rAppName} = appUqs;\r\n            if (appOwner === rAppOwner && appName === rAppName) ret = appUqs;\r\n        }\r\n        if (ret === undefined) {\r\n            ret = await this.uqsPure(appOwner, appName);\r\n            ret.appName = appName;\r\n            ret.appOwner = appOwner;\r\n            //localStorage.setItem(JSON.stringify(obj));\r\n            this.local.set(ret);\r\n        }\r\n        //return this.cachedUqs = _.cloneDeep(ret);\r\n        return ret;\r\n        */\r\n    }\r\n    private async uqsPure(appOwner:string, appName:string):Promise<UqAppData> {\r\n        return await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\r\n    }\r\n    /*\r\n    private async isOkCheckUqs(appOwner:string, appName:string):Promise<boolean> {\r\n        let ret = await this.uqsPure(appOwner, appName);\r\n        let {id:cachedId, uqs:cachedUqs} = this.local.get(); //.cachedUqs;\r\n        let {id:retId, uqs:retUqs} = ret;\r\n        if (cachedId !== retId) return false;\r\n        if (cachedUqs.length !== retUqs.length) return false;\r\n        let len = cachedUqs.length;\r\n        for (let i=0; i<len; i++) {\r\n            if (_.isMatch(cachedUqs[i], retUqs[i]) === false) return false;\r\n        }\r\n        return true;\r\n    }\r\n    async checkUqs(appOwner:string, appName:string):Promise<boolean> {\r\n        let ret = await this.isOkCheckUqs(appOwner, appName);\r\n        if (ret === false) {\r\n            this.local.remove();\r\n            nav.start();\r\n        }\r\n        return ret;\r\n    }\r\n    */\r\n    async unitxUq(unit:number):Promise<UqServiceData> {\r\n        return await this.get('tie/unitx-uq', {unit:unit});\r\n    }\r\n    async changePassword(param: {orgPassword:string, newPassword:string}) {\r\n        return await this.post('tie/change-password', param);\r\n    }\r\n}\r\n\r\nexport async function loadAppUqs(appOwner:string, appName:string): Promise<UqAppData> {\r\n    let centerAppApi = new CenterAppApi('tv/', undefined);\r\n    //let unit = meInFrame.unit;\r\n    let ret = await centerAppApi.uqs(appOwner, appName);\r\n    //await centerAppApi.checkUqs(appOwner, appName);\r\n    /*\r\n    .then(v => {\r\n        if (v === false) {\r\n            localStorage.removeItem(appUqs);\r\n            nav.start();\r\n        }\r\n    });\r\n    */\r\n    return ret;\r\n}\r\n\r\n//import { nav } from '../ui';\r\n\r\nexport interface RegisterParameter {\r\n    nick:string, \r\n    user:string, \r\n    pwd:string,\r\n    country:number, \r\n    mobile:number, \r\n    mobileCountry:number,\r\n    email:string,\r\n    verify:string,\r\n};\r\n\r\nexport class UserApi extends CenterApiBase {\r\n    async login(params: {user: string, pwd: string, guest: number}): Promise<any> {\r\n        //(params as any).device = nav.local.device.get();\r\n        let ret = await this.get('user/login', params);\r\n        switch (typeof ret) {\r\n            default: return;\r\n            case 'string': return decodeUserToken(ret);\r\n            case 'object':\r\n                let token = ret.token;\r\n                let user = decodeUserToken(token);\r\n                let {nick, icon} = ret;\r\n                if (nick) user.nick = nick;\r\n                if (icon) user.icon = icon;\r\n                return user;\r\n        }\r\n        // !== undefined) return decodeToken(token);\r\n    }\r\n    async register(params: RegisterParameter): Promise<any>\r\n    {\r\n        return await this.post('user/register', params);\r\n    }\r\n\r\n    async sendVerify(account:string, type:'mobile'|'email', oem:string) {\r\n        return await this.post('user/set-verify', {account:account, type:type, oem:oem});\r\n    }\r\n\r\n    async checkVerify(account:string, verify:string) {\r\n        return await this.post('user/check-verify', {account:account, verify:verify});\r\n    }\r\n\r\n    async isExists(account:string) {\r\n        return await this.get('user/is-exists', {account:account});\r\n    }\r\n\r\n    async resetPassword(account:string, password:string, verify:string, type:'mobile'|'email'):Promise<any[]> {\r\n        return await this.post('user/reset-password', {account:account, password, verify, type});\r\n    }\r\n    \r\n    async userSetProp(prop:string, value:any) {\r\n        await this.post('tie/user-set-prop', {prop:prop, value:value});\r\n    }\r\n\r\n    async me():Promise<any> {\r\n        return await this.get('tie/me');\r\n    }\r\n\r\n    async user(id:number): Promise<any> {\r\n        return await this.get('tie/user', {id:id});\r\n\t}\r\n\t\r\n\tasync fromKey(key:string): Promise<{id:number, name:string, nick:string, icon:string}> {\r\n\t\treturn await this.get('tie/user-from-key', {key});\r\n\t}\r\n}\r\n\r\nexport const userApi = new UserApi('tv/', undefined);\r\n","export * from './uqMan';\r\nexport * from './entity';\r\nexport * from './action';\r\nexport * from './query';\r\nexport * from './sheet';\r\nexport * from './tuid';\r\nexport * from './book';\r\nexport * from './map';\r\nexport * from './history';\r\nexport * from './pending';\r\nexport * from './uqsMan';\r\nexport * from './tag/tag';\r\nexport * from './enum';\r\nexport * from './buildUqApp';\r\n","import _ from 'lodash';\r\n\r\nexport interface KeyValueRes {\r\n    [key:string]: any;\r\n}\r\n\r\nexport interface Res<T extends KeyValueRes> {\r\n    [lang:string]: T | {[district:string]: T};\r\n}\r\n\r\nexport const resOptions:{\r\n\tlang: string;\r\n\t$lang: string;\r\n\tdistrict: string;\r\n\t$district: string;\r\n} = {\r\n\tlang: undefined,\r\n\t$lang: undefined,\r\n\tdistrict: undefined,\r\n\t$district: undefined,\r\n}\r\n\r\nexport function setResOptions(lang:string, district:string) {\r\n\tresOptions.lang = lang;\r\n\tresOptions.$lang = '$' + lang;\r\n    resOptions.district = district;\r\n    resOptions.$district = '$' + district;\r\n}\r\n\r\n(function() {\r\n    let lang: string, district: string;\r\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\r\n        || navigator.language; // ||   // All browsers\r\n    //navigator.userLanguage; // IE <= 10\r\n    if (!language) {\r\n        lang = 'zh';\r\n        district = 'CN';\r\n    }\r\n    else {\r\n        let parts = language.split('-');\r\n        lang = parts[0];\r\n        if (parts.length > 1) district = parts[1].toUpperCase();\r\n    }\r\n    setResOptions(lang, district);\r\n}());\r\n\r\nexport function resLang<T extends KeyValueRes>(res:Res<T>):T {\r\n    let {lang, district} = resOptions;\r\n    let ret:T = {} as T;\r\n    if (res === undefined) return ret;\r\n    _.merge(ret, res._);\r\n    let l = res[lang];\r\n    if (l === undefined) return ret;\r\n    _.merge(ret, l._);\r\n    let d = l[district];\r\n    if (d === undefined) return ret;\r\n    _.merge(ret, d);\r\n    let {entity} = ret;\r\n    if (entity !== undefined) {\r\n        for (let i in entity) {\r\n            entity[i.toLowerCase()] = entity[i];\r\n        }\r\n    }\r\n    return ret;\r\n}\r\n\r\nconst resGlobal:any = {};\r\nexport function setRes(target: any, res: any):(str:string)=>any {\r\n\tif (res === undefined) return;\r\n\tlet {$lang, $district} = resOptions;\r\n\t_.merge(target, res);\r\n\tif ($lang !== undefined) {\r\n\t\tlet l = res[$lang];\r\n\t\tif (l !== undefined) {\r\n\t\t\t_.merge(target, l);\r\n\t\t\tlet d = l[$district];\r\n\t\t\tif (d !== undefined) {\r\n\t\t\t\t_.merge(target, d);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn function(str:string) {\r\n\t\treturn target[str] || str;\r\n\t}\r\n}\r\nexport function setGlobalRes(res: any) {\r\n\tsetRes(resGlobal, res);\r\n}\r\nexport function t(str:string):any {\r\n\treturn resGlobal[str] || str;\r\n}\r\n","import * as React from 'react';\r\nimport _ from 'lodash';\r\nimport {nav, Page, resOptions, PageHeaderProps, PageWebNav} from '../components';\r\nimport { User, env } from '../tool';\r\nimport { VPage } from './vpage';\r\nimport { View } from './view';\r\nimport { messageHub } from '../net';\r\n\r\nexport interface ConfirmOptions {\r\n    caption?: string;\r\n    message: string | JSX.Element;\r\n    classNames?: string;\r\n    ok?: string;\r\n    yes?: string;\r\n    no?: string;\r\n}\r\n\r\nexport interface WebNav<C extends Controller> {\r\n\tVNavHeader?: new (controller: C) => View<C>;\r\n\tVNavRawHeader?: new (controller: C) => View<C>;\r\n\tVNavFooter?: new (controller: C) => View<C>;\r\n\tVNavRawFooter?: new (controller: C) => View<C>;\r\n\trenderPageHeader?: (props: PageHeaderProps) => JSX.Element;\r\n}\r\n\r\nexport abstract class Controller {\r\n    readonly res: any;\r\n\treadonly x: any;\r\n\tprivate _t: any = {};\r\n\treadonly t: (str:string)=>any;\r\n    icon: string|JSX.Element;\r\n    label:string;\r\n\treadonly isDev:boolean = env.isDevelopment;\r\n\tpageWebNav: PageWebNav;\r\n    get user():User {return nav.user}\r\n    get isLogined():boolean {\r\n        let {user} = nav;\r\n        if (user === undefined) return false;\r\n        return user.id > 0;\r\n    }\r\n    constructor(res:any) {\r\n        this.res = res || {};\r\n\t\tthis.x = this.res.x || {};\r\n\t\tthis.t = (str:string):any => this.internalT(str) || str;\r\n\t}\r\n\r\n\tprotected beforeInit() {}\r\n\tprotected afterInit() {}\r\n\r\n\tinit(...param: any[]) {\r\n\t\tthis.beforeInit();\r\n\t\tthis.pageWebNav = this.getPageWebNav();\r\n\t\tthis.afterInit();\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\treturn this._t[str];\r\n\t}\r\n\r\n\tget webNav(): WebNav<any> {return undefined;}\r\n\r\n\tgetWebNav(): WebNav<any> {return this.webNav;}\r\n\r\n\tgetPageWebNav(): PageWebNav {return undefined;}\r\n\r\n\tget isWebNav(): boolean {return nav.isWebNav}\r\n\tnavigate(url:string) {\r\n\t\tnav.navigate(url);\r\n\t}\r\n\t\r\n\tprotected setRes(res:any) {\r\n\t\tif (res === undefined) return;\r\n\t\tlet {$lang, $district} = resOptions;\r\n\t\t_.merge(this._t, res);\r\n\t\tif ($lang !== undefined) {\r\n\t\t\tlet l = res[$lang];\r\n\t\t\tif (l !== undefined) {\r\n\t\t\t\t_.merge(this._t, l);\r\n\t\t\t\tlet d = l[$district];\r\n\t\t\t\tif (d !== undefined) {\r\n\t\t\t\t\t_.merge(this._t, d);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\r\n    private receiveHandlerId:number;\r\n    //private disposer:()=>void;\r\n\r\n    protected dispose = () => {\r\n        // message listener的清理\r\n\t\t//nav.unregisterReceiveHandler(this.receiveHandlerId);\r\n\t\tmessageHub.unregisterReceiveHandler(this.receiveHandlerId);\r\n        this.onDispose();\r\n    }\r\n\r\n    protected onDispose() {\r\n\t}\r\n\t\r\n\t//get isRouting() {return nav.isRouting;}\r\n\r\n\tisMe(id:any):boolean {\r\n\t\tif (id === null) return false;\r\n\t\tlet {user} = this;\r\n\t\tlet userId = user.id;\r\n\t\tswitch (typeof id) {\r\n\t\t\tdefault: return false;\r\n\t\t\tcase 'string': return Number(id) === userId;\r\n\t\t\tcase 'number': return id === userId;\r\n\t\t\tcase 'object': return id.id === userId;\r\n\t\t}\r\n\t}\r\n\r\n    protected async openVPage<C extends Controller, P extends VPage<C>>(vp: new (controller: C)=>P, param?:any, afterBack?:(ret:any)=>void):Promise<P> {\r\n\t\tlet ret = new vp((this as any) as C);\r\n\t\tawait ret.open(param, afterBack);\r\n\t\treturn ret;\r\n    }\r\n\r\n    protected async replaceVPage<C extends Controller, P extends VPage<C>>(vp: new (controller: C)=>P, param?:any, afterBack?:(ret:any)=>void):Promise<P> {\r\n\t\tlet ret = new vp((this as any) as C);\r\n\t\tawait ret.replaceOpen(param, afterBack);\r\n\t\treturn ret;\r\n    }\r\n\r\n    protected renderView<C extends Controller, V extends View<C>>(view: new (controller: C)=>V, param?:any):JSX.Element {\r\n\t\tlet v = new view((this as any) as C);\r\n\t\treturn v.render(param);\r\n    }\r\n\r\n    async event(type:string, value:any) {\r\n        await this.onEvent(type, value);\r\n    }\r\n\r\n    protected async onEvent(type:string, value:any) {\r\n    }\r\n\r\n    protected msg(text:string) {\r\n        alert(text);\r\n    }\r\n    protected errorPage(header:string, err:any) {\r\n        this.openPage(<Page header=\"App error!\">\r\n            <pre>\r\n                {typeof err === 'string'? err : err.message}\r\n            </pre>\r\n        </Page>);\r\n    }\r\n\r\n    protected onMessage(message:any):Promise<void> {\r\n        return;\r\n    }\r\n\r\n    private onMessageReceive = async (message:any):Promise<void> => {\r\n        await this.onMessage(message);\r\n    }\r\n\r\n    protected async beforeStart():Promise<boolean> {\r\n        /*\r\n        console.log('this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);');\r\n        this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);\r\n        console.log('return true');\r\n        */\r\n        return true;\r\n\t}\r\n\tprotected async afterStart():Promise<void> {\r\n\t}\r\n    protected registerReceiveHandler() {\r\n        this.receiveHandlerId = messageHub.registerReceiveHandler(this.onMessageReceive);\r\n    }\r\n\r\n    protected abstract internalStart(param?:any, ...params:any[]):Promise<void>;\r\n    async start(param?:any, ...params:any[]):Promise<void> {\r\n        //this.disposer = this.dispose;\r\n\t\tthis.registerReceiveHandler();\r\n        let ret = await this.beforeStart();\r\n        if (ret === false) return;\r\n\t\tawait this.internalStart(param, ...params);\r\n\t\tawait this.afterStart();\r\n    }\r\n\r\n    get isCalling():boolean {return this._resolve_$ !== undefined}\r\n\r\n    private _resolve_$:((value:any) => void)[];\r\n    async call<T>(param?:any, ...params:any[]):Promise<T> {\r\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\r\n        return new Promise<T> (async (resolve, reject) => {\r\n            this._resolve_$.push(resolve);\r\n            await this.start(param, ...params);\r\n        });\r\n    }\r\n\r\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\r\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\r\n        return new Promise<any> (async (resolve, reject) => {\r\n            this._resolve_$.push(resolve);\r\n            await (new vp(this as any)).open(param);\r\n        });\r\n    }\r\n\r\n    returnCall(value:any) {\r\n        if (this._resolve_$ === undefined) return;\r\n        let resolve = this._resolve_$.pop();\r\n        if (resolve === undefined) {\r\n            alert('the Controller call already returned, or not called');\r\n            return;\r\n        }\r\n        resolve(value);\r\n    }\r\n\r\n    openPage(page:JSX.Element, onClosePage?: (ret:any)=>void) {\r\n\t\tlet disposer: ()=>void;\r\n\t\tif (onClosePage !== undefined) {\r\n\t\t\tdisposer = () => {\r\n\t\t\t\t//if (this.disposer) this.disposer();\r\n\t\t\t\tonClosePage(undefined);\r\n\t\t\t}\r\n\t\t}\r\n\r\n        nav.push(page, disposer);\r\n        //this.disposer = undefined;\r\n    }\r\n\r\n    replacePage(page:JSX.Element, onClosePage?: ()=>void) {\r\n        nav.replace(page, onClosePage);\r\n        //this.disposer = undefined;\r\n    }\r\n\r\n    backPage() {\r\n        nav.back();\r\n    }\r\n\r\n    closePage(level?:number) {\r\n        nav.pop(level);\r\n    }\r\n\r\n    ceasePage(level?:number) {\r\n        nav.ceaseTop(level);\r\n\t}\r\n\t\r\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tnav.go(showPage, url, absolute);\r\n\t}\r\n\r\n    removeCeased() {\r\n        nav.removeCeased();\r\n    }\r\n\r\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        nav.regConfirmClose(confirmClose);\r\n\t}\r\n\r\n\tprivate topPageKey:any;\r\n\tprotected startAction() {\r\n\t\tthis.topPageKey = nav.topKey();\r\n    }\r\n    get TopKey() {\r\n        return this.topPageKey;\r\n    }\r\n    SetTopKey(key:any) {\r\n        this.topPageKey = key;\r\n    }\r\n\tpublic popToTopPage() {\r\n\t\tnav.popTo(this.topPageKey);\r\n\t}\r\n\r\n    async confirm(options: ConfirmOptions): Promise<'ok'|'yes'|'no'|undefined> {\r\n        return new Promise<'ok'|'yes'|'no'|undefined> (async (resolve, reject) => {\r\n            let {caption, message, ok, yes, no, classNames} = options;\r\n            let close = (res:'ok'|'yes'|'no'|undefined) => {\r\n                this.closePage();\r\n                resolve(res);\r\n            }\r\n            let buttons:any[] = [];\r\n            if (ok !== undefined) {\r\n                buttons.push(<button key=\"ok\" className=\"btn btn-primary mr-3\" onClick={()=>close('ok')}>{ok}</button>);\r\n            }\r\n            if (yes !== undefined) {\r\n                buttons.push(<button key=\"yes\" className=\"btn btn-success mr-3\" onClick={()=>close('yes')}>{yes}</button>);\r\n            }\r\n            if (no !== undefined) {\r\n                buttons.push(<button key=\"no\" className=\"btn btn-outline-danger mr-3\" onClick={()=>close('no')}>{no}</button>);\r\n            }\r\n            this.openPage(<Page header={caption || '请确认'} back=\"close\">\r\n                <div className={classNames || \"rounded bg-white m-5 p-3 border\"}>\r\n                    <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {message}\r\n                    </div>\r\n                    <div className=\"mt-3 d-flex align-items-center justify-content-center\">\r\n                        {buttons}\r\n                    </div>\r\n                </div>\r\n            </Page>);\r\n            nav.regConfirmClose(async ():Promise<boolean> => {\r\n                resolve(undefined);\r\n                return true;\r\n            });\r\n        });\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Page, Scroller, TabsProps } from \"../components\";\r\nimport { View } from \"./view\";\r\nimport { Controller } from \"./controller\";\r\n\r\nexport abstract class VPage<C extends Controller> extends View<C> {\r\n\tprotected retOnClosePage: any;\r\n\r\n    open(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\r\n\t\tthis.init(param);\r\n\t\tlet _onClosePage: ()=>void;\r\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\r\n\t\tthis.openPageElement(this.renderPage(), _onClosePage);\r\n\t\treturn;\r\n\t}\r\n\r\n    replaceOpen(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\r\n\t\tthis.init(param);\r\n\t\tlet _onClosePage: ()=>void;\r\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\r\n\t\tthis.replacePageElement(this.renderPage(), _onClosePage);\r\n\t\treturn;\r\n\t}\r\n\r\n\trender(param?:any):JSX.Element {\r\n\t\tthis.init(param);\r\n\t\treturn this.renderPage();\r\n\t}\r\n\r\n\tinit(param?:any):void {return;}\r\n\r\n\theader():string|boolean|JSX.Element {return null;}\r\n\tright():JSX.Element {return null;}\r\n\tcontent():JSX.Element {return null;}\r\n\tfooter():JSX.Element {return null;}\r\n\tlogout(): boolean | (()=>Promise<void>) {return false;}\r\n\tprotected renderPage():JSX.Element {\r\n\t\tlet header = this.header();\r\n\t\tif (!header) header = false;\r\n\t\tlet logout = this.logout();\r\n\t\treturn <Page\r\n\t\t\theader={header} right={this.right()} footer={this.footer()}\r\n\t\t\tonScroll={(e:any)=>this.onPageScroll(e)}\r\n\t\t\tonScrollTop={(scroller: Scroller) => this.onPageScrollTop(scroller)}\r\n\t\t\tonScrollBottom={(scroller: Scroller) => this.onPageScrollBottom(scroller)}\r\n\t\t\tback={this.back}\r\n\t\t\theaderClassName={this.headerClassName}\r\n\t\t\tclassName={this.className}\r\n\t\t\tafterBack={()=>this.afterBack()}\r\n\t\t\ttabsProps={this.tabsProps}\r\n\t\t\tlogout={logout}\r\n\t\t\twebNav={this.controller.pageWebNav}\r\n\t\t>\r\n\t\t\t{this.content()}\r\n\t\t</Page>;\r\n\t}\r\n\r\n\tprotected onPageScroll(e:any) {}\r\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {return false;}\r\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {return;}\r\n\tprotected afterBack():void {}\r\n\tprotected get back(): 'close' | 'back' | 'none' {return 'back'}\r\n\tprotected get headerClassName(): string {return null;}\r\n\tprotected get className(): string {return null;}\r\n\tprotected get tabsProps(): TabsProps {return null;}\r\n}\r\n","import React from 'react';\r\nimport _ from 'lodash';\r\nimport { FA, Page } from '../../components';\r\nimport { Controller } from \"../controller\";\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport interface CStringEditProps {\r\n\tlabel?: string;\r\n\tplaceholder?: string;\r\n\tmaxLength?: number;\r\n\tonValueChange?: (value: string) => Promise<void>;\r\n}\r\n\r\nexport class CStringEdit extends Controller {\r\n\tprivate props: CStringEditProps = {\r\n\t\tlabel: '编辑'\r\n\t}\r\n\t@observable value: string;\r\n\t@observable private newValue: string;\r\n\t@observable private isChanged: boolean;\r\n\t@observable private error: string;\r\n\r\n\tprotected async internalStart() {}\r\n\trender(value:string, props?:CStringEditProps) {\r\n\t\tthis.value = value;\r\n\t\tif (props) _.merge(this.props, props);\r\n\t\treturn React.createElement(observer(()=><>{this.renderValue()}{this.renderPencil()}</>))\r\n\t}\r\n\r\n\tprotected renderValue() {return <>{this.value}</>}\r\n\tprotected renderPencil() {\r\n\t\treturn <span onClick={this.onEdit} className=\"cursor-pointer\">\r\n\t\t\t&nbsp; <FA className=\"text-info\" name=\"pencil-square-o\" /> &nbsp;\r\n\t\t</span>;\r\n\t}\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.verifyValue();\r\n\t}\r\n\t\r\n\tprotected verifyValue() {}\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n\t}\r\n\t\r\n\tprivate onEdit = () => {\r\n\t\tlet {label, maxLength, placeholder, onValueChange} = this.props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (this.error === undefined) {\r\n\t\t\t\tthis.value = this.newValue;\r\n\t\t\t\tthis.closePage();\r\n\t\t\t\tif (onValueChange) onValueChange(this.value);\r\n\t\t\t}\r\n\t\t}\r\n        let right = React.createElement(observer(() => <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>));\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\t\tif (evt.keyCode === 13) onSave();\r\n\t\t}\r\n\t\tthis.openPage(<Page header={label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<input type=\"text\"\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\tdefaultValue={this.value}\r\n\t\t\t\t\tmaxLength={maxLength} />\r\n                {\r\n\t\t\t\t\tReact.createElement(observer(()=> placeholder && <div className=\"small muted m-2\">{placeholder}</div>))                    \r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n\t\t</Page>);\r\n\t}\r\n}\r\n","const ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\nconst ID_LENGTH = 8;\r\n\r\nexport function uid():string {\r\n    let len = ALPHABET.length;\r\n    let rtn = '';\r\n    for (let i = 0; i < ID_LENGTH; i++) {\r\n        rtn += ALPHABET.charAt(Math.floor(Math.random() * len));\r\n    }\r\n    return rtn;\r\n}\r\n","import _ from 'lodash';\r\nimport {observable, IObservableArray} from 'mobx';\r\nimport { PageItems } from '../tool';\r\nimport {Field, ArrFields} from './uqMan';\r\nimport {Entity} from './entity';\r\nimport { QueryQueryCaller, QueryPageCaller } from './caller';\r\n\r\nexport type QueryPageApi = (name:string, pageStart:any, pageSize:number, params:any) => Promise<string>;\r\n\r\nexport class QueryPager<T extends any> extends PageItems<T> {\r\n\tprivate query: Query;\r\n\tprivate $page: any;\r\n\tprotected idFieldName: any;\r\n    constructor(query: Query, pageSize?: number, firstSize?: number, itemObservable?:boolean) {\r\n        super(itemObservable);\r\n        this.query = query;\r\n        if (pageSize !== undefined) this.pageSize = pageSize;\r\n\t\tif (firstSize !== undefined) this.firstSize = firstSize;\r\n\t}\r\n\r\n\tsetReverse() {\r\n\t\tthis.appendPosition = 'head';\r\n\t}\r\n\r\n    protected async onLoad() {\r\n\t\tif (this.$page) return;\r\n        let {schema} = this.query;\r\n        if (schema === undefined) {\r\n\t\t\tawait this.query.loadSchema();\r\n\t\t\tschema = this.query.schema;\r\n\t\t}\r\n\t\tif (schema === undefined) return;\r\n\t\tlet $page = this.$page = (schema.returns as any[]).find(v => v.name === '$page');\r\n\t\tif ($page === undefined) return;\r\n\t\tthis.sortOrder = $page.order;\r\n\t\tlet fields = $page.fields;\r\n\t\tif (fields !== undefined) {\r\n\t\t\tlet field = fields[0];\r\n\t\t\tif (field) this.idFieldName = field.name;\r\n\t\t}\r\n    }\r\n\r\n    protected async loadResults(param:any, pageStart:number, pageSize:number):Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.query.page(param, pageStart, pageSize);\r\n\t\treturn ret;\r\n\t}\r\n\tprotected getPageId(item:T) {\r\n\t\tif (item === undefined) return;\r\n\t\tif (typeof item === 'number') return item;\r\n\t\tlet start = (item as any)[this.idFieldName];\r\n\t\tif (start === null) return;\r\n\t\tif (start === undefined) return;\r\n\t\tif (typeof start === 'object') {\r\n\t\t\tlet id = start.id;\r\n\t\t\tif (id !== undefined) return id;\r\n\t\t}\r\n\t\treturn start;\r\n\t}\r\n\tasync refreshItems(item:T) {\r\n\t\tlet index = this._items.indexOf(item);\r\n\t\tif (index < 0) return;\r\n\t\tlet startIndex:number;\r\n\t\tif (this.appendPosition === 'tail') {\r\n\t\t\tstartIndex = index - 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tstartIndex = index + 1;\r\n\t\t}\r\n\t\tlet pageStart = this.getPageId(this._items[startIndex]);\r\n\t\tlet pageSize = 1;\r\n        let ret = await this.load(\r\n\t\t\tthis.param, \r\n\t\t\tpageStart,\r\n\t\t\tpageSize);\r\n\t\tlet len = ret.length;\r\n\t\tif (len === 0) {\r\n\t\t\tthis._items.splice(index, 1);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet newItem = ret[i];\r\n\t\t\tif (!newItem) continue;\r\n\t\t\tlet newId = newItem[this.idFieldName];\r\n\t\t\tif (newId === undefined || newId === null) continue;\r\n\t\t\tif (typeof newId === 'object') newId = newId.id;\r\n\t\t\tlet oldItem = this._items.find(v => {\r\n\t\t\t\tlet oldId = (v as any)[this.idFieldName];\r\n\t\t\t\tif (oldId === undefined || oldId === null) return false;\r\n\t\t\t\tif (typeof oldId === 'object') oldId = oldId.id;\r\n\t\t\t\treturn oldId = newId;\r\n\t\t\t});\r\n\t\t\tif (oldItem) {\r\n\t\t\t\t_.merge(oldItem, newItem);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class UqQuery<P, R> extends Entity {\r\n    get typeName(): string { return 'query';}\r\n    private pageStart: any;\r\n    private pageSize:number;\r\n    private params:any;\r\n    private more: boolean;\r\n    private startField: Field;\r\n    @observable list:IObservableArray; // = observable.array([], {deep: false});\r\n    returns: ArrFields[];\r\n    isPaged: boolean;\r\n\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {returns} = schema;\r\n        //this.returns = returns;\r\n        this.isPaged = returns && (returns as any[]).find(v => v.name === '$page') !== undefined;\r\n    }\r\n\r\n    resetPage(size:number, params:any) {\r\n        this.pageStart = undefined;\r\n        this.pageSize = size;\r\n        this.params = params;\r\n        this.more = false;\r\n        this.list = undefined;\r\n    }\r\n    get hasMore() {return this.more;}\r\n    async loadPage():Promise<void> {\r\n        if (this.pageSize === undefined) {\r\n            throw new Error('call resetPage(size:number, params:any) first');\r\n        }\r\n        let pageStart:any;\r\n        if (this.pageStart !== undefined) {\r\n            switch (this.startField.type) {\r\n                default: pageStart = this.pageStart; break;\r\n                case 'date':\r\n                case 'time':\r\n                case 'datetime': pageStart = (this.pageStart as Date).getTime(); break;\r\n            }\r\n        }\r\n\t\tlet ret = await this.page(this.params, pageStart, this.pageSize+1);\r\n\t\tlet page = (ret as any).$page;\r\n        /*\r\n        await this.loadSchema();\r\n        let res = await this.tvApi.page(this.name, pageStart, this.pageSize+1, this.params);\r\n        let data = await this.unpackReturns(res);\r\n        let page = data['$page'] as any[];\r\n        */\r\n        this.list = observable.array([], {deep: false});\r\n        if (page !== undefined) {\r\n            if (page.length > this.pageSize) {\r\n                this.more = true;\r\n                page.pop();\r\n                let ret = this.returns.find(r => r.name === '$page');\r\n                this.startField = ret.fields[0];\r\n                this.pageStart = page[page.length-1][this.startField.name];\r\n            }\r\n            else {\r\n                this.more = false;\r\n            }\r\n            this.list.push(...page);\r\n        }\r\n        //this.loaded = true;\r\n    }\r\n\r\n    protected pageCaller(params: any, showWaiting: boolean = true): QueryPageCaller {\r\n        return new QueryPageCaller(this, params, showWaiting);\r\n    }\r\n\r\n    async page(params:P, pageStart:any, pageSize:number, showWaiting: boolean = true):Promise<R> {\r\n        let p = {pageStart, pageSize, params};\r\n        let res = await this.pageCaller(p, showWaiting).request();\r\n        return res;\r\n    }\r\n    protected queryCaller(params: P, showWaiting: boolean = true): QueryQueryCaller {\r\n        return new QueryQueryCaller(this, params, showWaiting);\r\n    }\r\n    async query(params:P, showWaiting:boolean = true):Promise<R> {\r\n        let res = await this.queryCaller(params, showWaiting).request();\r\n        return res;\r\n    }\r\n    async table(params:P, showWaiting:boolean = true): Promise<any[]> {\r\n        let ret = await this.query(params, showWaiting);\r\n        for (let i in ret) {\r\n            return (ret as any)[i];\r\n        }\r\n    }\r\n    async obj(params:P, showWaiting:boolean = true):Promise<any> {\r\n        let ret = await this.table(params, showWaiting);\r\n        if (ret.length > 0) return ret[0];\r\n    }\r\n    async scalar(params:P, showWaiting:boolean = true):Promise<any> {\r\n        let ret = await this.obj(params, showWaiting);\r\n        for (let i in ret) return ret[i];\r\n    }\r\n}\r\n\r\nexport class Query extends UqQuery<any, any> {\r\n}\r\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABGCAYAAACQRffVAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAF8mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjAtMDUtMjlUMTU6MDY6MzgtMDQ6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTA1LTI5VDE3OjE4OjM2LTA0OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTA1LTI5VDE3OjE4OjM2LTA0OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmE3ZjJlZGZmLTlkMzUtNDBiNy1hNmRhLTNlNDZjZWMwOWJiZiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3ZmY0N2IxZC1mZmYwLTQ3ZWMtYjVhNS1hZDZkOGNkY2Y2MzEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3ZmY0N2IxZC1mZmYwLTQ3ZWMtYjVhNS1hZDZkOGNkY2Y2MzEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjdmZjQ3YjFkLWZmZjAtNDdlYy1iNWE1LWFkNmQ4Y2RjZjYzMSIgc3RFdnQ6d2hlbj0iMjAyMC0wNS0yOVQxNTowNjozOC0wNDowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmE3ZjJlZGZmLTlkMzUtNDBiNy1hNmRhLTNlNDZjZWMwOWJiZiIgc3RFdnQ6d2hlbj0iMjAyMC0wNS0yOVQxNzoxODozNi0wNDowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+BVuKlQAACWlJREFUeJzlm32QVlUdxz/Pw8MuLAgIsiAvusKAxC6p1JBoYhKCVtSgGGSWOaKCFjKppJjNOFraCxVaEwUiE5ZCmQahEVC8hLptqEWstpBAA4jBKiDs6i672x/fe3nuc577cu7zXJxl+MzsPPece86553vvefmd3zmbqq6o5OQiVWjGjwK3ZhKsyQdEGwWKXggMTydbmXbLIOA8YMmpIvi7zu8rp4LgjwCTnesXTwXBjzi/e4EtJ6ngNtuEVwAXOdcvAE0nqWBrFnuuVwHEmZY6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\"","import { messageHub } from \"./messageHub\";\r\n\r\nlet subAppWindow:Window;\r\nfunction postWsToSubApp(msg:any) {\r\n    if (subAppWindow === undefined) return;\r\n    subAppWindow.postMessage({\r\n        type: 'ws',\r\n        msg: msg\r\n    }, '*');\r\n}\r\n\r\nexport function setSubAppWindow(win:Window) {\r\n    subAppWindow = win;\r\n}\r\n\r\nexport function postWsToTop(msg:any) {\r\n    window.top.postMessage({\r\n        type: 'ws',\r\n        msg: msg\r\n    }, '*');\r\n}\r\n\r\nexport abstract class WsBase {\r\n\tprivate messageHub = messageHub;\r\n\t/*\r\n    wsBaseId:string;\r\n    private handlerSeed = 1;\r\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\r\n\tprivate msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\r\n\t*/\r\n\t/*\r\n    onWsReceiveAny(handler:(msg:any)=>Promise<void>):number {\r\n        let seed = this.handlerSeed++;\r\n        this.anyHandlers[seed] = handler;\r\n        return seed;\r\n    }\r\n    onWsReceive(type:string, handler:(msg:any)=>Promise<void>):number {\r\n        let seed = this.handlerSeed++;\r\n        this.msgHandlers[seed] = {type:type, handler: handler};\r\n        return seed;\r\n    }\r\n    endWsReceive(handlerId:number) {\r\n        delete this.anyHandlers[handlerId];\r\n        delete this.msgHandlers[handlerId];\r\n\t}\r\n\t*/\r\n    async receive(msg:any) {\r\n\t\tthis.messageHub.dispatch(msg);\r\n\t\t/*\r\n        let {$type} = msg;\r\n        for (let i in this.anyHandlers) {\r\n            await this.anyHandlers[i](msg);\r\n        }\r\n        for (let i in this.msgHandlers) {\r\n            let {type, handler} = this.msgHandlers[i];\r\n            if (type !== $type) continue;\r\n            await handler(msg);\r\n\t\t}\r\n\t\t*/\r\n    }\r\n}\r\n\r\nlet wsBaseSeed = 1;\r\nexport class WsBridge extends WsBase {\r\n    wsBaseId:string = 'WsBridge seed ' + wsBaseSeed++;\r\n}\r\n\r\nexport const wsBridge = new WsBridge();\r\n\r\nexport class WSChannel extends WsBase {\r\n    wsBaseId:string = 'WSChannel seed ' + wsBaseSeed++;\r\n    static centerToken:string;\r\n    private wsHost: string;\r\n    private token: string;\r\n    private ws: WebSocket;\r\n\r\n    constructor(wsHost: string, token: string) {\r\n        super();\r\n        this.wsHost = wsHost;\r\n        this.token = token;\r\n    }\r\n\r\n    static setCenterToken(token?: string) {\r\n        WSChannel.centerToken = token;\r\n    }\r\n    \r\n    connect():Promise<void> {\r\n        //this.wsHost = wsHost;\r\n        //this.token = token || WSChannel.centerToken;\r\n        if (this.ws !== undefined) return;\r\n        let that = this;\r\n        return new Promise((resolve, reject) => {\r\n            let ws = new WebSocket(this.wsHost, this.token || WSChannel.centerToken);\r\n            console.log('connect webSocket %s', this.wsHost);\r\n            ws.onopen = (ev) => {\r\n                console.log('webSocket connected %s', this.wsHost);\r\n                that.ws = ws;\r\n                resolve();\r\n            };\r\n            ws.onerror = (ev) => {\r\n                reject('webSocket can\\'t open!');\r\n            };\r\n            ws.onmessage = async (msg) => await that.wsMessage(msg);\r\n            ws.onclose = (ev) => {\r\n                that.ws = undefined;\r\n                console.log('webSocket closed!');\r\n            }\r\n        });\r\n    }\r\n    close() {\r\n        if (this.ws !== undefined) {\r\n            this.ws.close();\r\n            this.ws = undefined;\r\n        }\r\n    }\r\n    private async wsMessage(event:any):Promise<void> {\r\n        try {\r\n            console.log('websocket message: %s', event.data);\r\n            let msg = JSON.parse(event.data);\r\n            postWsToSubApp(msg);\r\n            await this.receive(msg);\r\n        }\r\n        catch (err) {\r\n            console.log('ws msg error: ', err);\r\n        }\r\n    }\r\n    sendWs(msg:any) {\r\n        let netThis = this;\r\n        this.connect().then(() => {\r\n            netThis.ws.send(msg);\r\n        });\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { BoxId } from './boxId';\r\nimport { Tuid } from './tuid';\r\nimport { observer } from 'mobx-react';\r\n\r\nconst TuidContent = (tuidName:string, values:any, x?:any) => {\r\n    return <>{tuidName}: {uqStringify(values)}</>;\r\n};\r\n\r\nexport function uqStringify(values: any): string {\r\n    let s = '{';\r\n    if (values === undefined) return 'undefined';\r\n    for (let i in values) {\r\n        let v = values[i];\r\n        s += i + ': ';\r\n        if (v === undefined) {\r\n            s += 'undefined';\r\n        }\r\n        else if (v === null) {\r\n            s += 'null';\r\n        }\r\n        else {\r\n            switch (typeof v) {\r\n                default:\r\n                    s += v;\r\n                    break;\r\n                case 'function':\r\n                    s += 'function';\r\n                    break;\r\n                case 'object':\r\n                    s += '{obj}';\r\n                    break;\r\n            }\r\n        }\r\n        s += ', ';\r\n    }\r\n    return s + '}';\r\n}\r\n\r\nexport class ReactBoxId implements BoxId {\r\n    readonly id: number;\r\n    protected tuid: Tuid;\r\n    protected ui: (values:any) => JSX.Element;\r\n    readonly isUndefined:boolean;\r\n    constructor(id: number, tuid: Tuid, ui: (values:any) => JSX.Element) {\r\n        this.id = Number(id);\r\n        this.tuid = tuid;\r\n        this.ui = ui;\r\n        this.isUndefined = (this.tuid === undefined);\r\n    }\r\n\r\n    get obj():any {\r\n        return this.tuid.valueFromId(this.id);\r\n    }\r\n\r\n    equ(id:BoxId|number): boolean {\r\n        if (id === undefined || id === null) return false;\r\n        if (typeof id === 'object') return this.id === id.id;\r\n        return this.id === id;\r\n    }\r\n\r\n    render(ui:TvTemplet, x:any):JSX.Element {\r\n        if (this.id === undefined || this.id === null || isNaN(this.id) === true) return;\r\n        let boxName = this.boxName; // this.tuid.name;\r\n        let val = this.obj; // this.tuid.valueFromId(this.id);\r\n        if (this.isUndefined === true) {\r\n            if (ui !== undefined) return ui(val, x);\r\n            return TuidContent(boxName, val, x);\r\n        }\r\n        switch (typeof val) {\r\n            case 'undefined':\r\n                return <span className=\"text-black-50\">{boxName} undefined</span>;\r\n            case 'number':\r\n                return <span className=\"text-light\">{boxName} {this.id}</span>;\r\n        }\r\n        if (ui === undefined) {\r\n            ui = this.ui;\r\n        }\r\n        if (ui !== undefined) {\r\n            if (typeof ui !== 'function') {\r\n                ui = (ui as any).content;\r\n            }\r\n            if (ui !== undefined) {\r\n                let ret = ui(val/*, this.tuidUR.res*/);\r\n                if (ret !== undefined) return ret;\r\n                return <span className=\"text-danger\">{boxName} {this.id}</span>;\r\n            }\r\n        }\r\n\r\n        return TuidContent(boxName, val);\r\n    }\r\n\r\n    get boxName():string {return this.tuid.name}\r\n    // ui(): TvTemplet {return this.tuid.ui}\r\n    // res(): any {return this.tuid.res}\r\n\r\n    async assure(): Promise<BoxId> {\r\n        await this.tuid.assureBox(this.id);\r\n        return this;\r\n    }\r\n}\r\n\r\nfunction boxIdContent(bi: number|BoxId, ui:TvTemplet, x:any) {\r\n    let logContent:any;\r\n    let boxId:ReactBoxId = bi as ReactBoxId;\r\n    switch(typeof bi) {\r\n        case 'undefined': logContent = <>boxId undefined</>; break;\r\n        case 'number': logContent = <>id:{bi}</>; break;\r\n        default:\r\n            if (typeof boxId.render !== 'function') {\r\n                if (ui === undefined) {\r\n                    logContent = TuidContent(boxId.boxName, bi, x);\r\n                }\r\n                else {\r\n                    return ui(bi, x);\r\n                }\r\n            }\r\n            break;\r\n    }\r\n    if (logContent !== undefined) {\r\n        return <del className=\"text-danger\">{logContent}</del>;\r\n    }\r\n    return boxId.render(ui, x);\r\n}\r\n\r\nexport type TvTemplet = (values?:any, x?:any) => JSX.Element;\r\n\r\ninterface Props {\r\n    tuidValue: number|BoxId, \r\n    ui?: TvTemplet,\r\n    x?: any,\r\n    nullUI?: ()=>JSX.Element\r\n}\r\n\r\nconst Tv = observer(({tuidValue, ui, x, nullUI}:Props) => {\r\n    if (tuidValue === undefined) {\r\n        if (nullUI === undefined) return <small className=\"text-muted\">[无]</small>;\r\n        return nullUI();\r\n    }\r\n    if (tuidValue === null) {\r\n        if (nullUI === undefined) return <>[null]</>;\r\n        return nullUI();\r\n    }\r\n    let ttv = typeof tuidValue;\r\n    switch (ttv) {\r\n        default:\r\n            if (ui === undefined)\r\n                return <>{ttv}-{tuidValue}</>;\r\n            else {\r\n                let ret = ui(tuidValue, x);\r\n                if (ret !== undefined) return ret;\r\n                return <>{tuidValue}</>;\r\n            }\r\n        case 'object':\r\n            let divObj = boxIdContent(tuidValue, ui, x);\r\n            if (divObj !== undefined) return divObj;\r\n            return nullUI === undefined? <>id null</>: nullUI();\r\n        case 'number':\r\n            return <>id...{tuidValue}</>;\r\n    }\r\n});\r\n\r\nexport const tv = (tuidValue:number|BoxId, ui?:TvTemplet, x?:any, nullUI?:()=>JSX.Element):JSX.Element => {\r\n    return <Tv tuidValue={tuidValue} ui={ui} x={x} nullUI={nullUI} />;\r\n};\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { nav } from './nav';\r\n\r\nexport interface ImageProps {\r\n    src: string;\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    altImage?: string;\r\n}\r\n\r\n// src = .src, 表示fontawesome Icon\r\nexport function Image(props: ImageProps) {\r\n\tlet {className, style, src, altImage} = props;\r\n\tlet icon:string;\r\n    if (src) {\r\n\t\tif (src.indexOf('.') !== 0) {\r\n\t\t\tif (src.startsWith(':') === true) {\r\n\t\t\t\tsrc = nav.resUrl + src.substr(1);\r\n\t\t\t}\r\n\t\t\treturn <img src={src} className={className} alt=\"img\"\r\n\t\t\t\tstyle={style}\r\n\t\t\t\tonError={evt=>{\r\n\t\t\t\t\tif (altImage) evt.currentTarget.src=altImage;\r\n\t\t\t\t\telse evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\r\n\t\t\t\t}} />;\r\n\t\t}\r\n\t\ticon = src.substr(1);\r\n\t}\r\n\telse {\r\n\t\ticon = 'file-o'\r\n\t}\r\n\treturn <span className={classNames(className, 'image-none')} style={style}>\r\n\t\t<i className={'fa fa-' + icon} />\r\n\t</span>;\r\n}\r\n","import jwtDecode from 'jwt-decode';\r\n\r\nexport interface Unit {\r\n    id: number;\r\n    name: string;\r\n}\r\n\r\nexport interface Guest {\r\n    id: number;             // id = 0\r\n    guest: number;\r\n    token: string;\r\n}\r\n\r\nexport interface User extends Guest {\r\n    id: number;\r\n    name: string;\r\n    nick?: string;\r\n    icon?: string;\r\n}\r\n\r\nexport function decodeUserToken(token: string): User {\r\n    let ret:any = jwtDecode(token);\r\n    let user: User = {\r\n        id: ret.id,\r\n        name: ret.name,\r\n        guest: ret.guest,\r\n        token: token,\r\n    };\r\n    return user;\r\n}\r\n\r\nexport function decodeGuestToken(token: string): Guest {\r\n    let ret:any = jwtDecode(token);\r\n    let guest: Guest = {\r\n        id: 0,\r\n        guest: ret.guest,\r\n        token: token,\r\n    };\r\n    return guest;\r\n}\r\n","import { env } from '../tool';\r\n\r\nconst centerHost = process.env['REACT_APP_CENTER_HOST'];\r\nconst centerDebugHost = 'localhost:3000'; //'192.168.86.64';\r\nconst resHost = process.env['REACT_APP_RES_HOST'] || centerHost;\r\nconst resDebugHost = 'localhost:3015'; //'192.168.86.63';\r\nconst uqDebugHost = 'localhost:3015'; //'192.168.86.63';\r\nconst uqDebugBuilderHost = 'localhost:3009';\r\ninterface HostValue {\r\n    value: string;\r\n\tlocal: boolean;\r\n}\r\nconst hosts:{[name:string]:HostValue} = {\r\n    centerhost: {\r\n        value: process.env['REACT_APP_CENTER_DEBUG_HOST'] || centerDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    reshost: {\r\n        value: process.env['REACT_APP_RES_DEBUG_HOST'] || resDebugHost,\r\n\t\tlocal: false,\r\n    },\r\n    uqhost: {\r\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    unitxhost: {\r\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    \"uq-build\": {\r\n        value: process.env['REACT_APP_UQ_DEBUG_BUILDER_HOST'] || uqDebugBuilderHost, \r\n\t\tlocal: false,\r\n    }\r\n}\r\n\r\nconst httpArr = ['https://', 'http://'];\r\nfunction isAbsoluteUrl(url:string):boolean {\r\n    for (let str of httpArr) {\r\n        if (url.startsWith(str) === true) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction urlFromHost(host:string):string {\r\n    if (isAbsoluteUrl(host) === true) {\r\n        if (host.endsWith('/')) return host;\r\n        return host + '/';\r\n    }\r\n    return `http://${host}/`;\r\n}\r\n\r\nfunction centerUrlFromHost(host:string):string {\r\n    return urlFromHost(host);\r\n}\r\nfunction centerWsFromHost(host:string) {\r\n    let https = 'https://';\r\n    if (host.startsWith(https) === true) {\r\n        host = host.substr(https.length);\r\n        if (host.endsWith('/') === true) host = host.substr(0, host.length-1);\r\n        return 'wss://' + host + '/tv/';\r\n    }\r\n    return `ws://${host}/tv/`\r\n}\r\nexport function resUrlFromHost(host:string) {\r\n\tif (!host) return;\r\n    let url = urlFromHost(host);\r\n    return url + 'res/';\r\n}\r\n\r\nconst fetchOptions = {\r\n    method: \"GET\",\r\n    mode: \"no-cors\", // no-cors, cors, *same-origin\r\n    headers: {\r\n        \"Content-Type\": \"text/plain\"\r\n    },\r\n};\r\n\r\nclass Host {\r\n    testing: boolean;\r\n    url: string;\r\n    ws: string;\r\n    resHost: string;\r\n\r\n    async start(testing:boolean) {\r\n\t\tif (!centerHost) debugger;\r\n        this.testing = testing;\r\n        if (env.isDevelopment === true) {\r\n            await this.tryLocal();\r\n        }\r\n        let host = this.getCenterHost();\r\n        this.url = centerUrlFromHost(host);\r\n        this.ws = centerWsFromHost(host);\r\n\t\tthis.resHost = this.getResHost();\r\n    }\r\n\r\n    private debugHostUrl(host:string) {return `http://${host}/hello`}\r\n    private async tryLocal() {\r\n        let promises:PromiseLike<any>[] = [];\r\n        let hostArr:string[] = [];\r\n        for (let i in hosts) {\r\n            let hostValue = hosts[i];\r\n            let {value} = hostValue;\r\n            if (hostArr.findIndex(v => v === value) < 0) hostArr.push(value);\r\n        }\r\n\r\n        for (let host of hostArr) {\r\n            let fetchUrl = this.debugHostUrl(host);\r\n            promises.push(localCheck(fetchUrl));\r\n        }\r\n        let results = await Promise.all(promises);\r\n        let len = hostArr.length;\r\n        for (let i=0; i<len; i++) {\r\n            let local = results[i];\r\n            let host = hostArr[i];\r\n            for (let j in hosts) {\r\n                let hostValue = hosts[j];\r\n                if (hostValue.value === host) {\r\n                    hostValue.local = local;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getCenterHost():string {\r\n        let {value, local} = hosts.centerhost;\r\n        let hash = document.location.hash;\r\n        if (hash.includes('sheet_debug') === true) {\r\n            return value;\r\n        }\r\n        if (env.isDevelopment === true) {\r\n            if (local === true) return value;\r\n        }\r\n        return centerHost;\r\n    }\r\n\r\n    private getResHost():string {\r\n        let {value, local} = hosts.reshost;\r\n        let hash = document.location.hash;\r\n        if (hash.includes('sheet_debug') === true) {\r\n            return value;\r\n        }\r\n        if (env.isDevelopment === true) {\r\n            if (local === true) return value;\r\n        }\r\n        return resHost;\r\n    }\r\n\r\n    getUrlOrDebug(url:string, debugHost:string = 'uqhost'):string {\r\n        if (env.isDevelopment === false) return url;\r\n        let host = hosts[debugHost];\r\n        if (host === undefined) return url;\r\n        let {value, local} = host;\r\n        if (local === false) return url;\r\n        return `http://${value}/`;\r\n    }\r\n    getUrlOrTest(db:string, url:string, urlTest:string):string {\r\n\t\tlet path:string;\r\n\t\tif (!urlTest) {\r\n\t\t\turlTest = url;\r\n\t\t\tif (!urlTest) {\r\n\t\t\t\tconsole.error('no server set for ' + db);\r\n\t\t\t\tdebugger;\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!url) {\r\n\t\t\turl = urlTest;\r\n\t\t\tthis.testing = true\r\n\t\t}\r\n        if (this.testing === true) {\r\n            if (urlTest !== '-') url = urlTest;\r\n            path = 'uq/test/' + db + '/';\r\n        }\r\n        else {\r\n            path = 'uq/prod/' + db + '/';\r\n        }\r\n\t\turl = this.getUrlOrDebug(url);\r\n\t\tif (url.endsWith('/') === false) {\r\n\t\t\turl += '/';\r\n\t\t}\r\n        return url + path;\r\n    }\r\n\r\n    async localCheck(urlDebug: string):Promise<boolean> {\r\n        return await localCheck(urlDebug);\r\n    }\r\n}\r\n\r\nexport const host:Host = new Host();\r\n\r\n// 因为测试的都是局域网服务器，甚至本机服务器，所以一秒足够了\r\n// 网上找了上面的fetch timeout代码。\r\n// 尽管timeout了，fetch仍然继续，没有cancel\r\n\r\n// 实际上，一秒钟不够。web服务器会自动停。重启的时候，可能会比较长时间。也许两秒甚至更多。\r\n//const timeout = 2000;\r\nconst timeout = 2000;\r\n\r\nfunction fetchLocalCheck(url:string):Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      fetch(url, fetchOptions as any)\r\n      .then(v => {\r\n          v.text().then(resolve).catch(reject);\r\n      })\r\n      .catch(reject);\r\n      const e = new Error(\"Connection timed out\");\r\n      env.setTimeout('fetchLocalCheck', reject, timeout, e);\r\n    });\r\n}\r\n\r\nasync function localCheck(url:string):Promise<boolean> {\r\n    try {\r\n\t\tawait fetchLocalCheck(url);\r\n        return true;\r\n    }\r\n    catch (err) {\r\n        return false;\r\n    }\r\n}\r\n\r\n/*\r\nexport interface IUqForChannel {\r\n    uq: string;\r\n    uqVersion: number;\r\n}\r\n*/","import React from 'react';\r\nimport { PageHeaderProps } from './pageHeader';\r\n\r\nconst scrollAfter = 20; // 20ms之后，scroll执行\r\nexport class Scroller {\r\n    private el: HTMLBaseElement;\r\n    constructor(el: HTMLBaseElement) {\r\n        this.el = el;\r\n    }\r\n\r\n    scrollToTop():void {\r\n        setTimeout(() => this.el.scrollTo(0, 0), scrollAfter);\r\n    }\r\n    scrollToBottom():void {\r\n        setTimeout(() => this.el.scrollTo(0, this.el.scrollTop + this.el.offsetHeight), scrollAfter);\r\n    }\r\n}\r\n\r\nexport interface ScrollProps {\r\n    onScroll?: (e:any) => void;\r\n    onScrollTop?: (scroller: Scroller) => Promise<boolean>;\r\n\tonScrollBottom?: (scroller: Scroller) => Promise<void>;\r\n\tclassName?: string;\r\n}\r\ninterface ScrollViewProps extends ScrollProps {\r\n\tclassName?: string;\r\n\tstyle?: React.CSSProperties;\r\n}\r\nconst scrollTimeGap = 100;\r\nabstract class ScrollViewBase<T extends ScrollViewProps> extends React.Component<T, null> {\r\n    private bottomTime:number = 0;\r\n\tprivate topTime:number = 0;\r\n\tprivate div: HTMLDivElement;\r\n\r\n\tprotected refDiv = (div:HTMLDivElement) => {\r\n\t\tif (!div) {\r\n\t\t\tif (this.div) {\r\n\t\t\t\tthis.div.removeEventListener('resize', this.onResize)\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.div = div;\r\n\t\tthis.div.addEventListener('resize', this.onResize);\r\n\t}\r\n\r\n\tprivate onResize = (ev:UIEvent) => {\r\n\t\tconsole.error('div resize');\r\n\t};\r\n\r\n    protected onScroll = async (e:any) => {\r\n        let {onScroll, onScrollTop, onScrollBottom} = this.props;\r\n        if (onScroll) onScroll(e);\r\n        let el = e.target as HTMLBaseElement;\r\n        let scroller = new Scroller(el);\r\n        if (el.scrollTop < 30) {\r\n            if (onScrollTop !== undefined) {\r\n                let topTime = new Date().getTime();\r\n                if (topTime-this.topTime > scrollTimeGap) {\r\n                    this.topTime = topTime;\r\n\t\t\t\t\tonScrollTop(scroller).then(ret => {\r\n\t\t\t\t\t\t // has more\r\n\t\t\t\t\t\tif (ret === true) {\r\n\t\t\t\t\t\t\tlet sh = el.scrollHeight;\r\n\t\t\t\t\t\t\tlet top = 200;\r\n\t\t\t\t\t\t\tif (top > sh) top = sh;\r\n\t\t\t\t\t\t\tel.scrollTop = top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n                }\r\n            }\r\n        }\r\n        if (el.scrollTop + el.offsetHeight > el.scrollHeight - 30) {\r\n            //this.eachChild(this, 'bottom');\r\n            if (onScrollBottom !== undefined) {\r\n                let bottomTime = new Date().getTime();\r\n                if (bottomTime - this.bottomTime > scrollTimeGap) {\r\n                    this.bottomTime = bottomTime;\r\n                    onScrollBottom(scroller);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    private eachChild(c:any, direct:'top'|'bottom') {\r\n        let { props } = c;\r\n        if (props === undefined)\r\n            return;\r\n        let { children } = props;\r\n        if (children === undefined)\r\n            return;\r\n        React.Children.forEach(children, (child, index) => {\r\n            let {_$scroll} = child as any;\r\n            if (_$scroll) _$scroll(direct);\r\n            console.log(child.toString());\r\n            this.eachChild(child, direct);\r\n        });\r\n\t}\r\n}\r\n\r\nexport class ScrollView extends ScrollViewBase<ScrollViewProps> {\r\n    render() {\r\n\t\tlet {className, style} = this.props;\r\n\t\treturn <div ref={this.refDiv} className=\"tv-page\"\r\n\t\t\tonScroll={this.onScroll} style={style}>\r\n\t\t\t<article className={className}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t</article>\r\n\t\t</div>;\r\n    }\r\n}\r\n\r\nexport interface PageWebNav {\r\n\tnavHeader?: JSX.Element; \r\n\tnavRawHeader?: JSX.Element; \r\n\tnavFooter?: JSX.Element; \r\n\tnavRawFooter?: JSX.Element; \r\n\trenderPageHeader?: (props:PageHeaderProps)=>JSX.Element;\r\n}\r\ninterface WebNavScrollViewProps extends ScrollViewProps {\r\n\twebNav: PageWebNav;\r\n}\r\n\r\nexport class WebNavScrollView extends ScrollViewBase<WebNavScrollViewProps> {\r\n    render() {\r\n\t\tlet {className, style, webNav} = this.props;\r\n\t\tlet {navHeader, navRawHeader, navFooter, navRawFooter} = webNav;\r\n\t\tlet vHeader:any, vFooter:any;\r\n\t\tif (navRawHeader) vHeader = navRawHeader;\r\n\t\telse if (navHeader) vHeader = <header><main>{navHeader}</main></header>\r\n\t\tif (navRawFooter) vFooter = navRawFooter;\r\n\t\telse if (navFooter) vFooter = <footer><main>{navFooter}</main></footer>\r\n\r\n\t\treturn <div ref={this.refDiv} className=\"tv-page-webnav\"\r\n\t\t\tonScroll={this.onScroll} style={style}>\r\n\t\t\t{vHeader}\r\n\t\t\t<article className={className}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t</article>\r\n\t\t\t{vFooter}\r\n\t\t</div>;\r\n    }\r\n}\r\n","import { Entity } from './entity';\r\nimport { ActionCaller } from './caller';\r\n\r\nexport class UqAction<P, R> extends Entity {\r\n    get typeName(): string { return 'action';}\r\n    async submit(data:P, waiting: boolean = true) {\r\n\t\tlet caller = new ActionSubmitCaller(this, data)\r\n\t\tlet ret = await caller.request();\r\n\t\treturn ret;\r\n    }\r\n    async submitReturns(data:P):Promise<R> {\r\n       return await new SubmitReturnsCaller(this, data).request();\r\n    }\r\n    async submitConvert(data:P) {\r\n        return await new SubmitConvertCaller(this, data).request();\r\n    }\r\n}\r\n\r\nexport class Action extends UqAction<any, any> {\r\n}\r\n\r\nexport class ActionSubmitCaller extends ActionCaller {\r\n    get path():string {return 'action/' + this.entity.name;}\r\n    buildParams():any {\r\n\t\treturn {data: this.entity.pack(this.params)}\r\n\t}\r\n}\r\n\r\nclass SubmitReturnsCaller extends ActionSubmitCaller {\r\n    get path():string {return 'action/' + this.entity.name + '/returns';}\r\n    xresult(res:any):any {\r\n        let {returns} = this.entity;\r\n        let len = returns.length;\r\n        let ret:{[r:string]:any[]} = {};\r\n        for (let i=0; i<len; i++) {\r\n            let retSchema = returns[i];\r\n            ret[retSchema.name] = res[i];\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nclass SubmitConvertCaller extends ActionSubmitCaller {\r\n    get path():string {return 'action-convert/' + this.entity.name;}\r\n    buildParams():any {\r\n        return {\r\n            data: this.params\r\n        };\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport '../../css/va-lmr.css';\r\n\r\nexport interface LMRProps {\r\n    className?: string | string[];\r\n    left?: string|JSX.Element;\r\n    right?: string|JSX.Element;\r\n    onClick?: ()=>void;\r\n}\r\n\r\n@observer\r\nexport class LMR extends React.Component<LMRProps> {\r\n    render() {\r\n        let {className, left, children, right, onClick} = this.props;\r\n        let l, r;\r\n        if (left !== undefined) l = <header>{left}</header>;\r\n        if (right !== undefined) r = <footer>{right}</footer>;\r\n        let cursor;\r\n        if (onClick !== undefined) cursor = 'cursor-pointer';\r\n        return <div className={classNames('va-lmr', className, cursor)} onClick={onClick}>\r\n            {l}\r\n            <div>{children}</div>\r\n            {r}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport '../../css/va-badge.css';\r\n\r\nexport interface BadgeProps {\r\n    className?: string;\r\n    badge?: string|number;\r\n    size?: 'xs' | 'sm' | 'lg';\r\n    color?: 'secondary'|'success'|'danger'|'primary'|'info'|'warning';\r\n    badgeAlign?: 'left'|'center'|'right';\r\n    badgeVertical?: 'top'|'middle'|'bottom';\r\n}\r\n\r\n@observer\r\nexport class Badge extends React.Component<BadgeProps> {\r\n    render() {\r\n        let {className, badge, size, color, badgeAlign, badgeVertical, children} = this.props;\r\n        let cn = classNames(\r\n            className,\r\n            'va-badge',\r\n            size && 'va-badge-'+size,\r\n            'va-badge-' + (color||'secondary'),\r\n            badgeAlign && 'va-badg-'+badgeAlign,\r\n            badgeVertical && 'va-badg-'+badgeVertical,\r\n        );\r\n        let b;\r\n        if (badge) b = <b>{badge}</b>;\r\n        return <div className={cn}>\r\n            {children}\r\n            {b}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport interface FAProps {\r\n    name: string;\r\n    className?: string;\r\n    size?: 'lg'|'2x'|'3x'|'4x'|'5x';\r\n    spin?: boolean;\r\n    fixWidth?: boolean;\r\n    border?: boolean;\r\n    pull?: 'left'|'right';\r\n    pulse?: boolean;\r\n    rotate?: 90|180|270;\r\n    flip?: 'horizontal'|'vertical';\r\n    inverse?: boolean;\r\n}\r\n\r\nexport class FA extends React.Component<FAProps> {\r\n    render() {\r\n        let {name, className, size, spin, fixWidth, border, pull, pulse, rotate, flip, inverse} = this.props;\r\n        let cn = classNames(className, 'fa',\r\n            name && ('fa-' + name),\r\n            size && 'fa-'+size,\r\n            fixWidth && 'fa-fw',\r\n            border && 'fa-border',\r\n            pull && 'fa-pull-' + pull,\r\n            spin && 'fa-spin',\r\n            pulse && 'fa-pulse',\r\n            rotate && 'fa-rotate-' + rotate,\r\n            flip && 'fa-flip-' + flip,\r\n            inverse && 'fa-inverse',\r\n        );\r\n        return <i className={cn} />\r\n    }\r\n}\r\n\r\nexport interface StackedFAProps {\r\n    className?: string;\r\n    size?: 'lg',\r\n}\r\nexport class StackedFA extends React.Component<StackedFAProps> {\r\n    render() {\r\n        let {className, size, children} = this.props;\r\n        let cn = classNames(\r\n            'fa-stack',\r\n            className,\r\n            size && 'fa-' + size);\r\n        return <span className={cn}>\r\n            {children}\r\n        </span>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {FA} from './FA';\r\n\r\nexport interface IconTextProps {\r\n    icon: string;\r\n    iconClass?: string;\r\n    text: string;\r\n    textClass?: string;\r\n}\r\n\r\nexport class IconText extends React.Component<IconTextProps> {\r\n    render() {\r\n        let {icon, iconClass, text, textClass} = this.props;\r\n        return <div className=\"py-2\">\r\n            <FA className={iconClass} name={icon} fixWidth={true} />\r\n            <span className={textClass}>{text}</span>\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport const Muted = (props:any) => \r\n<small className={classNames('text-muted', props.className)} style={props.style}>\r\n    {props.children}\r\n</small>;\r\n","import _ from 'lodash';\r\n\r\nclass _LocalStorage {\r\n    getItem(key:string) {\r\n        return localStorage.getItem(key)\r\n    }\r\n    setItem(key:string, value:string) {\r\n        localStorage.setItem(key, value);\r\n    }\r\n    removeItem(key:string) {\r\n        localStorage.removeItem(key);\r\n    }\r\n}\r\n\r\nconst __ls = new _LocalStorage(); // new Ls;\r\n\r\nexport class LocalCache {\r\n    private readonly local: Local;\r\n    //private value: T;\r\n    readonly key: string|number;\r\n\r\n    constructor(local:Local, key:string|number) {\r\n        this.local = local;\r\n        this.key = key;\r\n    }\r\n    get():any {\r\n        try {\r\n            // 下面缓冲的内容不能有，可能会被修改，造成circular引用\r\n            //if (this.value !== undefined) return this.value;\r\n            let text = this.local.getItem(this.key);\r\n            if (text === null) return;\r\n            if (text === undefined) return undefined;\r\n            //return this.value = \r\n            return JSON.parse(text);\r\n        }\r\n        catch (err) {\r\n            this.local.removeItem(this.key);\r\n            return;\r\n        }\r\n    }\r\n    set(value:any) {\r\n\t\tlet t = JSON.stringify(value, (key, value) => {\r\n\t\t\tif (key !== '_tuid') return value;\r\n\t\t});\r\n\t\tthis.local.setItem(this.key, t);\r\n    }\r\n    remove(local?:Local) {\r\n        if (local === undefined) {\r\n            this.local.removeItem(this.key);\r\n        }\r\n        else {\r\n            this.local.removeLocal(local);\r\n        }\r\n    }\r\n    child(key:string|number):LocalCache {\r\n        return this.local.child(key);\r\n    }\r\n    arr(key:string|number):LocalArr {\r\n        return this.local.arr(key);\r\n    }\r\n    map(key:string|number):LocalMap {\r\n        return this.local.map(key);\r\n    }\r\n}\r\n\r\nabstract class Local {\r\n    private readonly caches: {[key:string]:LocalCache};\r\n    private readonly locals: {[key:string]:Local};\r\n    protected readonly name: string;\r\n    constructor(name: string) {\r\n        this.name = name;\r\n        this.caches = {};\r\n        this.locals = {};\r\n    }\r\n\r\n    protected abstract keyForGet(key:string|number):string;\r\n    protected abstract keyForSet(key:string|number):string;\r\n    protected abstract keyForRemove(key:string|number):string;\r\n    abstract removeAll():void;\r\n    getItem(key:string|number):string {\r\n        let k = this.keyForGet(key);\r\n        if (k === undefined) return;\r\n        return __ls.getItem(k);\r\n    }\r\n    setItem(key:string|number, value: string):void {\r\n        let k = this.keyForSet(key);\r\n        __ls.setItem(k, value);\r\n    }\r\n    removeItem(key:string|number):void {\r\n        let k = this.keyForSet(key);\r\n        if (k === undefined) return;\r\n        localStorage.removeItem(k);\r\n    }\r\n    arr(key:string|number):LocalArr {\r\n        let sk = String(key);\r\n        let arr = this.locals[sk] as LocalArr;\r\n        if (arr === undefined) {\r\n            let k = this.keyForSet(key);\r\n            this.locals[sk] = arr = new LocalArr(k);\r\n        }\r\n        return arr;\r\n    }\r\n    map(key:string|number):LocalMap {\r\n        let sk = String(key);\r\n        let map = this.locals[sk] as LocalMap;\r\n        if (map === undefined) {\r\n            let k = this.keyForSet(key);\r\n            this.locals[sk] = map = new LocalMap(k);\r\n        }\r\n        return map;\r\n    }\r\n    removeLocal(local:Local) {\r\n        let sk = local.name;\r\n        let k = this.keyForRemove(sk);\r\n        if (k === undefined) return;\r\n        let arr = this.locals[sk];\r\n        if (arr === undefined) arr = new LocalArr(k);\r\n        else this.locals[sk] = undefined;\r\n        arr.removeAll();\r\n    }\r\n    child(key:string|number):LocalCache {\r\n        let ks = String(key);\r\n        let ret = this.caches[ks];\r\n        if (ret !== undefined) return ret;\r\n        return this.caches[ks] =ret = new LocalCache(this, key);\r\n    }\r\n}\r\n\r\nconst maxArrSize = 500;\r\nexport class LocalArr extends Local {\r\n    private readonly index: number[];\r\n    constructor(name: string) {\r\n        super(name);\r\n        let index = __ls.getItem(this.name);\r\n        this.index = index === null? [] : index.split('\\n').map(v => Number(v));\r\n    }\r\n    private saveIndex() {\r\n        __ls.setItem(this.name, this.index.join('\\n'));\r\n    }\r\n    protected keyForGet(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i < 0) return undefined;\r\n        return `${this.name}.${key}`;\r\n    }\r\n    protected keyForSet(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i<0) {\r\n            this.index.unshift(key);\r\n            if (this.index.length > maxArrSize) this.index.pop();\r\n        }\r\n        else {\r\n            this.index.splice(i, 1);\r\n            this.index.unshift(key)\r\n        }\r\n        this.saveIndex();\r\n        return `${this.name}.${key}`;\r\n    }\r\n    protected keyForRemove(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i<0) return;\r\n        this.index.splice(i, 1);\r\n        this.saveIndex();\r\n        return `${this.name}.${key}`;\r\n    }\r\n    removeAll():void {\r\n        for (let i of this.index) {\r\n            __ls.removeItem(`${this.name}.${i}`);\r\n        }\r\n        __ls.removeItem(this.name);\r\n        this.index.splice(0);\r\n    }\r\n    item(index:number):LocalCache {\r\n        return this.child(index);\r\n    }\r\n}\r\n\r\nexport class LocalMap extends Local {\r\n    private readonly index: {[key:string]:number};\r\n    private max: number;\r\n    constructor(name: string) {\r\n        super(name);\r\n        this.max = 0;\r\n        this.index = {};\r\n        let index = __ls.getItem(this.name);\r\n        if (index !== null) {\r\n            let ls = index.split('\\n');\r\n            ls.forEach(l => {\r\n                let p = l.indexOf('\\t');\r\n                if (p<0) return;\r\n                let key = l.substr(0, p);\r\n                let i = Number(l.substr(p+1));\r\n                if (isNaN(i) === true) return;\r\n                this.index[key] = i;\r\n                if (i>this.max) this.max = i;\r\n            });\r\n        }\r\n    }\r\n    private saveIndex() {\r\n        let ls:string[] = [];\r\n        for (let k in this.index) {\r\n            let v = this.index[k];\r\n            if (v === undefined) continue;\r\n            ls.push(`${k}\\t${v}`);\r\n        }\r\n        __ls.setItem(this.name, ls.join('\\n'));\r\n    }\r\n    protected keyForGet(key:number):string {\r\n        let i = this.index[key];\r\n        if (i === undefined) return undefined;\r\n        return `${this.name}.${i}`;\r\n    }\r\n    protected keyForSet(key:number):string {\r\n        let i = this.index[key];\r\n        if (i === undefined) {\r\n            ++this.max;\r\n            i = this.max;\r\n            this.index[key] = i;\r\n            this.saveIndex();\r\n        }\r\n        return `${this.name}.${i}`;\r\n    }\r\n    protected keyForRemove(key:string|number):string {\r\n        let i = this.index[key];\r\n        if (i===undefined) return;\r\n        this.index[key] = undefined;\r\n        this.saveIndex();\r\n        return `${this.name}.${i}`;\r\n    }\r\n    removeAll():void {\r\n        for (let i in this.index) {\r\n            __ls.removeItem(`${this.name}.${this.index[i]}`);\r\n            this.index[i] = undefined;\r\n        }\r\n        __ls.removeItem(this.name);\r\n        this.max = 0;\r\n    }\r\n    item(key:string):LocalCache {\r\n        return this.child(key);\r\n    }\r\n}\r\n","import * as React from 'react';\r\n\r\nexport function Loading() {\r\n    return <div className=\"d-flex h-100 align-items-center justify-content-center\">\r\n        <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />\r\n    </div>;\r\n}\r\n","import * as React from 'react';\r\nimport { Page, Image, UserView } from '../components';\r\nimport { env, User } from '../tool';\r\nimport { Controller } from './controller';\r\nimport { VPage } from './vpage';\r\n\r\nexport abstract class View<C extends Controller> {\r\n    protected controller: C;\r\n    protected readonly res: any;\r\n\tprotected readonly x: any;\r\n\tprotected readonly t: (str:string)=>any;\r\n\r\n    constructor(controller: C) {\r\n        this.controller = controller;\r\n        this.res = controller.res;\r\n\t\tthis.x = controller.x;\r\n\t\tthis.t = controller.t;\r\n    }\r\n\r\n\tprotected get isDev() {return  env.isDevelopment}\r\n\tget isWebNav(): boolean {return this.controller.isWebNav}\r\n\tnavigate(url:string) {this.controller.navigate(url)}\r\n\tprotected isMe(id:any) {return this.controller.isMe(id)}\r\n    abstract render(param?:any): JSX.Element;\r\n\r\n    protected renderVm(vm: new (controller: C)=>View<C>, param?:any) {\r\n        return (new vm(this.controller)).render(param);\r\n    }\r\n\r\n    protected async openVPage(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:()=>Promise<void>):Promise<void> {\r\n        await (new vp(this.controller)).open(param, afterBack);\r\n    }\r\n\r\n    protected async event(type:string, value?:any) {\r\n        await this.controller.event(type, value);\r\n\t}\r\n\t\r\n\tprotected go(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tthis.controller.go(showPage, url, absolute);\r\n\t}\r\n\r\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\r\n        return await this.controller.vCall(vp, param);\r\n    }\r\n\r\n    protected returnCall(value:any) {\r\n        this.controller.returnCall(value);\r\n    }\r\n\r\n\tprotected renderUser(user:any, imageClassName?:string, textClassName?:string) {\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {name, nick, icon} = user;\r\n\t\t\treturn <>\r\n\t\t\t\t<Image src={icon} className={imageClassName || 'w-1c h-1c mr-2'} />\r\n\t\t\t\t<span className={textClassName}>{nick || name}</span>\r\n\t\t\t</>;\r\n\t\t}\r\n\t\treturn <UserView user={user} render={renderUser} />\r\n\t}\r\n\r\n\tprotected renderUserText(user:any) {\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {name, nick} = user;\r\n\t\t\treturn <>{nick || name}</>;\r\n\t\t}\r\n\t\treturn <UserView user={user} render={renderUser} />\r\n\t}\r\n\r\n\tprotected renderMe(imageClassName?:string, textClassName?:string) {\r\n\t\tlet {user} = this.controller;\r\n\t\tif (!user) return;\r\n\t\treturn this.renderUser(user.id, imageClassName, textClassName);\r\n\t}\r\n\r\n    protected openPage(view: React.StatelessComponent<any>, param?:any, onClosePage?:(ret:any)=>void) {\r\n        let type = typeof param;\r\n        if (type === 'object' || type === 'undefined') {\r\n            this.controller.openPage(React.createElement(view, param), onClosePage);\r\n        }\r\n        else {\r\n            this.controller.openPage(<Page header=\"param type error\">\r\n                View.openPage param must be object, but here is {type}\r\n            </Page>, onClosePage);\r\n        }\r\n    }\r\n\r\n    protected replacePage(view: React.StatelessComponent<any>, param?:any) {\r\n        this.controller.replacePage(React.createElement(view, param));\r\n    }\r\n\r\n    protected openPageElement(page: JSX.Element, onClosePage?: ()=>void) {\r\n        this.controller.openPage(page, onClosePage);\r\n    }\r\n\r\n    protected replacePageElement(page: JSX.Element, onClosePage?: ()=>void) {\r\n        this.controller.replacePage(page, onClosePage);\r\n    }\r\n\r\n    protected backPage() {\r\n        this.controller.backPage();\r\n    }\r\n\r\n    protected closePage(level?:number) {\r\n        this.controller.closePage(level);\r\n    }\r\n\r\n    protected ceasePage(level?:number) {\r\n        this.controller.ceasePage(level);\r\n    }\r\n\r\n    protected removeCeased() {\r\n        this.controller.removeCeased();\r\n    }\r\n\r\n    protected regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        this.controller.regConfirmClose(confirmClose);\r\n\t}\r\n\r\n\tprotected popToTopPage() {\r\n\t\tthis.controller.popToTopPage();\r\n\t}\r\n}\r\n","import { LocalMap } from './localDb';\r\n\r\n// 如果路径上有独立的test单词，则是test环境\r\nfunction isTesting():boolean {\r\n\tlet ret = /(\\btest\\b)/i.test(document.location.href);\r\n\treturn ret;\r\n}\r\n\r\nexport const env = (function () {\r\n    let testing = isTesting();\r\n    let localDb = new LocalMap(testing===true? '$$':'$');\r\n    return {\r\n        testing: testing,\r\n        isDevelopment: process.env.NODE_ENV === 'development',\r\n        localDb: localDb,\r\n        setTimeout: (tag:string, callback: (...args: any[]) => void, ms: number, ...args: any[]):NodeJS.Timer => {\r\n            //if (tag !== undefined) console.log('setTimeout ' + tag);\r\n            return global.setTimeout(callback, ms, ...args);\r\n        },\r\n        clearTimeout: (handle:NodeJS.Timer):void => {\r\n            global.clearTimeout(handle);\r\n        },\r\n        setInterval: (callback: (...args: any[]) => void, ms: number, ...args: any[]): NodeJS.Timer => {\r\n            return global.setInterval(callback, ms, ...args);\r\n        },\r\n        clearInterval: (handle:NodeJS.Timer):void => {\r\n            global.clearInterval(handle);\r\n        }\r\n    }\r\n}());\r\n","\r\nexport * from './boxId';\r\nexport * from './tuid';\r\nexport { TuidsCache } from './tuidsCache';\r\nexport { tv, ReactBoxId, uqStringify } from './reactBoxId';","import {HttpChannel} from './httpChannel';\r\nimport { Caller } from './caller';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url:string, options:any, \r\n    resolve:(values:any)=>any, reject:(reason:any)=>void)\r\n{\r\n    await channel.fetch(url, options, false, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    async xcall(caller:Caller<any>):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.xcall(this.path, caller);\r\n    }\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\nimport { UiImageItem } from '../schema';\r\nimport { ImageUploader } from '../resUploader';\r\nimport { nav } from '../nav';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class ImageItemEdit extends ItemEdit {\r\n    get uiItem(): UiImageItem {return this._uiItem as UiImageItem}\r\n    @observable private resId: string;\r\n\r\n    protected async internalStart():Promise<any> {\r\n        this.resId = this.value;\r\n        return new Promise<any>((resolve, reject) => {\r\n            nav.push(React.createElement(this.page, {resolve:resolve, reject:reject}), ()=>reject());\r\n        });\r\n    }\r\n\r\n    /*\r\n    private upload = async () => {\r\n        if (!this.resUploader) return;\r\n        let ret = await this.resUploader.upload();\r\n        if (ret === null) {\r\n            this.overSize = true;\r\n            env.setTimeout('imageItemEdit upload', () => this.overSize = false, 3000);\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.value);\r\n    }\r\n    */\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let size:any = this.uiItem && this.uiItem.size;\r\n\r\n        /*\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>resolve(this.resId)}>保存</button>;\r\n        let overSize:any;\r\n        if (this.overSize === true) {\r\n            overSize = <div className=\"text-danger\">\r\n                <i className=\"fa fa-times-circle\" /> 图片文件大小超过2M，无法上传\r\n            </div>;\r\n        }\r\n        */\r\n        return <ImageUploader \r\n            label={'更改' + this.label}\r\n            id={this.resId}\r\n            size={size}\r\n            onSaved={(resId):Promise<void>=>{resolve(resId); return;}} />;\r\n        /*\r\n        return <Page header={'更改' + this.label} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div>上传图片：</div>\r\n                    <div className=\"my-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} multiple={false} maxSize={2048} />\r\n                    </div>\r\n                    <div>\r\n                        <button className=\"btn btn-primary\" onClick={this.upload}>上传</button>\r\n                    </div>\r\n                </div>\r\n                {overSize}\r\n                <div className=\"small muted my-4\">支持JPG、GIF、PNG格式图片，不超过2M。</div>\r\n                <div className=\"d-flex\">\r\n                    <div className=\"w-12c h-12c mr-4\"\r\n                        style={{border: '1px dotted gray', padding: '8px'}}>\r\n                        <Image className=\"w-100 h-100\" src={this.resId} />\r\n                    </div>\r\n                    <div>\r\n                        <div className=\"small\">图片预览</div>\r\n                        <Image className=\"w-4c h-4c mt-3\" src={this.resId} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n        */\r\n    })\r\n}\r\n","//import _ from 'lodash';\r\nimport { KeyValueRes, Res } from './res';\r\n\r\nexport interface FormRes extends KeyValueRes {\r\n    required: string;\r\n    number: string;\r\n    integer: string;\r\n    min: string;\r\n    max: string;\r\n}\r\n\r\n/*eslint no-template-curly-in-string: 0*/\r\nexport const formRes:Res<FormRes> = {\r\n    _: {\r\n        required: 'required',\r\n        number: 'not valid number',\r\n        integer: 'not valid integer',\r\n        min: 'min value is ${min}',\r\n        max: 'max value is ${max}',\r\n    },\r\n    zh: {\r\n        _: {\r\n            required: '必须填',\r\n            number: '需要数字',\r\n            integer: '需要整数',\r\n            min: '不能小于${min}',\r\n            max: '不能大于${max}',\r\n        }\r\n    },\r\n}\r\n","import { KeyValueRes, Res } from './res';\r\n\r\nexport interface ListRes extends KeyValueRes {\r\n    none: string;\r\n}\r\n\r\n/*eslint no-template-curly-in-string: 0*/\r\nexport const listRes:Res<ListRes> = {\r\n    _: {\r\n        none: '[none]',\r\n    },\r\n    zh: {\r\n        _: {\r\n            none: '[无]',\r\n        }\r\n    },\r\n}\r\n","import { Res } from '../res';\r\n\r\nexport interface LoginRes {\r\n    a: string;\r\n}\r\n\r\nexport const loginRes: Res<LoginRes> = {\r\n    _: {\r\n        a: 'd',\r\n    }\r\n}\r\n","import { Res } from '../res';\r\n\r\nexport interface RegisterRes {\r\n    a: string;\r\n}\r\n\r\nexport const registerRes: Res<RegisterRes> = {\r\n    _: {\r\n        a: 'd',\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport {observable, IObservableArray, computed} from 'mobx';\r\n\r\nexport abstract class PageItems<T> {\r\n    constructor(itemObservable:boolean = false) {\r\n\t\tif (itemObservable === undefined) itemObservable = false;\r\n        this._items = observable.array<T>([], {deep:itemObservable});\r\n    }\r\n\tprivate isFirst: boolean = true;\r\n\tprivate pageItemAction: (item:T, results:{[name:string]:any[]}) => void;\r\n\tprivate itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T;\r\n    @observable loading: boolean = false;\r\n    @observable private beforeLoad: boolean = true;\r\n    @observable protected loaded: boolean = false;\r\n    protected _items:IObservableArray<T>;\r\n    @observable allLoaded: boolean = false;\r\n    @computed get items():IObservableArray<T> {\r\n        if (this.beforeLoad === true) return null;\r\n        if (this.loaded === false) return undefined;\r\n        return this._items;\r\n\t}\r\n\t\r\n\tsetEachPageItem(pageItemAction: (item:T, results:{[name:string]:any[]}) => void) {\r\n\t\tthis.pageItemAction = pageItemAction;\r\n\t}\r\n\r\n\tsetItemConverter(itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T) {\r\n\t\tthis.itemConverter = itemConverter;\r\n\t}\r\n\r\n    @observable topDiv:string = '$$top';\r\n    @observable bottomDiv:string = '$$bottom';\r\n    scrollToTop = () => {\r\n\t\tthis.scrollIntoView(this.topDiv);\r\n\t\t//let id = '$$top'+uid();\r\n\t\t//this.topDiv = id;\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(this.topDiv);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t\t*/\r\n    }\r\n    scrollToBottom = () => {\r\n\t\tthis.scrollIntoView(this.bottomDiv);\r\n\t\t//let id = '$$bottom'+uid();\r\n\t\t//this.bottomDiv = id;\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(this.bottomDiv);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t\t*/\r\n\t}\r\n\tprivate scrollIntoView(divId:string) {\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(divId);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t}\r\n\r\n    protected param: any;\r\n    protected firstSize = 100;\r\n    protected pageStart:any = undefined;\r\n    protected pageSize = 30;\r\n    protected appendPosition:'head'|'tail' = 'tail';\r\n\r\n\tprotected sortOrder:'asc'|'desc';\r\n\tprotected abstract loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}>;\r\n\tprotected getPageId(item:T):any {return;}\r\n\tprotected setPageStart(item:T) {\r\n\t\tthis.pageStart = this.getPageId(item);\r\n\t}\r\n\t\r\n\tprotected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\r\n\t\tlet results = await this.loadResults(param, pageStart, pageSize);\r\n\t\tlet pageList = results.$page;\r\n\t\tif (this.itemConverter) {\r\n\t\t\tlet ret:T[] = [];\r\n\t\t\tlet len = pageList.length;\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tlet item = this.itemConverter(pageList[i], results);\r\n\t\t\t\tret.push(item);\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\tif (this.pageItemAction !== undefined) {\r\n\t\t\tlet len = pageList.length;\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tthis.pageItemAction(pageList[i], results);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn pageList;\r\n\t}\r\n\r\n    reset() {\r\n        this.isFirst = true;\r\n        this.beforeLoad = true;\r\n        this.loaded = false;\r\n        this.param = undefined;\r\n\t\tthis.allLoaded = false;\r\n\t\tthis.pageStart = undefined;\r\n        this._items.clear();\r\n        //this.setPageStart(undefined);\r\n    }\r\n\r\n    append(item:T) {\r\n        if (this.appendPosition === 'tail')\r\n            this._items.unshift(item);\r\n        else\r\n            this._items.push(item);\r\n    }\r\n\r\n    async first(param:any):Promise<void> {\r\n        this.reset();\r\n        this.beforeLoad = false;\r\n        this.param = param;\r\n        await this.more();\r\n\t}\r\n\r\n\tprivate changing = false;\r\n\tasync attach(): Promise<void> {\r\n\t\tif (this.sortOrder === undefined) {\r\n\t\t\tconsole.error('没有定义增减序，无法attach');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.changing === true) return;\r\n\t\tthis.changing = true;\r\n\t\tlet items = this._items;\r\n\t\tlet isAsc = this.sortOrder === 'asc';\r\n\t\t//let isTail:boolean, \r\n\t\tlet endItem:T;\r\n\t\tlet scrollToEnd:() => void;\r\n\t\tlet pushItem:(item:T) => void;\r\n\t\tif (this.appendPosition === 'tail') {\r\n\t\t\t//isTail = true;\r\n\t\t\tendItem = items[0];\r\n\t\t\tscrollToEnd = this.scrollToTop;\r\n\t\t\tpushItem = (item:T) => items.unshift(item);\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//isTail = false;\r\n\t\t\tlet endIndex = items.length;\r\n\t\t\tendItem = items[endIndex-1];\r\n\t\t\tscrollToEnd = this.scrollToBottom;\r\n\t\t\tpushItem = (item:T) => items.splice(endIndex, 0, item);\r\n\t\t}\r\n\t\tlet startId = this.getPageId(endItem);\r\n\t\tlet pid = undefined;\r\n\t\tlet sum = 0, max = 50;\r\n\t\tfor (;sum < max;) {\r\n\t\t\tlet ret = await this.load(this.param, pid, 3);\r\n\t\t\tlet len = ret.length;\r\n\t\t\tif (len === 0) break;\r\n\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tlet item = ret[i];\r\n\t\t\t\tpid = this.getPageId(item);\r\n\t\t\t\tif (isAsc === true) {\r\n\t\t\t\t\tif (pid >= startId) {\r\n\t\t\t\t\t\tmax = 0;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (pid <= startId) {\r\n\t\t\t\t\t\tmax = 0;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tpushItem(item);\r\n\t\t\t\t/*\r\n\t\t\t\tif (isTail === true) {\r\n\t\t\t\t\tthis._items.unshift(item);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._items.push(item);\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\t++sum;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.changing = false;\r\n\t\tif (sum > 0) {\r\n\t\t\tscrollToEnd();\r\n\t\t\t/*\r\n\t\t\tif (isTail === true) this.scrollToTop();\r\n\t\t\telse this.scrollToBottom();\r\n\t\t\t*/\r\n\t\t}\r\n\t}\r\n\r\n\tasync refresh(): Promise<void> {\r\n\t\tif (this.changing === true) return;\r\n\t\tthis.changing = true;\r\n\t\tlet ret = await this.load(this.param, undefined, this.firstSize>this.pageSize? this.firstSize:this.pageSize);\r\n\t\tthis._items.clear();\r\n\t\tthis.setLoaded(ret);\r\n\t\t/*\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet item = ret[i];\r\n\t\t\tlet pid = this.getRefreshPageId(item);\r\n\t\t\tlet index = this._items.findIndex(v => this.getRefreshPageId(v) === pid);\r\n\t\t\t//let index = _.sortedIndexBy(this._items, item, v=>this.getRefreshPageId(v));\r\n\t\t\t//let oldItem = this._items[index];\r\n\t\t\t//let oid = this.getRefreshPageId(oldItem);\r\n\t\t\tif (index >= 0) {\r\n\t\t\t\t_.merge(this._items[index], item);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._items.splice(0, 0, item);\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\tthis.changing = false;\r\n\t}\r\n\r\n\tprotected getRefreshPageId(item:T) {\r\n\t\treturn this.getPageId(item);\r\n\t}\r\n\r\n    protected async onLoad(): Promise<void> {}\r\n    protected async onLoaded(): Promise<void> {}\r\n\r\n    async more():Promise<boolean> {\r\n        if (this.allLoaded === true) return false;\r\n\t\tif (this.loading === true) return true;\r\n\t\tif (this.changing === true) return true;\r\n\t\tthis.loading = true;\r\n\t\tthis.changing = true;\r\n        await this.onLoad();\r\n        if (this.pageStart === undefined) this.setPageStart(undefined);\r\n        let pageSize = this.pageSize + 1;\r\n        if (this.isFirst === true) {\r\n            if (this.firstSize > this.pageSize) pageSize = this.firstSize+1;\r\n        }\r\n        let ret = await this.load(\r\n                this.param, \r\n                this.pageStart,\r\n\t\t\t\tpageSize);\r\n        this.loaded = true;\r\n\t\tlet len = ret.length;\r\n        if ((this.isFirst===true && len>this.firstSize) ||\r\n            (this.isFirst===false && len>this.pageSize))\r\n        {\r\n            this.allLoaded = false;\r\n            --len;\r\n            ret.splice(len, 1);\r\n        }\r\n        else {\r\n            this.allLoaded = true;\r\n\t\t}\r\n\t\t/*\r\n        if (len === 0) {\r\n\t\t\tthis.setPageStart(undefined);\r\n            this._items.clear();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.setPageStart(ret[len-1]);\r\n\t\t\tif (this.appendPosition === 'tail') {\r\n\t\t\t\tthis._items.push(...ret);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._items.unshift(...ret.reverse());\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\tthis.setLoaded(ret);\r\n\t\tthis.isFirst = false;\r\n\t\tthis.onLoaded();\r\n\t\tthis.changing = false;\r\n\t\tthis.loading = false;\r\n\t\treturn !this.allLoaded;\r\n\t}\r\n\t\r\n\tprivate setLoaded(data:any[]) {\r\n\t\tlet len = data.length;\r\n        if (len === 0) {\r\n\t\t\tthis.setPageStart(undefined);\r\n            this._items.clear();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.setPageStart(data[len-1]);\r\n\t\t\tif (this.appendPosition === 'tail') {\r\n\t\t\t\tthis._items.push(...data);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._items.unshift(...data.reverse());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfindItem(item:any):T {\r\n\t\tlet pid = this.getPageId(item);\r\n\t\tlet index = _.findIndex(this._items, v => this.getPageId(v) === pid);\r\n\t\tif (index < 0) return;\r\n\t\treturn this._items[index];\r\n\t\t//let oldItem = this._items[index];\r\n\t\t//let oid = this.getPageId(oldItem);\r\n\t\t//if (pid === oid) return oldItem;\r\n\t}\r\n}\r\n","class MessageHub {\r\n    private handlerSeed = 1;\r\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\r\n    private msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\r\n\tregisterReceiveHandler(handler:(msg:any)=>Promise<void>):number;\r\n\tregisterReceiveHandler(type:string, handler:(msg:any)=>Promise<void>):number;\t\r\n    registerReceiveHandler(...args:any[]):number {\r\n\t\tlet seed = this.handlerSeed++;\r\n\t\tlet args0 = args[0];\r\n\t\tlet handler:(msg:any)=>Promise<void>;\r\n\t\tswitch (typeof args0) {\r\n\t\t\tcase 'string':\r\n\t\t\t\thandler = args[1];\r\n\t\t\t\tthis.msgHandlers[seed] = {type:args0, handler};\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'function':\r\n\t\t\t\tthis.anyHandlers[seed] = args0;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn seed;\r\n    }\r\n    unregisterReceiveHandler(handlerId:number) {\r\n        delete this.anyHandlers[handlerId];\r\n        delete this.msgHandlers[handlerId];\r\n    }\r\n    async dispatch(msg:any) {\r\n        let {$type} = msg;\r\n        for (let i in this.anyHandlers) {\r\n            await this.anyHandlers[i](msg);\r\n        }\r\n        for (let i in this.msgHandlers) {\r\n            let {type, handler} = this.msgHandlers[i];\r\n            if (type !== $type) continue;\r\n            await handler(msg);\r\n        }\r\n    }\r\n}\r\n\r\nexport const messageHub = new MessageHub();\r\n","// typescript version of krasimir/navigo\r\n\r\nexport type RouteFunc = (params?:string|{[name:string]:string}, query?:string) => void;\r\n\r\nexport interface NamedRoute {\r\n\tas: string;\r\n\tuses: RouteFunc;\r\n\thooks?: Hooks;\r\n}\r\nexport interface Hooks {\r\n\tbefore: (done:()=>void, params:object) => void;\r\n\tafter: (params:object) => void;\r\n\tleave: (params:object) => void;\r\n\talready: (params:object) => void;\r\n}\r\ninterface Handler {\r\n\thandler: RouteFunc;\r\n\thooks: Hooks;\r\n}\r\ninterface LastResolved {\r\n\turl: string;\r\n\tquery: string;\r\n\thooks: Hooks;\r\n\tparams?: {[name:string]:string};\r\n\tname?: string;\r\n}\r\ninterface Route {\r\n\troute: string|RegExp;\r\n\thandler: RouteFunc,\r\n\tname: string,\r\n\thooks: Hooks\r\n}\r\n\r\nexport class Navigo {\r\n\tprivate static PARAMETER_REGEXP = /([:*])(\\w+)/g;\r\n\tprivate static WILDCARD_REGEXP = /\\*/g;\r\n\tprivate static REPLACE_VARIABLE_REGEXP = '([^\\\\/]+)';   \t// 单\\，编译错误 ([^\\/]+)\r\n\tprivate static REPLACE_WILDCARD = `(?:.*)`;\r\n\tprivate static FOLLOWED_BY_SLASH_REGEXP = '(?:\\\\/$|$)';\t\t// 单\\，编译错误 (?:\\/$|$)\r\n\tprivate static MATCH_REGEXP_FLAGS = '';\r\n\r\n\tprivate static isPushStateAvailable() {\r\n\t\treturn !!(\r\n\t\t  typeof window !== 'undefined' &&\r\n\t\t  window.history &&\r\n\t\t  window.history.pushState\r\n\t\t);\r\n\t}\r\n\t\r\n\tprivate static clean(s:string|RegExp) {\r\n\t\tif (s instanceof RegExp) return s;\r\n\t\treturn Navigo.cleanUrl(s);\r\n\t}\r\n\tprivate static cleanUrl(s:string) {\r\n\t\treturn s.replace(/\\/+$/, '').replace(/^\\/+/, '^/');\r\n\t}\r\n\r\n\tprivate static regExpResultToParams(match:any[], names:string[]) {\r\n\t\tif (names.length === 0) return null;\r\n\t\tif (!match) return null;\r\n\t\treturn match\r\n\t\t  .slice(1, match.length)\r\n\t\t  .reduce((params, value, index) => {\r\n\t\t\t\tif (params === null) params = {};\r\n\t\t\t\tparams[names[index]] = decodeURIComponent(value);\r\n\t\t\t\treturn params;\r\n\t\t  }, null);\r\n\t}\r\n\t  \r\n\tprivate static replaceDynamicURLParts(route:string|RegExp) {\r\n\t\tlet paramNames:string[] = [], regexp:RegExp;\r\n\t  \r\n\t\tif (route instanceof RegExp) {\r\n\t\t\tregexp = route;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tregexp = new RegExp(\r\n\t\t\t\troute.replace(Navigo.PARAMETER_REGEXP, function (full, dots, name) {\r\n\t\t\t\t\t\tparamNames.push(name);\r\n\t\t\t\t\t\treturn Navigo.REPLACE_VARIABLE_REGEXP;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.replace(Navigo.WILDCARD_REGEXP, Navigo.REPLACE_WILDCARD) + Navigo.FOLLOWED_BY_SLASH_REGEXP\r\n\t\t\t\t, Navigo.MATCH_REGEXP_FLAGS);\r\n\t\t}\r\n\t\treturn { regexp, paramNames };\r\n\t}\r\n\t  \r\n\tprivate static getUrlDepth(url:string):number {\r\n\t\treturn url.replace(/\\/$/, '').split('/').length;\r\n\t}\r\n\t  \r\n\tprivate static compareUrlDepth(urlA:string, urlB:string) {\r\n\t\treturn Navigo.getUrlDepth(urlB) - Navigo.getUrlDepth(urlA);\r\n\t}\r\n\t  \r\n\tprivate static findMatchedRoutes(url:string, routes:Route[] = []) {\r\n\t\treturn routes.map(route => {\r\n\t\t\tlet { regexp, paramNames } = Navigo.replaceDynamicURLParts(Navigo.clean(route.route));\r\n\t\t\tlet match = url.replace(/^\\/+/, '/').match(regexp);\r\n\t\t\tlet params = Navigo.regExpResultToParams(match, paramNames);\r\n\t\t\treturn match ? { match, route, params } : false;\r\n\t\t}).filter(m => m);\r\n\t}\r\n\t  \r\n\tprivate static match(url:string, routes:Route[]) {\r\n\t\treturn Navigo.findMatchedRoutes(url, routes)[0] || false;\r\n\t}\r\n\t  \r\n\tprivate static root(url:string, routes:Route[]) {\r\n\t\tconst colonExp = RegExp('\\\\/:\\\\D(\\\\w*)', 'g');\r\n\t\tconst exp = ''; // '($|\\\\/)';  // 单\\，编译报错 ($|\\/)\r\n\t\tlet matched = routes.map(\r\n\t\t\troute => {\r\n\t\t\t\tlet r = route.route;\r\n\t\t\t\tif (r === '' || r === '*') return url;\r\n\t\t\t\tif (typeof r === 'string') {\r\n\t\t\t\t\tr = r.replace(colonExp, '\\\\/\\\\w+');\r\n\t\t\t\t}\r\n\t\t\t\tlet routeExp = r + exp;\r\n\t\t\t\tlet ret = url.split(new RegExp(routeExp))[0];\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\t\t);\r\n\t\tlet fallbackURL = Navigo.cleanUrl(url);\r\n\t\tlet len = matched.length;\r\n\t\tif (len === 0) return fallbackURL;\r\n\t\tlet matched0 = matched[0];\r\n\t\tif (len === 1) return matched0;\r\n\t\treturn matched.reduce((result, url) => {\r\n\t\t\tif (result.length > url.length) result = url;\r\n\t\t\treturn result;\r\n\t\t}, matched0);\r\n\t}\r\n\t  \r\n\tprivate static isHashChangeAPIAvailable() {\r\n\t\treturn typeof window !== 'undefined' && 'onhashchange' in window;\r\n\t}\r\n\t  \r\n\tprivate static extractGETParameters(url:string):string {\r\n\t\treturn url.split(/\\?(.*)?$/).slice(1).join('');\r\n\t}\r\n\t  \r\n\tprivate static getOnlyURL(url:string, useHash:boolean, hash:string) {\r\n\t\tlet onlyURL = url, split:string[];\r\n\t\tvar cleanGETParam = (str:string) => str.split(/\\?(.*)?$/)[0];\r\n\t  \r\n\t\tif (typeof hash === 'undefined') {\r\n\t\t\t// To preserve BC\r\n\t\t\thash = '#';\r\n\t\t}\r\n\t  \r\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\r\n\t\t  \tonlyURL = cleanGETParam(url).split(hash)[0];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsplit = url.split(hash);\r\n\t\t\tonlyURL = split.length > 1 ? cleanGETParam(split[1]) : cleanGETParam(split[0]);\r\n\t\t}\r\n\t\treturn onlyURL;\r\n\t}\r\n\t  \r\n\tprivate static manageHooks(handler:RouteFunc, hooks:Hooks, params?:any, exHooks?:Hooks) {\r\n\t\tif (hooks && typeof hooks === 'object') {\r\n\t\t\tif (hooks.before) {\r\n\t\t\t\thooks.before((shouldRoute = true) => {\r\n\t\t\t\tif (!shouldRoute) return;\r\n\t\t\t\thandler();\r\n\t\t\t\thooks.after && hooks.after(params);\r\n\t\t\t\t}, params);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telse if (hooks.after) {\r\n\t\t\t\thandler();\r\n\t\t\t\thooks.after && hooks.after(params);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\thandler();\r\n\t}\r\n\t  \r\n\tprivate static isHashedRoot(url:string, useHash:boolean, hash:string) {\r\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\r\n\t\t  return false;\r\n\t\t}\r\n\t  \r\n\t\tif (!url.match(hash)) {\r\n\t\t  return false;\r\n\t\t}\r\n\t  \r\n\t\tlet split = url.split(hash);\r\n\t  \r\n\t\treturn split.length < 2 || split[1] === '';\r\n\t}\r\n\t\r\n\tprivate root:string;\r\n\tprivate _routes:Route[] = [];\r\n\tprivate _useHash:boolean;\r\n\tprivate _hash:string;\r\n\tprivate _paused:boolean;\r\n\tprivate _destroyed:boolean;\r\n\tprivate _lastRouteResolved:LastResolved;\r\n\tprivate _notFoundHandler:Handler;\r\n\tprivate _defaultHandler:Handler;\r\n\tprivate _usePushState:boolean;\r\n\tprivate _genericHooks:Hooks;\r\n\tprivate _historyUpdateMethod: 'pushState' | 'replaceState'; // HistoryUpdateMethod;\r\n\tprivate timout: any; //NodeJS.Timeout;\r\n\r\n\tconstructor(r:string = null, useHash:boolean = false, hash:string = '#') {\r\n\t\tthis.root = null;\r\n\t\tthis._useHash = useHash;\r\n\t\tthis._hash = (!hash)? '#' : hash;\r\n\t\tthis._paused = false;\r\n\t\tthis._destroyed = false;\r\n\t\tthis._lastRouteResolved = null;\r\n\t\tthis._notFoundHandler = null;\r\n\t\tthis._defaultHandler = null;\r\n\t\tthis._usePushState = !useHash && Navigo.isPushStateAvailable();\r\n\t\t//this._onLocationChange = this._onLocationChange.bind(this);\r\n\t\tthis._genericHooks = null;\r\n\t\tthis._historyUpdateMethod = 'pushState';\r\n\t\r\n\t\tif (r) {\r\n\t\t\tthis.root = useHash ? r.replace(/\\/$/, '/' + this._hash) : r.replace(/\\/$/, '');\r\n\t\t} else if (useHash) {\r\n\t\t\tthis.root = this._cLoc().split(this._hash)[0].replace(/\\/$/, '/' + this._hash);\r\n\t\t}\r\n\t\r\n\t\tthis._listen();\r\n\t\tthis.updatePageLinks();\r\n\t}\r\n  \r\n\tnavigate(path:string, absolute:boolean = false):Navigo {\r\n\t\tlet to:string;\r\n\t\tpath = path || '';\r\n\t\tif (this._usePushState) {\r\n\t\t\tto = (!absolute ? this._getRoot() + '/' : '') + path.replace(/^\\/+/, '/');\r\n\t\t\tto = to.replace(/([^:])(\\/{2,})/g, '$1/');\r\n\t\t\tthis._historyUpdate({}, '', to);\r\n\t\t\tthis.resolve();\r\n\t\t}\r\n\t\telse if (typeof window !== 'undefined') {\r\n\t\t\tpath = path.replace(new RegExp('^' + this._hash), '');\r\n\t\t\tlet {location} = window;\r\n\t\t\tlocation.href = location.href\r\n\t\t\t\t.replace(/#$/, '')\r\n\t\t\t\t.replace(new RegExp(this._hash + '.*$'), '') + this._hash + path;\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\ton(...args:any[]):Navigo {\r\n\t\tlet arg0 = args[0];\r\n\t\tlet arg1 = args[1];\r\n\t\tswitch (typeof arg0) {\r\n\t\t\tcase 'function':\r\n\t\t\t\tthis._defaultHandler = { handler: arg0, hooks: arg1 };\r\n\t\t\t\tif (!this._notFoundHandler) {\r\n\t\t\t\t\tthis._notFoundHandler = this._defaultHandler;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'object':\r\n\t\t\t\tlet orderedRoutes = Object.keys(arg0).sort(Navigo.compareUrlDepth);\r\n\t\t\t\torderedRoutes.forEach(route => this.on(route, arg0[route]));\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tif (args.length < 2) break;\r\n\t\t\t\tif (arg0 === '/') {\r\n\t\t\t\t\tthis._defaultHandler = { \r\n\t\t\t\t\t\thandler: typeof arg1 === 'object'? arg1.uses : arg1, \r\n\t\t\t\t\t\thooks: args[2],\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tthis._add(arg0, arg1, args[2]);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\toff(handler:RouteFunc):Navigo {\r\n\t\tif (this._defaultHandler !== null && handler === this._defaultHandler.handler) {\r\n\t\t\tthis._defaultHandler = null;\r\n\t\t}\r\n\t\telse if (this._notFoundHandler !== null && handler === this._notFoundHandler.handler) {\r\n\t\t\tthis._notFoundHandler = null;\r\n\t\t}\r\n\t\tthis._routes = this._routes.reduce((result, r) => {\r\n\t\t\tif (r.handler !== handler) result.push(r);\r\n\t\t\treturn result;\r\n\t\t}, []);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tnotFound(handler:RouteFunc, hooks:Hooks):Navigo {\r\n\t\tthis._notFoundHandler = { handler, hooks };\r\n\t\treturn this;\r\n\t}\r\n\r\n\tresolve(current?:string) {\r\n\t\tlet c = current || this._cLoc();\r\n\t\tlet root = this._getRoot();\r\n\t\tlet url = c.replace(root, '');\r\n\t\r\n\t\tif (this._useHash) {\r\n\t\t\tconst exp = '^\\\\/';  // 单\\，编译报错 ^\\/\r\n\t\t\turl = url.replace(new RegExp(exp + this._hash), '/');\r\n\t\t}\r\n\t\r\n\t\tlet GETParameters = Navigo.extractGETParameters(current || this._cLoc());\r\n\t\tlet onlyURL = Navigo.getOnlyURL(url, this._useHash, this._hash);\r\n\t\r\n\t\tif (this._paused) return false;\r\n\t\r\n\t\tif (\r\n\t\t\tthis._lastRouteResolved &&\r\n\t\t\tonlyURL === this._lastRouteResolved.url &&\r\n\t\t\tGETParameters === this._lastRouteResolved.query\r\n\t\t) {\r\n\t\t\tif (this._lastRouteResolved.hooks && this._lastRouteResolved.hooks.already) {\r\n\t\t\t\tthis._lastRouteResolved.hooks.already(this._lastRouteResolved.params);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\r\n\t\tlet matched = Navigo.match(onlyURL, this._routes);\r\n\t\r\n\t\tlet manageHooks = (handler:Handler) => {\r\n\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\tquery: GETParameters, \r\n\t\t\t\t\t\thooks: handler.hooks\r\n\t\t\t\t\t};\r\n\t\t\t\t\thandler.handler(GETParameters);\r\n\t\t\t\t}, handler.hooks);\r\n\t\t\t}, this._genericHooks);\r\n\t\t}\r\n\r\n\t\tif (matched === false) {\r\n\t\t\tif (this._defaultHandler && (\r\n\t\t\t\tonlyURL === '' ||\r\n\t\t\t\tonlyURL === '/' ||\r\n\t\t\t\tonlyURL === this._hash ||\r\n\t\t\t\tNavigo.isHashedRoot(onlyURL, this._useHash, this._hash)\r\n\t\t\t)) {\r\n\t\t\t\t/*\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\t\tquery: GETParameters, \r\n\t\t\t\t\t\t\thooks: this._defaultHandler.hooks\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._defaultHandler.handler(GETParameters);\r\n\t\t\t\t\t}, this._defaultHandler.hooks);\r\n\t\t\t\t}, this._genericHooks);\r\n\t\t\t\t*/\r\n\t\t\t\tmanageHooks(this._defaultHandler);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\telse if (this._notFoundHandler) {\r\n\t\t\t\t/*\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\t\tquery: GETParameters,\r\n\t\t\t\t\t\t\thooks: this._notFoundHandler.hooks\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._notFoundHandler.handler(GETParameters);\r\n\t\t\t\t\t}, this._notFoundHandler.hooks);\r\n\t\t\t\t}, this._genericHooks);\r\n\t\t\t\t*/\r\n\t\t\t\tmanageHooks(this._notFoundHandler);\r\n\t\t\t}\r\n\t\t\treturn false;\t\r\n\t\t}\r\n\t\tlet m = matched;\r\n\t\tif (m) {\r\n\t\t\tthis._callLeave();\r\n\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\turl: onlyURL,\r\n\t\t\t\tquery: GETParameters,\r\n\t\t\t\thooks: m.route.hooks,\r\n\t\t\t\tparams: m.params,\r\n\t\t\t\tname: m.route.name\r\n\t\t\t};\r\n\t\t\tlet handler = m.route.handler;\r\n\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tm.route.route instanceof RegExp ?\r\n\t\t\t\t\thandler(...(m.match.slice(1, m.match.length))) :\r\n\t\t\t\t\thandler(m.params, GETParameters);\r\n\t\t\t\t}, m.route.hooks, m.params, this._genericHooks);\r\n\t\t\t}, this._genericHooks, m.params);\r\n\t\t\treturn m;\r\n\t\t}\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis._routes = [];\r\n\t\tthis._destroyed = true;\r\n\t\tthis._lastRouteResolved = null;\r\n\t\tthis._genericHooks = null;\r\n\t\tclearTimeout(this.timout);\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\twindow.removeEventListener('popstate', this._onLocationChange);\r\n\t\t\twindow.removeEventListener('hashchange', this._onLocationChange);\r\n\t\t}\r\n\t}\r\n\r\n\tupdatePageLinks() {\r\n\t\t//var self = this;\r\n\t\tif (typeof document === 'undefined') return;\r\n\t\t\tthis._findLinks().forEach(link => {\r\n\t\t\tif (!link.hasListenerAttached) {\r\n\t\t\t\tlink.addEventListener('click', (e: React.MouseEvent<HTMLElement>) => {\r\n\t\t\t\t\tif((e.ctrlKey || e.metaKey) && e.currentTarget.tagName.toLowerCase() === 'a'){ return false; }\r\n\t\t\t\t\tvar location = this.getLinkPath(link);\r\n\t\t\r\n\t\t\t\t\tif (!this._destroyed) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tthis.navigate(location.replace(/\\/+$/, '').replace(/^\\/+/, '/'));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tlink.hasListenerAttached = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tgenerate(name:string, data:any = {}) {\r\n\t\tlet result = this._routes.reduce((result, route) => {\r\n\t\t\tif (route.name === name) {\r\n\t\t\t\tresult = route.route.toString();\r\n\t\t\t\tfor (let key in data) {\r\n\t\t\t\t\tresult = result.replace(':' + key, data[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}, '');\r\n\t\r\n\t\treturn this._useHash ? this._hash + result : result;\r\n\t}\r\n\r\n\tlink(path:string) {\r\n\t\treturn this._getRoot() + path;\r\n\t}\r\n\r\n\tpause(status:boolean = true) {\r\n\t\tthis._paused = status;\r\n\t\tif (status) {\r\n\t\t\tthis._historyUpdateMethod = 'replaceState';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._historyUpdateMethod = 'pushState';\r\n\t\t}\r\n\t}\r\n\r\n\tresume() {\r\n\t\tthis.pause(false);\r\n\t}\r\n\r\n\thistoryAPIUpdateMethod(value:'pushState' | 'replaceState') {\r\n\t\tif (typeof value === 'undefined') return this._historyUpdateMethod;\r\n\t\tthis._historyUpdateMethod = value;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tdisableIfAPINotAvailable() {\r\n\t\tif (!Navigo.isPushStateAvailable()) {\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\t}\r\n\r\n\tlastRouteResolved() {\r\n\t\treturn this._lastRouteResolved;\r\n\t}\r\n\r\n\tgetLinkPath(link:any) {\r\n\t\treturn link.getAttribute('href');\r\n\t}\r\n\r\n\thooks(hooks:Hooks) {\r\n\t\tthis._genericHooks = hooks;\r\n\t}\r\n\r\n\tprivate _add(route:string|RegExp, handler:RouteFunc|NamedRoute, hooks:Hooks) {\r\n\t\tif (typeof route === 'string') {\r\n\t\t\troute = encodeURI(route);\r\n\t\t}\r\n\t\tthis._routes.push(\r\n\t\t\ttypeof handler === 'object' ?\r\n\t\t\t{\r\n\t\t\t\troute,\r\n\t\t\t\thandler: handler.uses,\r\n\t\t\t\tname: handler.as,\r\n\t\t\t\thooks: hooks || handler.hooks\r\n\t\t\t} \r\n\t\t\t:\r\n\t\t\t{\r\n\t\t\t\troute,\r\n\t\t\t\thandler, \r\n\t\t\t\tname: undefined,\r\n\t\t\t\thooks,\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn this._add;\r\n\t}\r\n\r\n\tprivate _historyUpdate(data:any, title:string, url?:string) {\r\n\t\tswitch (this._historyUpdateMethod) {\r\n\t\t\tdefault: throw Error('unknow history method ' + this._historyUpdateMethod);\r\n\t\t\tcase 'pushState': window.history.pushState(data, title, url); return;\r\n\t\t\tcase 'replaceState': window.history.replaceState(data, title, url); return;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _getRoot() {\r\n\t\tif (this.root !== null) return this.root;\r\n\t\tlet cLoc = this._cLoc();\r\n\t\tlet cLocRoot = cLoc.split('?')[0];\r\n\t\tthis.root = Navigo.root(cLocRoot, this._routes);\r\n\t\treturn this.root;\r\n\t}\r\n\r\n\tprivate _listen() {\r\n\t\tif (this._usePushState) {\r\n\t\t\twindow.addEventListener('popstate', this._onLocationChange);\r\n\t\t}\r\n\t\telse if (Navigo.isHashChangeAPIAvailable()) {\r\n\t\t\twindow.addEventListener('hashchange', this._onLocationChange);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet cached = this._cLoc();\r\n\t\r\n\t\t\tlet check = () => {\r\n\t\t\t\tlet current = this._cLoc();\r\n\t\t\t\tif (cached !== current) {\r\n\t\t\t\t\tcached = current;\r\n\t\t\t\t\tthis.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tif (this.timout) clearTimeout(this.timout);\r\n\t\t\t\tthis.timout = setTimeout(check, 200);\r\n\t\t\t};\r\n\t\t\tcheck();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _cLoc() {\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\t//if (typeof window.__NAVIGO_WINDOW_LOCATION_MOCK__ !== 'undefined') {\r\n\t\t\t//\treturn window.__NAVIGO_WINDOW_LOCATION_MOCK__;\r\n\t\t\t//}\r\n\t\t\treturn Navigo.cleanUrl(window.location.href);\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tprivate _findLinks() {\r\n\t\treturn [].slice.call(document.querySelectorAll('[data-navigo]'));\r\n\t}\r\n\r\n\tprivate _onLocationChange = () => {\r\n\t\tconsole.log('_onLocationChange');\r\n\t\tthis.resolve();\r\n\t}\r\n\r\n\tprivate _callLeave() {\r\n\t\tconst lastRouteResolved = this._lastRouteResolved;\t\r\n\t\tif (lastRouteResolved) {\r\n\t\t\tlet {params, hooks} = lastRouteResolved;\r\n\t\t\tif (hooks) {\r\n\t\t\t\tif (hooks.leave) {\r\n\t\t\t\t\thooks.leave(params);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//export default Navigo;\r\nexport const navigo = new Navigo();\r\n","import * as React from 'react';\r\nimport {nav} from '../nav';\r\n\r\nexport interface PageHeaderProps {\r\n    back?: 'back' | 'close' | 'none';\r\n    center: string | JSX.Element;\r\n    right?: JSX.Element;\r\n    logout?: boolean | (()=>Promise<void>);\r\n    className?: string;\r\n\tafterBack?: () => void;\r\n\tex?: JSX.Element;\r\n}\r\n\r\nexport function renderPageHeader(props: PageHeaderProps, inWebNav?: boolean) {\r\n    let onBack = async () => {\r\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\r\n\t\tlet {afterBack} = props;\r\n\t\tif (afterBack) afterBack();\r\n    }\r\n    let onLogoutClick = () => {\r\n\t\tlet logout = async () => {\r\n\t\t\tlet {logout} = props;\r\n\t\t\tif (typeof logout === 'function') {\r\n\t\t\t\tawait logout(); \r\n\t\t\t}\r\n\t\t\tawait nav.logout(undefined);\r\n\t\t}\r\n\t\tnav.showLogout(logout);\r\n    }\r\n\r\n\tlet b = nav.level > 1 || window.self !== window.top;\r\n\tlet {back, right, center, logout, className, ex} = props;\r\n\tif (inWebNav === true &&  !back && !right && !center) return;\r\n\tlet vBack:any, debugLogout:any;\r\n\tif (logout !== undefined && window.self === window.top) {\r\n\t\tif ((typeof logout === 'boolean' && logout === true)\r\n\t\t\t|| typeof logout === 'function')\r\n\t\t{\r\n\t\t\tlet {user} = nav;\r\n\t\t\tif (user !== undefined) {\r\n\t\t\t\tlet {nick, name} = user;\r\n\t\t\t\tdebugLogout = <div className=\"d-flex align-items-center\">\r\n\t\t\t\t\t<small className=\"text-light\">{nick || name}</small>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// eslint-disable-next-line\r\n\t\t\t\t\t\t<div className=\"ml-2 py-2 px-3 cursor-pointer\"\r\n\t\t\t\t\t\t\trole=\"button\"\r\n\t\t\t\t\t\t\tonClick={onLogoutClick}>\r\n\t\t\t\t\t\t\t<i className=\"fa fa-sign-out fa-lg\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (b) {\r\n\t\tswitch (props.back) {\r\n\t\t\tcase 'none':\r\n\t\t\t\tvBack = undefined;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\tcase 'back':\r\n\t\t\t\tvBack = <nav onClick={onBack}>{nav.backIcon}</nav>;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'close':\r\n\t\t\t\tvBack = <nav onClick={onBack}>{nav.backIcon}</nav>;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (window.self !== window.top) {\r\n\t\tconsole.log(document.location.href);\r\n\t\t// pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\r\n\t}\r\n\tif (vBack === undefined && typeof center === 'string') {\r\n\t\tcenter = <div className=\"px-3\">{center}</div>;\r\n\t}\r\n\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\r\n\tlet header = <header className={className}>\r\n\t\t<nav>\r\n\t\t\t{vBack}\r\n\t\t\t{/*pop 弹出window暂时停止作用 */}\r\n\t\t\t<div>{center}</div>\r\n\t\t\t{rightView}\r\n\t\t</nav>\r\n\t\t{ex}\r\n\t</header>;\r\n\tif (inWebNav === true) return header;\r\n\treturn <>\r\n\t\t<section className=\"tv-page-header\">{header}</section>\r\n\t\t{header}\r\n\t</>;\r\n}\r\n\r\nexport class PageHeader extends React.Component<PageHeaderProps> {\r\n\trender() {return renderPageHeader(this.props)}\r\n\t/*\r\n    private back = async () => {\r\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\r\n\t\tlet {afterBack} = this.props;\r\n\t\tif (afterBack) afterBack();\r\n    }\r\n    openWindow() {\r\n        window.open(document.location.href);\r\n    }\r\n    private logoutClick = () => {\r\n        nav.showLogout(this.logout);\r\n    }\r\n    private logout = async () => {\r\n        let {logout} = this.props;\r\n        if (typeof logout === 'function') {\r\n            await logout(); \r\n        }\r\n        await nav.logout(undefined);\r\n    }\r\n    render() {\r\n        let b = nav.level > 1 || window.self !== window.top;\r\n        let {right, center, logout, className, ex} = this.props;\r\n        let back:any, debugLogout:any;\r\n        if (logout !== undefined && window.self === window.top) {\r\n            if ((typeof logout === 'boolean' && logout === true)\r\n                || typeof logout === 'function')\r\n            {\r\n                let {user} = nav;\r\n                if (user !== undefined) {\r\n                    let {nick, name} = user;\r\n                    debugLogout = <div className=\"d-flex align-items-center\">\r\n                        <small className=\"text-light\">{nick || name}</small>\r\n                        {\r\n                            // eslint-disable-next-line\r\n                            <div className=\"ml-2 py-2 px-3 cursor-pointer\"\r\n                                role=\"button\"\r\n                                onClick={this.logoutClick}>\r\n                                <i className=\"fa fa-sign-out fa-lg\" />\r\n                            </div>\r\n                        }\r\n                    </div>;\r\n                }\r\n            }\r\n        }\r\n        if (b) {\r\n            switch (this.props.back) {\r\n                case 'none':\r\n                    back = undefined;\r\n                    break;\r\n                default:\r\n                case 'back':\r\n                    back = <nav onClick={this.back}><i className=\"fa fa-angle-left\" /></nav>;\r\n                    break;\r\n                case 'close':\r\n                    back = <nav onClick={this.back}><i className=\"fa fa-close\" /></nav>;\r\n                    break;\r\n            }\r\n        }\r\n        if (window.self !== window.top) {\r\n            console.log(document.location.href);\r\n            // pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\r\n        }\r\n        if (back === undefined && typeof center === 'string') {\r\n            center = <div className=\"px-3\">{center}</div>;\r\n        }\r\n\t\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\r\n\t\tlet header = <header className={className}>\r\n\t\t\t<nav>\r\n\t\t\t\t{back}\r\n\t\t\t\t<div>{center}</div>\r\n\t\t\t\t{rightView}\r\n\t\t\t</nav>\r\n\t\t\t{ex}\r\n\t\t</header>;\r\n        return <>\r\n\t\t\t<section className=\"tv-page-header\">{header}</section>\r\n\t\t\t{header}\r\n\t\t</>;\r\n\t}\r\n\t*/\r\n}\r\n","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport { IVPage } from './page';\r\nimport { IObservableValue } from 'mobx';\r\nimport '../../css/va-tab.css';\r\nimport { ScrollView } from './scrollView';\r\n\r\nexport type TabCaption = (selected:boolean) => JSX.Element;\r\n\r\nexport interface TabProp {\r\n    name: string;\r\n    caption: TabCaption;\r\n\tcontent?: () => JSX.Element;\r\n\tpage?: IVPage;\r\n    notify?: IObservableValue<number>;\r\n    load?: () => Promise<void>;\r\n\tonShown?: () => Promise<void>;\r\n\tisSelected?: boolean;\r\n\tonScroll?: () => void;\r\n\tonScrollTop?: () => Promise<boolean>;\r\n\tonScrollBottom?: () => Promise<void>;\r\n\tclassName?: string;\r\n}\r\n\r\nexport interface TabsProps {\r\n    tabs: TabProp[];\r\n    tabPosition?: 'top' | 'bottom';\r\n    size?: 'sm' | 'lg' | 'md';\r\n    tabBg?: string;\r\n    contentBg?: string;\r\n    sep?: string;\r\n    selected?: string;\r\n    borderColor?: string;\r\n    borderWidth?: string;\r\n}\r\n\r\nclass Tab {\r\n\t@observable private loaded: boolean = false;\r\n    name: string;\r\n    @observable selected: boolean;\r\n    caption: TabCaption;\r\n\tcontentBuilder: ()=>JSX.Element;\r\n\tpage: IVPage;\r\n    notify: IObservableValue<number>;\r\n    load?: () => Promise<void>;\r\n\tonShown?: () => Promise<void>;\r\n\tonScroll?: () => void;\r\n\tonScrollTop?: () => Promise<boolean>;\r\n\tonScrollBottom?: () => Promise<void>;\r\n\tclassName?: string;\r\n\r\n    private _content: JSX.Element;\r\n    \r\n    get content(): JSX.Element {\r\n\t\tif (this.load && this.loaded === false) return null;\r\n\t\tif (this.selected === false) return this._content;\r\n\t\tif (!this._content) {\r\n\t\t\tif (this.contentBuilder !== undefined) {\r\n\t\t\t\tthis._content = this.contentBuilder();\r\n\t\t\t}\r\n\t\t\telse if (this.page !== undefined) {\r\n\t\t\t\tthis._content = this.page.content();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._content = <div className=\"p-5\">tab 应该定义content或者page</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._content;\r\n    }\r\n\r\n    async shown() {\r\n        if (this.onShown !== undefined) {\r\n            await this.onShown();\r\n        }\r\n        if (this.load !== undefined) {\r\n\t\t\tif (this.loaded === false) {\r\n\t\t\t\tawait this.load();\r\n\t\t\t\tthis.loaded = true;\r\n\t\t\t}\r\n        }\r\n    }\r\n}\r\n\r\nexport const TabCaptionComponent = (label:string, icon:string, color:string) => <div \r\n    className={'d-flex justify-content-center align-items-center flex-column cursor-pointer ' + color}>\r\n    <div><i className={'fa fa-lg fa-' + icon} /></div>\r\n    <small>{label}</small>\r\n</div>;\r\n\r\n//export const TabCaption = TabCaptionComponent;\r\n\r\nexport class TabsView {\r\n\tprivate props: TabsProps;\r\n    private size: string;\r\n    private tabBg: string;\r\n    //private contentBg: string;\r\n    private sep: string;\r\n    @observable private selectedTab: Tab;\r\n    @observable private tabArr: Tab[];\r\n\r\n    constructor(props: TabsProps) {\r\n\t\tthis.props = props;\r\n\t\tlet {size, tabs, tabBg: tabBack, sep, selected} = props;\r\n\t\tthis.size = size || 'md';\r\n        this.tabArr = tabs.map(v => {\r\n            let tab = new Tab();\r\n            let {name, caption, content, page, notify, load, onShown, isSelected, onScroll, onScrollTop, onScrollBottom, className} = v;\r\n\t\t\ttab.name = name;\r\n\t\t\tif (isSelected === true || name === selected) {\r\n\t\t\t\tthis.selectedTab = tab;\r\n\t\t\t}\r\n\t\t\ttab.selected = false;\r\n\t\t\ttab.caption = caption;\r\n\t\t\tif (content !== undefined) {\r\n\t\t\t\ttab.contentBuilder = content;\r\n\t\t\t}\r\n\t\t\telse if (page !== undefined) {\r\n\t\t\t\ttab.page = page;\r\n\t\t\t\t//contentBuilder = () => {return page.content()};\r\n\t\t\t}\r\n            tab.notify = notify;\r\n            tab.load = load;\r\n\t\t\ttab.onShown = onShown;\r\n\t\t\ttab.onScroll = onScroll;\r\n\t\t\ttab.onScrollTop = onScrollTop;\r\n\t\t\ttab.onScrollBottom = onScrollBottom;\r\n\t\t\ttab.className = className;\r\n            return tab;\r\n        });\r\n        this.tabBg = tabBack;\r\n        //this.contentBg = contentBack;\r\n        this.sep = sep;\r\n        if (this.selectedTab === undefined) {\r\n\t\t\tthis.selectedTab = this.tabArr[0];\r\n\t\t}\r\n        this.selectedTab.selected = true;\r\n    }\r\n\r\n    tabClick = async (tab:Tab) => {\r\n\t\tif (!tab) {\r\n\t\t\ttab = this.selectedTab;\r\n\t\t\tif (tab === undefined) {\r\n\t\t\t\tif (this.tabArr === undefined) return;\r\n\t\t\t\tif (this.tabArr.length === 0) return;\r\n\t\t\t\ttab = this.tabArr[0];\r\n\t\t\t}\r\n\t\t}\r\n\r\n        this.selectedTab.selected = false;\r\n        tab.selected = true;\r\n\t\tthis.selectedTab = tab;\r\n\t\t\r\n\t\tawait tab.shown();\r\n    }\r\n\r\n\t/*\r\n    showTab(tabName: string) {\r\n        let tab = this.tabs.find(v => v.name === tabName);\r\n        if (tab === undefined) return;\r\n        if (this.selectedTab !== undefined) this.selectedTab.selected = false;\r\n        tab.selected = true;\r\n        this.selectedTab = tab;\r\n\t}\r\n\t*/\r\n\r\n\tprivate tabs = observer(() => {\r\n        let {tabPosition, borderColor} = this.props;\r\n        let bsCur:React.CSSProperties, bsTab:React.CSSProperties\r\n        if (borderColor) {\r\n            bsCur = {\r\n                borderColor: borderColor,\r\n                borderStyle: 'solid',\r\n                borderTopWidth: 1,\r\n                borderLeftWidth: 1,\r\n                borderRightWidth: 1,\r\n                borderBottomWidth: 1,\r\n            }\r\n            bsTab = {\r\n                borderColor: borderColor,\r\n                borderStyle: 'solid',\r\n                borderTopWidth: 1,\r\n                borderBottomWidth: 1,\r\n                borderLeftWidth: 0,\r\n                borderRightWidth: 0,\r\n            }\r\n            if (tabPosition === 'top') {\r\n                bsCur.borderBottomWidth = 0;\r\n                bsCur.borderTopLeftRadius = 10;\r\n                bsCur.borderTopRightRadius = 10;\r\n                bsTab.borderTopWidth = 0;\r\n            }\r\n            else {\r\n                bsCur.borderTopWidth = 0;\r\n                bsCur.borderBottomLeftRadius = 10;\r\n                bsCur.borderBottomRightRadius = 10;\r\n                bsTab.borderBottomWidth = 0;\r\n            }\r\n        }\r\n\t\tlet cn = classNames('tv-tabs', this.tabBg, this.sep, 'tv-tabs-' + this.size);\r\n\t\tlet tabs = <div className={cn}>\r\n            {this.tabArr.map((v,index) => {\r\n                let {selected, caption, notify} = v;\r\n                let notifyCircle:any;\r\n                if (notify !== undefined) {\r\n                    let num = notify.get();\r\n                    if (num !== undefined) {\r\n                        if (num > 0) notifyCircle = <u>{num>99?'99+':num}</u>;\r\n                        else if (num < 0) notifyCircle = <u className=\"dot\" />;\r\n                    }\r\n                }\r\n                return <div key={index} onClick={()=>this.tabClick(v)} style={selected===true? bsCur:bsTab}>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t{notifyCircle}\r\n\t\t\t\t\t{caption(selected)}\r\n\t\t\t\t\t</div>\r\n                </div>\r\n            })}\r\n\t\t</div>;\r\n\t\treturn tabs;\r\n\t});\r\n\r\n\tcontent = observer(() => {\r\n\t\tlet displayNone:React.CSSProperties = {visibility: 'hidden'};\r\n\t\treturn <>\r\n\t\t\t{this.tabArr.map((v,index) => {\r\n\t\t\t\tlet {tabPosition} = this.props;\r\n\t\t\t\tlet {content, page, onScroll, onScrollTop, onScrollBottom, className} = v;\r\n\t\t\t\tlet tabs = React.createElement(this.tabs);\r\n\t\t\t\tlet pageHeader:any, pageFooter:any;\r\n\t\t\t\tif (page !== undefined) {\r\n\t\t\t\t\tpageHeader = page.header();\r\n\t\t\t\t\tpageFooter = page.footer();\r\n\t\t\t\t}\r\n\t\t\t\tlet header:any, footer:any;\r\n\t\t\t\tlet visibility:React.CSSProperties = {visibility:'hidden'};\r\n\t\t\t\tif (tabPosition === 'top') {\r\n\t\t\t\t\theader = <>\r\n\t\t\t\t\t\t<section className=\"tv-page-header\">\r\n\t\t\t\t\t\t\t<header>{tabs}{pageHeader}</header>\r\n\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t<header style={visibility}>{tabs}{pageHeader}</header>\r\n\t\t\t\t\t</>;\r\n\t\t\t\t\tif (pageFooter !== undefined) {\r\n\t\t\t\t\t\tfooter = <>\r\n\t\t\t\t\t\t\t<footer style={visibility}>{pageFooter}</footer>\r\n\t\t\t\t\t\t\t<section className=\"tv-page-footer\">\r\n\t\t\t\t\t\t\t\t<footer>{pageFooter}</footer>\r\n\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t</>;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (pageHeader !== undefined) {\r\n\t\t\t\t\t\theader = <>\r\n\t\t\t\t\t\t\t<section className='tv-page-header'>\r\n\t\t\t\t\t\t\t\t<header>{pageHeader}</header>\r\n\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t\t<header style={visibility}>{pageHeader}</header>\r\n\t\t\t\t\t\t</>;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfooter = <>\r\n\t\t\t\t\t\t<footer style={visibility}>{pageFooter}{tabs}</footer>\r\n\t\t\t\t\t\t<section className='tv-page-footer'>\r\n\t\t\t\t\t\t\t<footer>{pageFooter}{tabs}</footer>\r\n\t\t\t\t\t\t</section>\r\n\t\t\t\t\t</>;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet style:React.CSSProperties;\r\n\t\t\t\tif (v.selected===false) style = displayNone;\r\n\t\t\t\treturn <ScrollView key={index} className={className}\r\n\t\t\t\t\tstyle={style}\r\n\t\t\t\t\tonScroll={onScroll} onScrollTop={onScrollTop} onScrollBottom={onScrollBottom}>\r\n\t\t\t\t\t{header}\r\n\t\t\t\t\t{content}\r\n\t\t\t\t\t{footer}\r\n\t\t\t\t</ScrollView>;\r\n\t\t\t})}\r\n\t\t</>;\r\n\t});\r\n\r\n    render() {\r\n\t\tlet {tabPosition} = this.props;\r\n\t\tlet tabs = React.createElement(this.tabs);\r\n\t\tlet header:any, footer:any;\r\n\t\tlet visibility:React.CSSProperties = {display:'none'};\r\n\t\tif (tabPosition === 'top') {\r\n\t\t\theader = <header>{tabs}</header>;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfooter = <footer>{tabs}</footer>;\r\n\t\t}\r\n\t\treturn <>\r\n\t\t\t{header}\r\n\t\t\t{this.tabArr.map((v,index) => {\r\n\t\t\t\tlet style:React.CSSProperties;\r\n\t\t\t\tif (v.selected===false) style = visibility;\r\n\t\t\t\treturn <div key={index} className={classNames(v.className)} style={style}>\r\n\t\t\t\t\t{v.content}\r\n\t\t\t\t</div>;\r\n\t\t\t})}\r\n\t\t\t{footer}\r\n\t\t</>;\r\n    }\r\n};\r\n\r\n@observer export class Tabs extends React.Component<TabsProps> {\r\n\tprivate readonly tabsView: TabsView;\r\n    constructor(props: TabsProps) {\r\n\t\tsuper(props);\r\n\t\tthis.tabsView = new TabsView(props);\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.tabsView.tabClick(undefined);\r\n\t\t}, 100);\r\n    }\r\n\r\n    render() {\r\n\t\treturn this.tabsView.render();\r\n    }\r\n};\r\n\r\n@observer export class RootTabs extends React.Component<TabsProps> {\r\n\tprivate readonly tabsView: TabsView;\r\n    constructor(props: TabsProps) {\r\n\t\tsuper(props);\r\n\t\tthis.tabsView = new TabsView(props);\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.tabsView.tabClick(undefined);\r\n\t\t}, 100);\r\n    }\r\n\r\n    render() {\r\n\t\treturn React.createElement(this.tabsView.content);\r\n    }\r\n};\r\n","import * as React from 'react';\r\nimport { nav } from './nav';\r\nimport { Loading } from './loading';\r\nimport { Image as ImageControl } from './image';\r\nimport { Page } from './page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\nimport { LMR } from './simple';\r\n\r\nexport interface ResUploaderProps {\r\n    className?: string;\r\n    label?: string;\r\n    multiple?: boolean;\r\n    maxSize?: number;\r\n    onFilesChange?: (evt: React.ChangeEvent<HTMLInputElement>) => void;\r\n}\r\n\r\n@observer\r\nexport class ResUploader extends React.Component<ResUploaderProps> {\r\n    private fileInput: HTMLInputElement;\r\n    @observable private fileName: string;\r\n\r\n    buildFormData():FormData {\r\n        let {maxSize} = this.props;\r\n        if (maxSize === undefined || maxSize <= 0) \r\n            maxSize = 100000000000;\r\n        else\r\n            maxSize = maxSize * 1024;\r\n        var files:FileList = this.fileInput.files;\r\n        var data = new FormData();\r\n        let len = files.length;\r\n        for (let i=0; i<len; i++) {\r\n            let file = files[i];\r\n            if (file.size > maxSize) return null;\r\n            data.append('files[]', file, file.name);\r\n        }\r\n    }\r\n\r\n    getFile0(): File {\r\n        return this.fileInput.files[0];\r\n    }\r\n\r\n    upload = async (formData?: FormData):Promise<string|{error:any}> => {\r\n        let resUrl = nav.resUrl + 'upload';\r\n        if (!formData) formData = this.buildFormData();\r\n        try {\r\n            nav.startWait();\r\n            let headers = new Headers();\r\n            headers.append('Access-Control-Allow-Origin', '*');\r\n            //2019-12-18：因为 vivo按oppo某些版本不支持，暂时先不要 \r\n            //let abortController = new AbortController();\r\n            let res = await fetch(resUrl, {\r\n                method: \"POST\",\r\n                body: formData,\r\n                headers: headers,\r\n                //signal: abortController.signal,\r\n            });\r\n            let json = await res.json();\r\n            return ':' + json.res.id;\r\n        }\r\n        catch (err) {\r\n            console.error('%s %s', resUrl, err);\r\n            return {error:err};\r\n        }\r\n        finally {\r\n            nav.endWait();\r\n        }\r\n    }\r\n\r\n    private onFilesChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        let {onFilesChange} = this.props;\r\n        if (onFilesChange) onFilesChange(evt);\r\n        let files = evt.target.files;\r\n        let len = files.length;\r\n        let names:string[] = [];\r\n        for (let i=0; i<len; i++) {\r\n            names.push(files.item(i).name);\r\n        }\r\n        this.fileName = names.join(', ');\r\n    }\r\n\r\n    render() {\r\n        let {className, multiple, label} = this.props;\r\n        return <div>\r\n                <label className=\"btn btn-outline-success\">\r\n                    {label || '选择文件'} \r\n                    <input \r\n                        className={className}\r\n                        ref={t=>this.fileInput=t} \r\n                        onChange={this.onFilesChange}\r\n                        type='file' name='file' \r\n                        multiple={multiple} style={{display:'none'}} />\r\n                </label>\r\n                &nbsp;\r\n                {this.fileName}\r\n            </div>\r\n    }\r\n}\r\n\r\nfunction formatSize(size:number, pointLength:number=2, units?:string[]) {\r\n    var unit;\r\n    units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\r\n    while ( (unit = units.shift()) && size > 1024 ) {\r\n        size = size / 1024;\r\n    }\r\n    return (unit === 'B' ? size : size.toFixed( pointLength === undefined ? 2 : pointLength)) + unit;\r\n}\r\n\r\ninterface ImageUploaderProps {\r\n    id?: string;\r\n    label?: string;\r\n    size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw';\r\n\tonSaved?: (imageId:string) => Promise<void>;\r\n\timageTypes?: string[];\r\n}\r\n\r\nconst xlargeSize = 1600;\r\nconst largeSize = 800;\r\nconst mediumSize = 400;\r\nconst smallSize = 180;\r\n\r\n@observer\r\nexport class ImageUploader extends React.Component<ImageUploaderProps> {\r\n\tprivate static imageTypes = ['gif', 'jpg', 'jpeg', 'png', 'svg', 'apng', 'bmp', 'ico', 'cur', 'tiff', 'tif', 'webp'];\r\n\tprivate imgBaseSize: number;\r\n\tprivate imageTypes: string[];\r\n    private suffix: string;\r\n    private resUploader: ResUploader;\r\n    @observable private file: File;    \r\n    @observable private desImgWidth: number;\r\n    @observable private desImgHeight: number;\r\n    @observable private desImgSize: number;\r\n    @observable private srcImgWidth: number;\r\n    @observable private srcImgHeight: number;\r\n    @observable private isChanged: boolean = false;\r\n    @observable private resId: string;\r\n    @observable private enableUploadButton: boolean = false;\r\n    @observable private srcImage: string;\r\n    @observable private desImage: string;\r\n    @observable private fileError: string;\r\n    @observable private uploaded: boolean = false;\r\n\r\n    constructor(props: ImageUploaderProps) {\r\n        super(props);\r\n\t\tthis.resId = props.id;\r\n\t\tthis.imageTypes = props.imageTypes || ImageUploader.imageTypes;\r\n    }\r\n\r\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.fileError = undefined;\r\n        this.uploaded = false;\r\n        this.enableUploadButton = evt.target.files.length > 0;\r\n        if (this.enableUploadButton) {\r\n            this.file = evt.target.files[0];\r\n            let pos = this.file.name.lastIndexOf('.');\r\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\r\n            if(this.imageTypes.indexOf(this.suffix) < 0){\r\n                this.fileError = `图片类型必须是 ${this.imageTypes.join(', ')} 中的一种`;\r\n                return;\r\n            }\r\n            let reader = new FileReader();\r\n            reader.readAsDataURL(this.file);\r\n            reader.onload = async () => {\r\n\t\t\t\tthis.srcImage = reader.result as string;\r\n\t\t\t\tswitch (this.suffix ) {\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tawait this.setSize(this.props.size);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'svg':\r\n\t\t\t\t\t\tthis.imgBaseSize = mediumSize;\r\n\t\t\t\t\t\tthis.desImgSize = this.srcImage.length;\r\n\t\t\t\t\t\tthis.desImage = this.srcImage;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n            };\r\n        }\r\n    }\r\n\r\n    private async setSize(size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw') {\r\n        switch (size) {\r\n            default:\r\n            case 'sm':\r\n                this.imgBaseSize = smallSize; break;\r\n            case 'md':\r\n                this.imgBaseSize = mediumSize; break;\r\n            case 'lg':\r\n\t\t\t\tthis.imgBaseSize = largeSize; break;\r\n\t\t\tcase 'xl':\r\n\t\t\t\tthis.imgBaseSize = xlargeSize; break;\r\n\t\t\tcase 'raw':\r\n\t\t\t\tthis.imgBaseSize = -1; break;\r\n\t\t}\r\n\t\tthis.desImage = await this.compress();\r\n    }\r\n\r\n    private compress = ():Promise<string> => {\r\n        return new Promise<string>((resolve, reject) => {\r\n            var img = new Image();\r\n            img.src = this.srcImage;\r\n            img.onload = () => {\r\n                //var that = this;\r\n                // 默认按比例压缩\r\n                let {width, height} = img;\r\n                this.srcImgWidth = width;\r\n                this.srcImgHeight = height;\r\n                let scale = width / height;\r\n\t\t\t\tlet w:number, h:number;\r\n\t\t\t\tif (this.imgBaseSize < 0) {\r\n\t\t\t\t\tw = width;\r\n\t\t\t\t\th = height;\r\n\t\t\t\t}\r\n                else if (width <= this.imgBaseSize && height <= this.imgBaseSize) {\r\n                    w = width;\r\n                    h = height;\r\n                }\r\n                else if (scale < 0) {\r\n                    w = this.imgBaseSize;\r\n                    h = w / scale;\r\n                }\r\n                else {\r\n                    h = this.imgBaseSize;\r\n                    w = h * scale;\r\n                }\r\n                this.desImgWidth = Math.round(w);\r\n                this.desImgHeight = Math.round(h);\r\n                var quality = 0.7;  // 默认图片质量为0.7\r\n                //生成canvas\r\n                var canvas = document.createElement('canvas');\r\n                var ctx = canvas.getContext('2d');\r\n                // 创建属性节点\r\n                var anw = document.createAttribute(\"width\");\r\n                anw.nodeValue = String(w);\r\n                var anh = document.createAttribute(\"height\");\r\n                anh.nodeValue = String(h);\r\n                canvas.setAttributeNode(anw);\r\n                canvas.setAttributeNode(anh);\r\n                ctx.drawImage(img, 0, 0, w, h);\r\n                let base64 = canvas.toDataURL('image/' + this.suffix , quality);\r\n                let blob = this.convertBase64UrlToBlob(base64);\r\n                this.desImgSize = blob.size;\r\n                if (this.desImgSize > 3*1024*1024) {\r\n                    this.fileError = \"图片大于3M，无法上传\";\r\n                    this.enableUploadButton = false;\r\n                }\r\n                resolve(base64);\r\n            }\r\n        });\r\n    }\r\n\r\n    private convertBase64UrlToBlob(urlData: string):Blob {\r\n        let arr = urlData.split(',');\r\n        let mime = arr[0].match(/:(.*?);/)[1];\r\n        let bstr = atob(arr[1]);\r\n        let n = bstr.length;\r\n        let u8arr = new Uint8Array(n);\r\n        while(n--){\r\n            u8arr[n] = bstr.charCodeAt(n);\r\n        }\r\n        return new Blob([u8arr], {type:mime});\r\n    }\r\n\r\n    private upload = async () => {\r\n        if (!this.resUploader) return;\r\n        let formData = new FormData();\r\n        let blob = this.convertBase64UrlToBlob(this.desImage);\r\n        formData.append('image', blob, this.file.name);\r\n        let ret = await this.resUploader.upload(formData);\r\n        if (typeof ret === 'object') {\r\n            let {error} = ret;\r\n            let type = typeof error;\r\n            let err:string;\r\n            switch (type) {\r\n                case 'undefined': err = 'error: undefined'; break;\r\n                case 'string': err = error; break;\r\n                case 'object': err = error.message; break;\r\n                default: err = String(err); break;\r\n            }\r\n            this.fileError = 'error: ' + type + ' - ' + err;\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.props.id);\r\n        this.uploaded = true;\r\n    }\r\n\r\n    private onSaved = (): Promise<void> => {\r\n        let {onSaved} = this.props;\r\n        onSaved && onSaved(this.resId);\r\n        return;\r\n    }\r\n\r\n    private showOrgImage = () => {\r\n        nav.push(<Page header=\"原图\">\r\n            <div className=\"p-3 text-center\">\r\n                <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.srcImage} />\r\n            </div>\r\n        </Page>);\r\n    }\r\n\r\n    private levelDiv() {\r\n        if (this.props.size) return;\r\n        let arr = [{caption:'小图', size:'sm'}];\r\n        if (this.srcImgHeight > mediumSize || this.srcImgWidth > mediumSize) {\r\n            arr.push({caption:'中图', size:'md'});\r\n        }\r\n        if (this.srcImgHeight > largeSize || this.srcImgWidth > largeSize) {\r\n            arr.push({caption:'大图', size:'lg'});\r\n        }\r\n        if (this.srcImgHeight > xlargeSize || this.srcImgWidth > xlargeSize) {\r\n\t\t\tarr.push({caption:'超大图', size:'xl'});\r\n\t\t\tarr.push({caption:'原图', size:'raw'});\r\n        }\r\n        if (arr.length < 2) return;\r\n        return <div>{arr.map((v, index) => {\r\n            let {caption, size} = v;\r\n            return <label key={index} className=\"mr-3\"><input type=\"radio\" name=\"size\" \r\n                onChange={()=>this.setSize(size as any)}\r\n                defaultChecked={index===0} /> {caption}</label>;\r\n        })}</div>\r\n    }\r\n\r\n    render() {\r\n        let {label} = this.props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={this.onSaved}>保存</button>;\r\n        return <Page header={label || '更改图片'} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div className=\"mb-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} \r\n                            multiple={false} maxSize={2048} \r\n                            label=\"选择图片文件\"\r\n                            onFilesChange={this.onFileChange} />\r\n                        <div className=\"small text-muted\">支持 {this.imageTypes.join(', ')} 格式图片。</div>\r\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\r\n                    </div>\r\n                    <LMR left=\r\n                    {\r\n                        this.uploaded === true? \r\n                            <div className=\"text-success p-2\">上传成功！</div>\r\n                            :\r\n                            this.file && this.desImgSize > 0 && <div className=\"mb-3 d-flex align-items-end\">\r\n                                <div className=\"mr-5\">\r\n                                    {this.levelDiv()}\r\n                                    <div>分辨率：{this.desImgWidth} x {this.desImgHeight}\r\n                                    &nbsp; &nbsp;\r\n                                    文件大小：{formatSize(this.desImgSize)}\r\n                                    </div>\r\n                                </div>\r\n                                <button className=\"btn btn-primary\" \r\n                                    disabled={!this.enableUploadButton}\r\n                                    onClick={this.upload}>上传</button>\r\n                            </div>\r\n                    }\r\n                    right={this.desImage && \r\n                        <button className=\"btn btn-link btn-sm text-right mb-3\" onClick={this.showOrgImage}>\r\n                            原图大小: {formatSize(this.file.size)}<br/>\r\n                            分辨率：{this.srcImgWidth} x {this.srcImgHeight}\r\n                        </button>\r\n                    }\r\n                    ></LMR>\r\n                </div>\r\n                <div className=\"text-center\" \r\n                    style={{\r\n                        border: (this.uploaded===true? '2px solid green' : '1px dotted gray'),\r\n                        padding: '8px'\r\n                    }}>\r\n                    <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.desImage} />\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\ninterface AudioUploaderProps {\r\n    id?: string;\r\n    label?: string;\r\n    onSaved?: (imageId:string) => Promise<void>;\r\n}\r\n\r\n@observer\r\nexport class AudioUploader extends React.Component<AudioUploaderProps> {\r\n\tprivate static audioTypes = ['mp3', 'wav'];\r\n\r\n    private suffix: string;\r\n\tprivate resUploader: ResUploader;\r\n\t@observable private content: string;\r\n\t@observable private file: File;    \r\n\t@observable private fileSize: number;\r\n\r\n    @observable private isChanged: boolean = false;\r\n    @observable private resId: string;\r\n    @observable private enableUploadButton: boolean = false;\r\n    @observable private fileError: string;\r\n\t@observable private uploaded: boolean = false;\r\n\t@observable private uploading: boolean = false;\r\n\r\n    constructor(props: AudioUploaderProps) {\r\n        super(props);\r\n        this.resId = props.id;\r\n    }\r\n\r\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.fileError = undefined;\r\n        this.uploaded = false;\r\n        this.enableUploadButton = evt.target.files.length > 0;\r\n        if (this.enableUploadButton) {\r\n            this.file = evt.target.files[0];\r\n            let pos = this.file.name.lastIndexOf('.');\r\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\r\n            if(AudioUploader.audioTypes.indexOf(this.suffix) < 0){\r\n                this.fileError = `音频类型必须是 ${AudioUploader.audioTypes.join(', ')} 中的一种`;\r\n                return;\r\n            }\r\n            let reader = new FileReader();\r\n            reader.readAsDataURL(this.file);\r\n            reader.onload = async () => {\r\n\t\t\t\tthis.content = reader.result as string;\r\n\t\t\t\tthis.fileSize = this.content.length;\r\n            };\r\n        }\r\n    }\r\n\r\n    private convertBase64UrlToBlob(urlData: string):Blob {\r\n        let arr = urlData.split(',');\r\n        let mime = arr[0].match(/:(.*?);/)[1];\r\n        let bstr = atob(arr[1]);\r\n        let n = bstr.length;\r\n        let u8arr = new Uint8Array(n);\r\n        while(n--){\r\n            u8arr[n] = bstr.charCodeAt(n);\r\n        }\r\n        return new Blob([u8arr], {type:mime});\r\n    }\r\n\r\n    private upload = async () => {\r\n\t\tif (!this.resUploader) return;\r\n\t\tthis.uploading = true;\r\n        let formData = new FormData();\r\n        let blob = this.convertBase64UrlToBlob(this.content);\r\n        formData.append('image', blob, this.file.name);\r\n        let ret = await this.resUploader.upload(formData);\r\n        if (typeof ret === 'object') {\r\n            let {error} = ret;\r\n            let type = typeof error;\r\n            let err:string;\r\n            switch (type) {\r\n                case 'undefined': err = 'error: undefined'; break;\r\n                case 'string': err = error; break;\r\n                case 'object': err = error.message; break;\r\n                default: err = String(err); break;\r\n            }\r\n            this.fileError = 'error: ' + type + ' - ' + err;\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.props.id);\r\n        this.uploaded = true;\r\n    }\r\n\r\n    private onSaved = (): Promise<void> => {\r\n        let {onSaved} = this.props;\r\n        onSaved && onSaved(this.resId);\r\n        return;\r\n    }\r\n\r\n    render() {\r\n        let {label} = this.props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={this.onSaved}>保存</button>;\r\n        return <Page header={label || '更改文件'} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div className=\"mb-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} \r\n                            multiple={false} maxSize={2048} \r\n                            label=\"选择音频文件\"\r\n                            onFilesChange={this.onFileChange} />\r\n                        <div className=\"small text-muted\">支持 {AudioUploader.audioTypes.join(', ')} 格式。</div>\r\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\t\t\t<LMR left=\r\n                    {\r\n                        this.uploaded === true? \r\n                            <div className=\"text-success p-2\">上传成功！</div>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\tthis.uploading === true?\r\n\t\t\t\t\t\t\t\t<div className=\"m-3\"><Loading /></div>\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\tthis.file && this.content && <div className=\"m-3\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"mb-3\">\r\n\t\t\t\t\t\t\t\t\t\t文件大小：{formatSize(this.fileSize)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary\" \r\n\t\t\t\t\t\t\t\t\t\tdisabled={!this.enableUploadButton}\r\n\t\t\t\t\t\t\t\t\t\tonClick={this.upload}>上传</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t/>\r\n        </Page>;\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport classNames from 'classnames';\r\nimport { nav } from \"../nav\";\r\n\r\nexport interface AxProps extends React.DetailedHTMLProps<React.AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement> {\r\n\t//children: React.ReactNode;\r\n\t//href: string;\r\n\t//onClick?: (event:React.MouseEvent) => void;\r\n\t//className?: string;\r\n\taClassName?: string;\r\n\tnaClassName?: string;\r\n\t//target?: string;\r\n\t//props?: any;\r\n}\r\n\r\n// 如果是web方式，用webNav方式route网页\r\n// 如果是app方式，用click方式压栈页面\r\nexport const Ax = (axProps: AxProps) => {\r\n\tlet {href, children, className, onClick} = axProps;\r\n\tif (nav.isWebNav === true) {\r\n\t\tlet {aClassName } = axProps;\r\n\t\tif (!href) return <span className=\"text-danger\">Error: href not defined in Ax</span>;\r\n\t\tlet onAxClick = (evt: React.MouseEvent<HTMLAnchorElement>) => {\r\n\t\t\tevt.preventDefault();\r\n\t\t\tlet ret:boolean;\r\n\t\t\tif (onClick) {\r\n\t\t\t\tret = onClick(evt) as unknown as boolean;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnav.navigate(href);\r\n\t\t\t\tret = false;\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\treturn <a {...axProps} className={classNames(className, aClassName)} onClick={onAxClick}>{children}</a>;\r\n\t}\r\n\telse {\r\n\t\tlet {naClassName} = axProps;\r\n\t\tif (!onClick) {\r\n\t\t\tonClick = () => {\r\n\t\t\t\tnav.openSysPage(href); //.navigate(href);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn <span className={classNames(className, 'cursor-pointer', naClassName)} onClick={onClick}>{children}</span>;\r\n\t}\r\n}\r\n\r\n// 同普通的a tag\r\n// 会自动处理href，处理生产版跟测试版之间的不同\r\nexport const A = (props: React.DetailedHTMLProps<React.AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement>) => {\r\n\tlet {children} = props;\r\n\tif (nav.isWebNav === false) {\r\n\t\treturn <a {...props}>{children}</a>;\r\n\t}\r\n\tlet {href} = props;\r\n\t//if (nav.testing === true) href += '#test';\r\n\tlet onClick = (evt: React.MouseEvent<HTMLAnchorElement>) => {\r\n\t\tevt.preventDefault();\r\n\t\tnav.navigate(href);\r\n\t\treturn false;\r\n\t}\r\n\treturn <a {...props} href={href} onClick={onClick}>{children}</a>;\r\n}\r\n","import _ from 'lodash';\r\nimport { UqApi, UqData, UnitxApi, appInFrame } from '../net';\r\nimport { Tuid, TuidDiv, TuidImport, TuidInner, TuidBox, TuidsCache } from './tuid';\r\nimport { Action } from './action';\r\nimport { Sheet } from './sheet';\r\nimport { Query } from './query';\r\nimport { Book } from './book';\r\nimport { History } from './history';\r\nimport { Map } from './map';\r\nimport { Pending } from './pending';\r\nimport { CreateBoxId, BoxId } from './tuid';\r\nimport { LocalMap, LocalCache } from '../tool';\r\nimport { UQsMan } from './uqsMan';\r\nimport { ReactBoxId } from './tuid/reactBoxId';\r\nimport { Tag } from './tag/tag';\r\nimport { UqEnum } from './enum';\r\nimport { Entity } from './entity';\r\n\r\nexport type FieldType = 'id' | 'tinyint' | 'smallint' | 'int' | 'bigint' | 'dec' | 'char' | 'text'\r\n    | 'datetime' | 'date' | 'time' | 'timestamp';\r\n\r\nexport function fieldDefaultValue(type:FieldType) {\r\n    switch (type) {\r\n        case 'tinyint':\r\n        case 'smallint':\r\n        case 'int':\r\n        case 'bigint':\r\n        case 'dec':\r\n            return 0;\r\n        case 'char':\r\n        case 'text':\r\n            return '';\r\n        case 'datetime':\r\n        case 'date':\r\n            return '2000-1-1';\r\n        case 'time':\r\n            return '0:00';\r\n    }\r\n}\r\n\r\nexport interface Field {\r\n    name: string;\r\n    type: FieldType;\r\n    tuid?: string;\r\n    arr?: string;\r\n    null?: boolean;\r\n    size?: number;\r\n    owner?: string;\r\n    _tuid: TuidBox;\r\n}\r\nexport interface ArrFields {\r\n    name: string;\r\n    fields: Field[];\r\n    id?: string;\r\n    order?: string;\r\n}\r\nexport interface FieldMap {\r\n    [name:string]: Field;\r\n}\r\nexport interface SchemaFrom {\r\n    owner:string;\r\n    uq:string;\r\n}\r\nexport interface TuidModify {\r\n    max: number;\r\n    seconds: number;\r\n}\r\n\r\nexport class UqMan {\r\n\tprivate readonly enums: {[name:string]: UqEnum} = {};\r\n    private readonly actions: {[name:string]: Action} = {};\r\n    private readonly sheets: {[name:string]: Sheet} = {};\r\n    private readonly queries: {[name:string]: Query} = {};\r\n    private readonly books: {[name:string]: Book} = {};\r\n    private readonly maps: {[name:string]: Map} = {};\r\n    private readonly histories: {[name:string]: History} = {};\r\n\tprivate readonly pendings: {[name:string]: Pending} = {};\r\n\tprivate readonly tags: {[name:string]: Tag} = {};\r\n    private readonly tuidsCache: TuidsCache;\r\n    private readonly localAccess: LocalCache;\r\n    private readonly tvs:{[entity:string]:(values:any)=>JSX.Element};\r\n    readonly localMap: LocalMap;\r\n    readonly localModifyMax: LocalCache;\r\n    readonly tuids: {[name:string]: Tuid} = {};\r\n    readonly createBoxId: CreateBoxId;\r\n    readonly newVersion: boolean;\r\n    readonly uqOwner: string;\r\n    readonly uqName: string;\r\n    readonly name: string;\r\n    readonly uqApi: UqApi;\r\n    readonly id: number;\r\n\r\n    uqVersion: number;\r\n\r\n    constructor(uqs:UQsMan, uqData: UqData, createBoxId:CreateBoxId, tvs:{[entity:string]:(values:any)=>JSX.Element}) {\r\n        this.createBoxId = createBoxId;\r\n        if (createBoxId === undefined) {\r\n            this.createBoxId = this.createBoxIdFromTVs;\r\n            this.tvs = tvs || {};\r\n        }\r\n        let {id, uqOwner, uqName, access, newVersion} = uqData;\r\n        this.newVersion = newVersion;\r\n        this.uqOwner = uqOwner;\r\n        this.uqName = uqName;\r\n        this.id = id;\r\n        this.name = uqOwner + '/' + uqName;\r\n        this.uqVersion = 0;\r\n        this.localMap = uqs.localMap.map(this.name);\r\n        this.localModifyMax = this.localMap.child('$modifyMax');\r\n        this.localAccess = this.localMap.child('$access');\r\n        //let hash = document.location.hash;\r\n        let baseUrl = 'tv/';\r\n\r\n        let acc: string[];\r\n        if (access === null || access === undefined || access === '*') {\r\n            acc = [];\r\n        }\r\n        else {\r\n            acc = access.split(';').map(v => v.trim()).filter(v => v.length > 0);\r\n        }\r\n        if (this.name === '$$$/$unitx') {\r\n            // 这里假定，点击home link之后，已经设置unit了\r\n            // 调用 UnitxApi会自动搜索绑定 unitx service\r\n            this.uqApi = new UnitxApi(appInFrame.unit);\r\n        }\r\n        else {\r\n            let {appOwner, appName} = uqs;\r\n            this.uqApi = new UqApi(baseUrl, appOwner, appName, uqOwner, uqName, acc, true);\r\n        }\r\n        this.tuidsCache = new TuidsCache(this);\r\n    }\r\n\r\n    get entities() {\r\n        return _.merge({}, \r\n            this.actions, this.sheets, this.queries, this.books,\r\n\t\t\tthis.maps, this.histories, this.pendings, this.tuids,\r\n\t\t\tthis.tags,\r\n        );\r\n    }\r\n\r\n    private createBoxIdFromTVs:CreateBoxId = (tuid:Tuid, id:number):BoxId =>{\r\n        let {name} = tuid;\r\n        /*\r\n        let tuidUR = this.tuidURs[name];\r\n        if (tuidUR === undefined) {\r\n            let {ui, res} = this.getUI(tuid);\r\n            this.tuidURs[name] = tuidUR = new TuidWithUIRes(tuid, ui, res);\r\n        }\r\n        */\r\n        return new ReactBoxId(id, tuid, this.tvs[name]);\r\n    }\r\n\r\n    tuid(name:string):Tuid {return this.tuids[name.toLowerCase()]}\r\n    tuidDiv(name:string, div:string):TuidDiv {\r\n        let tuid = this.tuids[name.toLowerCase()]\r\n        return tuid && tuid.div(div.toLowerCase());\r\n    }\r\n    action(name:string):Action {return this.actions[name.toLowerCase()]}\r\n    sheet(name:string):Sheet {return this.sheets[name.toLowerCase()]}\r\n    query(name:string):Query {return this.queries[name.toLowerCase()]}\r\n    book(name:string):Book {return this.books[name.toLowerCase()]}\r\n    map(name:string):Map {return this.maps[name.toLowerCase()]}\r\n    history(name:string):History {return this.histories[name.toLowerCase()]}\r\n    pending(name:string):Pending {return this.pendings[name.toLowerCase()]}\r\n\r\n    sheetFromTypeId(typeId:number):Sheet {\r\n        for (let i in this.sheets) {\r\n            let sheet = this.sheets[i];\r\n            if (sheet.typeId === typeId) return sheet;\r\n        }\r\n    }\r\n\r\n    readonly tuidArr: Tuid[] = [];\r\n    readonly actionArr: Action[] = [];\r\n    readonly enumArr: UqEnum[] = [];\r\n    readonly sheetArr: Sheet[] = [];\r\n    readonly queryArr: Query[] = [];\r\n    readonly bookArr: Book[] = [];\r\n    readonly mapArr: Map[] = [];\r\n    readonly historyArr: History[] = [];\r\n    readonly pendingArr: Pending[] = [];\r\n    readonly tagArr: Tag[] = [];\r\n\r\n    async init() {\r\n        await this.uqApi.init();\r\n    }\r\n\r\n    async loadEntities(): Promise<string> {\r\n        try {\r\n            let accesses = this.localAccess.get();\r\n            if (!accesses) {\r\n                accesses = await this.uqApi.loadAccess();\r\n            }\r\n            if (!accesses) return;\r\n            this.buildEntities(accesses);\r\n        }\r\n        catch (err) {\r\n            return err;\r\n        }\r\n    }\r\n\r\n\tbuildEntities(entities:any) {\r\n        if (entities === undefined) {\r\n            debugger;\r\n        }\r\n        this.localAccess.set(entities);\r\n        let {access, tuids, version} = entities;\r\n        this.uqVersion = version;\r\n        this.buildTuids(tuids);\r\n        this.buildAccess(access);\r\n\t}\r\n\t\r\n    private buildTuids(tuids:any) {\r\n        for (let i in tuids) {\r\n            let schema = tuids[i];\r\n            let {typeId, from} = schema;\r\n            let tuid = this.newTuid(i, typeId, from);\r\n            tuid.sys = true;\r\n        }\r\n        for (let i in tuids) {\r\n            let schema = tuids[i];\r\n            let tuid = this.getTuid(i);\r\n            tuid.setSchema(schema);\r\n        }\r\n        for (let i in this.tuids) {\r\n            let tuid = this.tuids[i];\r\n            tuid.buildFieldsTuid();\r\n        }\r\n\t}\r\n\r\n    async loadEntitySchema(entityName: string): Promise<any> {\r\n        return await this.uqApi.schema(entityName);\r\n    }\r\n\r\n\tasync loadAllSchemas():Promise<void> {\r\n\t\tlet ret = await this.uqApi.allSchemas();\r\n\t\tlet entities: Entity[][] = [\r\n\t\t\tthis.actionArr, \r\n\t\t\tthis.enumArr,\r\n\t\t\tthis.sheetArr,\r\n\t\t\tthis.queryArr,\r\n\t\t\tthis.bookArr,\r\n\t\t\tthis.mapArr,\r\n\t\t\tthis.historyArr,\r\n\t\t\tthis.pendingArr,\r\n\t\t\tthis.tagArr,\r\n\t\t];\r\n\t\tentities.forEach(arr => {\r\n\t\t\tarr.forEach(v => {\r\n\t\t\t\tlet entity = ret[v.name.toLowerCase()];\r\n\t\t\t\tif (!entity) return;\r\n\t\t\t\tlet schema = entity.call;\r\n\t\t\t\tif (!schema) return;\r\n\t\t\t\tv.buildSchema(schema);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n    getTuid(name:string): Tuid {\r\n        return this.tuids[name];\r\n    }\r\n\r\n    private buildAccess(access:any) {\r\n        for (let a in access) {\r\n            let v = access[a];\r\n            switch (typeof v) {\r\n                case 'string': this.fromType(a, v); break;\r\n                case 'object': this.fromObj(a, v); break;\r\n            }\r\n        }\r\n    }\r\n\r\n    cacheTuids(defer:number) {\r\n        this.tuidsCache.cacheTuids(defer);\r\n    }\r\n\r\n    newEnum(name:string, id:number):UqEnum {\r\n        let enm = this.enums[name];\r\n        if (enm !== undefined) return enm;\r\n        enm = this.enums[name] = new UqEnum(this, name, id)\r\n        this.enumArr.push(enm);\r\n        return enm;\r\n    }\r\n\tnewAction(name:string, id:number):Action {\r\n        let action = this.actions[name];\r\n        if (action !== undefined) return action;\r\n        action = this.actions[name] = new Action(this, name, id)\r\n        this.actionArr.push(action);\r\n        return action;\r\n    }\r\n    private newTuid(name:string, id:number, from:SchemaFrom):Tuid {\r\n        let tuid = this.tuids[name];\r\n        if (tuid !== undefined) return tuid;\r\n        if (from !== undefined)\r\n            tuid = new TuidImport(this, name, id, from);\r\n        else\r\n            tuid = new TuidInner(this, name, id);\r\n        this.tuids[name] = tuid;\r\n        this.tuidArr.push(tuid);\r\n        return tuid;\r\n    }\r\n    newQuery(name:string, id:number):Query {\r\n        let query = this.queries[name];\r\n        if (query !== undefined) return query;\r\n        query = this.queries[name] = new Query(this, name, id)\r\n        this.queryArr.push(query);\r\n        return query;\r\n    }\r\n    private newBook(name:string, id:number):Book {\r\n        let book = this.books[name];\r\n        if (book !== undefined) return book;\r\n        book = this.books[name] = new Book(this, name, id);\r\n        this.bookArr.push(book);\r\n        return book;\r\n    }\r\n    private newMap(name:string, id:number):Map {\r\n        let map = this.maps[name];\r\n        if (map !== undefined) return map;\r\n        map = this.maps[name] = new Map(this, name, id)\r\n        this.mapArr.push(map);\r\n        return map;\r\n    }\r\n    private newTag(name:string, id:number):Tag {\r\n        let tag = this.tags[name];\r\n        if (tag !== undefined) return tag;\r\n        tag = this.tags[name] = new Tag(this, name, id)\r\n        this.tagArr.push(tag);\r\n        return tag;\r\n    }\r\n    private newHistory(name:string, id:number):History {\r\n        let history = this.histories[name];\r\n        if (history !== undefined) return;\r\n        history = this.histories[name] = new History(this, name, id)\r\n        this.historyArr.push(history);\r\n        return history;\r\n    }\r\n    private newPending(name:string, id:number):Pending {\r\n        let pending = this.pendings[name];\r\n        if (pending !== undefined) return;\r\n        pending = this.pendings[name] = new Pending(this, name, id)\r\n        this.pendingArr.push(pending);\r\n        return pending;\r\n    }\r\n    newSheet(name:string, id:number):Sheet {\r\n        let sheet = this.sheets[name];\r\n        if (sheet !== undefined) return sheet;\r\n        sheet = this.sheets[name] = new Sheet(this, name, id);\r\n        this.sheetArr.push(sheet);\r\n        return sheet;\r\n    }\r\n    private fromType(name:string, type:string) {\r\n        let parts = type.split('|');\r\n        type = parts[0];\r\n        let id = Number(parts[1]);\r\n        switch (type) {\r\n            //case 'uq': this.id = id; break;\r\n            case 'tuid':\r\n                // Tuid should not be created here!;\r\n                //let tuid = this.newTuid(name, id);\r\n                //tuid.sys = false;\r\n                break;\r\n            case 'action': this.newAction(name, id); break;\r\n            case 'query': this.newQuery(name, id); break;\r\n            case 'book': this.newBook(name, id); break;\r\n            case 'map': this.newMap(name, id); break;\r\n            case 'history': this.newHistory(name, id); break;\r\n            case 'sheet':this.newSheet(name, id); break;\r\n\t\t\tcase 'pending': this.newPending(name, id); break;\r\n\t\t\tcase 'tag': this.newTag(name, id); break;\r\n\t\t\tcase 'enum': this.newEnum(name, id); break;\r\n        }\r\n    }\r\n    private fromObj(name:string, obj:any) {\r\n        switch (obj['$']) {\r\n            case 'sheet': this.buildSheet(name, obj); break;\r\n        }\r\n    }\r\n    private buildSheet(name:string, obj:any) {\r\n        let sheet = this.sheets[name];\r\n        if (sheet === undefined) sheet = this.newSheet(name, obj.id);\r\n        sheet.build(obj);\r\n    }\r\n    buildFieldTuid(fields:Field[], mainFields?:Field[]) {\r\n        if (fields === undefined) return;\r\n        for (let f of fields) {\r\n            let {tuid} = f;\r\n            if (tuid === undefined) continue;\r\n            let t = this.getTuid(tuid);\r\n            if (t === undefined) continue;\r\n            f._tuid = t.buildTuidBox();\r\n        }\r\n        for (let f of fields) {\r\n            let {owner} = f;\r\n            if (owner === undefined) continue;\r\n            let ownerField = fields.find(v => v.name === owner);\r\n            if (ownerField === undefined) {\r\n                if (mainFields !== undefined) {\r\n                    ownerField = mainFields.find(v => v.name === owner);\r\n                }\r\n                if (ownerField === undefined) {\r\n                    debugger;\r\n                    throw new Error(`owner field ${owner} is undefined`);\r\n                }\r\n            }\r\n            let {arr, tuid} = f;\r\n            let t = this.getTuid(ownerField._tuid.tuid.name);\r\n            if (t === undefined) continue;\r\n            let div = t.div(arr || tuid);\r\n            f._tuid = div && div.buildTuidDivBox(ownerField);\r\n            if (f._tuid === undefined) {\r\n                debugger;\r\n                throw new Error(`owner field ${owner} is not tuid`);\r\n            }\r\n        }\r\n    }\r\n    buildArrFieldsTuid(arrFields:ArrFields[], mainFields:Field[]) {\r\n        if (arrFields === undefined) return;\r\n        for (let af of arrFields) {\r\n            let {fields} = af;\r\n            if (fields === undefined) continue;\r\n            this.buildFieldTuid(fields, mainFields);\r\n        }\r\n    }\r\n\r\n    pullModify(modifyMax:number) {\r\n        this.tuidsCache.pullModify(modifyMax);\r\n    }\r\n}\r\n","import { Entity } from './entity';\r\nimport { PageItems } from '../tool/pageItems';\r\nimport { EntityCaller } from './caller';\r\nimport { ArrFields, Field } from './uqMan';\r\n\r\nexport interface SheetState {\r\n    name: string;\r\n    actions: SheetAction[];\r\n}\r\n\r\nexport interface SheetAction {\r\n    name: string;\r\n}\r\n\r\nexport interface StateCount {\r\n    state: string;\r\n    count: number;\r\n}\r\n\r\nexport interface SheetSaveReturnV<V> {\r\n\tid: number;\r\n\tflow: number;\r\n\tstate: string;\r\n\tverify: V[];\r\n}\r\n\r\nexport interface SheetSaveReturn extends SheetSaveReturnV<any> {\r\n}\r\n\r\ninterface GetSheetReturn<M> {\r\n\tbrief: any;\r\n\tdata: M;\r\n\tflows: any[];\r\n}\r\n\r\nexport class UqSheet<M, V> extends Entity {\r\n    get typeName(): string { return 'sheet';}\r\n\tstates: SheetState[];\r\n\tverify: {returns: ArrFields[]};\r\n\r\n    /*\r\n    setStates(states: SheetState[]) {\r\n        for (let state of states) {\r\n            this.setStateAccess(this.states.find(s=>s.name==state.name), state);\r\n        }\r\n    }*/\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n\t\tthis.states = schema.states;\r\n\t\tthis.verify = schema.verify;\r\n    }\r\n    build(obj:any) {\r\n        this.states = [];\r\n        for (let op of obj.ops) {\r\n            this.states.push({name: op, actions:undefined});\r\n        }\r\n        /*\r\n        for (let p in obj) {\r\n            switch(p) {\r\n                case '#':\r\n                case '$': continue;\r\n                default: this.states.push(this.createSheetState(p, obj[p])); break;\r\n            }\r\n        }*/\r\n    }\r\n    private createSheetState(name:string, obj:object):SheetState {\r\n        let ret:SheetState = {name:name, actions:[]};\r\n        let actions = ret.actions;\r\n        for (let p in obj) {\r\n            let action:SheetAction = {name: p};\r\n            actions.push(action);\r\n        }\r\n        return ret;\r\n    }\r\n    async save(discription:string, data:M):Promise<SheetSaveReturn> {\r\n        let {id} = this.uq;\r\n        let params = {app: id, discription: discription, data:data};\r\n        return await new SaveCaller(this, params).request();\r\n    }\r\n    async saveDebugDirect(discription:string, data:M):Promise<SheetSaveReturn> {\r\n        let {id} = this.uq;\r\n        let params = {app: id, discription: discription, data:data};\r\n        return await new SaveDirectCaller(this, params).request();\r\n    }\r\n    async action(id:number, flow:number, state:string, action:string) {\r\n        return await new ActionCaller(this, {id:id, flow:flow, state:state, action:action}).request();\r\n    }\r\n    async actionDebugDirect(id:number, flow:number, state:string, action:string) {\r\n        return await new ActionDirectCaller(this, {id:id, flow:flow, state:state, action:action}).request();\r\n    }\r\n    private unpack(data:any):GetSheetReturn<M> {\r\n        //if (this.schema === undefined) await this.loadSchema();\r\n        let ret = data[0];\r\n        let brief = ret[0];\r\n        let sheetData = this.unpackSheet(brief.data);\r\n        let flows = data[1];\r\n        return {\r\n            brief: brief,\r\n            data: sheetData,\r\n            flows: flows,\r\n        }\r\n    }\r\n    async getSheet(id:number):Promise<GetSheetReturn<M>> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.getSheet(this.name, id);\r\n        */\r\n        let ret = await new GetSheetCaller(this, id).request();\r\n        if (ret[0].length === 0) return await this.getArchive(id);\r\n        return this.unpack(ret);\r\n    }\r\n    async getArchive(id:number):Promise<GetSheetReturn<M>> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.sheetArchive(this.name, id)\r\n        return this.unpack(ret);\r\n        */\r\n        let ret = await new SheetArchiveCaller(this, id).request();\r\n        return this.unpack(ret);\r\n    }\r\n\r\n    async getArchives(pageStart:number, pageSize:number) {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.sheetArchives(this.name, {pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {pageStart:pageStart, pageSize:pageSize};\r\n        return await new SheetArchivesCaller(this, params).request();\r\n    }\r\n\r\n    async getStateSheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.stateSheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\r\n        return await new StateSheetsCaller(this, params).request();\r\n    }\r\n    createPageStateItems<T>(): PageStateItems<T> {return new PageStateItems<T>(this);}\r\n\r\n    async stateSheetCount():Promise<StateCount[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret:StateCount[] = await this.uqApi.stateSheetCount(this.name);\r\n        return this.states.map(s => {\r\n            let n = s.name, count = 0;\r\n            let r = ret.find(v => v.state === n);\r\n            if (r !== undefined) count = r.count;\r\n            return {state: n, count: count} \r\n        });\r\n        */\r\n        return await new StateSheetCountCaller(this, undefined).request();\r\n    }\r\n\r\n    async userSheets(state:string, user:number, pageStart:number, pageSize:number):Promise<any[]> {\r\n        let params = {state:state, user:user, pageStart:pageStart, pageSize:pageSize};\r\n        return await new UserSheetsCaller(this, params).request();\r\n    }\r\n\r\n    async mySheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.mySheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\r\n        return await new MySheetsCaller(this, params).request();\r\n    }\r\n}\r\n\r\nexport class Sheet extends UqSheet<any, any> {\r\n}\r\n\r\nabstract class SheetCaller<T> extends EntityCaller<T> {\r\n    protected get entity(): Sheet {return this._entity as Sheet;}\r\n    protected readonly suffix:string;\r\n    get path():string {return `sheet/${this.entity.name}/${this.suffix}`;}\r\n}\r\n\r\nclass SaveCaller extends SheetCaller<{app:number; discription:string; data:any}> {\r\n    get path():string {return `sheet/${this.entity.name}`;}\r\n    buildParams() {\r\n        let {app, discription, data} = this.params;\r\n        return {\r\n            app: app,\r\n            discription: discription,\r\n            data: this.entity.pack(data)\r\n        };\r\n    }\r\n    xresult(res:any):any {\r\n\t\tlet {verify} = this.entity;\r\n\t\tif (verify === undefined) return res;\r\n\t\tlet resVerify = res.verify;\r\n\t\tif (resVerify === undefined || resVerify.length === 0) {\r\n\t\t\tres.verify = undefined;\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\tlet {returns} = verify;\r\n\t\tres.verify = this.entity.unpackReturns(resVerify, returns);\r\n        return res;\r\n    }\r\n}\r\n\r\nclass SaveDirectCaller extends SaveCaller {\r\n    get path():string {return `sheet/${this.entity.name}/direct`;}\r\n}\r\n\r\nclass ActionCaller extends SheetCaller<{id:number, flow:number, state:string, action:string}> {\r\n    method = 'PUT';\r\n    get path():string {return `sheet/${this.entity.name}`;}\r\n}\r\n\r\nclass ActionDirectCaller extends ActionCaller {\r\n    get path():string {return `sheet/${this.entity.name}/direct`;}\r\n}\r\n\r\nclass GetSheetCaller extends SheetCaller<number> {\r\n    //protected readonly params: number;  // id\r\n    method = 'GET';\r\n    //private id:number;\r\n    //protected readonly suffix = 'archive';\r\n    buildParams() {}\r\n    get path():string {return `sheet/${this.entity.name}/get/${this.params}`;}\r\n}\r\n\r\nclass SheetArchiveCaller extends SheetCaller<number> {\r\n    //protected readonly params: number;  // id\r\n    method = 'GET';\r\n    //protected readonly suffix = 'archive';\r\n    buildParams() {}\r\n    get path():string {return `sheet/${this.entity.name}/archive/${this.params}`;}\r\n}\r\n\r\nclass SheetArchivesCaller extends SheetCaller<{pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'archives';\r\n}\r\n\r\nclass StateSheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'states';\r\n}\r\n\r\nclass StateSheetCountCaller extends SheetCaller<undefined> {\r\n    method = 'GET';\r\n    protected readonly suffix = 'statecount';\r\n    xresult(res:any):any {\r\n        let {states} = this.entity;\r\n        return states.map(s => {\r\n            let n = s.name, count = 0;\r\n            let r = (res as any[]).find(v => v.state === n);\r\n            if (r !== undefined) count = r.count;\r\n            return {state: n, count: count} \r\n        });\r\n    }\r\n}\r\n\r\nclass UserSheetsCaller extends SheetCaller<{state:string, user:number, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'user-sheets';\r\n    xresult(res:any):any {\r\n        return res;\r\n    }\r\n}\r\n\r\nclass MySheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'my-sheets';\r\n    xresult(res:any):any {\r\n        return res;\r\n    }\r\n}\r\n\r\nexport class PageStateItems<T> extends PageItems<T> {\r\n    private sheet: Sheet;\r\n    constructor(sheet: Sheet) {\r\n        super(true);\r\n        this.sheet = sheet;\r\n        this.pageSize = 10;\r\n\t}\r\n\tprotected async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\r\n\t\treturn {$page: ret};\r\n\t}\r\n\t/*\r\n    protected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\r\n        let ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\r\n        return ret;\r\n\t}\r\n\t*/\r\n\tprotected getPageId(item:T) {\r\n\t\treturn item === undefined? 0 : (item as any).id;\r\n\t}\r\n\t/*\r\n    protected setPageStart(item:any) {\r\n        this.pageStart = item === undefined? 0 : item.id;\r\n\t}\r\n\t*/\r\n}\r\n","import {Query} from './query';\r\nimport { QueryQueryCaller } from './caller';\r\n\r\nexport class Book extends Query {\r\n    get typeName(): string { return 'book';}\r\n    protected queryApiName = 'book';\r\n\r\n    protected queryCaller(params: any): QueryQueryCaller {\r\n        return new BookQueryCaller(this, params);\r\n    }\r\n}\r\n\r\nexport class BookQueryCaller extends QueryQueryCaller {\r\n    get path():string {return `book/${this.entity.name}`;}\r\n}\r\n","import {Query} from './query';\r\n\r\nexport class History extends Query {\r\n    get typeName(): string { return 'history';}\r\n    protected queryApiName = 'history';\r\n}\r\n","import { Entity } from './entity';\r\nimport { Action, ActionSubmitCaller } from './action';\r\nimport { Query } from './query';\r\nimport { Field } from './uqMan';\r\nimport { EntityCaller, QueryPageCaller, QueryQueryCaller } from './caller';\r\n\r\ninterface MapActions {\r\n    add: Action;\r\n    del: Action;\r\n}\r\ninterface MapQueries {\r\n    all: Query;\r\n    page: Query;\r\n    query: Query;\r\n}\r\n\r\nexport class Map extends Entity {\r\n    get typeName(): string { return 'map';}\r\n    keys: Field[];\r\n    actions: MapActions = {} as any;\r\n    queries: MapQueries = {} as any;\r\n    schemaFrom: {owner:string; uq:string};\r\n\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        this.schemaFrom = this.schema.from;\r\n        let {actions, queries, keys} = schema;\r\n        this.uq.buildFieldTuid(this.keys = keys);\r\n        for (let i in actions) {\r\n            let actionSchema = actions[i];\r\n            let {name} = actionSchema;\r\n            let action = this.uq.newAction(name, undefined);\r\n            action.setSchema(actionSchema);\r\n            action.buildFieldsTuid();\r\n            (this.actions as any)[i] = action;\r\n        }\r\n        for (let i in queries) {\r\n            let querySchema = queries[i];\r\n            let {name} = querySchema;\r\n            let query = this.uq.newQuery(name, undefined);\r\n            query.setSchema(querySchema);\r\n            query.buildFieldsTuid();\r\n            (this.queries as any)[i] = query;\r\n        }\r\n    }\r\n\r\n    async add(param:any) {\r\n        let ret = await new AddCaller(this, param).request();\r\n        return ret;\r\n    }\r\n\r\n    async del(param:any) {\r\n        let ret = await new DelCaller(this, param).request();\r\n        return ret;\r\n    }\r\n\r\n    async all() {\r\n        let ret = await new AllCaller(this, undefined).request();\r\n        return ret;\r\n    }\r\n\r\n    async page(param:any, pageStart:any, pageSize: number) {\r\n        let ret = await new PageCaller(this, {pageStart:pageStart, pageSize:pageSize, param:param}).request();\r\n        return ret;\r\n    }\r\n\r\n    async query(param:any) {\r\n       let qc = new QueryCaller(this, param);\r\n       let ret = await qc.request();\r\n       return ret;\r\n   }\r\n    async table(params:any): Promise<any[]> {\r\n        let ret = await this.query(params);\r\n        for (let i in ret) {\r\n            return ret[i];\r\n        }\r\n    }\r\n    async obj(params:any):Promise<any> {\r\n        let ret = await this.table(params);\r\n        if (ret.length > 0) return ret[0];\r\n    }\r\n    async scalar(params:any):Promise<any> {\r\n        let ret = await this.obj(params);\r\n        for (let i in ret) return ret[i];\r\n    }\r\n}\r\n\r\nabstract class MapCaller extends EntityCaller<any> {\r\n    protected get entity(): Map {return this._entity as Map;}\r\n    get path():string {return undefined;}\r\n\r\n    protected abstract getCaller(param: any):EntityCaller<any>;\r\n\r\n    protected async innerCall(): Promise<any> {\r\n        let caller = this.getCaller(this.params);\r\n        let res = await this.entity.uqApi.xcall(caller);\r\n        let ret = caller.xresult(res.res);\r\n        return {res: ret};\r\n    }\r\n\r\n    buildParams() {\r\n        let p = super.buildParams();\r\n        return p;\r\n    }\r\n}\r\n\r\nclass AddCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapAddCaller(this.entity, this.entity.actions.add, param);\r\n    }\r\n}\r\n\r\nclass DelCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapDelCaller(this.entity, this.entity.actions.add, param);\r\n    }\r\n}\r\n\r\nclass AllCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapAllCaller(this.entity, this.entity.queries.all, param);\r\n    }\r\n}\r\n\r\nclass PageCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapPageCaller(this.entity, this.entity.queries.page, param);\r\n    }\r\n}\r\n\r\nclass QueryCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapQueryCaller(this.entity, this.entity.queries.query, param);\r\n    }\r\n}\r\n\r\nclass MapAddCaller extends ActionSubmitCaller {\r\n    private map: Map;\r\n    constructor(map:Map, action:Action, params:any) {\r\n        super(action, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/add`}\r\n    get headers(): {[header:string]: string} {return undefined;}\r\n}\r\n\r\nclass MapDelCaller extends ActionSubmitCaller {\r\n    private map: Map;\r\n    constructor(map:Map, action:Action, params:any) {\r\n        super(action, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/del`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapAllCaller extends QueryPageCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/all`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapPageCaller extends QueryPageCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/page`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapQueryCaller extends QueryQueryCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/query`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n","import {Query} from './query';\r\n\r\nexport class Pending extends Query {\r\n    get typeName(): string { return 'pending';}\r\n    protected queryApiName = 'pending';\r\n}\r\n","import { Entity } from \"./entity\";\r\n\r\nexport class UqEnum extends Entity {\r\n    get typeName(): string { return 'enum';}\r\n}","import * as React from 'react';\r\nimport { IValuesView, IValuesViewRenderOptions } from '../../components';\r\nimport { Tag, TagValue } from './tag';\r\n\r\nconst radioStyle:React.CSSProperties = {height: 'auto'};\r\n\r\nexport class TagView implements IValuesView {\r\n\tprivate tag: Tag;\r\n\tconstructor(tag: Tag) {\r\n\t\tthis.tag = tag;\r\n\t}\r\n\trender(values: number|string):JSX.Element {\r\n\t\tlet names:string[];\r\n\t\tif (typeof values === 'number') {\r\n\t\t\tnames = [this.tag.nameFromId(values)];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tnames = this.tag.namesFromIds(values);\r\n\t\t}\r\n\t\treturn <div className=\"d-flex flex-wrap \">{names.map((name, index)=>{\r\n\t\t\treturn <div key={index} className=\"mx-2 border border-muted rounded px-3 bg-light\">{name}</div>\r\n\t\t})}</div>;\r\n\t}\r\n\trenderRadios(value: number, options: IValuesViewRenderOptions): JSX.Element {\r\n        let content = this.tag.values.map((item,index) => {\r\n\t\t\treturn <div className=\"col\" key={index}>{this.renderRadio(item, value, options)}</div>;\r\n        });\r\n\t\treturn this.renderView(options, content);\r\n\t}\r\n\trenderChecks(values: string, options: IValuesViewRenderOptions): JSX.Element {\r\n\t\tlet arr = values===undefined? undefined : values.split('|').map(v => Number(v));\r\n\t\tlet content = this.tag.values.map((item,index) => {\r\n\t\t\tlet checked: boolean = arr===undefined? undefined : arr.indexOf(item.id)>=0;\r\n\t\t\treturn <div className=\"col\" key={index}>{this.renderCheck(item, checked, options)}</div>\r\n\t\t});\r\n\t\treturn this.renderView(options, content);\r\n\t}\r\n\tprivate renderView(options: IValuesViewRenderOptions, content:any) {\r\n\t\tlet {className, wrapClassName} = options;\r\n\t\twrapClassName = wrapClassName?\r\n\t\t\t'row ' + wrapClassName\r\n\t\t\t:\r\n\t\t\t'row row-cols-2 row-cols-sm-3 row-cols-md-4';\r\n\t\treturn <div className={className} style={radioStyle}>\r\n\t\t\t<div className={wrapClassName}>\r\n                {content}\r\n\t\t\t</div>\r\n        </div>;\r\n\t}\r\n\tprivate renderRadio(item:TagValue, value: number, options: IValuesViewRenderOptions):JSX.Element {\r\n\t\tlet {id, name} = item;\r\n\t\tlet {inputs, inputName, onInputChange} = options;\r\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\r\n\t\treturn <label className=\"form-radio-inline\">\r\n\t\t\t<input ref={ref} type=\"radio\" name={inputName}\r\n\t\t\t\tvalue={id} defaultChecked={value===id}\r\n\t\t\t\tonChange={onInputChange} />\r\n\t\t\t{name}\r\n\t\t</label>;\r\n\t}\r\n\r\n\tprivate renderCheck(item:TagValue, checked: boolean, options: IValuesViewRenderOptions):JSX.Element {\r\n\t\tlet {id, name} = item;\r\n\t\tlet {inputs, onInputChange} = options;\r\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\r\n\t\treturn <label className=\"form-radio-inline\">\r\n\t\t\t<input ref={ref} type=\"checkbox\"\r\n\t\t\t\tvalue={id} defaultChecked={checked}\r\n\t\t\t\tonChange={onInputChange} />\r\n\t\t\t{name}\r\n\t\t</label>;\r\n\t}\r\n}\r\n","import { Entity } from \"../entity\";\r\nimport { TagView } from \"./tagView\";\r\n\r\nexport interface TagValue {\r\n\tid: number;\r\n\tname: string;\r\n\text: string;\r\n}\r\n\r\nexport class Tag extends Entity {\r\n    get typeName(): string { return 'tag';}\r\n\tvalues: TagValue[];\r\n\tprivate coll: {[id:number]: TagValue} = {};\r\n\r\n\tprivate _view: TagView;\r\n\tget view(): TagView { \r\n\t\tif (this._view !== undefined) return this._view; \r\n\t\treturn this._view = new TagView(this);\r\n\t}\r\n\r\n\tnameFromId(id:number) {\r\n\t\tlet c = this.coll[id]; \r\n\t\treturn c===undefined? undefined : c.name;\r\n\t}\r\n\r\n\tnamesFromIds(ids:string):string[] {\r\n\t\tlet ret:string[] = [];\r\n\t\tfor (let id of ids.split('|')) {\r\n\t\t\tlet c = this.coll[Number(id)];\r\n\t\t\tlet name = c===undefined? undefined : c.name;\r\n\t\t\tif (name !== undefined) ret.push(name);\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync loadValues():Promise<TagValue[]> {\r\n\t\tif (this.values !== undefined) return this.values;\r\n\t\tthis.values = [];\r\n\t\tlet ret = await this.uqApi.get('tag/values/' + this.name);\r\n\t\tif (ret === undefined) return;\r\n\t\tlet lines = (ret as string).split('\\n');\r\n\t\tfor (let line of lines) {\r\n\t\t\tif (line.length === 0) continue;\r\n\t\t\tlet parts = line.split('\\t');\r\n\t\t\tlet id = Number(parts[0]);\r\n\t\t\tlet val = {\r\n\t\t\t\tid: id,\r\n\t\t\t\tname: parts[1],\r\n\t\t\t\text: parts[2],\r\n\t\t\t};\r\n\t\t\tthis.values.push(val);\r\n\t\t\tthis.coll[id] = val;\r\n\t\t}\r\n\t\treturn this.values;\r\n\t}\r\n}\r\n","module.exports = __webpack_public_path__ + \"static/media/setting.783e21a7.svg\";","module.exports = __webpack_public_path__ + \"static/media/number-01.d3e87675.svg\";","module.exports = __webpack_public_path__ + \"static/media/order-01.ebc12679.svg\";","export * from './page';\r\nexport * from './tabs';\r\nexport * from './scrollView';\r\nexport * from './pageHeader';","export * from './schema';\r\nexport * from './uiSchema';\r\nexport * from './toUiSelectItems';\r\nexport * from './IValuesView';","\r\nexport const mobileRegex = /^[0-9]*$/;\r\nexport const emailRegex = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\r\n// /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/\r\n\r\nexport const EmailFieldRule = (value:any): string|string[] => {\r\n    if (emailRegex.test(value as string) === false) return '电子邮件格式错误';\r\n}\r\n\r\nexport const MobileFieldRule = (value:any): string|string[] => {\r\n    if (emailRegex.test(value as string) === false) return '手机格式错误';\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport interface DropdownAction {\r\n    icon?: string;\r\n    caption?: string;\r\n\taction?: () => void;\r\n\ticonClass?: string;\r\n\tcaptionClass?: string;\r\n}\r\n\r\nexport interface DropdownActionsProps {\r\n    icon?: string;\r\n    actions: DropdownAction[];\r\n    isRight?: boolean;\r\n\tclassName?: string;\r\n\titemIconClass?: string;\r\n\titemCaptionClass?: string;\r\n}\r\n\r\nexport interface DropdownActionsState {\r\n    dropdownOpen: boolean;\r\n}\r\n\r\nexport class DropdownActions extends React.Component<DropdownActionsProps, DropdownActionsState> {\r\n    private menu: HTMLDivElement;\r\n    private button: HTMLElement;\r\n    constructor(props:DropdownActionsProps) {\r\n        super(props);\r\n        this.state = {\r\n            dropdownOpen: false\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('click', this.handleDocumentClick);\r\n        document.addEventListener('touchstart', this.handleDocumentClick);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('click', this.handleDocumentClick);\r\n        document.removeEventListener('touchstart', this.handleDocumentClick);\r\n    }\r\n\r\n    private handleDocumentClick = (evt:any) => {\r\n        if (this.state.dropdownOpen === false) return;\r\n        if (this.button && this.button.contains(evt.target)) return;\r\n        if (!this.menu) return;\r\n        //if (!this.menu.contains(evt.target)) \r\n        this.toggle();\r\n    }\r\n\r\n    private toggle = () => {\r\n        this.setState({\r\n            dropdownOpen: !this.state.dropdownOpen\r\n        });\r\n    }\r\n\r\n    render() {\r\n        let {icon, actions, isRight, className, itemIconClass, itemCaptionClass} = this.props;\r\n        if (isRight === undefined) isRight = true;\r\n        let hasIcon = actions.some(v => v.icon!==undefined);\r\n        let {dropdownOpen} = this.state;\r\n\t\t//isOpen={this.state.dropdownOpen} toggle={this.toggle}\r\n\t\tlet cn = className || 'cursor-pointer dropdown-toggle btn btn-sm';\r\n\t\t//if (className) cn += className;\r\n        return <div className={'dropdown'}>\r\n\t\t\t<button ref={v=>this.button=v} \r\n\t\t\t\tclassName={cn}\r\n                data-toggle=\"dropdown\"\r\n                aria-expanded={dropdownOpen}\r\n                onClick={this.toggle}>\r\n                <i className={classNames('fa fa-fw ', 'fa-'+(icon||'ellipsis-v'))} />\r\n            </button>\r\n            <div ref={v => this.menu=v} className={classNames({\"dropdown-menu\":true, \"dropdown-menu-right\":isRight, \"show\":dropdownOpen})}>\r\n                {\r\n                    actions.map((v,index) => {\r\n\t\t\t\t\t\tif (!v) {\r\n                            return <div className=\"dropdown-divider\" key={index}/>;\r\n\t\t\t\t\t\t}\r\n                        let {icon, caption, action, iconClass, captionClass} = v;\r\n                        if (icon === undefined && caption === undefined) \r\n                            return <div className=\"dropdown-divider\" />;\r\n                        let i:any;\r\n                        if (hasIcon === true) {\r\n                            if (icon !== undefined) icon = 'fa-' + icon;\r\n\t\t\t\t\t\t\ti = <i className={classNames('mr-2', 'fa', icon, 'fa-fw', iconClass || itemIconClass)}\r\n\t\t\t\t\t\t\t\taria-hidden={true}></i>;\r\n                        }\r\n                        if (action === undefined) \r\n                            return <h6 className=\"dropdown-header\">{i} {caption}</h6>;\r\n                        let onMenuItemClick = (evt:React.MouseEvent<HTMLAnchorElement>)=>{\r\n                            evt.preventDefault();\r\n                            action();\r\n                        }\r\n                        let onTouchStart = (evt: React.TouchEvent<HTMLAnchorElement>) => {\r\n                            action();\r\n                        }\r\n                            // eslint-disable-next-line\r\n                        return <a className=\"dropdown-item\" key={index} href=\"#/\" \r\n                            onClick={onMenuItemClick} onTouchStart={onTouchStart}\r\n                            >{i} <span className={captionClass || itemCaptionClass}>{caption}</span></a>\r\n                    })\r\n                }\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { setRes } from '../../components';\r\n\r\nexport interface EasyDateProps {\r\n    date: Date | number;\r\n}\r\n\r\n//type YMD = (year:number, month:number, date:number) => string;\r\n//type MD = (month:number, date:number) => string;\r\n\r\nconst timeRes:{[prop:string]:any} = {\r\n\tmd: (month:number, date:number) => `${month}-${date}`,\r\n\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\r\n\tyesterday: 'Yday',\r\n\ttoday: 'Today',\r\n\ttomorrow: 'Tmw',\r\n\t$zh: {\r\n\t\tmd: (month:number, date:number) => `${month}月${date}日`,\r\n\t\tymd: (year:number, month:number, date:number) => `${year}年${month}月${date}日`,\r\n\t\tyesterday: '昨天',\r\n\t\ttoday: '今天',\r\n\t\ttomorrow: '明天',\r\n\t},\r\n\t$en: {\r\n\t\tmd: (month:number, date:number) => `${month}-${date}`,\r\n\t\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\r\n\t\tyesterday: 'Yday',\r\n\t\ttoday: 'Today',\r\n\t\ttomorrow: 'Tmw',\r\n\t}\r\n}\r\n\r\nsetRes(timeRes, timeRes);\r\n\r\nfunction tt(str:string):any {\r\n\treturn timeRes[str];\r\n}\r\n\r\nfunction renderDate(vDate:Date|number, withTime:boolean, always:boolean = false) {\r\n    if (!vDate) return null;\r\n    let date: Date;\r\n    switch (typeof vDate) {\r\n        default: date = vDate as Date; break;\r\n        case 'string': date = new Date(vDate); break;\r\n        case 'number': date = new Date((vDate as number)*1000); break;\r\n    }\r\n\r\n    let now = new Date();\r\n    let tick:number, nDate:number, _date:number, month:number, year:number, nowYear:number;\r\n    let d = date;\r\n    tick = now.getTime() - d.getTime();\r\n    let hour=d.getHours(), minute=d.getMinutes();\r\n    nDate=now.getDate();\r\n    _date=d.getDate();\r\n    month=d.getMonth()+1;\r\n    year=d.getFullYear();\r\n\tnowYear = now.getFullYear();\r\n\r\n\tlet appendTime:boolean = false;\r\n\tlet dPart:string = (function() {\r\n\t\tif (tick < -24*3600*1000) {\r\n\t\t\tif (year === nowYear) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt('md')(month, _date);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt('ymd')(year, month, _date);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (tick < 24*3600*1000) {\r\n\t\t\tif (_date!==nDate) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt(tick < 0? 'tomorrow' : 'yesterday');\r\n\t\t\t}\r\n\t\t\tif (withTime===true) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn tt('today');\r\n\t\t}\r\n\t\tif (year === nowYear) {\r\n\t\t\treturn tt('md')(month, _date);\r\n\t\t}\r\n\t\treturn tt('ymd')(year, month, _date);\r\n\t})();\r\n\r\n\tlet hm = hour + ((minute<10?':0':':') + minute);\r\n\r\n\t/*\r\n    if (tick < -24*3600*1000) {\r\n        if (year === nowYear)\r\n            return tt('md')(month, _date) + ' ' + hm;\r\n        else\r\n            return tt('ymd')(year, month, _date) + ' ' + hm;\r\n    }\r\n    if (always === true || tick < 24*3600*1000) {\r\n        return _date!==nDate? \r\n            tt(tick < 0? 'tomorrow' : 'yesterday') + ' ' + hm \r\n            : withTime===true? hm : tt('today');\r\n    }\r\n    if (year === nowYear) {\r\n        return tt('md')(month, _date);\r\n    }\r\n\treturn tt('ymd')(year, month, _date);\r\n\t*/\r\n\tif (appendTime === true || always === true) {\r\n\t\treturn dPart + ' ' + hm;\r\n\t}\r\n\treturn dPart;\r\n}\r\n\r\n\r\nexport class EasyDate extends React.Component<EasyDateProps> {\r\n    render() {\r\n        return renderDate(this.props.date, false);\r\n    }\r\n}\r\n\r\ninterface EasyTimeProps extends EasyDateProps {\r\n\talways?: boolean;\r\n}\r\nexport class EasyTime extends React.Component<EasyTimeProps> {\r\n    render() {\r\n\t\tlet {date, always} = this.props;\r\n        return renderDate(date, true, always);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Image } from '.';\r\n\r\nexport interface MediaProps {\r\n    icon: string;\r\n    main: string|JSX.Element;\r\n    discription?: string | JSX.Element;\r\n    px?: number;\r\n    py?: number;\r\n}\r\n\r\nexport class Media extends React.Component<MediaProps> {\r\n    render() {\r\n        let {icon, main, discription, px, py} = this.props;\r\n        let disp:any;\r\n        if (typeof discription === 'string')\r\n            disp = <div>{discription}</div>;\r\n        else\r\n            disp = discription;\r\n        let cn = classNames(\r\n            'media', \r\n            px===undefined? 'px-0':'px-'+px, \r\n            py===undefined? 'py-2':'py-'+py);\r\n        return <div className={cn}>\r\n            <Image className=\"mr-3 w-4c h-4c\" src={icon} />\r\n            <div className=\"media-body\">\r\n                <h5 className=\"mt-0\">{main}</h5>\r\n                {disp}\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { observable } from 'mobx';\r\n\r\nexport interface SearchBoxProps {\r\n    className?: string;\r\n    label?: string;\r\n    initKey?: string;\r\n    placeholder?: string;\r\n    buttonText?: string;\r\n    maxLength?: number;\r\n    size?: 'sm' | 'md' | 'lg';\r\n    inputClassName?: string;\r\n    onSearch: (key:string)=>Promise<void>;\r\n    onFocus?: ()=>void;\r\n    allowEmptySearch?: boolean;\r\n}\r\n\r\n/*\r\nexport interface SearchBoxState {\r\n    disabled: boolean;\r\n}*/\r\n\r\nexport class SearchBox extends React.Component<SearchBoxProps> { //}, SearchBoxState> {\r\n    private input: HTMLInputElement;\r\n    private key: string = null;\r\n    @observable private disabled: boolean;\r\n\r\n    private onChange = (evt: React.ChangeEvent<any>) => {\r\n        this.key = evt.target.value;\r\n        if (this.key !== undefined) {\r\n            this.key = this.key.trim();\r\n            if (this.key === '') this.key = undefined;\r\n        }\r\n        if (this.props.allowEmptySearch !== true) {\r\n            this.disabled = !this.key;\r\n        }\r\n    }\r\n    private onSubmit = async (evt: React.FormEvent<any>) => {\r\n        evt.preventDefault();\r\n        if (this.key === null) this.key = this.props.initKey || '';\r\n        if (this.props.allowEmptySearch !== true) {\r\n            if (!this.key) return;\r\n            if (this.input) this.input.disabled = true;\r\n        }\r\n        await this.props.onSearch(this.key);\r\n        if (this.input) this.input.disabled = false;\r\n    }\r\n    clear() {\r\n        if (this.input) this.input.value = '';\r\n    }\r\n    render() {\r\n        let {className, inputClassName, onFocus,\r\n            label, placeholder, buttonText, maxLength, size} = this.props;\r\n        let inputSize:string;\r\n        switch (size) {\r\n            default:\r\n            case 'sm': inputSize = 'input-group-sm'; break;\r\n            case 'md': inputSize = 'input-group-md'; break;\r\n            case 'lg': inputSize = 'input-group-lg'; break;\r\n        }\r\n        return <form className={className} onSubmit={this.onSubmit} >\r\n            <div className={classNames(\"input-group\", inputSize)}>\r\n                {label && <div className=\"input-group-addon align-self-center mr-2\">{label}</div>}\r\n                <input ref={v=>this.input=v} onChange={this.onChange}\r\n                    type=\"text\"\r\n                    name=\"key\"\r\n                    onFocus={onFocus}\r\n                    className={classNames('form-control', inputClassName || 'border-primary')}\r\n                    placeholder={placeholder}\r\n                    defaultValue={this.props.initKey}\r\n                    maxLength={maxLength} />\r\n                <div className=\"input-group-append\">\r\n                    <button className=\"btn btn-primary\"\r\n                        type=\"submit\"\r\n                        disabled={this.disabled}>\r\n                        <i className='fa fa-search' />\r\n                        <i className=\"fa\"/>\r\n                        {buttonText}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </form>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { nav } from './nav';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\nimport { userApi } from '../net';\r\nimport { User } from '../tool';\r\n\r\nexport type UserLoader = (userId:number)=>Promise<any>;\r\n\r\nexport class UserCache<T> {\r\n\tprivate loader: UserLoader;\r\n\tprivate onLoaded: (user:User) => void;\r\n\tprivate map = observable(new Map<number, T|number>());\r\n\r\n\tconstructor(loader: UserLoader) {\r\n\t\tif (loader === undefined) loader = (userId:number)=>userApi.user(userId);\r\n\t\tthis.loader = loader;\r\n\t}\r\n\r\n\tuse(id:number|any, onLoaded?:(user:User)=>void) {\t\t\r\n\t\tif (!id) return;\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tif (!id) return;\r\n\t\tthis.onLoaded = onLoaded;\r\n\t\tid = Number(id);\r\n\t\tlet ret = this.map.get(id);\r\n\t\tif (ret === undefined) {\r\n\t\t\tthis.map.set(id, id);\r\n\t\t}\r\n\t}\r\n\r\n\tgetValue(id:number|any):any {\r\n\t\tif (!id) return;\r\n\t\tswitch (typeof(id)) {\r\n\t\t\tcase 'object': \r\n\t\t\t\tid = id.id; \r\n\t\t\t\tif (!id) return;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tlet ret = this.map.get(id);\r\n\t\tif (!ret) return;\r\n\t\tswitch (typeof(ret)) {\r\n\t\tdefault:\r\n\t\t\treturn ret;\r\n\t\tcase 'number':\r\n\t\t\tif (ret < 0) return id;\r\n\t\t\tthis.map.set(id, -id);\r\n\t\t\tthis.loader(id).then(v => {\r\n\t\t\t\tif (!v) v = null;\r\n\t\t\t\tthis.map.set(id, v);\r\n\t\t\t\tif (this.onLoaded) this.onLoaded(v);\r\n\t\t\t}).catch(reason => {\r\n\t\t\t\tconsole.error(reason);\r\n\t\t\t});\r\n\t\t\treturn id;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst userCache = new UserCache(undefined);\r\n\r\nexport interface UserIconProps {\r\n    id: number;\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    altImage?: string;\r\n    noneImage?: any;\r\n}\r\n\r\nexport const UserIcon = observer((props: UserIconProps):JSX.Element => {\r\n    let {className, style, id, altImage, noneImage} = props;\r\n    let user = userCache.getValue(id);\r\n    switch (typeof user) {\r\n\tcase 'undefined':\r\n\tcase 'number':\r\n        return <div className={classNames(className, 'image-none')} style={style}>\r\n            {noneImage || <i className=\"fa fa-file-o\" />}\r\n        </div>;\r\n    }\r\n    let {icon} = user;\r\n    if (!icon) {\r\n        return <div className={classNames(className, 'image-none')} style={style}>\r\n            <i className=\"fa fa-file-o\" />\r\n        </div>;\r\n    }\r\n    if (icon.startsWith(':') === true) {\r\n        icon = nav.resUrl + icon.substr(1);\r\n    }\r\n    return <img src={icon} className={className} alt=\"img\"\r\n        style={style}\r\n        onError={evt=>{\r\n            if (altImage) evt.currentTarget.src=altImage;\r\n            else evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\r\n        }} />;\r\n});\r\n\r\nexport interface UserViewProps {\r\n\tid?: number;\r\n\tuser?: number|User;\r\n\trender: (user:User) => JSX.Element;\r\n\tonLoaded?: (user:User) => void\r\n}\r\n\r\nexport const UserView = observer((props: UserViewProps):JSX.Element => {\r\n\tlet {id:idProp, user, render, onLoaded} = props;\r\n\tif (user === null) return <>null</>;\r\n\tswitch (typeof user) {\r\n\t\tcase 'undefined': \r\n\t\t\tuser = userCache.getValue(idProp);\r\n\t\t\tbreak;\r\n\t\tcase 'object': \r\n\t\t\tlet {/*obj, */id} = user as any;\r\n\t\t\t//if (typeof obj !== 'object') {\r\n\t\t\t\tuseUser(id, onLoaded);\r\n\t\t\t\tuser = userCache.getValue(id);\r\n\t\t\t//}\r\n\t\t\tbreak;\r\n\t\tcase 'number':\r\n\t\t\tuseUser(user as number, onLoaded);\r\n\t\t\tuser = userCache.getValue(user as number);\r\n\t\t\tbreak;\r\n\t\tcase 'string':\r\n\t\t\tuseUser(Number(user), onLoaded);\r\n\t\t\tuser = userCache.getValue(Number(user));\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tuser = undefined;\r\n\t\t\tbreak;\r\n\t}\r\n    switch (typeof user) {\r\n\t\tcase 'undefined':\r\n\t\tcase 'number':\r\n        \treturn <>{user}</>;\r\n    }\r\n    return render(user);\r\n});\r\n\r\nexport function useUser(id: number|object, onLoaded?: (user:User)=>void) {\r\n\tif (!id) return;\r\n\tif (typeof(id) === 'object') {\r\n\t\tid = (id as any).id;\r\n\t}\r\n\tuserCache.use(id, onLoaded);\r\n}\r\n","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport { IObservableValue } from 'mobx';\r\n\r\n//export function autoHideTips(visible: IObservableValue<boolean>, tips:string|JSX.Element, timeout?:number):React.FunctionComponentElement<any>;\r\n//export function autoHideTips(tips: IObservableValue<string>, tips:string|JSX.Element, timeout?:number):React.FunctionComponentElement<any>;\r\n\r\nexport function autoHideTips(\r\n\ttips: IObservableValue<boolean|string|JSX.Element>, \r\n\ttemplet?:string|JSX.Element|((v:string|JSX.Element)=>JSX.Element), \r\n\ttimeout?:number):React.FunctionComponentElement<any> {\r\n/*\r\nexport function autoHideTips(tips: IObservableValue<boolean|string|JSX.Element>, timeout?:number):React.FunctionComponentElement<any>;\r\nexport function autoHideTips(tips: IObservableValue<boolean|string|JSX.Element>, templet:(tips: boolean|string|JSX.Element) => JSX.Element, timeout?:number):React.FunctionComponentElement<any>;\r\n\r\nexport function autoHideTips(tips: IObservableValue<boolean|string|JSX.Element>, ...params:any[]) {\r\n*/\r\n\tlet timer:any;\r\n\treturn React.createElement(observer(():JSX.Element => {\r\n\t\tif (timer) {\r\n\t\t\tclearTimeout(timer);\r\n\t\t\ttimer = undefined;\r\n\t\t}\r\n\t\tlet t = tips.get();\r\n\t\tif (!t) return null;\r\n\t\tif (timeout === undefined) timeout = 3000;\r\n\t\t//let p0 = params[0];\r\n\t\t//let timeout = 3000;\r\n\t\t//let templet: (tips: boolean|string|JSX.Element) => JSX.Element;\r\n\t\t/*\r\n\t\tswitch (typeof p0) {\r\n\t\t\tcase 'number':\r\n\t\t\t\ttimeout = p0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'function':\r\n\t\t\t\ttemplet = p0;\r\n\t\t\t\tlet p1 = params[1];\r\n\t\t\t\tif (typeof p1 === 'number') {\r\n\t\t\t\t\ttimeout = p1;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\tif (timeout > 0) {\r\n\t\t\ttimer = setTimeout(() => {\r\n\t\t\t\ttips.set(null);\r\n\t\t\t}, timeout);\r\n\t\t}\r\n\t\tswitch (typeof templet) {\r\n\t\t\tcase 'undefined': return <>{t}</>;\r\n\t\t\tcase 'function': return templet(t as string);\r\n\t\t\tcase 'string': return <>{templet}</>;\r\n\t\t\tdefault: return templet;\r\n\t\t}\r\n\t}));\r\n};\r\n","import { UqMan, TuidModify } from '../uqMan';\r\nimport { Tuid } from \"./tuid\";\r\nimport { env } from '../../tool';\r\n\r\ninterface Modify {\r\n    id: number;\r\n    entity: string;\r\n    key: string;\r\n}\r\n\r\nexport class TuidsCache {\r\n    private readonly uq: UqMan;\r\n    private modifyMax: TuidModify;\r\n    private cacheTimer: any;\r\n    constructor(uq: UqMan) {\r\n        this.uq = uq;\r\n    }\r\n\r\n    cacheTuids(defer:number) {\r\n        this.clearCacheTimer();\r\n        this.cacheTimer = env.setTimeout('TuidsCache.cacheTuids', this.loadIds, defer);\r\n    }\r\n    private clearCacheTimer() {\r\n        if (this.cacheTimer === undefined) return;\r\n        env.clearTimeout(this.cacheTimer);\r\n        this.cacheTimer = undefined;\r\n    }\r\n    private loadIds = () => {\r\n        this.clearCacheTimer();\r\n        let {tuids} = this.uq;\r\n        for (let i in tuids) {\r\n            let tuid = tuids[i];\r\n            tuid.cacheIds();\r\n        }\r\n    }\r\n    \r\n    pullModify(modifyMax:number) {\r\n        if (modifyMax === undefined) return;\r\n        let now = Math.floor(Date.now() / 1000);\r\n        if (this.modifyMax === undefined) {\r\n            this.modifyMax = this.uq.localModifyMax.get();\r\n            if (this.modifyMax === undefined) {\r\n                this.modifyMax = {\r\n                    max: modifyMax,\r\n                    seconds: now,\r\n                };\r\n                this.uq.localModifyMax.set(this.modifyMax);\r\n            }\r\n        }\r\n        let {max, seconds} = this.modifyMax;\r\n        let lockGap = 3600;\r\n        if (now - seconds < lockGap) return;\r\n        if (modifyMax <= max) return;\r\n        let tuidCached:string[] = [];\r\n        let {tuids} = this.uq;\r\n        for (let i in tuids) {\r\n            //if (tuids[i].cached === true) \r\n            tuidCached.push(i);\r\n        }\r\n        if (tuidCached.length === 0) return;\r\n        this.modifyMax.seconds = now;\r\n        this.innerPullModify(tuidCached.join('\\t'));\r\n    }\r\n\r\n    private async innerPullModify(tuidLists:string):Promise<void> {\r\n        let {uqApi, tuids} = this.uq;\r\n        let {max} = this.modifyMax;\r\n        let ret:{queue:Modify[], queueMax:number} = await uqApi.queueModify(max, 30, tuidLists);\r\n        let group:{[entity:string]: {tuid:Tuid; ids: string[]}} = {};\r\n        let modifyMax:number = 0;\r\n        for (let modify of ret.queue) {\r\n\t\t\tlet {id, entity, key} = modify;\r\n\t\t\tif (!key) continue;\r\n            let tuid = tuids[entity];\r\n            if (tuid === undefined) continue;\r\n            let item = group[entity];\r\n            if (item === undefined) {\r\n                item = group[entity] = {tuid: tuid, ids:[]};\r\n            }\r\n            item.ids.push(key);\r\n            if (id > modifyMax) modifyMax = id;\r\n        }\r\n        for (let i in group) {\r\n            let {tuid, ids} = group[i];\r\n            await tuid.modifyIds(ids);\r\n        }\r\n        let now = Math.floor(Date.now() / 1000);\r\n        this.modifyMax = {\r\n            max: modifyMax,\r\n            seconds: now,\r\n        }\r\n        this.uq.localModifyMax.set(this.modifyMax);\r\n    }\r\n}\r\n","import { LocalMap, LocalCache, env } from '../tool';\r\nimport { UqData, UqAppData, loadAppUqs } from '../net';\r\nimport { UqMan } from './uqMan';\r\nimport { TuidImport, TuidInner } from './tuid';\r\nimport { nav } from '../components';\r\n\r\nexport interface TVs {\r\n    [uqName:string]: {\r\n        [tuidName: string]: (values: any) => JSX.Element;\r\n    }\r\n}\r\n\r\nexport class UQsMan {\r\n\tstatic _uqs: any;\r\n\tstatic value: UQsMan;\r\n\tstatic errors: string[];\r\n\r\n\tstatic async load(tonvaAppName:string, version:string, tvs:TVs) {\r\n\t\tlet uqsMan = UQsMan.value = new UQsMan(tonvaAppName, tvs);\r\n        let {appOwner, appName} = uqsMan;\r\n        let {localData} = uqsMan;\r\n        let uqAppData:UqAppData = localData.get();\r\n        if (!uqAppData || uqAppData.version !== version) {\r\n\t\t\tuqAppData = await loadAppUqs(appOwner, appName);\r\n\t\t\tif (!uqAppData.id) {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\r\n\t\t\t\t];\r\n\t\t\t}\r\n            uqAppData.version = version;\r\n            localData.set(uqAppData);\r\n            // \r\n            for (let uq of uqAppData.uqs) uq.newVersion = true;\r\n        }\r\n        let {id, uqs} = uqAppData;\r\n        uqsMan.id = id;\r\n        await uqsMan.init(uqs);\r\n        let retErrors = await uqsMan.load();\r\n        if (retErrors.length === 0) {\r\n            retErrors.push(...uqsMan.setTuidImportsLocal());\r\n            if (retErrors.length === 0) {\r\n                UQsMan._uqs = uqsMan.buildUQs();\r\n                return;\r\n            }\r\n        }\r\n        UQsMan.errors = retErrors;\r\n\t}\r\n\r\n    private collection: {[uqName: string]: UqMan};\r\n    private readonly tvs: TVs;\r\n\r\n    readonly appOwner: string;\r\n    readonly appName: string;\r\n    readonly localMap: LocalMap;\r\n    readonly localData: LocalCache;\r\n    id: number;\r\n\r\n    private constructor(tonvaAppName:string, tvs:TVs) {\r\n        this.tvs = tvs || {};\r\n        this.buildTVs();\r\n        this.collection = {};\r\n        let parts = tonvaAppName.split('/');\r\n        if (parts.length !== 2) {\r\n            throw new Error('tonvaApp name must be / separated, owner/app');\r\n        }\r\n        this.appOwner = parts[0];\r\n        this.appName = parts[1];\r\n        this.localMap = env.localDb.map(tonvaAppName);\r\n        this.localData = this.localMap.child('uqData');\r\n    }\r\n\r\n    // to be removed in the future\r\n    addUq(uq: UqMan) {\r\n        this.collection[uq.name] = uq;\r\n    }\r\n\r\n    private buildTVs() {\r\n        for (let i in this.tvs) {\r\n            let uqTVs = this.tvs[i];\r\n            if (uqTVs === undefined) continue;\r\n            let l = i.toLowerCase();\r\n            if (l === i) continue;\r\n            this.tvs[l] = uqTVs;\r\n            for (let j in uqTVs) {\r\n                let en = uqTVs[j];\r\n                if (en === undefined) continue;\r\n                let lj = j.toLowerCase();\r\n                if (lj === j) continue;\r\n                uqTVs[lj] = en;\r\n            }\r\n        }\r\n    }\r\n\r\n    async init(uqsData:UqData[]):Promise<void> {\r\n        let promiseInits: PromiseLike<void>[] = uqsData.map(uqData => {\r\n\t\t\tlet {uqOwner, uqName} = uqData;\r\n\t\t\tlet uqFullName = uqOwner + '/' + uqName;\r\n\t\t\t//let uqUI = this.ui.uqs[uqFullName] as UqUI || {};\r\n\t\t\t//let cUq = this.newCUq(uqData, uqUI);\r\n\t\t\t//this.cUqCollection[uqFullName] = cUq;\r\n\t\t\t//this.uqs.addUq(cUq.uq);\r\n\t\t\tlet uq = new UqMan(this, uqData, undefined, this.tvs[uqFullName] || this.tvs[uqName]);\r\n\t\t\tthis.collection[uqFullName] = uq;\r\n\t\t\tlet lower = uqFullName.toLowerCase();\r\n\t\t\tif (lower !== uqFullName) {\r\n\t\t\t\tthis.collection[lower] = uq;\r\n\t\t\t}\r\n\t\t\treturn uq.init();\r\n\t\t});\r\n        await Promise.all(promiseInits);\r\n    }\r\n\r\n    async load(): Promise<string[]> {\r\n        let retErrors:string[] = [];\r\n        let promises: PromiseLike<string>[] = [];\r\n        for (let i in this.collection) {\r\n            let uq = this.collection[i];\r\n            promises.push(uq.loadEntities());\r\n\t\t}\r\n        let results = await Promise.all(promises);\r\n        for (let result of results)\r\n        {\r\n            let retError = result; // await cUq.loadSchema();\r\n            if (retError !== undefined) {\r\n                retErrors.push(retError);\r\n                continue;\r\n            }\r\n\t\t}\r\n        return retErrors;\r\n    }\r\n\r\n    buildUQs(): any {\r\n        let that = this;\r\n        let uqs:any = {};\r\n        for (let i in this.collection) {\r\n            let uqMan = this.collection[i];\r\n            //let n = uqMan.name;\r\n            let uqName = uqMan.uqName;\r\n            let l = uqName.toLowerCase();\r\n\t\t\tlet uqKey:string = uqName.split(/[-._]/).join('').toLowerCase();\r\n            let entities = uqMan.entities;\r\n            let keys = Object.keys(entities);\r\n            for (let key of keys) {\r\n                let entity = entities[key];\r\n\t\t\t\tlet {name} = entity;\r\n\t\t\t\tentities[name.toLowerCase()] = entity;\r\n            }\r\n            let proxy = uqs[l] = new Proxy(entities, {\r\n                get: function(target, key, receiver) {\r\n                    let lk = (key as string).toLowerCase();\r\n                    let ret = target[lk];\r\n                    if (ret !== undefined) return ret;\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\tlet err = `entity ${uqName}.${String(key)} not defined`;\r\n                    console.error(err);\r\n                    that.showReload('UQ错误：' + err);\r\n                    return undefined;\r\n                }\r\n\t\t\t})\r\n\t\t\tif (uqKey !== l) uqs[uqKey] = proxy;\r\n        }\r\n        //let uqs = this.collection;\r\n        return new Proxy(uqs, {\r\n            get: function (target, key, receiver) {\r\n                let lk = (key as string).toLowerCase();\r\n                let ret = target[lk];\r\n                if (ret !== undefined) return ret;\r\n                /*\r\n                for (let i in uqs) {\r\n                    if (i.toLowerCase() === lk) {\r\n                        return uqs[i];\r\n                    }\r\n                }*/\r\n                debugger;\r\n                console.error('error in uqs');\r\n                that.showReload(`代码错误：新增 uq ${String(key)}`);\r\n                return undefined;\r\n            },\r\n        });\r\n\t}\r\n\t\r\n\tgetUqCollection() {\r\n\t\treturn this.collection;\r\n\t}\r\n\r\n    private showReload(msg: string) {\r\n        this.localMap.removeAll();\r\n        nav.showReloadPage(msg);\r\n    }\r\n\r\n    setTuidImportsLocal():string[] {\r\n        let ret:string[] = [];\r\n        for (let i in this.collection) {\r\n            let uq = this.collection[i];\r\n            for (let tuid of uq.tuidArr) {\r\n                if (tuid.isImport === true) {\r\n                    let error = this.setInner(tuid as TuidImport);\r\n                    if (error) ret.push(error);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    private setInner(tuidImport: TuidImport):string {\r\n        let {from} = tuidImport;\r\n        let fromName = from.owner + '/' + from.uq;\r\n        let uq = this.collection[fromName];\r\n        if (uq === undefined) {\r\n            //debugger;\r\n            return `setInner(tuidImport: TuidImport): uq ${fromName} is not loaded`;\r\n        }\r\n        let iName = tuidImport.name\r\n        let tuid = uq.tuid(iName);\r\n        if (tuid === undefined) {\r\n            //debugger;\r\n            return `setInner(tuidImport: TuidImport): uq ${fromName} has no Tuid ${iName}`;\r\n        }\r\n        if (tuid.isImport === true) {\r\n            //debugger;\r\n            return `setInner(tuidImport: TuidImport): uq ${fromName} Tuid ${iName} is import`;\r\n        }\r\n        tuidImport.setFrom(tuid as TuidInner);\r\n    }\r\n}\r\n","import fs from 'fs';\r\nimport { Action, Book, Query, Sheet, Tuid, UqEnum, UqMan, UQsMan, Map, History, Tag, Pending, Entity, ArrFields, Field } from './index';\r\nimport { nav } from '../components';\r\nimport { AppConfig } from '../app';\r\n//import { env } from 'tonva/tool';\r\n\r\n//const uqAppPath = 'src/UqApp';\r\nconst red = '\\x1b[41m%s\\x1b[0m';\r\nlet lastBuildTime:number = 0;\r\nlet gUqOwnerMap:{[key:string]:string};\r\n\r\nexport interface UqAppOptions extends Partial<AppConfig> {\r\n\tuqAppName: string;\r\n\tuqAppVersion: string;\r\n\tuqAppUnitId: number;\r\n\tuqAppSrcPath?: string;\r\n\tuqOwnerMap?: {[key:string]: string};\r\n}\r\n\r\nexport async function uqAppStart(options: UqAppOptions) {\r\n\tlet {uqAppName, uqAppVersion: appVersion, uqAppUnitId: appUnitId} = options;\r\n\tprocess.env.REACT_APP_UNIT = String(appUnitId);\r\n\tnav.forceDevelopment = true;\r\n\tawait nav.init();\r\n\tawait UQsMan.load(uqAppName, appVersion, undefined);\r\n}\r\nexport async function buildUqApp(options: UqAppOptions) {\r\n\tlet {uqAppSrcPath, uqOwnerMap} = options;\r\n\tif (!uqAppSrcPath) uqAppSrcPath = 'src/UqApp';\r\n\tgUqOwnerMap = uqOwnerMap || {};\r\n\tfor (let i in gUqOwnerMap) {\r\n\t\tgUqOwnerMap[i.toLowerCase()] = gUqOwnerMap[i];\r\n\t}\r\n\tif (lastBuildTime > 0) {\r\n\t//if (Date.now() - lastBuildTime < 30*1000) {\r\n\t\tconsole.log(red, 'quit !');\r\n\t\treturn;\r\n\t}\r\n\tif (!fs.existsSync(uqAppSrcPath)) {\r\n\t\tfs.mkdirSync(uqAppSrcPath);\r\n\t}\r\n\tlet tsAppName = buildTsAppName(options);\r\n\tsaveTsFile(uqAppSrcPath, 'appName', tsAppName);\r\n\tlet tsAppConfig = buildTsAppConfig(options);\r\n\tsaveTsFileIfNotExists(uqAppSrcPath, 'appConfig', tsAppConfig);\r\n\tlet tsIndex = buildTsIndex();\r\n\tsaveTsFile(uqAppSrcPath, 'index', tsIndex);\r\n\tlet tsCApp = buildTsCApp();\r\n\tsaveTsFileIfNotExists(uqAppSrcPath, 'CApp', tsCApp);\r\n\tlet tsCBase = buildTsCBase();\r\n\tsaveTsFile(uqAppSrcPath, 'CBase', tsCBase);\r\n\tlet tsVMain = buildTsVMain();\r\n\tsaveTsFileIfNotExists(uqAppSrcPath, 'VMain', tsVMain, 'tsx');\r\n\r\n\tsaveTsFile(uqAppSrcPath, 'uqs', '');\r\n\tfs.unlinkSync(uqAppSrcPath + '/uqs.ts');\r\n\tawait buildUqsFolder(uqAppSrcPath + '/uqs', options);\r\n};\r\n\r\nfunction saveTsFileIfNotExists(uqAppSrcPath:string, fileName:string, content:string, suffix:string = 'ts') {\r\n\tlet tsFile = `${uqAppSrcPath}/${fileName}.${suffix}`;\r\n\tif (fs.existsSync(tsFile) === true) return;\r\n\tsaveTsFile(uqAppSrcPath, fileName, content, suffix);\r\n}\r\nfunction saveTsFile(uqAppSrcPath:string, fileName:string, content:string, suffix:string = 'ts') {\r\n\tlet srcFile = `${uqAppSrcPath}/${fileName}.${suffix}.txt`;\r\n\tlet tsFile = `${uqAppSrcPath}/${fileName}.${suffix}`;\r\n\tif (!fs.existsSync(srcFile)) {\r\n\t\tif (fs.existsSync(tsFile)) {\r\n\t\t\tfs.renameSync(tsFile, srcFile);\r\n\t\t}\r\n\t}\r\n\tfs.writeFileSync(tsFile, content);\r\n\tlastBuildTime = Date.now();\r\n\tconsole.log(red, `${tsFile} is built`);\r\n}\r\nfunction overrideTsFile(uqAppSrcPath:string, fileName:string, content:string, suffix:string = 'ts') {\r\n\tlet tsFile = `${uqAppSrcPath}/${fileName}.${suffix}`;\r\n\tfs.writeFileSync(tsFile, content);\r\n\tlastBuildTime = Date.now();\r\n\tconsole.log(red, `${tsFile} is built`);\r\n}\r\nfunction buildTsHeader() {\r\n\treturn `//=== UqApp builder created on ${new Date()} ===//`;\r\n}\r\nfunction buildTsAppName(options: UqAppOptions):string {\r\n\tlet {uqAppName, appName} = options;\r\n\treturn `${buildTsHeader()}\r\nexport const appName = '${uqAppName || appName}';\r\n`;\r\n}\r\nfunction buildTsAppConfig(options: UqAppOptions):string {\r\n\tlet {version, noUnit, tvs, oem, htmlTitle} = options;\r\n\tfunction toString(s:string) {\r\n\t\tif (s === undefined) return;\r\n\t\tif (s === null) return null;\r\n\t\treturn `'${s}'`;\r\n\t}\r\n\treturn `${buildTsHeader()}\r\nimport { AppConfig } from \"tonva\";\r\nimport { appName } from \"./appName\";\r\n\r\nexport const appConfig: AppConfig = {\r\n    appName: appName,\r\n\tversion: ${toString(version)},\r\n\tnoUnit: ${noUnit},\r\n    tvs: ${JSON.stringify(tvs)},\r\n\toem: ${toString(oem)},\r\n\thtmlTitle: ${toString(htmlTitle)},\r\n};\r\n`;\r\n}\r\nfunction buildTsIndex():string {\r\n\treturn `${buildTsHeader()}\r\nexport { appConfig } from './appConfig';\r\nexport { CUqApp, CUqBase, CUqSub } from './CBase';\r\nexport { CApp } from './CApp';\r\nexport * from './uqs';\r\n`;\r\n}\r\nfunction buildTsCApp():string {\r\n\treturn `${buildTsHeader()}\r\nimport { CUqApp } from \"./CBase\";\r\nimport { VMain } from \"./VMain\";\r\n\r\nexport class CApp extends CUqApp {\r\n\tprotected async internalStart(isUserLogin: boolean) {\r\n\t\tthis.openVPage(VMain, undefined, this.dispose);\r\n\t}\r\n}\r\n`;\t\r\n}\r\nfunction buildTsCBase():string {\r\n\treturn `${buildTsHeader()}\r\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonva';\r\nimport { UQs } from './uqs';\r\nimport { CApp } from './CApp';\r\n\r\nexport abstract class CUqBase extends CBase {\r\n\tget cApp(): CApp { return this._cApp; }\r\n\tprotected get uqs(): UQs { return this._uqs as UQs };\r\n}\r\n\r\nexport abstract class CUqSub<T extends CUqBase> extends CSub<T> {\r\n\tget cApp(): CApp { return this._cApp; }\r\n\tprotected get uqs(): UQs { return this._uqs as UQs };\r\n\tget owner(): T { return this._owner as T }\r\n}\r\n\r\nexport abstract class CUqApp extends CAppBase {\r\n\tget uqs(): UQs { return this._uqs };\r\n\r\n\tprotected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n\t\tlet c = new type(this);\r\n\t\tc.init();\r\n\t\treturn c;\r\n\t}\r\n}\r\n`;\r\n}\r\nfunction buildTsVMain() {\r\n\treturn `${buildTsHeader()}\r\nimport { VPage, Page } from 'tonva';\r\nimport { CApp } from './CApp';\r\n\r\nexport class VMain extends VPage<CApp> {\r\n\tasync open(param?: any, onClosePage?: (ret:any)=>void) {\r\n\t\tthis.openPage(this.render, param, onClosePage);\r\n\t}\r\n\r\n\trender = (param?: any): JSX.Element => {\r\n\t\treturn <Page header=\"TEST\">\r\n\t\t\t<div className=\"m-3\">\r\n\t\t\t\t<div>{this.renderMe()}</div>\r\n\t\t\t\t<div className=\"mb-5\">同花样例主页面</div>\r\n\t\t\t</div>\r\n\t\t</Page>;\r\n\t}\r\n}\r\n`;\r\n}\r\n\r\nasync function buildUqsFolder(uqsFolder:string, options: UqAppOptions) {\r\n\tawait uqAppStart(options);\r\n\r\n\tlet uqsMan = UQsMan.value;\r\n\tlet coll = uqsMan.getUqCollection();\r\n\t\r\n\tlet promiseArr:Promise<void>[] = [];\r\n\tlet uqs:UqMan[] = [];\r\n\tfor (let i in coll) {\r\n\t\tlet lowerI = i.toLowerCase();\r\n\t\tif (lowerI !== i) continue;\r\n\t\tuqs.push(coll[i]);\r\n\t}\r\n\t\r\n\tif (!uqsMan.id) {\r\n\t\tlet error = options.uqAppName + ' not defined!';\r\n\t\tthrow new Error(error);\r\n\t}\r\n\r\n\tfor (let uq of uqs) {\r\n\t\tpromiseArr.push(loadUqEntities(uq));\r\n\t}\r\n\tawait Promise.all(promiseArr);\r\n\r\n\tif (!fs.existsSync(uqsFolder)) {\r\n\t\tfs.mkdirSync(uqsFolder);\r\n\t}\r\n\tlet tsUqsIndexHeader = buildTsHeader();\r\n\tlet tsUqsIndexContent = `\\n\\nexport interface UQs {`;\r\n\tlet tsUqsExports = '\\n\\n';\r\n\tfor (let uq of uqs) {\r\n\t\tlet {uqOwner, uqName} = uq;\r\n\t\tlet o1 = getUqOwnerName(uqOwner);\r\n\t\tlet n1 = getUqName(uqName);\r\n\t\tlet tsUq = buildTsUq(uq);\r\n\t\toverrideTsFile(uqsFolder, o1+n1, tsUq);\r\n\t\t// as ${o1}${n1}\r\n\t\ttsUqsIndexHeader += `\\nimport { ${o1}${n1} } from './${o1}${n1}';`;\r\n\t\ttsUqsIndexContent += `\\n\\t${o1}${n1}: ${o1}${n1}.Uq${o1}${n1};`;\r\n\r\n\t\ttsUqsExports += `\\nexport {`; \r\n\t\tfor (let enm of uq.enumArr) {\r\n\t\t\tlet enmName = `${capitalCaseString(enm.sName)}`;\r\n\t\t\ttsUqsExports += `\\n\\t${enmName} as ${o1}${n1}${enmName},`;\r\n\t\t}\r\n\t\ttsUqsExports += `\\n} from './${o1}${n1}';`;\r\n\t}\r\n\r\n\toverrideTsFile(uqsFolder, 'index', \r\n\t\ttsUqsIndexHeader + tsUqsIndexContent + '\\n}' + tsUqsExports + '\\n');\r\n}\r\n\r\nfunction buildTsUq(uq: UqMan) {\r\n\tlet ret = buildTsHeader();\r\n\tret += '\\nimport { UqTuid, UqQuery, UqAction, UqSheet/*, Map, Tag*/ } from \"tonva\";';\r\n\r\n\t//for (let uq of uqs) {\r\n\t\tret += '\\n';\r\n\t\tret += '\\n//===============================';\r\n\t\tret += `\\n//======= UQ ${uq.name} ========`;\r\n\t\tret += '\\n//===============================';\r\n\t\tret += '\\n';\r\n\t\tret += buildUQ(uq);\r\n\t\tret += '\\n';\r\n\t\tret += '\\n';\r\n\t//}\r\n\t/*\r\n\tret += '\\n//===============================';\r\n\tret += `\\n//============= UQs =============`;\r\n\tret += '\\n//===============================';\r\n\tret += '\\nexport interface UQs {';\r\n\tfor (let uq of uqs) {\r\n\t\tlet {uqOwner, uqName} = uq;\r\n\t\tlet o1 = getUqOwnerName(uqOwner);\r\n\t\tlet n1 = getUqName(uqName);\r\n\t\tret += `\\n\\t${o1}${n1}: ${o1}${n1}.Uq;`;\r\n\t}\r\n\tret += '\\n}\\n';\r\n\t*/\r\n\treturn ret;\r\n}\r\n\r\nfunction capitalCaseString(s:string):string {\r\n\tlet parts = s.split(/[-._]/);\r\n\treturn parts.map(v => firstCharUppercase(v)).join('');\r\n}\r\n\r\nfunction camelCaseString(s:string):string {\r\n\tlet parts = s.split(/[-._]/);\r\n\tlet len = parts.length;\r\n\tparts[0] = firstCharLowercase(parts[0]);\r\n\tfor (let i=1; i<len; i++) {\r\n\t\tparts[1] = firstCharUppercase(parts[1]);\r\n\t}\r\n\treturn parts.join('');\r\n}\r\nfunction entityName(s:string):string {\r\n\treturn capitalCaseString(s);\r\n}\r\n\r\nfunction getUqOwnerName(uqOwner:string) {\r\n\tlet uo = gUqOwnerMap[uqOwner.toLowerCase()];\r\n\tif (uo === undefined) return '';\r\n\tif (uo.length === 0) return '';\r\n\treturn capitalCaseString(uo);\r\n}\r\n\r\nfunction getUqName(uqName:string) {\r\n\treturn capitalCaseString(uqName);\r\n}\r\n\r\nfunction uqBlock<T extends Entity>(entity: T, build: (entity: T)=>string) {\r\n\tlet {name} = entity;\r\n\tif (name.indexOf('$') > 0) return '';\r\n\tlet entityCode = build(entity);\r\n\tif (!entityCode) return '';\r\n\treturn '\\n' + entityCode;\r\n}\r\n\r\nfunction uqEntityInterface<T extends Entity>(entity: T, buildInterface: (entity: T)=>string) {\r\n\tlet {name} = entity;\r\n\tif (name.indexOf('$') > 0) return '';\r\n\tlet entityCode = buildInterface(entity);\r\n\tif (!entityCode) return '';\r\n\t//return uqFirstLine(entity) + \r\n\treturn '\\n' + entityCode + '\\n';\r\n}\r\n\r\nconst aCode = 'a'.charCodeAt(0);\r\nconst zCode = 'z'.charCodeAt(0);\r\nfunction firstCharUppercase(s:string) {\r\n\tif (!s) return '';\r\n\tlet c = s.charCodeAt(0);\r\n\tif (c >= aCode && c <= zCode) {\r\n\t\treturn String.fromCharCode(c - 0x20) + s.substr(1);\r\n\t}\r\n\treturn s;\r\n}\r\nconst ACode = 'A'.charCodeAt(0);\r\nconst ZCode = 'Z'.charCodeAt(0);\r\nfunction firstCharLowercase(s:string) {\r\n\tif (!s) return '';\r\n\tlet c = s.charCodeAt(0);\r\n\tif (c >= ACode && c <= ZCode) {\r\n\t\treturn String.fromCharCode(c + 0x20) + s.substr(1);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nasync function loadUqEntities(uq:UqMan):Promise<void> {\r\n\tawait uq.loadAllSchemas();\r\n\t/*\r\n\tlet arr: Promise<any>[] = [];\r\n    uq.actionArr.forEach(v => arr.push(v.loadSchema()));\r\n    uq.enumArr.forEach(v => arr.push(v.loadSchema()));\r\n    uq.sheetArr.forEach(v => arr.push(v.loadSchema()));\r\n    uq.queryArr.forEach(v => arr.push(v.loadSchema()));\r\n    uq.bookArr.forEach(v => arr.push(v.loadSchema()));\r\n    uq.mapArr.forEach(v => arr.push(v.loadSchema()));\r\n    uq.historyArr.forEach(v => arr.push(v.loadSchema()));\r\n    uq.pendingArr.forEach(v => arr.push(v.loadSchema()));\r\n\tuq.tagArr.forEach(v => arr.push(v.loadSchema()));\r\n\tawait Promise.all(arr);\r\n\t*/\r\n}\r\n\r\nfunction buildUQ(uq:UqMan) {\r\n\tlet {uqOwner, uqName} = uq;\r\n\tlet ts:string = ``;\r\n\tuq.enumArr.forEach(v => ts += uqEntityInterface<UqEnum>(v, buildEnumInterface));\r\n\t\r\n\tts += `\\nexport declare namespace ${getUqOwnerName(uqOwner)}${getUqName(uqName)} {`;\r\n\tuq.tuidArr.forEach(v => ts += uqEntityInterface<Tuid>(v, buildTuidInterface));\r\n    uq.actionArr.forEach(v => ts += uqEntityInterface<Action>(v, buildActionInterface));\r\n    uq.sheetArr.forEach(v => ts += uqEntityInterface<Sheet>(v, buildSheetInterface));\r\n    uq.queryArr.forEach(v => ts += uqEntityInterface<Query>(v, buildQueryInterface));\r\n    uq.bookArr.forEach(v => ts += uqEntityInterface<Book>(v, buildBookInterface));\r\n    uq.mapArr.forEach(v => ts += uqEntityInterface<Map>(v, buildMapInterface));\r\n    uq.historyArr.forEach(v => ts += uqEntityInterface<History>(v, buildHistoryInterface));\r\n    uq.pendingArr.forEach(v => ts += uqEntityInterface<Pending>(v, buildPendingInterface));\r\n\tuq.tagArr.forEach(v => ts += uqEntityInterface<Tag>(v, buildTagInterface));\r\n\r\n\tts += `\\n\\nexport interface Uq${getUqOwnerName(uqOwner)}${getUqName(uqName)} {`;\r\n\tuq.tuidArr.forEach(v => ts += uqBlock<Tuid>(v, buildTuid));\r\n    uq.actionArr.forEach(v => ts += uqBlock<Action>(v, buildAction));\r\n    //uq.enumArr.forEach(v => ts += uqBlock<UqEnum>(v, buildEnum));\r\n    uq.sheetArr.forEach(v => ts += uqBlock<Sheet>(v, buildSheet));\r\n    uq.queryArr.forEach(v => ts += uqBlock<Query>(v, buildQuery));\r\n    uq.bookArr.forEach(v => ts += uqBlock<Book>(v, buildBook));\r\n    uq.mapArr.forEach(v => ts += uqBlock<Map>(v, buildMap));\r\n    uq.historyArr.forEach(v => ts += uqBlock<History>(v, buildHistory));\r\n    uq.pendingArr.forEach(v => ts += uqBlock<Pending>(v, buildPending));\r\n\tuq.tagArr.forEach(v => ts += uqBlock<Tag>(v, buildTag));\r\n\tts += '\\n}\\n}\\n';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildFields(fields: Field[], indent:number = 1) {\r\n\tif (!fields) return;\r\n\tlet ts = '';\r\n\tfor (let f of fields) {\r\n\t\tts += buildField(f, indent);\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nconst fieldTypeMap:{[type:string]:string} = {\r\n\t\"char\": \"string\",\r\n\t\"text\": \"string\",\r\n\t\"id\": \"number\",\r\n\t\"int\": \"number\",\r\n\t\"bigint\": \"number\",\r\n\t\"smallint\": \"number\",\r\n\t\"tinyint\": \"number\",\r\n};\r\nfunction buildField(field: Field, indent:number = 1) {\r\n\tlet {type} = field;\r\n\tlet s = fieldTypeMap[type];\r\n\tif (!s) s = 'any';\r\n\treturn `\\n${'\\t'.repeat(indent)}${field.name}: ${s};`;\r\n}\r\n\r\nfunction buildArrs(arrFields: ArrFields[]):string {\r\n\tif (!arrFields) return '';\r\n\tlet ts = '\\n';\r\n\tfor (let af of arrFields) {\r\n\t\tts += `\\t${camelCaseString(af.name)}: {`;\r\n\t\tts += buildFields(af.fields, 2);\r\n\t\tts += '\\n\\t}[];\\n';\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nconst typeMap:{[type:string]:string} = {\r\n\taction: 'Action',\r\n\tquery: 'Query',\r\n}\r\nfunction buildReturns(entity:Entity, returns:ArrFields[]):string {\r\n\tif (!returns) return;\r\n\t//let {typeName} = entity;\r\n\t//let type = typeMap[typeName] || typeName;\r\n\tlet {sName} = entity;\r\n\tsName = capitalCaseString(sName);\r\n\tlet ts = '';\r\n\tfor (let ret of returns) {\r\n\t\tlet retName = capitalCaseString(ret.name);\r\n\t\tts += `interface Return${sName}${retName} {`;\r\n\t\tts += buildFields(ret.fields);\r\n\t\tts += '\\n}\\n';\r\n\t}\r\n\r\n\tts += `interface Result${sName} {\\n`;\r\n\tfor (let ret of returns) {\r\n\t\tlet retName = capitalCaseString(ret.name);\r\n\t\tts += `\\t${ret.name}: Return${sName}${retName}[];\\n`;\r\n\t}\r\n\tts += '}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildTuid(tuid: Tuid) {\r\n\tlet ts = `\\t${entityName(tuid.sName)}: UqTuid<Tuid${capitalCaseString(tuid.sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildTuidInterface(tuid: Tuid) {\r\n\tlet ts = `export interface Tuid${capitalCaseString(tuid.sName)} {`;\r\n\tts += buildFields(tuid.fields);\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildAction(action: Action) {\r\n\tlet ts = `\\t${entityName(action.sName)}: UqAction<Param${capitalCaseString(action.sName)}, Result${capitalCaseString(action.sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildActionInterface(action: Action) {\r\n\tlet ts = `export interface Param${capitalCaseString(action.sName)} {`;\r\n\tts += buildFields(action.fields);\r\n\tts += buildArrs(action.arrFields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(action, action.returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildEnumInterface(enm: UqEnum) {\r\n\tlet {schema} = enm;\r\n\tif (!schema) return;\r\n\tlet {values} = schema;\r\n\tlet ts = `export enum ${capitalCaseString(enm.sName)} {`;\r\n\tlet first:boolean = true;\r\n\tfor (let i in values) {\r\n\t\tif (first === false) {\r\n\t\t\tts += ',';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfirst = false;\r\n\t\t}\r\n\t\tlet v = values[i];\r\n\t\tts += '\\n\\t' + i + ' = ';\r\n\t\tif (typeof v === 'string') {\r\n\t\t\tts += '\"' + v + '\"';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tts += v;\r\n\t\t}\r\n\t}\r\n\treturn ts += '\\n};'\r\n}\r\n\r\nfunction buildQuery(query: Query) {\r\n\tlet {sName} = query;\r\n\tlet ts = `\\t${entityName(sName)}: UqQuery<Param${capitalCaseString(sName)}, Result${capitalCaseString(sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildQueryInterface(query: Query) {\r\n\tlet ts = `export interface Param${capitalCaseString(query.sName)} {`;\r\n\tts += buildFields(query.fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(query, query.returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildSheet(sheet: Sheet) {\r\n\tlet {sName, verify} = sheet;\r\n\tlet cName = capitalCaseString(sName);\r\n\tlet v = verify? `Verify${cName}` : 'any';\r\n\tlet ts = `\\t${entityName(sName)}: UqSheet<Sheet${cName}, ${v}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildSheetInterface(sheet: Sheet) {\r\n\tlet {sName, fields, arrFields, verify} = sheet;\r\n\tlet ts = `export interface Sheet${capitalCaseString(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += buildArrs(arrFields);\r\n\tts += '}';\r\n\r\n\tif (verify) {\r\n\t\tlet {returns} = verify;\r\n\t\tts += `\\nexport interface Verify${capitalCaseString(sName)} {`;\r\n\t\tfor (let item of returns) {\r\n\t\t\tlet {name:arrName, fields} = item;\r\n\t\t\tts += '\\n\\t' + arrName + ': {';\r\n\t\t\tts += buildFields(fields, 2);\r\n\t\t\tts += '\\n\\t}[];';\r\n\t\t}\r\n\t\tts += '\\n}';\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nfunction buildBook(book: Book):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildBookInterface(book: Book):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildMap(map: Map):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildMapInterface(map: Map):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildHistory(history: History):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildHistoryInterface(history: History):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildPending(pending: Pending):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildPendingInterface(pending: Pending):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildTag(tag: Tag):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildTagInterface(tag: Tag):string {\r\n\treturn;\r\n}\r\n","module.exports = __webpack_public_path__ + \"static/media/logo_pointShop.644af5a6.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/homeTopicMap.89cdf192.jpg\";","module.exports = __webpack_public_path__ + \"static/media/TriangleShadingO.abe107d7.png\";","module.exports = __webpack_public_path__ + \"static/media/TriangleShadingT.7a55757e.png\";","module.exports = __webpack_public_path__ + \"static/media/signTopicMap.928fc4cf.png\";","module.exports = __webpack_public_path__ + \"static/media/signViceMap.6387bb88.png\";","module.exports = __webpack_public_path__ + \"static/media/Homemadelogo.06f15feb.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 239;","import { observable } from 'mobx';\r\nimport moment from 'moment';\r\nimport { CApp } from 'tapp';\r\nimport { BoxId } from 'tonva';\r\nimport { MainBrand, Chemical } from './model';\r\n\r\nexport interface InventoryAllocation {\r\n\twarehouse: BoxId;\r\n\tquantity: number;\r\n\tdeliveryTimeDescription: string;\r\n}\r\n\r\nexport interface PackRow {\r\n\tpack: BoxId;\r\n\tquantity: number;\r\n}\r\n\r\nexport interface ProductPackRow extends PackRow {\r\n\tretail: number;\r\n\tvipPrice?: number;\r\n\tpromotionPrice?: number;\r\n\tcurrency: BoxId;\r\n\tinventoryAllocation: InventoryAllocation[];\r\n}\r\n\r\nexport interface ProductProps {\r\n\tid: BoxId; \t\t\t\t// {id: 525, tuid: TuidInner, ui: ƒ, isUndefined: false}\r\n\torigin: string;\r\n\tdescription: string;\r\n\tdescriptionC: string;\r\n\timageUrl: string;\r\n\tbrand: BoxId;\r\n\tCAS: string; \t\t\t\t// '50525-27-4'\r\n\tchemical: BoxId; \t\t\t// ReactBoxId {id: 2030, tuid: TuidInner, ui: undefined, isUndefined: false}\r\n\tmolecularWeight: string; \t//'748.63'\r\n\tmolecularFomula: string;\r\n\tno: string; //\t\t\t\t// 'A01102033'\r\n\tpurity: string; \t\t\t// '98%'\r\n\t// seq: number;\r\n}\r\n\r\nexport class Product {\r\n\tprivate cApp: CApp;\r\n\r\n\tid: number;\r\n\t@observable.ref props: ProductProps;\r\n\r\n\t@observable.ref brand: MainBrand;\r\n\t@observable.ref chemical: Chemical;\r\n\t@observable favorite: boolean;\r\n\t@observable.shallow packs: ProductPackRow[];\r\n\t@observable prices: any[];\t\t\t\t// 包含价格和折扣信息\r\n\t@observable futureDeliveryTimeDescription: string;\r\n\t@observable MSDSFiles: any;\r\n\t@observable specFiles: any;\r\n\t@observable data: any;\r\n\t@observable discount: any;\r\n\r\n\tconstructor(cApp: CApp, id: number | BoxId) {\r\n\t\tthis.cApp = cApp;\r\n\t\tthis.id = typeof id === 'object' ? id.id : id;\r\n\t}\r\n\r\n\tgetInventoryAllocation(packId: number): InventoryAllocation[] {\r\n\t\treturn undefined;\r\n\t\tif (this.packs === undefined) return undefined;\r\n\t\tlet pack = this.packs.find(v => v.pack.id === packId);\r\n\t\tif (!pack) return undefined;\r\n\t\treturn pack.inventoryAllocation;\r\n\t}\r\n\r\n\tasync loadDetail() {\r\n\t\tthis.discount = 0;\r\n\t\tawait this.loadBase();\r\n\t\tawait this.loadBrand();\r\n\t\tlet promises: PromiseLike<any>[] = [\r\n\t\t\tthis.loadChemical(),\r\n\t\t\tthis.loadFavorite(),\r\n\t\t\tthis.loadPrices(),\r\n\t\t\tthis.loadMSDSFile(),\r\n\t\t\tthis.loadSpecFile(),\r\n\t\t\tthis.loadFDTimeDescription()\r\n\t\t];\r\n\t\tawait Promise.all(promises);\r\n\t}\r\n\r\n\tasync loadListItem() {\r\n\t\tawait this.loadBase();\r\n\t\tawait this.loadBrand();\r\n\t\tlet promises: PromiseLike<any>[] = [\r\n\t\t\tthis.loadChemical(),\r\n\t\t\tthis.loadFavorite(),\r\n\t\t\tthis.loadPrices(),\r\n\t\t];\r\n\t\tawait Promise.all(promises);\r\n\t}\r\n\r\n\tprivate async loadBase() {\r\n\t\tif (this.props) return;\r\n\t\tlet ret = await this.cApp.uqs.product.ProductX.load(this.id);\r\n\t\tthis.props = ret;\r\n\t}\r\n\r\n\tprivate async loadBrand() {\r\n\t\tif (this.brand) return;\r\n\t\tlet ret = await this.cApp.uqs.product.Brand.load(this.props.brand);\r\n\t\tthis.brand = ret;\r\n\t}\r\n\r\n\tprivate async loadChemical() {\r\n\t\tif (this.chemical) return;\r\n\t\tlet ret = await this.cApp.uqs.product.ProductChemical.obj({ product: this.id });\r\n\t\tthis.chemical = ret;\r\n\t}\r\n\r\n\tasync loadFavorite() {\r\n\t\tif (this.favorite !== undefined) return;\r\n\t\tlet ret = await this.cApp.uqs.webuser.myFavorites.obj({ webUser: this.cApp.currentUser, product: this.id });\r\n\t\tthis.favorite = (ret !== undefined);\r\n\t}\r\n\r\n\t/**\r\n\t * 获取产品MSDS文件\r\n\t */\r\n\tprivate async loadMSDSFile() {\r\n\t\tif (this.MSDSFiles) return;\r\n\t\tlet productMSDSFiles = await this.cApp.uqs.product.ProductMSDSFile.table({ product: 11 });\r\n\t\tthis.MSDSFiles = productMSDSFiles.sort((a: any, b: any) => b.language.id - a.language.id);\r\n\t}\r\n\r\n\t/**\r\n\t * 获取产品Spec文件\r\n\t */\r\n\tprivate async loadSpecFile() {\r\n\t\tif (this.specFiles) return;\r\n\t\tthis.specFiles = await this.cApp.uqs.product.ProductSpecFile.table({ product: 11 });\r\n\t}\r\n\r\n\tprivate async loadPrices() {\r\n\t\tlet { customerDiscount, product, promotion, warehouse } = this.cApp.uqs;\r\n\t\tlet discount = 0;\r\n\t\tlet { currentUser, currentSalesRegion, cart, currentLanguage } = this.cApp;\r\n\t\t//线上客户是否是线下客户 协议折扣  discount\r\n\t\tif (currentUser.hasCustomer) {\r\n\t\t\tlet discountSetting = await customerDiscount.GetDiscount.obj({ brand: this.brand.id, customer: currentUser.currentCustomer });\r\n\t\t\tif (discountSetting && discountSetting.discount)\r\n\t\t\t\tdiscount = discountSetting.discount;\r\n\t\t}\r\n\r\n\t\t// 协议客户与vip客户不同存\r\n\t\tif (currentUser.webUserVIPCard !== undefined) {\r\n\t\t\tlet brandDiscounts = currentUser.VIPDiscount;\r\n\t\t\tlet brandDiscount = brandDiscounts.ret.find((e: any) => e.brand.id === this.brand.id);\r\n\t\t\t// 协议与vip折扣比较 取其大值  (两者不可同存)\r\n\t\t\tif (brandDiscount && brandDiscount.discount > discount)\r\n\t\t\t\tdiscount = brandDiscount && brandDiscount.discount;\r\n\t\t}\r\n\r\n\t\tlet { id: currentSalesRegionId } = currentSalesRegion;\r\n\t\tlet prices = await product.PriceX.table({ product: this.id, salesRegion: currentSalesRegionId });\r\n\r\n\t\tthis.prices = prices.filter(e => e.discountinued === 0 && e.expireDate > Date.now()).sort((a, b) => a.retail - b.retail).map(element => {\r\n\t\t\tlet ret: any = {};\r\n\t\t\tret.pack = element.pack;\r\n\t\t\tret.retail = element.retail;\r\n\t\t\tif (discount !== 0)\r\n\t\t\t\tret.vipPrice = Math.round(element.retail * (1 - discount));\r\n\t\t\tret.currency = currentSalesRegion.currency;\r\n\t\t\tif (cart) {\r\n\t\t\t\tret.quantity = cart.getQuantity(this.id, element.pack.id)\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t});\r\n\r\n\t\tlet promises: PromiseLike<any>[] = [];\r\n\t\tlet promises1: PromiseLike<any>[] = [];\r\n\t\t// let promises2: PromiseLike<any>[] = [];/* 收藏夹 暂时不做 */\r\n\t\tthis.prices.forEach(v => {\r\n\t\t\tpromises.push(promotion.GetPromotionPack.obj({ product: this.id, pack: v.pack, salesRegion: currentSalesRegion, language: currentLanguage }));\r\n\t\t\tpromises1.push(warehouse.GetInventoryAllocation.table({ product: this.id, pack: v.pack, salesRegion: currentSalesRegion }));\r\n\t\t\t// promises2.push(this.cApp.uqs.webuser.myFavorites.obj({ webUser: this.cApp.currentUser, product: this.id, pack: v.pack.id }));\r\n\t\t});\r\n\t\tlet results = await Promise.all(promises);\r\n\t\tlet results2 = await Promise.all(promises1);\r\n\t\t// let resultsFavorite = await Promise.all(promises2);\r\n\r\n\t\tlet newPacks = [];\r\n\t\tfor (let i = 0; i < this.prices.length; i++) {\r\n\t\t\tlet inventoryAllocation = results2.find((v: any[]) => {\r\n\t\t\t\tlet res = v.filter((j: any) => j.pack.id === this.prices[i].pack.id);\r\n\t\t\t\treturn res.length;\r\n\t\t\t});\r\n\t\t\tnewPacks.push({ ...this.prices[i], inventoryAllocation: inventoryAllocation })\r\n\r\n\t\t\tlet price = this.prices[i];\r\n\t\t\tlet promotion = results[i];\r\n\t\t\tlet discount = promotion && promotion.discount;\r\n\t\t\tif (discount)\r\n\t\t\t\tprice.promotionPrice = Math.round((1 - discount) * price.retail);\r\n\t\t}\r\n\t\tthis.packs = newPacks;\r\n\t}\r\n\r\n\tasync loadPacks(param: any) {\r\n\t\tlet { currentSalesRegion, uqs } = this.cApp;\r\n\t\tlet { pack, quantity, retail, currency } = param;\r\n\t\tlet inventoryAllocation = await uqs.warehouse.GetInventoryAllocation.table({ product: this.id, pack: pack, salesRegion: currentSalesRegion });\r\n\t\tthis.packs = [{ pack, quantity, retail, currency, inventoryAllocation }];\r\n\t}\r\n\r\n\tprivate async addProductFavorites(pack?: any) {\r\n\t\tlet { currentUser } = this.cApp;\r\n\t\tlet createDate = moment().format('YYYY-MM-DD HH:mm:ss');\r\n\t\tawait this.cApp.uqs.webuser.myFavorites.add({ webUser: currentUser, product: this.id, arr1: [{ pack: 0, date: createDate }] });\r\n\t\tthis.favorite = true;\r\n\t}\r\n\r\n\tprivate async delProductFavorites(pack?: any) {\r\n\t\tlet { currentUser } = this.cApp;\r\n\t\tawait this.cApp.uqs.webuser.myFavorites.del({ webUser: currentUser, product: this.id, arr1: [{ pack: 0 }] });\r\n\t\tthis.favorite = false;\r\n\t}\r\n\r\n\tfavoriteOrCancel = async (pack?: any) => {\r\n\t\tawait this.cApp.assureLogin();\r\n\t\tawait this.loadFavorite();\r\n\t\tif (this.favorite === true) {\r\n\t\t\tawait this.delProductFavorites();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tawait this.addProductFavorites();\r\n\t\t}\r\n\t}\r\n\r\n\tgetProductAndDiscount = async (productId: BoxId) => {\r\n\t\tlet product = await this.cApp.uqs.product.ProductX.load(productId);\r\n\t\tlet discount = 0;\r\n\t\tlet { currentUser } = this.cApp;\r\n\t\tif (currentUser.hasCustomer) {\r\n\t\t\tlet discountSetting = await this.cApp.uqs.customerDiscount.GetDiscount.obj({ brand: product.brand.id, customer: currentUser.currentCustomer });\r\n\t\t\tdiscount = discountSetting && discountSetting.discount;\r\n\t\t}\r\n\t\treturn { product: product, discount: discount };\r\n\t}\r\n\r\n\t/**\r\n\t * 获取PDF文件流\r\n\t */\r\n\tgetPDFFileUrl = async (captcha: string) => {\r\n\t\tdebugger;\r\n\t\t/*\r\n\t\tlet lang = this.currentLanguage ? this.currentLanguage.id : undefined;\r\n\t\tlet productId = this.currentProduct ? this.currentProduct.id : undefined;\r\n\t\t// let res = await window.fetch(GLOABLE.CONTENTSITE + `/partial/productpdffile/${captcha}/${32}/${7084}`);\r\n\t\tlet res = await window.fetch(GLOABLE.CONTENTSITE + `/partial/productpdffile/${captcha}/${lang}/${productId}`);\r\n\t\tif (res.status === 200) {\r\n\t\t\tlet content = await res.arrayBuffer();\r\n\t\t\treturn content;\r\n\t\t} else {\r\n\t\t\treturn {\r\n\t\t\t\tstatus: res.status,\r\n\t\t\t\tmsg: res.status !== 412 ? res.statusText : '验证码错误!'\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\t/**\r\n\t * 获取验证码\r\n\t */\r\n\tgetVerifyCode = async () => {\r\n\t\tdebugger;\r\n\t\t/*\r\n\t\tlet timer = (new Date()).getTime()\r\n\t\tthis.verifyCode = GLOABLE.CONTENTSITE + `/partial/captcha/?timer=${timer}`;//'http://dummyimage.com/200x100';\r\n\t\t*/\r\n\t}\r\n\r\n\tprivate async loadFDTimeDescription() {\r\n\t\tlet { currentSalesRegion, uqs } = this.cApp;\r\n\t\tlet futureDeliveryTime = await uqs.product.GetFutureDeliveryTime.table({ product: this.id, salesRegion: currentSalesRegion });\r\n\t\tif (futureDeliveryTime.length > 0) {\r\n\t\t\tlet { minValue, maxValue, unit, deliveryTimeDescription } = futureDeliveryTime[0];\r\n\t\t\tthis.futureDeliveryTimeDescription = minValue + (maxValue > minValue ? '~' + maxValue : '') + ' ' + unit;\r\n\t\t} else {\r\n\t\t\tthis.futureDeliveryTimeDescription = '';\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\tgetChemicalInfo(product: number|BoxId):any {\r\n\t\tlet p = this.getCacheProduct(product);\r\n\t\tlet {chemical} = p;\r\n\t\tif (chemical) return chemical;\r\n\t\tif (chemical === null) return null;\r\n\t\tif (chemical as any === '') return null;\r\n\t\tp.chemical = '';\r\n\t\tthis.uqs.product.ProductChemical.obj({ product }).then(value => {\r\n\t\t\tp.chemical = value;\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\t*/\r\n\r\n\t/*\r\n\tgetInventoryAllocation(product: number|BoxId, pack: number|BoxId): any[] {\r\n\t\tlet p = this.getCacheProduct(product);\r\n\t\tlet {inventoryAllocation} = p;\r\n\t\tif (inventoryAllocation) return inventoryAllocation;\r\n\t\tif (inventoryAllocation === null) return null;\r\n\t\tif (inventoryAllocation as any === '') return null;\r\n\t\tp.inventoryAllocation = '' as any;\r\n\t\tthis.uqs.warehouse.GetInventoryAllocation.table({ product, pack, salesRegion: this.cApp.currentSalesRegion }).then(results => {\r\n\t\t\tp.inventoryAllocation = results;\r\n\t\t});\r\n\t}\r\n\r\n\tgetFutureDeliveryTimeDescription(product: number|BoxId) {\r\n\t\tlet p = this.getCacheProduct(product);\r\n\t\tlet {futureDeliveryTimeDescription} = p;\r\n\t\tif (futureDeliveryTimeDescription) return futureDeliveryTimeDescription;\r\n\t\tif (futureDeliveryTimeDescription === null) return null;\r\n\t\tif (futureDeliveryTimeDescription === '') return null;\r\n\t\tp.futureDeliveryTimeDescription = '';\r\n\t\tthis.uqs.product.GetFutureDeliveryTime.table({ product, salesRegion: this.cApp.currentSalesRegion.id}).then(futureDeliveryTime => {\r\n\t\t\tlet value: string;\r\n\t\t\tif (futureDeliveryTime.length > 0) {\r\n\t\t\t\tlet { minValue, maxValue, unit, deliveryTimeDescription } = futureDeliveryTime[0];\r\n\t\t\t\tvalue = minValue + (maxValue > minValue ? '~' + maxValue : '') + ' ' + unit;\r\n\t\t\t} else {\r\n\t\t\t\tvalue = null;\r\n\t\t\t}\r\n\t\t\tp.futureDeliveryTimeDescription = value;\r\n\t\t});\r\n\t}\r\n\r\n\tgetPrices(product: BoxId, discount:number): any[] {\r\n\t\tlet p = this.getCacheProduct(product);\r\n\t\tlet {prices} = p;\r\n\t\tif (prices) return prices;\r\n\t\tif (prices === null) return null;\r\n\t\tif (prices as any === '') return null;\r\n\t\tp.prices = '';\r\n\t\tlet { id: productId } = product;\r\n\t\tlet { currentSalesRegion, cart, currentLanguage, uqs } = this.cApp;\r\n\r\n\t\tuqs.product.PriceX.table({ product: product, salesRegion: currentSalesRegion }).then(pricesResult => {\r\n\t\t\tlet priceSets = pricesResult.filter(e => e.discountinued === 0 && e.expireDate > Date.now()).sort((a, b) => a.retail - b.retail).map(element => {\r\n\t\t\t\tlet ret: any = {};\r\n\t\t\t\tret.pack = element.pack;\r\n\t\t\t\tret.retail = element.retail;\r\n\t\t\t\tif (discount !== 0)\r\n\t\t\t\t\tret.vipPrice = Math.round(element.retail * (1 - discount));\r\n\t\t\t\tret.currency = currentSalesRegion.currency;\r\n\t\t\t\tret.quantity = cart.getQuantity(productId, element.pack.id)\r\n\t\t\t\treturn ret;\r\n\t\t\t});\r\n\t\t\tlet promises: PromiseLike<any>[] = priceSets.map(v => {\r\n\t\t\t\treturn uqs.promotion.GetPromotionPack.obj({ product: productId, pack: v.pack, salesRegion: currentSalesRegion, language: currentLanguage });\r\n\t\t\t})\r\n\t\t\tPromise.all(promises).then(results => {\r\n\t\t\t\tfor (let i = 0; i < priceSets.length; i++) {\r\n\t\t\t\t\tlet priceSet = priceSets[i];\r\n\t\t\t\t\tlet promotion = results[i];\r\n\t\t\t\t\tlet discount = promotion && promotion.discount;\r\n\t\t\t\t\tif (discount)\r\n\t\t\t\t\t\tpriceSet.promotionPrice = Math.round((1 - discount) * priceSet.retail);\r\n\t\t\t\t}\r\n\t\t\t\tp.prices = priceSets;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t*/\r\n\r\n\t/*\r\n\tgetInventoryAllocation = async (productId: number, packId: number, salesRegionId: number) => {\r\n\t\treturn await this.uqs.warehouse.GetInventoryAllocation.table({ product: productId, pack: packId, salesRegion: this.cApp.currentSalesRegion });\r\n\t}\r\n\r\n\tgetFutureDeliveryTimeDescription = async (productId: number, salesRegionId: number) => {\r\n\t\tlet cacheId = productId + '_' + salesRegionId;\r\n\t\tif (this.futureDeliveryTimeDescriptionContainer[cacheId] === undefined) {\r\n\t\t\tlet futureDeliveryTime = await this.uqs.product.GetFutureDeliveryTime.table({ product: productId, salesRegion: salesRegionId });\r\n\t\t\tif (futureDeliveryTime.length > 0) {\r\n\t\t\t\tlet { minValue, maxValue, unit, deliveryTimeDescription } = futureDeliveryTime[0];\r\n\t\t\t\tthis.futureDeliveryTimeDescriptionContainer[cacheId] = minValue + (maxValue > minValue ? '~' + maxValue : '') + ' ' + unit;\r\n\t\t\t} else {\r\n\t\t\t\tthis.futureDeliveryTimeDescriptionContainer[cacheId] = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this.futureDeliveryTimeDescriptionContainer[cacheId];\r\n\t}\r\n\t*/\r\n\r\n}\r\n","\nvar content = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-3-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-3-1!../../node_modules/postcss-loader/src/index.js??postcss!./style.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-3-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-3-1!../../node_modules/postcss-loader/src/index.js??postcss!./style.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-3-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-3-1!../../node_modules/postcss-loader/src/index.js??postcss!./style.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import _ from 'lodash';\r\nimport { Context } from '../context';\r\nimport { FormRes } from '../../../res/formRes';\r\n\r\nexport abstract class Rule {\r\n    abstract check(defy:string[], value:any):void;\r\n}\r\n\r\nexport type ContextRule = (context:Context)=>{[target:string]:string[]|string} | string[] | string;\r\nexport type FieldRule = (value:any) => string[] | string;\r\n\r\nexport class RuleCustom extends Rule {\r\n    private func: FieldRule;\r\n    constructor(func: FieldRule) {\r\n        super();\r\n        this.func = func;\r\n    }\r\n    check(defy:string[], value:any) {\r\n        let ret = this.func(value);\r\n        if (ret === undefined) return;\r\n        switch (typeof ret) {\r\n            case 'undefined': return;\r\n            case 'string': defy.push(ret as string); return;\r\n            default: defy.push(...ret); return;\r\n        }        \r\n    }\r\n}\r\n\r\nexport abstract class RulePredefined extends Rule {\r\n    protected res: FormRes;\r\n    constructor(res: FormRes) {\r\n        super();\r\n        this.res = res;\r\n    }\r\n}\r\n\r\nexport class RuleRequired extends RulePredefined {\r\n    check(defy:string[], value:any) {\r\n        switch (typeof value) {\r\n            default:\r\n            case 'boolean': return;\r\n            case 'object':\r\n                if (value !== null) return;\r\n                break;\r\n            case 'string':\r\n                if ((value as string).trim().length > 0) return;\r\n                break;\r\n            case 'number':\r\n                if (isNaN(value as number) === false) return;\r\n                break;\r\n            case 'undefined':\r\n                break;\r\n        }\r\n        defy.push(this.res.required);\r\n    }\r\n}\r\n\r\nexport class RuleNum extends RulePredefined {\r\n    private minMsg: _.TemplateExecutor;\r\n    private maxMsg: _.TemplateExecutor;\r\n    protected min: number;\r\n    protected max: number\r\n    constructor(res: FormRes, min?: number, max?: number) {\r\n        super(res);\r\n        this.minMsg = _.template(res.min);\r\n        this.maxMsg = _.template(res.max);\r\n        this.min = min;\r\n        this.max = max;\r\n    }\r\n    check(defy:string[], value:any) {\r\n        if (value === undefined || value === null) return;\r\n        let n = Number(value);\r\n        if (isNaN(n) === true) {\r\n            defy.push(this.res.number);\r\n        }\r\n        else {\r\n            this.checkMore(defy, n);\r\n        }\r\n    }\r\n\r\n    protected checkMore(defy:string[], value: number) {\r\n        if (this.min !== undefined && Number(value) < this.min) {\r\n            defy.push(this.minMsg({min:this.min}));\r\n        }\r\n        if (this.max !== undefined && Number(value) > this.max) {\r\n            defy.push(this.maxMsg({max:this.max}));\r\n        }\r\n    }\r\n}\r\n\r\nexport class RuleInt extends RuleNum {\r\n    protected checkMore(defy:string[], n: number) {\r\n        super.checkMore(defy, n);\r\n        if (Number.isInteger(n) === false) {\r\n            defy.push(this.res.integer);\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { UiItem, ChangingHandler, ChangedHandler } from '../../schema';\r\nimport { FieldProps } from '../field';\r\nimport { Context } from '../context';\r\nimport { ItemSchema } from '../../schema';\r\nimport { Rule, RuleRequired, RuleCustom, FieldRule } from '../rules';\r\nimport { computed, observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport abstract class Widget {\r\n    name: string;\r\n    protected context: Context;\r\n    protected fieldProps:FieldProps;\r\n    protected children: React.ReactNode;\r\n    protected _itemSchema: ItemSchema;\r\n    protected _ui: UiItem;\r\n\tprotected defaultValue: any;\r\n\tprotected value: any;\r\n    protected rules: Rule[];\r\n    @observable errors: string[] = [];\r\n    @observable protected contextErrors: string[] = [];\r\n    @computed protected get hasError():boolean {return (this.errors.length + this.contextErrors.length)>0}\r\n    protected readOnly:boolean;\r\n    protected disabled:boolean;\r\n    @observable visible:boolean;\r\n\r\n    constructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n        this.context = context;\r\n        let {name} = itemSchema;\r\n        this.name = name;\r\n        this._itemSchema = itemSchema;\r\n        this.fieldProps = fieldProps;\r\n        this.children = children;\r\n        this._ui = context.getUiItem(name);\r\n        if (this.ui === undefined) {\r\n            this.readOnly = false;\r\n            this.disabled = false;\r\n            this.visible = true;\r\n        }\r\n        else {\r\n            let {readOnly, disabled, visible} = this.ui;\r\n            this.readOnly = (readOnly === true);\r\n            this.disabled = (disabled === true);\r\n            this.visible = !(visible === false);            \r\n        }\r\n        this.value = this.defaultValue =  context.getValue(name); //defaultValue;\r\n        // this.init();\r\n    }\r\n\r\n    protected get itemSchema(): ItemSchema {return this._itemSchema};\r\n    protected get ui(): UiItem {return this._ui};\r\n\r\n    init() {\r\n        this.rules = [];\r\n        if (this.itemSchema.required === true) {\r\n            this.rules.push(new RuleRequired(this.context.form.res));\r\n        }\r\n        this.buildRules();\r\n        if (this.ui === undefined) return;\r\n        let {rules} = this.ui;\r\n        if (rules === undefined) return;\r\n        if (Array.isArray(rules) === false) {\r\n            this.rules.push(new RuleCustom(rules as FieldRule));\r\n            return;\r\n        }\r\n        for (let rule of rules as FieldRule[]) {\r\n            this.rules.push(new RuleCustom(rule));\r\n        }\r\n    }\r\n\r\n    protected buildRules() {\r\n    }\r\n\r\n    checkRules() {\r\n        let defy:string[] = [];\r\n        for (let r of this.rules) r.check(defy, this.value);\r\n        if (defy.length === 0) {\r\n            this.context.removeErrorWidget(this);\r\n        }\r\n        else {\r\n            this.context.addErrorWidget(this);\r\n            this.errors.push(...defy);\r\n        }\r\n    }\r\n\r\n    @computed get isOk() {\r\n        return this.errors.length ===0;\r\n    }\r\n\r\n    setError(err:string | string[]) {\r\n        if (err === undefined) return;\r\n        if (typeof err === 'string') this.errors.push(err);\r\n        else this.errors.push(...err);\r\n    }\r\n\r\n    setContextError(err:string | string[]) {\r\n        if (err === undefined) return;\r\n        if (typeof err === 'string') this.contextErrors.push(err);\r\n        else this.contextErrors.push(...err);\r\n    }\r\n\r\n    clearError() {\r\n        this.errors.splice(0);\r\n    }\r\n\r\n    clearContextError() {\r\n        this.contextErrors.splice(0);\r\n    }\r\n\r\n    protected parse(value:any):any {return value}\r\n\r\n    protected setElementValue(value:any) {}\r\n    protected setDataValue(value:any) {\r\n        if (this.isChanging === true) return;\r\n        this.context.initData[this.name] = this.value = this.parse(value);\r\n    }\r\n\r\n    setValue(value:any) {\r\n        if (this.isChanging === true) return;\r\n        //this.setDataValue(value);\r\n        //this.setElementValue(value);\r\n        this.changeValue(value, false);\r\n    }\r\n\r\n    getValue() {\r\n        return this.context.getValue(this.name);\r\n    }\r\n\r\n    getReadOnly():boolean {return this.readOnly}\r\n    getDisabled():boolean {return this.disabled}\r\n    getVisible():boolean {return this.visible}\r\n    setReadOnly(value:boolean) {this.readOnly = value}\r\n    setDisabled(value:boolean) {this.disabled = value}\r\n    setVisible(value:boolean) {this.visible = value}\r\n\r\n    private isChanging: boolean;\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n        this.changeValue(evt.target.value, true);\r\n    }\r\n\r\n    protected changeValue(newValue: any, fromElement: boolean) {\r\n        let prev = this.value;\r\n        let onChanging: ChangingHandler;\r\n        let onChanged: ChangedHandler;\r\n        if (this.ui !== undefined) {\r\n            onChanging = this.ui.onChanging;\r\n            onChanged = this.ui.onChanged;\r\n        }\r\n        let allowChange = true;\r\n        if (onChanging !== undefined) {\r\n            this.isChanging = true;\r\n            allowChange = onChanging(this.context, this.value, prev);\r\n            this.isChanging = false;\r\n        }\r\n        if (allowChange === true) {\r\n            this.setDataValue(newValue);\r\n            if (fromElement !== true) this.setElementValue(newValue);\r\n            if (onChanged !== undefined) {\r\n                this.isChanging = true;\r\n                onChanged(this.context, this.value, prev);\r\n                this.isChanging = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected get className():string {\r\n        let fieldClass:string;\r\n        if (this.context.inNode === false) fieldClass = 'form-control';\r\n        return classNames(fieldClass, this.context.form.FieldClass, this.ui && this.ui.className);\r\n    }\r\n\r\n    protected abstract render():JSX.Element;\r\n\r\n    protected renderBody():JSX.Element {\r\n        let elDiscription;\r\n        if (this.hasError === false && this.ui) {\r\n            let {discription, discriptionClassName} = this.ui;\r\n            if (discriptionClassName === undefined) discriptionClassName = 'small text-muted';\r\n            elDiscription = <span className={discriptionClassName}>\r\n                {discription}\r\n            </span>;\r\n        }\r\n        return <>\r\n            {this.render()}\r\n            {elDiscription}\r\n        </>;\r\n    }\r\n\r\n    container = observer(():JSX.Element => {\r\n        if (this.visible === false) return null;\r\n        let {form, inNode} = this.context;\r\n        if (inNode === true) return this.render();\r\n        let label:any = this.label;\r\n        if (this.itemSchema.required === true && form.props.requiredFlag !== false) {\r\n            if (label !== null) label = <>{label}&nbsp;<span className=\"text-danger\">*</span></>;\r\n        }\r\n        return form.FieldContainer(label, this.renderBody());\r\n    })\r\n\r\n    protected get label():string {\r\n        let label:any;\r\n        if (this.ui === undefined) {\r\n            label = this.name;\r\n        }\r\n        else {\r\n            let uiLabel = this.ui.label;\r\n            if (uiLabel === null) label = null;\r\n            else label = uiLabel || this.name;\r\n        }\r\n        return label;\r\n    }\r\n\r\n    protected renderTemplet():JSX.Element | undefined {\r\n        if (this.children !== undefined) {\r\n            return <>{this.children}</>;\r\n        }\r\n        if (this.ui === undefined) return undefined;\r\n        let {Templet} = this.ui;\r\n        if (typeof Templet === 'function') return Templet(this.value);\r\n        return Templet;\r\n    }\r\n\r\n    protected renderErrors() {\r\n        let errorList:string[] = [...this.errors, ...this.contextErrors];\r\n        if (errorList.length === 0) return null;\r\n        let {inNode} = this.context;\r\n        let tag = inNode === true? 'span' : 'div';\r\n        return errorList.map(err => React.createElement(tag, \r\n            {\r\n                key: err, \r\n                className: 'text-danger d-inline-block my-2 ml-3'\r\n            },\r\n            <><i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}</>\r\n        ));\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiTextItem, StringSchema } from '../../schema';\r\nimport { observable } from 'mobx';\r\n\r\nexport class TextWidget extends Widget {\r\n    protected inputType = 'text';\r\n    protected get ui(): UiTextItem {return this._ui as UiTextItem};\r\n    protected input: HTMLInputElement;\r\n    @observable protected hasFocus: boolean;\r\n\r\n    protected setElementValue(value:any) {\r\n        if (this.input === null) return;\r\n        this.input.value = value;\r\n    }\r\n    protected get placeholder() {return (this.ui && this.ui.placeholder) || this.name}\r\n    protected onKeyDown = async (evt:React.KeyboardEvent<HTMLInputElement>) => {\r\n        this.internalOnKeyDown(evt);\r\n        if (evt.keyCode !== 13) return;\r\n        let {onEnter} = this.context.form.props;\r\n        if (onEnter === undefined) return;\r\n\r\n        this.changeValue(evt.currentTarget.value, true);\r\n\r\n        //this.checkRules();\r\n        //this.context.checkContextRules();\r\n        this.input.blur();\r\n\r\n        let ret = await onEnter(this.name, this.context);\r\n        if (ret !== undefined) {\r\n            this.context.setError(this.name, ret);\r\n        }\r\n    }\r\n\r\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\r\n    }\r\n\r\n    protected onBlur = (evt: React.FocusEvent<any>) => {\r\n        this.onInputChange(evt);\r\n        this.checkRules();\r\n\t\tthis.context.checkContextRules();\r\n\t\tthis.hasFocus = false;\r\n    }\r\n    protected onFocus = (evt: React.FocusEvent<any>) => {\r\n        this.clearError();\r\n        this.context.removeErrorWidget(this);\r\n        this.context.clearErrors();\r\n\t\tthis.hasFocus = true;\r\n    }\r\n    protected onChange(evt: React.ChangeEvent<any>) {\r\n    }\r\n\r\n    setReadOnly(value:boolean) {\r\n        if (this.input === null) return;\r\n        this.input.readOnly = this.readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        if (this.input === null) return;\r\n        this.input.disabled = this.disabled = value;\r\n    }\r\n\r\n    render() {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn:any = {\r\n            //'form-control': true,\r\n        };\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        return <><input ref={input=>this.input = input}\r\n            className={classNames(this.className, cn)}\r\n            type={this.inputType}\r\n            defaultValue={this.value}\r\n            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\r\n            placeholder={this.placeholder}\r\n            readOnly={this.readOnly}\r\n            disabled={this.disabled}\r\n            onKeyDown = {this.onKeyDown}\r\n            onFocus = {this.onFocus}\r\n            onBlur={this.onBlur}\r\n            maxLength={(this.itemSchema as StringSchema).maxLength} />\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiTextAreaItem } from '../../schema';\r\nimport { StringSchema } from '../../schema';\r\n\r\nexport class TextAreaWidget extends Widget {\r\n    protected get itemSchema(): StringSchema {return this._itemSchema as StringSchema};\r\n    protected input: HTMLTextAreaElement;\r\n    protected get ui(): UiTextAreaItem {return this._ui as UiTextAreaItem};\r\n\r\n    protected setElementValue(value:any) {this.input.value = value}\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.setValue(evt.currentTarget.value);\r\n    }\r\n\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n\tprotected onBlur = (evt: React.FocusEvent<any>) => {\r\n        this.onInputChange(evt);\r\n        this.checkRules();\r\n        this.context.checkContextRules();\r\n    }\r\n    protected onFocus = (evt: React.FocusEvent<any>) => {\r\n        this.clearError();\r\n        this.context.removeErrorWidget(this);\r\n        this.context.clearErrors();\r\n    }\r\n\r\n    render() {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn:any = {};\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        return <>\r\n\t\t\t<textarea ref={(input) => this.input=input}\r\n\t\t\t\tonBlur={this.onBlur} \r\n\t\t\t\tonFocus={this.onFocus}\r\n                className={classNames(this.className, cn)}\r\n                rows={this.ui && this.ui.rows}\r\n                maxLength={this.itemSchema.maxLength}\r\n                defaultValue={this.defaultValue} onChange={this.onInputChange} />\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\n\r\nexport class PasswordWidget extends TextWidget {\r\n    protected inputType = 'password';\r\n}\r\n\r\nexport class UrlWidget extends TextWidget {\r\n    protected inputType = 'url';\r\n}\r\n\r\nexport class EmailWidget extends TextWidget {\r\n    protected inputType = 'email';\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\nimport { RuleNum, RuleInt } from '../rules';\r\nimport { NumBaseSchema } from '../../schema';\r\n\r\nexport class NumberWidget extends TextWidget {\r\n    protected inputType = 'number';\r\n    protected get itemSchema(): NumBaseSchema {return this._itemSchema as NumBaseSchema};\r\n\r\n    protected buildRules() {\r\n        super.buildRules();\r\n        let res = this.context.form.res;\r\n        let {min, max} = this.itemSchema;\r\n        this.rules.push(\r\n            this.itemSchema.type === 'integer'?\r\n                new RuleNum(res, min, max) :\r\n                new RuleInt(res, min, max)\r\n        );\r\n        /*\r\n        if (this.itemSchema.type === 'integer') {\r\n            this.rules.push(new RuleInt);\r\n        }\r\n        let {min, max} = this.itemSchema;\r\n        if (min !== undefined) this.rules.push(new RuleMin(min));\r\n        if (max !== undefined) this.rules.push(new RuleMax(max));\r\n        */\r\n    }\r\n\r\n    protected parse(value:any):any {\r\n        if (value === undefined || value === null) return;\r\n        return Number(value);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { NumberWidget } from './numberWidget';\r\n\r\nexport class UpdownWidget extends NumberWidget {\r\n    protected inputType = 'number';\r\n\r\n    protected isValidKey(key:number):boolean {\r\n        return key===46 || key===8 || key===37 || key===39\r\n            || (key>=48 && key<=57)\r\n            || (key>=96 && key<=105)\r\n            || key===109 || key===189;\r\n    }\r\n    \r\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\r\n        let key = evt.keyCode;\r\n        window.event.returnValue = this.isValidKey(key);\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\n\r\nexport class DateWidget extends TextWidget {\r\n    protected inputType = 'date';\r\n}\r\n\r\nexport class DateTimeWidget extends TextWidget {\r\n    protected inputType = 'datetime';\r\n}\r\n\r\nexport class TimeWidget extends TextWidget {\r\n    protected inputType = 'time';\r\n}\r\n\r\nexport class MonthWidget extends TextWidget {\r\n    protected inputType = 'month';\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiCheckItem } from '../../schema';\r\n\r\nexport class CheckBoxWidget extends Widget {\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiCheckItem {return this._ui as UiCheckItem};\r\n    protected trueValue: any;\r\n    protected falseValue: any;\r\n\r\n    init() {\r\n        super.init();\r\n        if (this.ui !== undefined) {\r\n            let {trueValue, falseValue} = this.ui;\r\n            if (trueValue === undefined) this.trueValue = true;\r\n            else this.trueValue = trueValue;\r\n            if (falseValue === undefined) this.falseValue = false;\r\n            else this.falseValue = falseValue;\r\n        }\r\n        else {\r\n            this.trueValue = true;\r\n            this.falseValue = false;\r\n        }\r\n    }\r\n    protected setElementValue(value:any) {\r\n        this.input.checked = value === this.trueValue;\r\n    }\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        let v = evt.target.checked === true? this.trueValue : this.falseValue;\r\n        this.setDataValue(v);\r\n    }\r\n\r\n    protected onClick = () => {\r\n        this.context.clearErrors();\r\n    }\r\n\r\n    render() {\r\n        let cn = classNames(this.className, 'form-check-inline p-0');\r\n        let input = <input\r\n            ref={(input)=>this.input = input}\r\n            className={'align-self-center'}\r\n            type=\"checkbox\"\r\n            defaultChecked={this.defaultValue} \r\n            onChange={this.onInputChange}\r\n            onClick={this.onClick} />;\r\n        if (this.context.inNode === true) {\r\n            return <label className={cn}>\r\n                {input} {(this.ui&&this.ui.label) || this.name}\r\n            </label>\r\n        }\r\n        else {\r\n            return <div className={cn}>\r\n                <label className=\"w-100 h-100 mb-0 d-flex justify-content-center\">{input}</label>\r\n            </div>;\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { observable } from 'mobx';\r\nimport { Widget } from './widget';\r\nimport { UiSelect } from '../../schema';\r\n\r\nexport class SelectWidget extends Widget {\r\n    protected select: HTMLSelectElement;\r\n    protected get ui(): UiSelect {return this._ui as UiSelect};\r\n    @observable protected readOnly: boolean;\r\n\r\n    protected setElementValue(value:any) {this.select.value = value}\r\n    protected onInputChange = (evt:React.ChangeEvent<HTMLSelectElement>) => {\r\n        this.setDataValue(evt.target.value);\r\n    }\r\n\r\n    setReadOnly(value:boolean) {this.select.disabled = this.readOnly = !value}\r\n    setDisabled(value:boolean) {this.select.disabled = this.disabled = value}\r\n\r\n    render() {\r\n        if (this.readOnly === true) {\r\n            let option = this.ui.list.find(v => v.value === this.value);\r\n            let title = (option === undefined)? '(???)' : option.title;\r\n            return <span className=\"form-control w-min-6c\">{title}</span>;\r\n        }\r\n        return <select\r\n            ref={(select)=>this.select = select}\r\n            className={classNames(this.className, 'form-control')}\r\n            defaultValue={this.defaultValue} \r\n            onChange={this.onInputChange}>\r\n            {this.ui.list.map((v,index) => {\r\n                let {title, value} = v;\r\n                let cn:string;\r\n                //if (value === undefined || value === null) cn = 'text-light small';\r\n                //else cn = 'text-danger';\r\n                return <option className={cn} key={index} value={value}>{title || value}</option>\r\n            })}\r\n        </select>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n//import { TextWidget } from './textWidget';\r\nimport { Widget } from './widget';\r\nimport { UiRadio } from '../../schema';\r\nimport { RowContext } from '../context';\r\n\r\n\r\nconst radioStyle:React.CSSProperties = {height: 'auto'};\r\n\r\nexport class RadioWidget extends Widget {\r\n    protected inputs: {[index:number]: HTMLInputElement} = {};\r\n    protected get ui(): UiRadio {return this._ui as UiRadio};\r\n\r\n    protected setElementValue(value:any) {\r\n        for (let i in this.inputs) {\r\n            let input = this.inputs[i];\r\n            input.checked = value === input.value;\r\n        }\r\n    }\r\n    setReadOnly(value:boolean) {\r\n        this.readOnly = value;\r\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        this.disabled = value;\r\n        for (let i in this.inputs) this.inputs[i].disabled = value\r\n    }\r\n\r\n    /*\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n        this.changeValue(evt.target.value, true);\r\n    }\r\n    */\r\n\r\n    render() {\r\n        let {defaultValue, list} = this.ui;\r\n        let {isRow} = this.context;\r\n        let rowKey:number;\r\n        if (isRow === true) {\r\n            rowKey = (this.context as RowContext).rowKey;\r\n        }\r\n        let cn = classNames(this.className, 'py-0');\r\n        return <span className={cn} style={radioStyle}>\r\n                {list.map((v,index) => {\r\n                    let {value, title} = v;\r\n                    let name = this.name;\r\n                    if (rowKey !== undefined) name += '-' + rowKey;\r\n                    return <label key={index} className=\"form-radio-inline\">\r\n                        <input ref={input=>this.inputs[index]=input} type=\"radio\" name={name}\r\n                            value={value} defaultChecked={(this.defaultValue || defaultValue)===value}\r\n                            onChange={this.onInputChange} />\r\n                        {title || value}\r\n                    </label>;\r\n                    //</span>\r\n                })}\r\n            </span>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { UiRange } from '../../schema';\r\nimport { Widget } from './widget';\r\n\r\nexport class RangeWidget extends Widget {\r\n    protected inputType = 'range';\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiRange {return this._ui as UiRange};\r\n\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n    render() {\r\n        let {min, max, step} = this.ui;\r\n        return <><input ref={input=>this.input = input}\r\n            className={classNames(this.className, 'form-control', 'w-min-6c')}\r\n            type={this.inputType}\r\n            defaultValue={this.defaultValue} \r\n            onChange={this.onInputChange}\r\n            max={max}\r\n            min={min}\r\n            step={step}\r\n            />\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiIdItem, TempletType } from '../../schema';\r\nimport { observable } from 'mobx';\r\n\r\nconst none = <small className=\"text-muted\">[无]</small>;\r\n\r\nexport class IdWidget extends Widget {\r\n    protected get ui(): UiIdItem {return this._ui as UiIdItem};\r\n    @observable protected value:number;\r\n    setReadOnly(value:boolean) {this.readOnly = value}\r\n    setDisabled(value:boolean) {this.disabled = value}    \r\n\r\n    protected onClick = async () => {\r\n        let pickId = this.ui && this.ui.pickId;\r\n        if (pickId === undefined) {\r\n            alert('no pickId defined!');\r\n            return;\r\n        }\r\n        let id = await pickId(this.context, this.name, this.value);        \r\n        this.setDataValue(id);\r\n        this.clearError();\r\n        this.clearContextError();\r\n        this.checkRules();\r\n    }\r\n\r\n    render() {\r\n        let placeholder:string|JSX.Element, Templet: TempletType;\r\n        if (this.ui !== undefined) {\r\n            placeholder = this.ui.placeholder;\r\n            Templet = this.ui.Templet;\r\n        }\r\n        let cn:any = {\r\n            'form-control': true,\r\n            'required-item': this.itemSchema.required === true,\r\n            'cursor-pointer': true,\r\n            'is-invalid': this.hasError,\r\n        };\r\n        let content;\r\n        if (this.value === undefined || this.value === null) {\r\n            content = placeholder || none;\r\n            cn['text-muted'] = true;\r\n        }\r\n        else if (Templet === undefined) {\r\n            let c: any;\r\n            if (this.value === null) {\r\n                c = 'null';\r\n            }\r\n            else {\r\n                switch (typeof this.value) {\r\n                    case 'undefined': c = none; break;\r\n                    case 'object': c = (this.value as any).id; break;\r\n                    default: c = this.value; break;\r\n                }\r\n            }\r\n            content = <>{c}</>;\r\n        }\r\n        else if (typeof Templet === 'function') {\r\n            content = Templet(this.value);\r\n        }\r\n        else {\r\n            content = Templet;\r\n        }\r\n        return <>\r\n            <div className={classNames(cn)} onClick={this.onClick}>{content}</div>\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { DataType } from '../../schema';\r\nimport { UiType } from '../../schema';\r\n\r\nexport const Unknown = (dataType:DataType, uiType:UiType, dataTypes:DataType[]) => {\r\n    return <span className=\"text-danger\">!!data type {dataType} only support {(dataTypes || []).join(', ')}, can't use ui {uiType}!!</span>;\r\n};\r\n","import * as React from 'react';\r\nimport { UiButton, TempletType } from '../../schema';\r\nimport { Unknown } from './unknown';\r\nimport { Widget } from './widget';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class ButtonWidget extends Widget {\r\n    protected get ui(): UiButton {return this._ui as UiButton};\r\n\r\n    protected onClick = async () => {\r\n        this.clearError();\r\n        this.clearContextError();\r\n        let {name, type} = this.itemSchema;\r\n        if (type === 'submit') {\r\n            await this.context.submit(name);\r\n        }\r\n        /*\r\n        let {onButtonClick} = this.context.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`button ${name} clicked. you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(name, this.context);\r\n        if (ret === undefined) return;\r\n        this.context.setError(name, ret);\r\n        */\r\n    }\r\n\r\n    private observerRender = observer(() => {\r\n        let {name, type} = this.itemSchema;\r\n        let Templet:TempletType, cn:string, caption:string;\r\n        if (this.ui !== undefined) {\r\n            let {widget:widgetType} = this.ui;\r\n            if (widgetType !== 'button') return Unknown(type, widgetType, ['button']);\r\n            Templet = this.ui.Templet;\r\n            cn = this.ui.className;\r\n            caption = this.ui.label;\r\n        }\r\n        let {form, hasError} = this.context;\r\n        let context = this.context;\r\n        let disabled = type==='submit' && hasError;\r\n        let content:any;\r\n        if (this.children !== undefined) content = this.children;\r\n        else if (typeof Templet === 'function') content = Templet();\r\n        else if (Templet !== undefined) content = Templet;\r\n        else content = caption; \r\n        let button = <button \r\n            className={cn} \r\n            type=\"button\"\r\n            disabled={disabled}\r\n            onClick={this.onClick}>\r\n            {content || name}\r\n        </button>;\r\n        if (context.inNode === true) return <>{button}{this.renderErrors()}</>;\r\n        return <div className={form.ButtonClass}>\r\n            <div>{this.renderErrors()}</div>\r\n            {button}\r\n        </div>;\r\n    });\r\n    \r\n    protected get label():string {return null}\r\n\r\n    render() {\r\n        return React.createElement(this.observerRender);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Form } from './form';\r\nimport { UiSchema, UiArr, UiItem } from '../schema';\r\nimport { ArrSchema, ItemSchema } from '../schema';\r\nimport { Widget } from './widgets/widget';\r\n//import { ArrRow } from './arrRow';\r\nimport { observable, computed } from 'mobx';\r\nimport { ContextRule } from './rules';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport abstract class Context {\r\n    private subContexts:{[name:string]:{[rowKey:string]:Context}};\r\n    readonly form: Form;\r\n    readonly uiSchema: UiSchema;\r\n    readonly initData: any;\r\n    readonly inNode: boolean;           // true: 在</> 流中定义Field\r\n    readonly widgets: {[name:string]: Widget} = {};\r\n    readonly rules: ContextRule[];\r\n    readonly isRow: boolean;\r\n    @observable errors: string[] = [];\r\n    @observable errorWidgets:Widget[] = [];\r\n\r\n    constructor(form: Form, uiSchema: UiSchema, data: any, inNode: boolean, isRow: boolean) {\r\n        this.form = form;\r\n        this.uiSchema = uiSchema;\r\n        this.initData = data;\r\n        this.inNode = inNode;\r\n        this.isRow = isRow;\r\n        if (uiSchema !== undefined) {\r\n            let {rules} = uiSchema;\r\n            if (rules !== undefined) {\r\n                this.rules = [];\r\n                if (Array.isArray(rules) === false)\r\n                    this.rules.push(rules as ContextRule);\r\n                else\r\n                    this.rules.push(...rules as ContextRule[]);\r\n            }\r\n        }\r\n    }\r\n\r\n    getArrRowContexts(arrName: string) {\r\n        if (this.subContexts === undefined) this.subContexts = {};\r\n        let arrRowContexts = this.subContexts[arrName];\r\n        if (arrRowContexts === undefined) this.subContexts[arrName] = arrRowContexts = {};\r\n        return arrRowContexts;\r\n    }\r\n\r\n    abstract get data():any;\r\n    abstract getItemSchema(itemName:string):ItemSchema;\r\n    abstract getUiItem(itemName:string):UiItem;\r\n    get arrName():string {return undefined}\r\n    getValue(itemName:string):any {return this.initData[itemName]}\r\n    setValue(itemName:string, value:any) {\r\n        this.initData[itemName] = value;\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setValue(value);\r\n    }\r\n    getDisabled(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) return widget.getDisabled();\r\n        return undefined;\r\n    }\r\n    setDisabled(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setDisabled(value);\r\n    }\r\n    getReadOnly(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.getReadOnly();\r\n        return undefined;\r\n    }\r\n    setReadOnly(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setReadOnly(value);\r\n    }\r\n    getVisible(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.getVisible();\r\n        return undefined;\r\n    }\r\n    setVisible(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setVisible(value);\r\n    }\r\n\r\n    async submit(buttonName: string) {\r\n        this.checkRules()\r\n        if (this.hasError === true) {\r\n            let err = '';\r\n            for (let ew of this.errorWidgets) {\r\n                err += ew.name + ':\\n' + ew.errors.join('\\n');\r\n            }\r\n            console.error(err);\r\n            return;\r\n        }\r\n        let {onButtonClick} = this.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`button ${buttonName} clicked. you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(buttonName, this);\r\n        if (ret === undefined) return;\r\n        this.setError(buttonName, ret);\r\n\r\n    }\r\n\r\n    checkFieldRules() {\r\n        for (let i in this.widgets) {\r\n            this.widgets[i].checkRules();\r\n        }\r\n        if (this.subContexts === undefined) return;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                arrRowContexts[j].checkFieldRules();\r\n            }\r\n        }\r\n    }\r\n\r\n    checkContextRules() {\r\n        this.clearErrors();\r\n        if (this.rules === undefined) return;\r\n        for (let rule of this.rules) {\r\n            let ret = rule(this);\r\n            if (ret === undefined) continue;\r\n            if (Array.isArray(ret) === true) {\r\n                this.errors.push(...ret as string[]);\r\n            }\r\n            else if (typeof ret === 'string') {\r\n                this.errors.push(ret as string);\r\n            }\r\n            else {\r\n                for (let i in ret as object) this.setError(i, (ret as any)[i]);\r\n            }\r\n        }\r\n        if (this.subContexts === undefined) return;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                let rowContext = arrRowContexts[j];\r\n                rowContext.clearErrors();\r\n                rowContext.checkContextRules();\r\n            }\r\n        }\r\n    }\r\n\r\n    setError(itemName:string, error:string) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget === undefined) return;\r\n        widget.setContextError(error);\r\n        this.addErrorWidget(widget);\r\n    }\r\n\r\n    clearContextErrors() {\r\n        for (let i in this.widgets) {\r\n            let widget = this.widgets[i];\r\n            if (widget === undefined) continue;\r\n            widget.clearContextError();\r\n        }\r\n    }\r\n\r\n    clearWidgetsErrors() {\r\n        for (let i in this.widgets) {\r\n            let widget = this.widgets[i];\r\n            if (widget === undefined) continue;\r\n            widget.clearError();\r\n        }\r\n    }\r\n\r\n    checkRules() {\r\n        this.clearErrors();\r\n        this.clearWidgetsErrors();\r\n        this.checkFieldRules();\r\n        if (this.hasError === true) return;\r\n        this.checkContextRules();\r\n    }\r\n\r\n    addErrorWidget(widget:Widget) {\r\n        let pos = this.errorWidgets.findIndex(v => v === widget);\r\n        if (pos < 0) this.errorWidgets.push(widget);\r\n    }\r\n    removeErrorWidget(widget:Widget) {\r\n        let pos = this.errorWidgets.findIndex(v => v === widget);\r\n        if (pos >= 0) this.errorWidgets.splice(pos, 1);\r\n    }\r\n\r\n    protected checkHasError():boolean {\r\n        let ret = (this.errorWidgets.length + this.errors.length) > 0;\r\n        if (ret === true) return true;\r\n        if (this.subContexts === undefined) return false;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                if (arrRowContexts[j].hasError === true) return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    @computed get hasError():boolean {\r\n        return this.checkHasError();\r\n    };\r\n\r\n    clearErrors() {\r\n        this.errors.splice(0);\r\n        this.errorWidgets.splice(0);\r\n        this.clearContextErrors();\r\n    }\r\n\r\n    renderErrors = observer((): JSX.Element => {\r\n        let {errors} = this;\r\n        if (errors.length === 0) return null;\r\n        return <>\r\n            {errors.map(err => <span key={err} className=\"text-danger inline-block my-1 ml-3\">\r\n                <i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}\r\n            </span>)}\r\n        </>\r\n    });\r\n}\r\n\r\nlet rowKeySeed:number = 1;\r\nexport class RowContext extends Context {\r\n    readonly parentContext: Context;\r\n    readonly arrSchema: ArrSchema;\r\n    readonly rowKey: number;\r\n\treadonly data: any;\r\n    //readonly uiSchema: UiArr;\r\n\t\r\n    constructor(parentContext:Context, arrSchema: ArrSchema, data: any, inNode: boolean) {\r\n        let uiArr:UiArr;\r\n        let {uiSchema} = parentContext;\r\n        if (uiSchema !== undefined) {\r\n            let {items} = uiSchema;\r\n            if (items !== undefined) uiArr = items[arrSchema.name] as UiArr;\r\n        }\r\n        super(parentContext.form, uiArr, data, inNode, true);\r\n        this.parentContext = parentContext;\r\n        this.arrSchema = arrSchema;\r\n        this.rowKey = rowKeySeed++;\r\n        this.data = data;\r\n    }\r\n    getItemSchema(itemName:string):ItemSchema {return this.arrSchema.itemSchemas[itemName]}\r\n    getUiItem(itemName:string):UiItem {\r\n        if (this.uiSchema === undefined) return undefined;\r\n        let {items} = this.uiSchema;\r\n        if (items === undefined) return undefined;\r\n        return items[itemName]\r\n    }\r\n    get arrName():string {return this.arrSchema.name}\r\n    clearErrors() {\r\n        super.clearErrors();\r\n        this.parentContext.clearErrors();\r\n    }\r\n\r\n    get parentData():any {return this.parentContext.data;}\r\n}\r\n\r\nexport class FormContext extends Context {\r\n    constructor(form:Form, inNode:boolean) {\r\n        super(form, form.uiSchema, form.data, inNode, false);\r\n    }\r\n    get data():any {return this.form.data}\r\n    getItemSchema(itemName:string):ItemSchema {return this.form.itemSchemas[itemName]}\r\n    getUiItem(itemName:string):UiItem {\r\n        let {uiSchema} = this.form;\r\n        if (uiSchema === undefined) return undefined;\r\n        let {items} = uiSchema;\r\n        if (items === undefined) return undefined;\r\n        return items[itemName];\r\n    }\r\n}\r\n\r\nexport const ContextContainer = React.createContext<Context>({} as any);\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\n//import { ArrRow } from '../arrRow';\r\nimport { Context, RowContext, ContextContainer } from '../context';\r\nimport { ArrSchema } from '../../schema';\r\nimport { UiArr, TempletType } from '../../schema';\r\nimport { Unknown } from './unknown';\r\nimport { factory } from './factory';\r\n\r\nexport const ArrComponent = observer((\r\n    {parentContext, arrSchema, children}:{parentContext: Context, arrSchema: ArrSchema, children: React.ReactNode}) => \r\n{\r\n    let {name, arr} = arrSchema;\r\n    let data = parentContext.initData[name] as any[];\r\n    let {form} = parentContext;\r\n    let arrRowContexts = parentContext.getArrRowContexts(name);\r\n\tlet ui = parentContext.getUiItem(name) as UiArr;\r\n\tlet {onDeleted, onRestored} = ui;\r\n    let arrLabel = name;\r\n    let Templet:TempletType;\r\n    let selectable:boolean, deletable:boolean, restorable:boolean;\r\n    let {ArrContainer, RowContainer, RowSeperator, uiSchema} = form;\r\n    if (uiSchema !== undefined) {\r\n        let {selectable:formSelectable, deletable:formDeletable, restorable:formRestorable} = uiSchema;\r\n        if (selectable !== true) selectable = formSelectable;\r\n        if (deletable !== true) deletable = formDeletable;\r\n        if (restorable !== true) restorable = formRestorable;\r\n    }\r\n    if (ui !== undefined) {\r\n        let {widget:widgetType, label, \r\n            selectable:arrSelectable, deletable:arrDeletable, restorable:arrRestorable,\r\n            ArrContainer:ac, RowContainer:rc, RowSeperator:rs\r\n        } = ui;\r\n        if (arrSelectable !== undefined) selectable = arrSelectable;\r\n        if (arrDeletable !== undefined) deletable = arrDeletable;\r\n        if (arrRestorable !== undefined) restorable = arrRestorable;\r\n        if (ac !== undefined) ArrContainer = ac;\r\n        if (rc !== undefined) RowContainer = rc;\r\n        if (rs !== undefined) RowSeperator = rs;\r\n        Templet = ui.Templet;\r\n        if (widgetType !== 'arr') return Unknown(arrSchema.type, widgetType, ['arr']);\r\n        arrLabel = label || arrLabel;\r\n    }\r\n    let first = true;\r\n    return ArrContainer(arrLabel, <>\r\n        {data.map((row:any, index) => {\r\n            let rowContext: RowContext;\r\n            let rowContent: JSX.Element;\r\n            let sep = undefined;\r\n            if (first === false) sep = RowSeperator;\r\n            else first = false;\r\n            if (children !== undefined) {\r\n                rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                rowContent = <>{children}</>;\r\n            }\r\n            else {\r\n                let typeofTemplet = typeof Templet;\r\n                if (typeofTemplet === 'function') {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                    rowContent = React.createElement(observer(Templet as React.StatelessComponent), row);\r\n                }\r\n                else if (typeofTemplet === 'object') {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                    rowContent = Templet as JSX.Element;\r\n                }\r\n                else {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, false);\r\n                    rowContent = <>{\r\n                        arr.map((v, index) => {\r\n                            return <React.Fragment key={v.name}>\r\n                                {factory(rowContext, v, undefined)}\r\n                            </React.Fragment>\r\n                        })}\r\n                    </>;\r\n                }\r\n            }\r\n            let {rowKey} = rowContext;\r\n            arrRowContexts[rowKey] = rowContext;\r\n\r\n            let selectCheck:JSX.Element, deleteIcon:JSX.Element;\r\n            if (selectable === true) {\r\n                let onClick = (evt: React.MouseEvent<HTMLInputElement>)=>{\r\n                    let {checked} = (evt.target as HTMLInputElement);\r\n                    row.$isSelected = checked;\r\n                    let {$source} = row;\r\n                    if ($source !== undefined) $source.$isSelected = checked;\r\n                    rowContext.clearErrors();\r\n                }\r\n                selectCheck = <div className=\"form-row-checkbox\">\r\n                    <input type=\"checkbox\" onClick={onClick} defaultChecked={row.$isSelected} />\r\n                </div>;\r\n            }\r\n            let isDeleted = !(row.$isDeleted===undefined || row.$isDeleted===false);\r\n            if (deletable === true) {\r\n                let icon = isDeleted? 'fa-undo' : 'fa-trash';\r\n                let onDelClick = () => {\r\n                    if (restorable === true) {\r\n                        row.$isDeleted = !isDeleted;\r\n                        let {$source} = row;\r\n\t\t\t\t\t\tif ($source !== undefined) $source.$isDeleted = !isDeleted;\r\n\t\t\t\t\t\tif (onRestored) onRestored(row);\r\n                    }\r\n                    else {\r\n                        let p = data.indexOf(row);\r\n\t\t\t\t\t\tif (p>=0) data.splice(p, 1);\r\n\t\t\t\t\t\tif (onDeleted) onDeleted(row);\r\n                    }\r\n                    rowContext.clearErrors();\r\n                }\r\n                deleteIcon = <div className=\"form-row-edit text-info\" onClick={onDelClick}>\r\n                    <i className={classNames('fa', icon, 'fa-fw')} />\r\n                </div>;\r\n            }\r\n            let editContainer = selectable===true || deletable===true?\r\n                (content:any) => <fieldset disabled={isDeleted}><div className={classNames('d-flex', {'deleted':isDeleted, 'row-selected':row.$isSelected})}>\r\n                    {selectCheck}\r\n                    <div className={selectable===true && deletable===true? \"form-row-content\":\"form-row-content-1\"}>{content}</div>\r\n                    {deleteIcon}\r\n                </div></fieldset>\r\n                :\r\n                (content:any) => content;\r\n\r\n            return <ContextContainer.Provider key={rowKey} value={rowContext}>\r\n                {sep}\r\n                {RowContainer(editContainer(<><rowContext.renderErrors />{rowContent}</>))}\r\n            </ContextContainer.Provider>;\r\n        })}\r\n    </>);\r\n});\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiImageItem } from '../../schema';\r\nimport { Image } from '../../image';\r\nimport { ImageItemEdit } from '../../edit/imageItemEdit';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\n\r\nexport class ImageWidget extends Widget {\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiImageItem {return this._ui as UiImageItem};\r\n    @observable private imageSrc: string;\r\n\r\n    init() {\r\n        super.init();\r\n        this.imageSrc = this.value;\r\n    }\r\n\r\n    protected onClick = async () => {\r\n        let edit = new ImageItemEdit(undefined, this.itemSchema, this.ui, this.ui.label, this.value);\r\n        let ret = await edit.start();\r\n        if (ret !== null) {\r\n            this.setValue(ret);\r\n            this.imageSrc = ret;\r\n        }\r\n        await edit.end();\r\n    }\r\n\r\n    render() {\r\n        return React.createElement(this.observerRender);\r\n    }\r\n\r\n    private observerRender = observer(() => {\r\n        let cn = [\r\n            'bg-white p-1 d-flex justify-content-center',\r\n        ];\r\n        let onClick: any;\r\n        if (!this.readOnly && !this.disabled) {\r\n            cn.push('cursor-pointer');\r\n            onClick = this.onClick;\r\n        }\r\n        return <div className={classNames(cn)} onClick={onClick}>\r\n            <Image src={this.imageSrc} className=\"w-4c h-4c\"/>\r\n        </div>;\r\n    });\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiTag, IValuesViewRenderOptions } from '../../schema';\r\nimport { RowContext } from '../context';\r\n\r\nabstract class TagWidget extends Widget {\r\n    protected inputs: {[index:number]: HTMLInputElement} = {};\r\n    protected get ui(): UiTag {return this._ui as UiTag};\r\n\r\n    protected setElementValue(value:any) {\r\n        for (let i in this.inputs) {\r\n            let input = this.inputs[i];\r\n            input.checked = value === input.value;\r\n        }\r\n    }\r\n    setReadOnly(value:boolean) {\r\n        this.readOnly = value;\r\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        this.disabled = value;\r\n        for (let i in this.inputs) this.inputs[i].disabled = value\r\n\t}\r\n\t\r\n\tabstract render():JSX.Element;\r\n}\r\n\r\nexport class TagSingleWidget extends TagWidget {\r\n\trender() {\r\n\t\tlet {valuesView, wrapClassName} = this.ui;\r\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\r\n        let {isRow} = this.context;\r\n        let rowKey:number;\r\n        if (isRow === true) {\r\n            rowKey = (this.context as RowContext).rowKey;\r\n        }\r\n        let cn = classNames(this.className, 'py-0');\r\n\t\tlet name = this.name;\r\n\t\tif (rowKey !== undefined) name += '-' + rowKey;\r\n\t\tlet options:IValuesViewRenderOptions = {\r\n\t\t\tclassName: cn,\r\n\t\t\tinputName: name,\r\n\t\t\twrapClassName,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t}\r\n\t\treturn valuesView.renderRadios(this.defaultValue, options);\r\n    }\r\n}\r\n\r\nexport class TagMultiWidget extends TagWidget {\r\n\tprivate defaultArr:number[];\r\n\tinit() {\r\n\t\tsuper.init();\r\n\t\tlet def = this.defaultValue;\r\n\t\tswitch (typeof def) {\r\n\t\t\tdefault:\r\n\t\t\t\tthis.defaultArr = [];\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'string':\r\n\t\t\t\tthis.defaultArr = def.split('|').map(v => Number(v));\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n\t\tlet values:string[] = [];\r\n\t\tfor (let i in this.inputs) {\r\n\t\t\tlet input = this.inputs[i];\r\n\t\t\tif (input.checked === true) values.push(input.value);\r\n\t\t}\r\n        this.changeValue(values.join('|'), true);\r\n\t}\r\n\trender() {\r\n\t\tlet {valuesView, wrapClassName} = this.ui;\r\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\r\n        let cn = classNames(this.className, 'py-0');\r\n\t\tlet options:IValuesViewRenderOptions = {\r\n\t\t\tclassName: cn,\r\n\t\t\tinputs: this.inputs,\r\n\t\t\twrapClassName,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t}\r\n\t\treturn valuesView.renderChecks(this.defaultValue, options);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { ArrSchema, DataType, ItemSchema } from '../../schema';\r\nimport { TypeWidget, UiCustom } from '../../schema';\r\nimport { TextWidget } from './textWidget';\r\nimport { TextAreaWidget } from './textareaWidget';\r\nimport { PasswordWidget, UrlWidget, EmailWidget } from './passwordWidget';\r\nimport { UpdownWidget } from './updownWidget';\r\nimport { NumberWidget } from './numberWidget';\r\nimport { DateWidget, DateTimeWidget, TimeWidget, MonthWidget } from './dateWidget';\r\nimport { CheckBoxWidget } from './checkBoxWidget';\r\nimport { FieldProps } from '../field';\r\nimport { Context } from '../context';\r\nimport { SelectWidget } from './selectWidget';\r\nimport { RadioWidget } from './radioWidget';\r\nimport { RangeWidget } from './rangeWidget';\r\nimport { IdWidget } from './idWidget';\r\nimport { ButtonWidget } from './buttonWidget';\r\nimport { ArrComponent } from './arrComponent';\r\nimport { ImageWidget } from './imageWidget';\r\nimport { TagSingleWidget, TagMultiWidget } from './tagWidget';\r\n\r\nconst widgetsFactory: {[type: string]: {widget?: TypeWidget, dataTypes?: DataType[]}} = {\r\n    id: {\r\n        dataTypes: ['id'],\r\n        widget: IdWidget,\r\n    },\r\n    text: {\r\n        dataTypes: ['integer', 'number', 'string'],\r\n        widget: TextWidget\r\n    },\r\n    textarea: {\r\n        dataTypes: ['string'],\r\n        widget: TextAreaWidget\r\n    },\r\n    password: {\r\n        dataTypes: ['string'],\r\n        widget: PasswordWidget\r\n    },\r\n    date: {\r\n        dataTypes: ['date'],\r\n        widget: DateWidget\r\n    },\r\n    datetime: {\r\n        dataTypes: ['date'],\r\n        widget: DateTimeWidget\r\n    },\r\n    time: {\r\n        dataTypes: ['date'],\r\n        widget: TimeWidget\r\n    },\r\n    month: {\r\n        dataTypes: ['date'],\r\n        widget: MonthWidget\r\n    },\r\n    select: {\r\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\r\n        widget: SelectWidget\r\n    },\r\n    url: {\r\n        dataTypes: ['string'],\r\n        widget: UrlWidget\r\n    },\r\n    email: {\r\n        dataTypes: ['string'],\r\n        widget: EmailWidget\r\n    },\r\n    number: {\r\n        dataTypes: ['integer', 'number'],\r\n        widget: NumberWidget\r\n    },\r\n    updown: {\r\n        dataTypes: ['integer', 'number'],\r\n        widget: UpdownWidget\r\n    },\r\n    color: {\r\n\r\n    },\r\n    checkbox: {\r\n        dataTypes: ['boolean', 'integer', 'number'],\r\n        widget: CheckBoxWidget\r\n    },\r\n    image: {\r\n        dataTypes: ['string'],\r\n        widget: ImageWidget,\r\n    },\r\n    checkboxes: {\r\n\r\n    },\r\n    radio: {\r\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\r\n        widget: RadioWidget\r\n\t},\r\n\ttagSingle: {\r\n\t\tdataTypes: ['integer'],\r\n\t\twidget: TagSingleWidget\r\n\t},\r\n\ttagMulti: {\r\n\t\tdataTypes: ['string'],\r\n\t\twidget: TagMultiWidget\r\n\t},\r\n    range: {\r\n        dataTypes: ['integer'],\r\n        widget: RangeWidget,\r\n    },\r\n    button: {\r\n        dataTypes: ['button', 'submit'],\r\n        widget: ButtonWidget,\r\n    }\r\n}\r\n\r\nexport function factory(context: Context, itemSchema: ItemSchema, children:React.ReactNode, fieldProps?: FieldProps):JSX.Element {\r\n    if (context === undefined) {\r\n        debugger;\r\n        return null;\r\n    }\r\n    if (itemSchema === undefined) return undefined;\r\n    let {name, type} = itemSchema;\r\n    switch (type) {\r\n    case 'arr':\r\n        let arrSchema = context.getItemSchema(name) as ArrSchema;\r\n        return <ArrComponent parentContext={context} arrSchema={arrSchema} children={children} />;\r\n    default:\r\n        break;\r\n    }\r\n\r\n    let typeWidget: TypeWidget;\r\n    let ui = context.getUiItem(name);\r\n    function getTypeWidget(t:DataType): TypeWidget {\r\n        switch(t) {\r\n        default: return TextWidget; \r\n        case 'id': return IdWidget;\r\n        case 'integer': return UpdownWidget;\r\n        case 'number': return NumberWidget; \r\n        case 'string': return TextWidget; \r\n        case 'date': return DateWidget; \r\n        case 'boolean': return CheckBoxWidget; \r\n        case 'button':\r\n        case 'submit': return ButtonWidget;\r\n        }\r\n    }\r\n    if (ui === undefined) { \r\n        typeWidget = getTypeWidget(type);\r\n    }\r\n    else {\r\n        let {widget:widgetType} = ui;\r\n        switch (widgetType) {\r\n        default:\r\n            if (widgetType !== undefined) {\r\n                let widgetFactory = widgetsFactory[widgetType];\r\n                typeWidget = widgetFactory.widget;\r\n            }\r\n            if (typeWidget === undefined) typeWidget = getTypeWidget(type);\r\n            break;\r\n        case 'custom':\r\n            typeWidget = (ui as UiCustom).WidgetClass;\r\n            break;\r\n        case 'group':\r\n            return <span>impletment group</span>;\r\n        }\r\n        //label = uiLabel || name;\r\n    }\r\n    \r\n\tlet {widgets} = context;\r\n\tlet widget = widgets[name];\r\n\tif (!widget) {\r\n\t\twidget = new typeWidget(context, itemSchema, fieldProps, children);\r\n\t\twidget.init();\r\n\t\twidgets[name] = widget;\r\n\t}\r\n\r\n    return <widget.container />;\r\n    /*\r\n    if (isRow === false) {\r\n        let WidgetElement = observer(() => widget.container());\r\n        return <WidgetElement />;\r\n    }\r\n    else {\r\n        let widgetElement = widget.container();\r\n        return widgetElement;\r\n    }\r\n    */\r\n}\r\n\r\n","import * as React from 'react';\r\nimport {observable, IReactionDisposer, autorun} from 'mobx';\r\nimport classNames from 'classnames';\r\nimport { Schema, ItemSchema, ArrSchema } from '../schema';\r\nimport { UiSchema, TempletType } from '../schema';\r\nimport { factory } from './widgets';\r\nimport 'font-awesome/css/font-awesome.min.css';\r\nimport { ContextContainer, FormContext, Context } from './context';\r\nimport { FormRes, formRes } from '../../res';\r\nimport { resLang } from '../../res/res';\r\n\r\nexport type FormButtonClick = (name:string, context: Context) => Promise<any>;\r\nexport type InputEnter = (name:string, context: Context) => Promise<any>;\r\n\r\nexport interface FormProps {\r\n    className?: string;\r\n    schema: Schema;\r\n    uiSchema?: UiSchema;\r\n    formData?: any;\r\n    onButtonClick?: FormButtonClick;\r\n    onEnter?: InputEnter;\r\n    fieldLabelSize?: number;            // col-sm-2 for label\r\n    requiredFlag?: boolean;             // default=true\r\n    beforeShow?: (formContext:FormContext) => void;\r\n    res?: FormRes;\r\n\r\n    Container?: (content:JSX.Element) => JSX.Element;\r\n    FieldContainer?: (label:string|JSX.Element, content:JSX.Element) => JSX.Element;\r\n    FieldClass?: string;\r\n    ButtonClass?: string;\r\n}\r\n\r\nexport class Form extends React.Component<FormProps> {\r\n    readonly schema: Schema;\r\n    readonly itemSchemas: {[name:string]: ItemSchema};\r\n    readonly uiSchema: UiSchema;\r\n    readonly res?: FormRes;\r\n    protected formContext: FormContext;\r\n    private disposer: IReactionDisposer;\r\n    readonly data:any;\r\n\r\n    readonly Container: (content:JSX.Element) => JSX.Element;\r\n    readonly FieldContainer: (label:any, content:JSX.Element) => JSX.Element;\r\n    readonly FieldClass: string;\r\n    readonly ButtonClass: string;\r\n    \r\n    constructor(props:FormProps) {\r\n        super(props);\r\n        let {schema, uiSchema, \r\n            Container, FieldContainer, FieldClass, \r\n            ButtonClass, res,\r\n        } = props;\r\n        this.Container = Container || this.DefaultContainer;\r\n        this.FieldContainer = FieldContainer || this.DefaultFieldContainer;\r\n        this.FieldClass = FieldClass!==undefined && FieldClass!==''&&FieldClass!==null? FieldClass : this.DefaultFieldClass;\r\n        this.res = res || this.DefaultRes;\r\n        this.ButtonClass = ButtonClass || this.DefaultButtonClass;\r\n\r\n        this.schema = schema;\r\n        this.itemSchemas = {};\r\n        for (let itemSchema of this.schema) {\r\n            this.itemSchemas[itemSchema.name] = itemSchema;\r\n        }\r\n        this.uiSchema = uiSchema;\r\n\r\n        this.disposer = autorun(this.watch);\r\n        this.data = {};\r\n    }\r\n\r\n    private renderContent():any {\r\n        this.initData(this.props.formData);\r\n        let {children} = this.props;\r\n        if (children !== undefined) {\r\n            this.formContext = new FormContext(this, true);\r\n            return <>{children}</>;\r\n        }\r\n\r\n        let Templet: TempletType;\r\n        if (this.uiSchema !== undefined) {\r\n            Templet = this.uiSchema.Templet;\r\n        }\r\n        if (Templet !== undefined) {\r\n            this.formContext = new FormContext(this, true);\r\n            return typeof(Templet) === 'function'? Templet(this.data) : Templet;\r\n        }\r\n\r\n\t\tif (!this.formContext) {\r\n\t\t\tthis.formContext = new FormContext(this, false);\r\n\t\t}\r\n        return <>{this.schema.map((v, index) => {\r\n            return <React.Fragment key={index}>{factory(this.formContext, v, children)}</React.Fragment>\r\n        })}</>;\r\n    }\r\n\r\n    private initData(formData: any) {\r\n        if (formData === undefined) formData = {};\r\n        if (this.uiSchema !== undefined) {\r\n            let {items} = this.uiSchema;\r\n            if (items !== undefined) {\r\n                for (let i in items) {\r\n                    let ui = items[i];\r\n                    let dv = ui.defaultValue;\r\n                    if (dv !== undefined) {\r\n                        if (formData[i] === undefined) {\r\n                            formData[i] = dv;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (let itemSchema of this.schema) {\r\n            this.initDataItem(itemSchema, this.data, formData);\r\n        }\r\n    }\r\n\r\n    private initDataItem(itemSchema: ItemSchema, data:any, formData: any):any {\r\n        let {name, type} = itemSchema;\r\n        if (type === 'button') return;\r\n        if (type !== 'arr') {\r\n            data[name] = formData[name];\r\n            return;\r\n        }\r\n\r\n        let arrItem:ArrSchema = itemSchema as ArrSchema;\r\n        let {arr:arrItems} = arrItem;\r\n        if (arrItems === undefined) return;\r\n        let arrDict:any = arrItem.itemSchemas = {};\r\n        for (let item of arrItems) {\r\n            arrDict[item.name] = item;\r\n        }\r\n        let val:any[] = formData[name];\r\n        if (val === undefined) val = [];\r\n        else if (Array.isArray(val) === false) val = [val];\r\n        let arr:any[] = [];\r\n        for (let row of val) {\r\n            let {$isSelected, $isDeleted} = row;\r\n            let r = {\r\n                $source: row,\r\n                $isSelected: $isSelected,\r\n                $isDeleted: $isDeleted,\r\n            };\r\n            for (let item of arrItems) {\r\n                this.initDataItem(item, r, row);\r\n            }\r\n            arr.push(r);\r\n        }\r\n        // 如果没有observable，行删除标志点击不管用\r\n        // 不知道这里为什么要去掉observable。有可能会有别的问题\r\n        data[name] = observable(arr);\r\n        //data[name] = arr;\r\n        return;\r\n    }\r\n\r\n    private watch = () => {\r\n        let {formData} = this.props;\r\n        if (formData === undefined) return;\r\n        //this.initData(formData);\r\n        this.calcSelectOrDelete();\r\n    }\r\n    private calcSelectOrDelete() {\r\n        for (let itemSchema of this.schema) {\r\n            this.arrItemOperated(itemSchema);\r\n        }\r\n    }\r\n\r\n    private arrItemOperated(itemSchema: ItemSchema) {\r\n        let {name, type} = itemSchema;\r\n        if (type !== 'arr') return;\r\n        if (this.data === undefined) return;\r\n        let formArrVal = this.data[name];\r\n        if (formArrVal === undefined) return;\r\n        let {arr: arrItems} = itemSchema as ArrSchema;\r\n        for (let row of formArrVal) {\r\n            let {$source} = row;\r\n            if ($source === undefined) continue;\r\n            let {$isSelected, $isDeleted} = $source;\r\n            row.$isSelected = $isSelected;\r\n            row.$isDeleted = $isDeleted;\r\n            //console.log($isSelected, $isDeleted);\r\n            for (let item of arrItems) {\r\n                this.arrItemOperated(item);\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        let {beforeShow} = this.props;\r\n        if (beforeShow !== undefined) beforeShow(this.formContext);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.disposer !== undefined) this.disposer();\r\n    }\r\n\r\n    render() {\r\n        let content = this.renderContent();\r\n        return <ContextContainer.Provider value={this.formContext}>\r\n            {React.createElement(this.formContext.renderErrors)}\r\n            {this.Container(content)}\r\n        </ContextContainer.Provider>;\r\n    }\r\n\r\n    async buttonClick(buttonName:string) {\r\n        this.formContext.checkRules()\r\n        if (this.formContext.hasError === true) return;\r\n\r\n        let {onButtonClick} = this.formContext.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(buttonName, this.formContext);\r\n        if (ret === undefined) return;\r\n        this.formContext.setError(buttonName, ret);\r\n    }\r\n\r\n    protected DefaultContainer = (content:JSX.Element): JSX.Element => {\r\n        return <form className={classNames(this.props.className)} onSubmit={e=>e.preventDefault()}>\r\n            {content}\r\n        </form>;\r\n    }\r\n    protected DefaultFieldContainer = (label:string|JSX.Element, content:JSX.Element): JSX.Element => {\r\n        let {fieldLabelSize} = this.props;\r\n\r\n        if (fieldLabelSize > 0) {\r\n            let labelView:any;\r\n            if (label === null) {\r\n                fieldLabelSize = 0;\r\n            }\r\n            else {\r\n                labelView = <label className={classNames('col-sm-' + fieldLabelSize, 'col-form-label')}>{label}</label>\r\n            }\r\n            let fieldCol = 'col-sm-' + (12 - fieldLabelSize);\r\n            return <div className=\"form-group row\">\r\n                {labelView}\r\n                <div className={fieldCol}>{content}</div>\r\n            </div>;\r\n        }\r\n        return <div className=\"form-group\">\r\n            {label===null? null:<label className=\"col-form-label\">{label}</label>}\r\n            {content}\r\n        </div>;\r\n    }\r\n    protected DefaultFieldClass:string = undefined;\r\n    protected DefaultButtonClass = 'text-center py-2';\r\n    protected DefaultRes:FormRes = resLang<FormRes>(formRes);\r\n\r\n    ArrContainer = (label:any, content:JSX.Element): JSX.Element => {\r\n        return <div>\r\n            <div className={classNames('small text-muted text-center bg-light py-1 px-3 mt-4 mb-1')}>{label}</div>\r\n            {content}\r\n        </div>;\r\n    }\r\n    RowContainer = (content:JSX.Element): JSX.Element => {\r\n        let cn = classNames({\r\n            'py-3': true\r\n        });\r\n        return <div className={cn}>{content}</div>\r\n    }\r\n    RowSeperator = <div className=\"border border-gray border-top\" />;\r\n}\r\n","import * as React from 'react';\r\nimport { factory } from './widgets';\r\nimport { ContextContainer, Context } from './context';\r\n\r\nexport interface FieldProps {\r\n    name: string;\r\n}\r\n\r\nexport class FormField extends React.Component<FieldProps> {\r\n    static contextType = ContextContainer;\r\n    render() {\r\n        let {name, children } = this.props;\r\n        let context:Context = this.context;\r\n        if (context === undefined) return <span className=\"text-danger\">!only in Form!</span>;\r\n        let itemSchema = context.getItemSchema(name);\r\n        let content = factory(context, itemSchema, children, this.props);\r\n        if (content === undefined) {\r\n            return <span className=\"text-danger\">!!{name} is not defined!!</span>;\r\n        }\r\n        return content;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { UiTextItem } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport interface InputOptions {\r\n\ttype: string;\r\n\tmin?: number;\r\n\tmax?: number;\r\n\tstep?: number;\r\n}\r\n\r\nexport class StringItemEdit extends ItemEdit {\r\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve, reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.verifyValue();\r\n    }\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n\t}\r\n\t\r\n\tprotected inputOptions():InputOptions {\r\n\t\treturn {\r\n\t\t\ttype: 'text',\r\n\t\t}\r\n\t}\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n\t\tlet {resolve} = props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (this.error === undefined) {\r\n\t\t\t\tlet val = this.newValue;\r\n\t\t\t\tresolve(val);\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>;\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\t\tif (evt.keyCode === 13) onSave();\r\n\t\t}\r\n\t\tlet {type, max, min, step} = this.inputOptions();\r\n        return <Page header={this.label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<input type={type}\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n                    className=\"form-control\" \r\n                    defaultValue={this.value} min={min} max={max} step={step} />\r\n                {\r\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiRadio } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class RadioItemEdit extends ItemEdit {\r\n    get uiItem(): UiRadio {return this._uiItem as UiRadio}\r\n\r\n\tinit() {\r\n        if (this.value === undefined) {\r\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\r\n        }\r\n\t}\r\n\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (value: any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let {name} = this.itemSchema;\r\n        let {list} = this.uiItem;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>{\r\n                this.verifyValue();\r\n                if (this.error === undefined) resolve(this.newValue);\r\n            }}>保存</button>;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\r\n                    <input name={name} type=\"radio\" value={value} \r\n                        onClick={()=>this.onChange(value)} \r\n                        defaultChecked={value === this.value} /> {title || value} &nbsp;\r\n                </label></div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<div className=\"row row-cols-2 row-cols-sm-3 row-cols-md-4\">{content}</div>\r\n\t\t\t</div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiSelect } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class SelectItemEdit extends ItemEdit {\r\n    get uiItem(): UiSelect {return this._uiItem as UiSelect}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (value:any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let {list} = this.uiItem;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\r\n                    {title || value}\r\n                </div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label}>\r\n            <div className=\"my-3\">\r\n                {content}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiIdItem } from '../schema';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class IdItemEdit extends ItemEdit {\r\n    get uiItem(): UiIdItem {return this._uiItem as UiIdItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            //let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            //nav.push(element,reject);\r\n\r\n            let {pickId} = this.uiItem;\r\n            if (pickId === undefined) {\r\n                alert('IdItemEdit.pickId = undefined');\r\n                return;\r\n            }\r\n            let boxId = await pickId(undefined, undefined, this.value);\r\n            //if (typeof id === 'object') {\r\n            //    id = (id as any).id;\r\n            //}\r\n            this.onChange(boxId.id);\r\n            resolve(boxId);\r\n            //this.newValue = id;\r\n        });\r\n    }\r\n\r\n    protected async internalEnd():Promise<void> {}\r\n\r\n    private onChange = (value:any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        /*\r\n        let {resolve, reject} = props;\r\n        let {list} = this.uiItem;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\r\n                    {title || value}\r\n                </div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label}>\r\n            <div className=\"my-3\">\r\n                {content}\r\n            </div>\r\n        </Page>;\r\n        */\r\n        return <Page header={'更改' + this.label}>\r\n            ddd\r\n        </Page>\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiTag } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nabstract class TagItemEdit extends ItemEdit {\r\n\tprotected inputs: {[index:number]: HTMLInputElement} = {};\r\n\tprotected inputType: 'checkbox' | 'radio';\r\n    get uiItem(): UiTag {return this._uiItem as UiTag};\r\n\r\n\tinit() {\r\n        if (this.value === undefined) {\r\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\r\n        }\r\n\t}\r\n\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n\t}\r\n\t\r\n\trenderContent() {\r\n\t\tlet valuesView = this.uiItem.valuesView;\r\n\t\tif (valuesView === undefined) return super.renderContent();\r\n\t\treturn valuesView.render(this.value);\r\n\t}\r\n\r\n\tprotected abstract renderInputs():JSX.Element;\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>{\r\n                this.verifyValue();\r\n                if (this.error === undefined) resolve(this.newValue);\r\n\t\t\t}}>保存</button>;\r\n\t\t/*\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {name:itemName, id} = v;\r\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\r\n                    <input ref={input=>this.inputs[id] = input} name={name} type={this.inputType} value={id} \r\n\t\t\t\t\t\tonClick={(e)=>this.onChange(e.currentTarget.checked, id)}\r\n                        defaultChecked={this.defaultChecked(id)} /> {itemName} &nbsp;\r\n                </label></div>;\r\n            })\r\n            :\r\n\t\t\t<>no list defined</>;\r\n\t\t*/\r\n        return <Page header={'更改' + this.label} right={right}>\r\n\t\t\t<div className=\"p-3\">\r\n\t\t\t\t{this.renderInputs()}\r\n\t\t\t</div>\r\n        </Page>;\r\n    })\r\n}\r\n\r\nexport class TagSingleItemEdit extends TagItemEdit {\r\n\tprotected inputType:'radio'|'checkbox' = 'radio';\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tlet {currentTarget} = evt;\r\n\t\tif (currentTarget.checked === false) return;\r\n        this.newValue = Number(currentTarget.value);\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n\t}\r\n\t\r\n\tprotected renderInputs():JSX.Element {\r\n\t\tlet {valuesView} = this.uiItem;\r\n\t\tlet options = {\r\n\t\t\tinputs: this.inputs,\r\n\t\t\tonInputChange: this.onInputChange,\r\n\t\t};\r\n\t\treturn valuesView.renderRadios(this.value, options);\r\n\t}\r\n}\r\n\r\nexport class TagMultiItemEdit extends TagItemEdit {\r\n\t//private arr:number[];\r\n\tprotected inputType:'radio'|'checkbox' = 'checkbox';\r\n\r\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tlet values:string[] = [];\r\n\t\tfor (let i in this.inputs) {\r\n\t\t\tlet input = this.inputs[i];\r\n\t\t\tif (input.checked === true) values.push(input.value);\r\n\t\t}\r\n        this.newValue = values.join('|');\r\n        //this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n\t}\r\n\tprotected renderInputs():JSX.Element {\r\n\t\tlet {valuesView} = this.uiItem;\r\n\t\tlet options = {\r\n\t\t\tinputs: this.inputs,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t};\r\n\t\treturn valuesView.renderChecks(this.value, options);\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { UiTextItem } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class TextAreaItemEdit extends ItemEdit {\r\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve, reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.verifyValue();\r\n    }\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n\t\tlet {resolve} = props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (this.error === undefined) {\r\n\t\t\t\tlet val = this.newValue;\r\n\t\t\t\tresolve(val);\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>;\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n\t\t\t// if (evt.keyCode === 13) onSave();\r\n\t\t}\r\n        return <Page header={this.label} right={right}>\r\n            <div className=\"m-3\">\r\n                <textarea\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n                    className=\"form-control\" \r\n\t\t\t\t\tdefaultValue={this.value}\r\n\t\t\t\t\trows={6} />\r\n                {\r\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import React from 'react';\r\nimport { UiCheckItem } from '../schema';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class CheckBoxItemEdit extends ItemEdit {\r\n\tprivate input: HTMLInputElement;\r\n    get uiItem(): UiCheckItem {return this._uiItem as UiCheckItem}\r\n\tget editInRow(): boolean {return true;}\r\n    protected async internalStart():Promise<any> {\r\n\t\tif (!this.input) return;\r\n\t\tlet uiItem = this.uiItem;\r\n\t\tif (uiItem === undefined) return this.input.checked;\r\n\t\tlet {checked} = this.input;\r\n\t\treturn this.getValue(checked);\r\n    }\r\n\tasync end():Promise<any> {}\r\n\trenderContent() {\r\n\t\tlet {readOnly} = this.uiItem;\r\n\t\tlet disabled = readOnly === true;\r\n\t\tlet onChange:any;\r\n\t\tif (readOnly !== true) onChange = this.onChange;\r\n\t\treturn <input ref={r => this.input=r} type=\"checkbox\" \r\n\t\t\tdefaultChecked={this.value} disabled={disabled}\r\n\t\t\tonChange={onChange} />\r\n\t}\r\n\r\n\tprivate getValue(checked: boolean) {\r\n\t\tlet {trueValue, falseValue} = this.uiItem;\r\n        return checked === true? (trueValue??true) : (falseValue??false);\r\n\t}\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = this.getValue(evt.target.checked);\r\n        let preValue = this.value;\r\n\t\tthis.isChanged = (this.newValue !== preValue);\r\n\t\tthis.edit.onItemChanged(this, this.newValue);\r\n    }\r\n}\r\n","import { UiRange } from \"../schema\";\r\nimport { InputOptions, StringItemEdit } from \"./stringItemEdit\";\r\n\r\nexport class RangeItemEdit extends StringItemEdit {\r\n\tprotected inputOptions():InputOptions {\r\n\t\tlet min:number, max:number, step:number;\r\n\t\tif (this._uiItem) {\r\n\t\t\tmin = (this._uiItem as UiRange).min\r\n\t\t\tmax = (this._uiItem as UiRange).max\r\n\t\t\tstep = (this._uiItem as UiRange).step\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttype: 'range',\r\n\t\t\tmin, max, step\r\n\t\t}\r\n\t}\r\n}\r\n","import { UiNumberItem } from \"../schema\";\r\nimport { InputOptions, StringItemEdit } from \"./stringItemEdit\";\r\n\r\nexport class NumberItemEdit extends StringItemEdit {\r\n\tprotected inputOptions():InputOptions {\r\n\t\tlet min:number, max:number, step:number;\r\n\t\tif (this._uiItem) {\r\n\t\t\tmin = (this._uiItem as UiNumberItem).min\r\n\t\t\tmax = (this._uiItem as UiNumberItem).max\r\n\t\t\tstep = (this._uiItem as UiNumberItem).step\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttype: 'number',\r\n\t\t\tmin, max, step\r\n\t\t}\r\n\t}\r\n}\r\n","import * as React from 'react';\r\n//import _ from 'lodash';\r\nimport { observer } from 'mobx-react';\r\nimport { Schema, UiSchema, ItemSchema, UiItem, UiRadio, UiTagSingle, UiTagMulti } from '../schema';\r\nimport { ItemEdit } from './itemEdit';\r\nimport { StringItemEdit } from './stringItemEdit';\r\nimport { ImageItemEdit } from './imageItemEdit';\r\nimport { RadioItemEdit } from './radioItemEdit';\r\nimport { SelectItemEdit } from './selectItemEdit';\r\nimport { IdItemEdit } from './idItemEdit';\r\nimport { TagSingleItemEdit, TagMultiItemEdit } from './tagItemEdit';\r\nimport { TextAreaItemEdit } from './textAreaItemEdit';\r\nimport { CheckBoxItemEdit } from './checkBoxItemEdit';\r\nimport { RangeItemEdit } from './rangeItemEdit';\r\nimport { NumberItemEdit } from './numberItemEdit';\r\n\r\nexport interface EditProps {\r\n    className?: string;\r\n    schema: Schema;\r\n    data: any;\r\n    onItemClick?: (itemSchema: ItemSchema, uiItem: UiItem, value: any) => Promise<void>;\r\n    onItemChanged?: (itemSchema: ItemSchema, newValue:any, preValue:any) => Promise<void>;\r\n    stopEdit?: boolean;\r\n    uiSchema?: UiSchema;\r\n    sepClassName?: string;\r\n    topBorderClassName?: string;\r\n    bottomBorderClassName?: string;\r\n    rowContainerClassName?: string;\r\n}\r\n\r\n@observer\r\nexport class Edit extends React.Component<EditProps> {\r\n    private defaultSepClassName = 'border-top edit-sep-light-gray';\r\n    private defaultRowContainerClassName = 'd-flex px-3 py-2 bg-white align-items-center';\r\n    private topBorder:JSX.Element;\r\n    private bottomBorder:JSX.Element;\r\n    private rowContainerClassName?: string;\r\n    private sep:JSX.Element;\r\n\tprivate uiSchema: {[name:string]: UiItem};\r\n\r\n    constructor(props: EditProps) {\r\n        super(props);\r\n        let {topBorderClassName, bottomBorderClassName, sepClassName, rowContainerClassName, uiSchema} = props;\r\n        this.topBorder = <div className={topBorderClassName || this.defaultSepClassName} />;\r\n        this.bottomBorder = <div className={bottomBorderClassName || this.defaultSepClassName} />;\r\n        this.rowContainerClassName = rowContainerClassName || this.defaultRowContainerClassName;\r\n        //if (stopEdit !== true) this.rowContainerClassName += ' cursor-pointer';\r\n        this.sep = <div className={sepClassName || this.defaultSepClassName} />;\r\n\t\tthis.uiSchema = (uiSchema && uiSchema.items) || {};\r\n    }\r\n\r\n    render() {\r\n        let {schema} = this.props;\r\n\t\tlet sep:any;\r\n        return <div>\r\n\t\t\t{this.topBorder}\r\n            {schema.map((itemSchema, index) => {\r\n\t\t\t\tlet {stopEdit} = this.props;\r\n\t\t\t\tlet {name} = itemSchema;\r\n\t\t\t\tlet uiItem = this.uiSchema===undefined? undefined : this.uiSchema[name];\r\n\t\t\t\tlet label:string, labelHide:any;\r\n\t\t\t\tif (uiItem !== undefined) {\r\n\t\t\t\t\tlabel = uiItem.label || name;\r\n\t\t\t\t\tlabelHide = uiItem.labelHide;\r\n\t\t\t\t};\r\n\t\t\t\tlet value = this.props.data[name];\r\n\t\t\t\tlet itemEdit = createItemEdit(this, itemSchema, uiItem, label, value);\r\n\t\t\t\tlet rowContainerClassName = this.rowContainerClassName;\r\n\t\t\t\tlet {editInRow} = itemEdit;\r\n\t\t\t\tif (editInRow === false) {\r\n\t\t\t\t\tif (stopEdit !== true) editInRow = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (editInRow === false) rowContainerClassName += ' cursor-pointer';\r\n\r\n\t\t\t\tlet {required} = itemSchema;\r\n\t\t\t\tlet requireFlag = required===true && <span className=\"text-danger\">*</span>;\r\n\t\t\t\tlet divLabel:any, cn:string = 'flex-fill d-flex ';\r\n\t\t\t\tif (labelHide === true) {\r\n\t\t\t\t\tdivLabel = undefined;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdivLabel = <div>{label} {requireFlag}</div>;\r\n\t\t\t\t\tcn += 'justify-content-end';\r\n\t\t\t\t}\r\n\t\t\t\tlet ret = <React.Fragment key={index}>\r\n\t\t\t\t\t{sep}\r\n\t\t\t\t\t<div className={'d-flex align-items-center' + rowContainerClassName} \r\n\t\t\t\t\t\tonClick={async ()=>await this.rowClick(itemEdit)}>\r\n\t\t\t\t\t\t{divLabel}\r\n\t\t\t\t\t\t<div className={cn}>{\r\n\t\t\t\t\t\t\titemEdit===undefined? undefined: itemEdit.renderContent()\r\n\t\t\t\t\t\t}</div>\r\n\t\t\t\t\t\t{editInRow === false && <div className=\"w-2c text-right\"><i className=\"fa fa-angle-right\" /></div>}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</React.Fragment>;\r\n\t\t\t\tsep = this.sep;\r\n\t\t\t\treturn ret;\r\n\t\t\t})}\r\n\t\t\t{this.bottomBorder}\r\n\t\t</div>;\r\n    }\r\n\r\n\tasync onItemChanged(itemEdit:ItemEdit, newValue:any) {\r\n\t\tlet {itemSchema, uiItem, value} = itemEdit;\r\n\t\tthis.props.data[itemSchema.name] = newValue;\r\n        let {onItemChanged, stopEdit} = this.props;\r\n\t\tif (stopEdit === true) return;\r\n\t\tif (uiItem?.readOnly === true) return;\r\n\t\tif (onItemChanged === undefined) {\r\n\t\t\talert(`${itemSchema.name} value changed, new: ${newValue}, pre: ${value}`);\r\n\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\r\n\t\t\t//this.props.data[itemSchema.name] = changeValue;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tawait onItemChanged(itemSchema, newValue, value);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate rowClick = async (itemEdit:ItemEdit) => {\r\n\t\tif (itemEdit === undefined) {\r\n\t\t\talert('item has no edit');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet {itemSchema, uiItem, value, editInRow} = itemEdit;\r\n\t\tif (editInRow === true) return;\r\n        let {onItemChanged, onItemClick, stopEdit} = this.props;\r\n\t\tif (stopEdit === true) return;\r\n\t\tif (uiItem?.readOnly === true) return;\r\n        let changeValue:any;\r\n        if (onItemClick !== undefined) {\r\n            await onItemClick(itemSchema, uiItem, value);\r\n            return;\r\n        }\r\n        //let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);\r\n        if (itemEdit === undefined) {\r\n            alert('undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);');\r\n            return;\r\n        }\r\n        try {\r\n            changeValue = await itemEdit.start();\r\n            if (changeValue !== value) {\r\n\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以移到这里来\r\n\t\t\t\tthis.props.data[itemSchema.name] = changeValue;\r\n                if (onItemChanged === undefined) {\r\n                    alert(`${itemSchema.name} value changed, new: ${changeValue}, pre: ${value}`);\r\n\t\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\r\n                    //this.props.data[itemSchema.name] = changeValue;\r\n                }\r\n                else {\r\n                    await onItemChanged(itemSchema, changeValue, value);\r\n                }\r\n            }\r\n            await itemEdit.end();\r\n        }\r\n        catch (err) {\r\n            // 如果直接back，会触发reject，就到这里了\r\n\t\t\tconsole.log('no value changed');\r\n\t\t\tconsole.error(err);\r\n        }\r\n    }\r\n}\r\n\r\ntype NewItemEdit = new (edit: Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) => ItemEdit;\r\n\r\nfunction createItemEdit(edit: Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any):ItemEdit {\r\n\tlet ie: ItemEdit;\r\n    let itemEdit: NewItemEdit;\r\n    if (uiItem !== undefined) {\r\n        switch (uiItem.widget) {\r\n            default: break;\r\n            case 'id': itemEdit = IdItemEdit; break;\r\n\t\t\tcase 'text': itemEdit = StringItemEdit; break;\r\n\t\t\tcase 'textarea': itemEdit = TextAreaItemEdit; break;\r\n            case 'image': itemEdit = ImageItemEdit; break;\r\n\t\t\tcase 'select': itemEdit = SelectItemEdit; break;\r\n\t\t\tcase 'range': itemEdit = RangeItemEdit; break;\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'updown': itemEdit = NumberItemEdit; break;\r\n\t\t\tcase 'checkbox': itemEdit = CheckBoxItemEdit; break;\r\n            case 'radio': \r\n\t\t\t\tie = new RadioItemEdit(edit, itemSchema, uiItem as UiRadio, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'tagSingle':\r\n\t\t\t\tie = new TagSingleItemEdit(edit, itemSchema, uiItem as UiTagSingle, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'tagMulti':\r\n\t\t\t\tie = new TagMultiItemEdit(edit, itemSchema, uiItem as UiTagMulti, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t}\r\n\tif (ie === undefined) {\r\n\t\tif (itemEdit === undefined) {\r\n\t\t\tswitch (itemSchema.type) {\r\n\t\t\t\tcase 'string': itemEdit = StringItemEdit; break;\r\n\t\t\t\tcase 'image': itemEdit = ImageItemEdit; break;\r\n\t\t\t\tcase 'boolean': itemEdit = CheckBoxItemEdit; break;\r\n\t\t\t\tcase 'number':\r\n\t\t\t\tcase 'integer': itemEdit = RangeItemEdit; break;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (itemEdit === undefined) return;\r\n\t\tie = new itemEdit(edit, itemSchema, uiItem, label, value);\r\n\t}\r\n\tie.init();\r\n\treturn ie;\r\n}\r\n","import {CenterApiBase} from '../net';\r\n\r\nexport class CenterApi extends CenterApiBase {\r\n    async userAppUnits(app:number):Promise<any[]> {\r\n        return await this.get('tie/user-app-units', {app:app});\r\n    }\r\n    async userFromId(userId:number):Promise<any> {\r\n        return await this.get('user/user-name-nick-icon-from-id', {userId:userId});\r\n\t}\r\n\tasync userFromKey(userName:string):Promise<any> {\r\n\t\treturn await this.get('tie/user-from-key', {key:userName});\r\n\t}\r\n}\r\n\r\nexport const centerApi = new CenterApi('tv/', undefined);\r\n","import * as React from 'react';\r\nimport { Page, FA, nav, LMR, List } from \"../components\";\r\nimport { VPage } from '../vm';\r\nimport { appInFrame } from '../net';\r\nimport { CAppBase } from \"./CAppBase\";\r\nimport { UQsMan } from '../uq';\r\n\r\n/*\r\nexport class VAppMain extends VPage<CMainBase> {\r\n    async open(param?:any) {\r\n        this.openPage(this.appPage);\r\n    }\r\n\r\n    render(param?:any) {\r\n        return this.appContent();\r\n    }\r\n\r\n    protected appPage = () => {\r\n        let {caption} = this.controller;\r\n        return <Page header={caption} logout={async()=>{appInFrame.unit = undefined}}>\r\n            {this.appContent()}\r\n        </Page>;\r\n    }\r\n\r\n    protected appContent = () => {\r\n        let {cUqArr} = this.controller;\r\n        let content:any;\r\n        if (cUqArr.length === 0) {\r\n            content = <div className=\"text-danger\">\r\n                <FA name=\"\" /> 此APP没有绑定任何的UQ\r\n            </div>;\r\n        }\r\n        else {\r\n            content = cUqArr.map((v,i) => <div key={i}>{v.render()}</div>);\r\n        }\r\n        return <>{content}</>;\r\n    };\r\n}\r\n*/\r\nexport class VUnsupportedUnit extends VPage<CAppBase> {\r\n    async open(predefinedUnit: number) {\r\n        this.openPage(this.page, {predefinedUnit:predefinedUnit});\r\n    }\r\n\r\n    private page = ({predefinedUnit}:{predefinedUnit: number}) => {\r\n        let {user} = nav;\r\n        let userName:string = user? user.name : '[未登录]';\r\n        let {appOwner, appName} = UQsMan.value;\r\n        return <Page header=\"APP无法运行\" logout={true}>\r\n            <div className=\"m-3 text-danger container\">\r\n                <div className=\"form-group row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">登录用户</div>\r\n                    <div className=\"col-sm text-body\">{userName}</div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">App</div>\r\n                    <div className=\"col-sm text-body\">{`${appOwner}/${appName}`}</div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">预设小号</div>\r\n                    <div className=\"col-sm text-body\">{predefinedUnit || <small className=\"\">[无预设小号]</small>}</div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">\r\n                        可能原因<FA name=\"exclamation-triangle\" />\r\n                    </div>\r\n                    <div className=\"col-sm text-body\">\r\n                        <ul className=\"p-0\">\r\n                            <li>没有小号运行 {appName}</li>\r\n                            <li>用户 <b>{userName}</b> 没有加入任何一个运行{appName}的小号</li>\r\n                            {\r\n                                predefinedUnit && \r\n                                <li>预设小号 <b>{predefinedUnit}</b> 没有运行App {appName}</li>\r\n                            }\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">小号{predefinedUnit}</div>\r\n                    <div className=\"col-sm text-body\">\r\n                        预设小号定义在 public/unit.json 文件中。\r\n                        定义了这个文件的程序，只能由url直接启动。\r\n                        用户第一次访问app之后，会缓存在localStorage里。<br/>\r\n                        如果要删去缓存的预定义Unit，logout然后再login。\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport class VUnitSelect extends VPage<CAppBase> {\r\n    async open() {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderRow = (item: any, index: number):JSX.Element => {\r\n        let {id, nick, name} = item;\r\n        return <LMR className=\"px-3 py-2\" right={'id: ' + id}>\r\n            <div>{nick || name}</div>\r\n        </LMR>;\r\n    }\r\n    private onRowClick = async (appUnit: any) => {\r\n\t\tappInFrame.unit = appUnit.id; // 25;\r\n\t\tthis.controller.setAppUnit(appUnit);\r\n        await this.controller.start();\r\n    }\r\n\r\n    private page = () => {\r\n        return <Page header=\"选择小号\" logout={true}>\r\n            <List items={this.controller.appUnits} item={{render: this.renderRow, onClick: this.onRowClick}}/>\r\n        </Page>\r\n    }\r\n}\r\n\r\nexport class VErrorsPage extends VPage<CAppBase> {\r\n    async open(errors:string[]) {\r\n        this.openPage(this.page, {errors:errors});\r\n    }\r\n\r\n    private page = (errors:{errors:string[]}) => {\r\n        return <Page header=\"ERROR\">\r\n            <div className=\"m-3\">\r\n\t\t\t\t<div className=\"p-3 d-flex justify-content-center align-items-center\">\r\n\t\t\t\t\t<button className=\"btn btn-danger\" onClick={nav.resetAll}>重启网页</button>\r\n\t\t\t\t</div>\r\n\r\n                <div>Load Uqs 发生错误：</div>\r\n                {errors.errors.map((r, i) => <div key={i}>{r}</div>)}\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport class VStartError extends VPage<CAppBase> {\r\n    async open(error:any) {\r\n        this.openPage(this.page, {error:error});\r\n    }\r\n\r\n    private page = ({error}:{error:any}) => {\r\n        return <Page header=\"App start error!\">\r\n            <pre>\r\n                {typeof error === 'string'? error : error.message}\r\n            </pre>\r\n        </Page>;\r\n    }\r\n}","import { nav, t, setGlobalRes, RouteFunc, Hooks, Navigo, NamedRoute } from \"../components\";\r\nimport { Controller } from '../vm';\r\nimport { UQsMan, TVs } from \"../uq\";\r\nimport { appInFrame } from \"../net\";\r\nimport { centerApi } from \"./centerApi\";\r\nimport { VUnitSelect, VErrorsPage, VStartError, VUnsupportedUnit } from \"./vMain\";\r\n\r\nexport interface IConstructor<T> {\r\n    new (...args: any[]): T;\r\n}\r\n\r\nexport interface AppConfig {\r\n    appName: string;        // 格式: owner/appName\r\n    version: string;        // 版本变化，缓存的uqs才会重载\r\n    tvs: TVs;\r\n    uqNameMap?: {[uqName:string]: string};      // uqName='owner/uq' 映射到内存简单名字：uq, 可以注明映射，也可以自动。有可能重\r\n    loginTop?: JSX.Element;\r\n    oem?: string;               // 用户注册发送验证码的oem厂家，默认同花\r\n\tprivacy?: string;\r\n\tnoUnit?: boolean;\t\t\t// app的运行，不跟unit绑定\r\n\thtmlTitle?: string;\r\n}\r\n\r\nexport interface Elements {\r\n\t[id:string]: (element: HTMLElement)=>void,\r\n}\r\n\r\nexport abstract class CAppBase extends Controller {\r\n\tprivate appConfig: AppConfig;\r\n    protected _uqs: any;\r\n\r\n    protected readonly name: string;\r\n\tprotected readonly noUnit: boolean;\r\n\r\n    appUnits:any[];\r\n\r\n    constructor(config?: AppConfig) {\r\n\t\tsuper(undefined);\r\n\t\tthis.appConfig = config || (nav.navSettings as AppConfig);\r\n\t\tif (this.appConfig) {\r\n\t\t\tlet {appName, noUnit} = this.appConfig;\r\n\t\t\tthis.name = appName;\r\n\t\t\tif (appName === undefined) {\r\n\t\t\t\tthrow new Error('appName like \"owner/app\" must be defined in MainConfig');\r\n\t\t\t}\r\n\t\t\tthis.noUnit = noUnit;\r\n\t\t}\r\n    }\r\n\r\n    get uqs(): any {return this._uqs;}\r\n\r\n\tinternalT(str:string):any {\r\n\t\treturn t(str);\r\n\t}\r\n\t\r\n\tprotected setRes(res:any) {\r\n\t\tsetGlobalRes(res);\r\n\t}\r\n\r\n\tprivate appUnit:any;\r\n\tprivate roleDefines: string[];\r\n\thasRole(role: string|number):boolean {\r\n\t\tlet nRole:number;\r\n\t\tif (typeof role === 'string') {\r\n\t\t\tif (role.length === 0) return false;\r\n\t\t\tlet index = this.roleDefines.findIndex(v => v === role);\r\n\t\t\tif (index < 0) return false;\r\n\t\t\tnRole = 1<<index;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tnRole = role;\r\n\t\t}\r\n\t\treturn (this.appUnit.roles & nRole) !== 0;\r\n\t}\r\n\r\n\tsetAppUnit(appUnit:any) {\r\n\t\tthis.appUnit = appUnit;\r\n\t\tlet {roleDefs} = appUnit;\r\n\t\tif (roleDefs) {\r\n\t\t\tthis.roleDefines = roleDefs.split('\\t');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.roleDefines = [];\r\n\t\t}\r\n}\r\n\t\r\n    protected async beforeStart():Promise<boolean> {\r\n        try {\r\n\t\t\tthis.onNavRoutes();\r\n\t\t\tif (!this.appConfig) return true;\r\n\t\t\tlet {appName, version, tvs} = this.appConfig;\r\n\t\t\tawait UQsMan.load(appName, version, tvs);\r\n\t\t\tthis._uqs = UQsMan._uqs;\t\t\t\r\n            //let retErrors = await this.load();\r\n            //let app = await loadAppUqs(this.appOwner, this.appName);\r\n            // if (isDevelopment === true) {\r\n\t\t\t// 这段代码原本打算只是在程序员调试方式下使用，实际上，也可以开放给普通用户，production方式下\r\n\t\t\tlet retErrors = UQsMan.errors;\r\n            let {predefinedUnit} = appInFrame;\r\n            let {user} = nav;\r\n            if (user !== undefined && user.id > 0) {\r\n\t\t\t\tlet result = await centerApi.userAppUnits(UQsMan.value.id);\r\n\t\t\t\tthis.appUnits = result;\r\n\t\t\t\t/*\r\n\t\t\t\t// 老版本，只返回一个数组。新版本，返回两个数组。下面做两个数组的判断\r\n\t\t\t\tif (result.length === 0) {\r\n\t\t\t\t\tthis.appUnits = result;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (Array.isArray(result[0]) === true) {\r\n\t\t\t\t\t\tthis.appUnits = result[0];\r\n\t\t\t\t\t\tlet result1 = result[1];\r\n\t\t\t\t\t\tif (Array.isArray(result1) === true) {\r\n\t\t\t\t\t\t\tthis.roleDefines = result1[0]?.roles?.split('\\t');\r\n\t\t\t\t\t\t\tif (this.roleDefines === undefined) this.roleDefines = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.appUnits = result;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\tif (this.noUnit === true) return true;\r\n                switch (this.appUnits.length) {\r\n                    case 0:\r\n                        this.showUnsupport(predefinedUnit);\r\n\t\t\t\t\t\treturn false;\r\n                    case 1:\r\n\t\t\t\t\t\tlet appUnit = this.appUnits[0];\r\n\t\t\t\t\t\tthis.setAppUnit(appUnit);\r\n\t\t\t\t\t\tlet {id} = appUnit;\r\n                        let appUnitId = id;\r\n                        if (appUnitId === undefined || appUnitId < 0 || \r\n                            (predefinedUnit !== undefined && appUnitId !== predefinedUnit))\r\n                        {\r\n                            this.showUnsupport(predefinedUnit);\r\n                            return false;\r\n                        }\r\n                        appInFrame.unit = appUnitId;\r\n                        break;\r\n                    default:\r\n                        if (predefinedUnit>0 && this.appUnits.find(v => v.id===predefinedUnit) !== undefined) {\r\n                            appInFrame.unit = predefinedUnit;\r\n                            break;\r\n                        }\r\n                        this.openVPage(VUnitSelect);\r\n                        return false;\r\n                }\r\n            }\r\n            if (retErrors !== undefined) {\r\n                this.openVPage(VErrorsPage, retErrors);\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        catch (err) {\r\n            this.openVPage(VStartError, err);\r\n            return false;\r\n        }\r\n    }\r\n\tprotected async afterStart():Promise<void> {\r\n\t\tnav.resolveRoute();\r\n\t}\r\n\r\n    async userFromId(userId:number):Promise<any> {\r\n        return await centerApi.userFromId(userId);\r\n    }\r\n\r\n\tprotected on(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\tprotected on(...args:any[]):Navigo {\r\n\t\treturn nav.on(args[0], args[1], args[2]);\r\n\t}\r\n\r\n\tprotected onNavRoutes() {return;}\r\n\r\n    private showUnsupport(predefinedUnit: number) {\r\n        nav.clear();\r\n        this.openVPage(VUnsupportedUnit, predefinedUnit);\r\n    }\r\n}\r\n","import { AppConfig, CAppBase } from './CAppBase';\r\n\r\nexport async function start(CApp: new (config: AppConfig) => CAppBase, appConfig: AppConfig, isUserLogin?:boolean) {\r\n\tif (appConfig) {\r\n\t\tlet {htmlTitle} = appConfig;\r\n\t\tif (htmlTitle) {\r\n\t\t\tdocument.title = htmlTitle;\r\n\t\t}\r\n\t\tlet html = document.getElementsByTagName('html');\r\n\t\tlet html0 = html[0];\r\n\t\tif (html0) {\r\n\t\t\tlet version = html0?.getAttribute('data-version');\r\n\t\t\tif (version) appConfig.version = version;\r\n\t\t}\r\n\t}\r\n\r\n\tlet cApp = new CApp(appConfig);\r\n    await cApp.start(isUserLogin);\r\n}\r\n","import _ from 'lodash';\r\nimport { Controller, WebNav } from \"../vm\";\r\nimport { IConstructor } from \"./CAppBase\";\r\n\r\nexport abstract class CBase extends Controller {\r\n    protected readonly _uqs: any;\r\n    protected readonly _cApp: any;\r\n\r\n    constructor(cApp: any) {\r\n        super(cApp.res);\r\n        this._cApp = cApp;\r\n        this._uqs = cApp && cApp.uqs;\r\n\t}\r\n\r\n    protected get uqs(): any {return this._uqs}\r\n\tget cApp(): any {return this._cApp}\r\n\thasRole(role:string|number):boolean {\r\n\t\treturn this._cApp?.hasRole(role);\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\tlet r = super.internalT(str);\r\n\t\tif (r!==undefined) return r;\r\n\t\treturn this._cApp.internalT(str);\r\n\t}\r\n\r\n    protected newC<T extends CBase>(type: IConstructor<T>, param?:any):T {\r\n\t\tlet c = new type(this.cApp);\r\n\t\tc.init(param);\r\n\t\treturn c;\r\n    }\r\n\r\n    protected newSub<O extends CBase, T extends CSub<O>>(type: IConstructor<T>, param?:any):T {\r\n\t\tlet s = new type(this);\r\n\t\ts.init(param);\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\tgetWebNav(): WebNav<any> {\r\n\t\tlet wn = this._cApp?.getWebNav();\r\n\t\tif (wn === undefined) return;\r\n\t\tlet ret = _.clone(wn);\r\n\t\t_.merge(ret, this.webNav);\r\n\t\treturn ret;\r\n\t}\r\n}\r\n\r\nexport abstract class CSub<T extends CBase> extends CBase {\r\n    protected _owner: T;\r\n\r\n    constructor(owner: T) {\r\n        super(owner.cApp);\r\n        this._owner = owner;\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\tlet r = super.internalT(str);\r\n\t\tif (r!==undefined) return r;\r\n\t\treturn this._owner.internalT(str);\r\n\t}\r\n\r\n    protected get owner(): CBase {return this._owner}\r\n\t\r\n\tgetWebNav(): WebNav<any> {\r\n\t\tlet wn = this._cApp?.getWebNav();\r\n\t\tif (wn === undefined) return;\r\n\t\tlet ownerWNs:WebNav<any>[] = [];\r\n\t\tfor (let p = this.owner; p!==undefined; p = (p as any)?.owner) {\r\n\t\t\townerWNs.push(p.webNav);\r\n\t\t}\r\n\t\tlet ret = _.clone(wn);\r\n\t\tfor (;;) {\r\n\t\t\tlet own = ownerWNs.pop();\r\n\t\t\tif (own === undefined) break;\r\n\t\t\t_.merge(ret, own);\r\n\t\t}\r\n\t\t_.merge(ret, this.webNav);\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import { AppConfig, CAppBase } from './CAppBase';\r\nimport { nav } from '../components';\r\n\r\nexport async function startPage(CApp: new (config: AppConfig) => CAppBase, appConfig: AppConfig) {\r\n\tlet {htmlTitle} = appConfig;\r\n\tif (htmlTitle) {\r\n\t\tdocument.title = htmlTitle;\r\n\t}\r\n\tlet html = document.getElementsByTagName('html');\r\n\tlet html0 = html[0];\r\n\tif (html0) {\r\n\t\tlet version = html0?.getAttribute('data-version');\r\n\t\tif (version) appConfig.version = version;\r\n\t}\r\n\t\r\n\tnav.setSettings(appConfig);\r\n\t//nav.isRouting = true;\r\n\t//await nav.init();\r\n\t//let {appName, version, tvs} = appConfig;\r\n\t//await UQsMan.load(appName, version, tvs);\r\n\t//nav.resolveRoute();\r\n\r\n\tlet cApp = new CApp(appConfig);\r\n\tcApp.init();\r\n    await cApp.start();\r\n}\r\n","import * as React from 'react';\r\nimport { IObservableArray, computed } from 'mobx';\r\nimport { PageItems } from '../../tool/pageItems';\r\nimport {List} from './index';\r\n\r\nexport abstract class ListBase {\r\n    protected list: List;\r\n    constructor(list: List) {\r\n        this.list = list;\r\n    }\r\n    get isPaged():boolean {\r\n        let items = this.list.props.items;\r\n        return (items !== null && items !== undefined && Array.isArray(items) === false);\r\n    }\r\n    get items():any[]|IObservableArray<any> {\r\n        let items = this.list.props.items;\r\n        if (items === null) return null;\r\n        if (items === undefined) return undefined;\r\n        if (Array.isArray(items) === true)\r\n            return items as IObservableArray<any>;\r\n        else\r\n            return (items as PageItems<any>).items;\r\n    }\r\n    @computed get loading():boolean {\r\n        let items = this.list.props.items;\r\n        if (items === null) return false;\r\n        if (items === undefined) return true;\r\n        let pageItems = items as PageItems<any>;\r\n        if (pageItems.items === undefined) return false;\r\n        return pageItems.loading;\r\n    }\r\n    get selectedItems():any[] { return undefined; }\r\n    //updateProps(nextProps:any) {}\r\n    dispose() {};\r\n    abstract render: (item:any, index:number) => JSX.Element;\r\n    protected renderContent(item:any, index:number) {\r\n        let {render} = this.list.props.item;\r\n        if (render === undefined) return <div className=\"px-3 py-2\">{JSON.stringify(item)}</div>;\r\n        return render(item, index);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {ListBase} from './base';\r\n\r\nexport class Clickable extends ListBase {\r\n    render = (item:any, index:number):JSX.Element => {\r\n        let {className, key, onClick} = this.list.props.item;\r\n        return <li key={key===undefined?index:key(item)} className={classNames('va-row-clickable', className)} onClick={()=>onClick && onClick(item)}>\r\n            {this.renderContent(item, index)}\r\n        </li>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { ListBase } from './base';\r\nimport { uid } from '../../tool/uid';\r\n\r\nexport class Static extends ListBase {\r\n    render = (item:any, index:number):JSX.Element => {\r\n        let {className, key} = this.list.props.item;\r\n        if (typeof item === 'string') {\r\n            let cn = classNames('va-list-gap', 'px-3', 'pt-1');\r\n            return <li key={uid()} className={cn}>{item}</li>;\r\n        }\r\n        return <li key={key===undefined?index:key(item)} className={classNames(className)}>\r\n            {this.renderContent(item, index)}\r\n        </li>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observable, IObservableArray, isObservableArray, observe} from 'mobx';\r\nimport classNames from 'classnames';\r\nimport {ListBase} from './base';\r\nimport {uid} from '../../tool/uid';\r\nimport { PageItems } from '../../tool/pageItems';\r\nimport { List } from './index';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport interface SelectableItem {\r\n    selected: boolean;\r\n    item: any;\r\n    labelId: string;\r\n}\r\n\r\nexport class Selectable extends ListBase {\r\n    @observable private _items: SelectableItem[];\r\n    private inputItems:{[uid:string]: HTMLInputElement} = {};\r\n\r\n    constructor(list: List) {\r\n        super(list);\r\n        this.buildItems();\r\n        this.listenArraySplice();\r\n    }    \r\n\r\n    private listenArraySplice() {\r\n        let {items} = this.list.props;\r\n        if (items === undefined) return;\r\n        if (items === null) return;\r\n        let itemsArray:any;\r\n        if (Array.isArray(items) === true) {\r\n            itemsArray = items as any;\r\n        }\r\n        else {\r\n            itemsArray = (items as PageItems<any>).items;\r\n        }\r\n        if (isObservableArray(items) === true) {\r\n            observe(itemsArray as IObservableArray<any>, (change) => {                \r\n                if (change.type === 'splice') {\r\n                    let {index, removedCount, added} = change;\r\n                    let _added = added && added.map(v => {\r\n                        return {\r\n                            selected: false, \r\n                            item: v, \r\n                            labelId:uid()\r\n                        }\r\n                    });\r\n                    this._items.splice(index, removedCount, ..._added);\r\n                    this.buildItems();\r\n                }\r\n            }, true);\r\n        }\r\n    }\r\n\r\n    private buildItems = () => {\r\n        let {items, isItemSelected, selectedItems, compare} = this.list.props;\r\n        let itemsArray:any[] | IObservableArray<any>;\r\n        if (items === undefined) {\r\n            this._items = undefined;\r\n            return;\r\n        }\r\n        if (items === null) {\r\n            this._items = null;\r\n            return;\r\n        }\r\n        \r\n        if (Array.isArray(items) === true) {\r\n            itemsArray = items as any;\r\n        }\r\n        else {\r\n            itemsArray = (items as PageItems<any>).items;\r\n        }\r\n\r\n\t\tif (isItemSelected) {\r\n\t\t\tlet retItems = itemsArray.map(v => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tselected: isItemSelected(v),\r\n\t\t\t\t\titem: v, \r\n\t\t\t\t\tlabelId:uid()\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tthis._items = retItems;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet comp: ((item:any, selectItem:any)=>boolean);\r\n\t\t\tif (compare === undefined) {\r\n\t\t\t\tcomp = (item:any, selectItem:any) => item === selectItem;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcomp = compare;\r\n\t\t\t}\r\n\t\t\tlet retItems = itemsArray.map(v => {\r\n\t\t\t\t//let isObserved = isObservable(v);\r\n\t\t\t\t//let obj = isObserved === true? toJS(v) : v;\r\n\t\t\t\t//let obj = v;\r\n\t\t\t\tlet selected = selectedItems === undefined?\r\n\t\t\t\t\tfalse\r\n\t\t\t\t\t: selectedItems.find(si => comp(v, si)) !== undefined;\r\n\t\t\t\treturn {\r\n\t\t\t\t\tselected: selected, \r\n\t\t\t\t\titem: v, \r\n\t\t\t\t\tlabelId:uid()\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tthis._items = retItems;\r\n\t\t}\r\n    }\r\n\r\n    get items() {\r\n        //if (this._items === undefined) \r\n        //this.buildItems();\r\n        return this._items;\r\n    }\r\n    private checkAll(on: boolean) {\r\n        for (let i in this.inputItems) this.inputItems[i].checked = on;\r\n        for (let item of this._items) item.selected = on;\r\n    }\r\n    selectAll() {\r\n        //if (this._items) this._items.forEach(v => v.selected = true);\r\n        this.checkAll(true);\r\n        this.list.props.item.onSelect(undefined, true, this.anySelected);\r\n    }\r\n    unselectAll() {\r\n        // if (this._items) this._items.forEach(v => v.selected = false);\r\n        this.checkAll(false);\r\n        this.list.props.item.onSelect(undefined, false, this.anySelected);\r\n    }\r\n    /*\r\n    updateProps(nextProps:any) {\r\n        if (nextProps.selectedItems === this._selectedItems) return;\r\n        this.buildItems();\r\n    }\r\n    */\r\n    private get anySelected():boolean {return this._items.some(v => v.selected)}\r\n    private onSelect(item:SelectableItem, selected:boolean) {\r\n        item.selected = selected;\r\n        this.list.props.item.onSelect(item.item, selected, this.anySelected);\r\n    }\r\n    \r\n    get selectedItems():any[] {\r\n        return this._items.filter(v => v.selected === true).map(v => v.item);\r\n    }\r\n    /*\r\n    set selectedItems(value: any[]) {\r\n        if (value === undefined) return;\r\n        if (this._items === undefined) return;\r\n        let sLen = this._items.length;\r\n        let list = value.slice();\r\n        for (let n=0; n<sLen; n++) {\r\n            let sItem = this._items[n];\r\n            let len = list.length;\r\n            if (len === 0) break;\r\n            let item = sItem.item;\r\n            for (let i=0; i<len; i++) {\r\n                let v = list[i];\r\n                if (item === v) {\r\n                    sItem.selected = true;\r\n                    value.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        };\r\n    }\r\n    */\r\n    //w-100 mb-0 pl-3\r\n    //m-0 w-100\r\n    render = (item:SelectableItem, index:number):JSX.Element => {\r\n        let {key} = this.list.props.item;\r\n\t\treturn React.createElement(this.row, {item, index, key:key===undefined?index:key(item)});\r\n    }\r\n\r\n    private row = observer((props: {item:SelectableItem, index:number}):JSX.Element => {\r\n        let {item, index} = props;\r\n        let {className} = this.list.props.item;\r\n        let {labelId, selected, item:obItem} = item;\r\n        return <li className={classNames(className)}>\r\n            <div className=\"d-flex align-items-center px-3\">\r\n                <input ref={input=>{if (input) this.inputItems[labelId] = input;}}\r\n                    className=\"\" type=\"checkbox\" value=\"\" id={labelId}\r\n                    defaultChecked={selected}\r\n                    onChange={(e)=>{\r\n                        this.onSelect(item, e.target.checked)} \r\n                    }/>\r\n                <label className=\"\" style={{flex:1, marginBottom:0}} htmlFor={labelId}>\r\n                    {this.renderContent(obItem, index)}\r\n                </label>\r\n            </div>\r\n        </li>\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {observer} from 'mobx-react';\r\nimport _ from 'lodash';\r\nimport {PageItems} from '../../tool/pageItems';\r\nimport {ListBase} from './base';\r\nimport {Clickable} from './clickable';\r\nimport {Static} from './static';\r\nimport {Selectable} from './selectable';\r\nimport '../../css/va-list.css';\r\nimport { IObservableArray } from 'mobx';\r\nimport { resLang } from '../../res/res';\r\nimport { ListRes, listRes } from '../../res';\r\n\r\ntype StaticRow = string|JSX.Element|(()=>string|JSX.Element);\r\ninterface ItemProps {\r\n\tclassName?: string|string[];\r\n\trender?: (item:any, index:number) => JSX.Element;\r\n\tonSelect?: (item:any, isSelected:boolean, anySelected:boolean)=>void;\r\n\tonClick?: (item:any)=>void;\r\n\tkey?: (item:any)=>string|number;\r\n}\r\n\r\nexport interface ListProps {\r\n    className?: string|string[];\r\n    items: any[] | IObservableArray<any> | PageItems<any>;\r\n    item: ItemProps;\r\n\tisItemSelected?: (item:any) => boolean;\r\n    compare?: (item:any, selectItem:any) => boolean;\r\n\tselectedItems?:any[];\r\n    header?: StaticRow;\r\n    footer?: StaticRow;\r\n    before?: StaticRow;\r\n    loading?: StaticRow;\r\n\tnone?: StaticRow;\r\n\tonFocus?: (evt: React.FocusEvent<HTMLUListElement>)=>void;\r\n}\r\n\r\n@observer\r\nexport class List extends React.Component<ListProps> {\r\n\tprivate static res:ListRes = resLang<ListRes>(listRes);\r\n\r\n\tprivate listBase: ListBase;\r\n\tprivate selectable: Selectable;\r\n    constructor(props:ListProps) {\r\n\t\tsuper(props);\r\n        this.buildBase();\r\n    }\r\n    _$scroll = (direct: 'top'|'bottom') => {\r\n        console.log('############### items scroll to ' + direct);\r\n    }\r\n    private buildBase() {\r\n        let {item} = this.props;\r\n        let {onClick, onSelect} = item;\r\n        if (onSelect !== undefined)\r\n            this.selectable = this.listBase = new Selectable(this);\r\n        else if (onClick !== undefined)\r\n            this.listBase = new Clickable(this);\r\n        else\r\n            this.listBase = new Static(this);\r\n\t}\r\n\tcomponentDidUpdate(prevProps: Readonly<ListProps>, prevState: Readonly<any>) {\r\n\t\tif (_.isEqual(this.props.item, prevProps.item) === false) {\r\n\t\t\tthis.buildBase();\r\n\t\t\tthis.forceUpdate();\r\n\t\t}\r\n\t}\r\n    componentWillUnmount() {\r\n        this.listBase.dispose();\r\n    }\r\n    selectAll() {\r\n        if (this.selectable) this.selectable.selectAll();\r\n    }\r\n    unselectAll() {\r\n        if (this.selectable) this.selectable.unselectAll();\r\n    }\r\n    get selectedItems():any[] {\r\n        return this.listBase.selectedItems;\r\n    }\r\n    render() {\r\n        let {className, header, footer, before, loading, none, onFocus} = this.props;\r\n        if (before === undefined) before = '-';\r\n        if (loading === undefined) loading = () => <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />;\r\n        if (none === undefined) none = List.res.none;\r\n        //this.listBase.selectedItems = selectedItems;\r\n        let {items, loading:isLoading} = this.listBase;\r\n        function staticRow(row:StaticRow, type:string) {\r\n            if (!row) return;\r\n            switch (typeof row) {\r\n                default:\r\n                case 'string': return <li className={\"va-list-\"+type}>{row}</li>;\r\n                case 'function': return <li className={\"va-list-\"+type}>{(row as ()=>string|JSX.Element)()}</li>;\r\n                case 'object': return <li>{row}</li>\r\n            } \r\n        }\r\n        let content:any, waitingMore:any;\r\n        if (items === null)\r\n            content = staticRow(before, 'before');\r\n        else if (items === undefined)\r\n            content = staticRow(loading, 'loading');\r\n        else if (items.length === 0)\r\n            content = staticRow(none, 'none');\r\n        else {\r\n            content = items.map((item, index) => {\r\n                return this.listBase.render(item, index);\r\n            });\r\n        }\r\n        if (isLoading === true && items) {\r\n            waitingMore = staticRow(loading, 'loading');\r\n\t\t}\r\n\t\tlet tabIndex:number;\r\n\t\tif (onFocus !== undefined) tabIndex = -1;\r\n        return <ul className={classNames('va-list', className)} onFocus={onFocus} tabIndex={tabIndex}>\r\n            {staticRow(header, 'header')}\r\n            {content}\r\n            {waitingMore}\r\n            {staticRow(footer, 'footer')}\r\n        </ul>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport className from 'classnames';\r\nimport {PropGridProps} from './PropGrid';\r\nimport {LabeledProp, StringProp, NumberProp, ListProp, ComponentProp} from './propView';\r\n\r\nexport abstract class PropRow {\r\n    setValues(values: any) {}\r\n    abstract render(key:string): any;\r\n}\r\n\r\nexport class PropBorder extends PropRow {\r\n    render(key:string): JSX.Element {\r\n        return <div key={'_b_' + key} className=\"\">\r\n            <div className=\"w-100\">\r\n                <div style={{borderTop: '1px solid #f0f0f0'}} />\r\n            </div>\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport class PropGap extends PropRow {\r\n    private param: string;\r\n    constructor(param?: string) {\r\n        super();\r\n        this.param = param;\r\n    }\r\n    render(key:string): JSX.Element {\r\n        let w: string;\r\n        switch (this.param) {\r\n            default: w = 'py-2'; break;\r\n            case '=': w = 'py-1'; break;\r\n            case '-': w = 'pb-1'; break;\r\n        }\r\n        let cn = className(w);\r\n        return <div key={'_g_' + key} className={cn} />;\r\n    }\r\n}\r\n\r\nconst valueAlignStart = 'justify-content-start';\r\nconst valueAlignCenter = 'justify-content-center';\r\nconst valueAlignEnd = 'justify-content-end';\r\nexport abstract class LabeledPropRow extends PropRow {\r\n    protected gridProps: PropGridProps;\r\n    protected _prop: LabeledProp;\r\n    protected get prop():LabeledProp {return this._prop}\r\n    protected content: any;\r\n    protected col: string;\r\n    //protected values: any;\r\n    constructor(gridProps:PropGridProps, prop: LabeledProp) {\r\n        super();\r\n        this.gridProps = gridProps;\r\n        this._prop = prop;\r\n        this.col = gridProps.labelFixLeft === true? 'col' : 'col-sm';\r\n        //this.values = values;\r\n    }\r\n    render(key:string):any {\r\n        let {onClick, bk} = this.prop;\r\n        let cn = className({\r\n            \"cursor-pointer\": onClick !== undefined,\r\n            \"bg-white\": bk === undefined, \r\n            \"row\": true\r\n        });\r\n        return <div key={key} className={cn} onClick={onClick}>\r\n            {this.renderLabel()}\r\n            {this.renderProp()}\r\n        </div>;\r\n    }\r\n    protected renderLabel():any {\r\n        let {label} = this.prop;\r\n        if (label === undefined) return null;\r\n        return <label className={this.col + '-3 col-form-label'}>\r\n            {label}\r\n        </label>;\r\n    }\r\n    protected renderProp():any {\r\n        let {label} = this.prop;\r\n        let align, vAlign;\r\n        switch (this.gridProps.alignValue) {\r\n            case 'left': align = valueAlignStart; break;\r\n            case 'center': align = valueAlignCenter; break;\r\n            case 'right': align = valueAlignEnd; break;\r\n        }\r\n        switch (this.prop.vAlign) {\r\n            case 'top': vAlign = 'align-items-start'; break;\r\n            default:\r\n            case 'center': vAlign = 'align-items-center'; break;\r\n            case 'bottom': vAlign = 'align-items-end'; break;\r\n            case 'stretch': vAlign = 'align-items-stretch'; break;\r\n        }\r\n        let col:string = this.col + (label===undefined? '-12':'-9');\r\n        let cn = className(align, vAlign, col, 'd-flex');\r\n        return <div className={cn}>\r\n            {this.renderPropBody()}\r\n        </div>;\r\n    }\r\n    protected renderPropBody():any {\r\n        return <div className=\"form-control-plaintext\">\r\n            {this.renderPropContent()}\r\n        </div>;\r\n    }\r\n    protected renderPropContent():any {\r\n        return this.content;\r\n    }\r\n}\r\n\r\nexport class StringPropRow extends LabeledPropRow {\r\n    protected get prop(): StringProp {return this._prop as StringProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else this.content = values[this.prop.name];\r\n    }\r\n}\r\n\r\nexport class NumberPropRow extends LabeledPropRow {\r\n    protected get prop(): NumberProp {return this._prop as NumberProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else this.content = values[this.prop.name];\r\n    }\r\n}\r\n\r\nexport class ListPropRow extends LabeledPropRow {\r\n    protected get prop(): ListProp {return this._prop as ListProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else {\r\n            let list = this.prop.list;\r\n            if (typeof list === 'string') this.content = values[list];\r\n            else this.content = undefined;\r\n        }\r\n    }\r\n    protected renderPropBody() {\r\n        let {list, row} = this.prop;\r\n        let items:any[] = typeof list === 'string'? this.content : list;\r\n        if (items === undefined) return <div/>;\r\n        // new row(item)\r\n        return <div className=\"w-100\">\r\n            {\r\n                items.map((item, index) => <React.Fragment key={index}>\r\n                    {index===0? null: <div style={{width:'100%', borderBottom:'1px solid #f0f0f0'}} />}\r\n                    {React.createElement(row, item)}\r\n                </React.Fragment>)\r\n            }\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport class ComponentPropRow extends LabeledPropRow {\r\n    protected get prop(): ComponentProp {return this._prop as ComponentProp;}\r\n    protected renderPropBody() {\r\n        let {component} = this.prop;\r\n        return component;\r\n    }\r\n    protected renderProp():any {\r\n        let {label, full} = this.prop;\r\n        let align, vAlign;\r\n        switch (this.gridProps.alignValue) {\r\n            case 'left': align = valueAlignStart; break;\r\n            case 'center': align = valueAlignCenter; break;\r\n            case 'right': align = valueAlignEnd; break;\r\n        }\r\n        switch (this.prop.vAlign) {\r\n            case 'top': vAlign = 'align-items-start'; break;\r\n            default:\r\n            case 'center': vAlign = 'align-items-center'; break;\r\n            case 'bottom': vAlign = 'align-items-end'; break;\r\n            case 'stretch': vAlign = 'align-items-stretch'; break;\r\n        }\r\n        let col:string;\r\n        if (full !== true)\r\n            col = this.col + (label===undefined? '-12':'-9');\r\n        else\r\n            col = 'w-100';\r\n        let cn = className(align, vAlign, col, 'd-flex');\r\n        return <div className={cn}>\r\n            {this.renderPropBody()}\r\n        </div>;\r\n    }\r\n}\r\n","import { PropGridProps } from './PropGrid';\r\nimport {\r\n    PropRow, PropBorder, PropGap, \r\n    StringPropRow, NumberPropRow, ListPropRow, ComponentPropRow\r\n} from './row';\r\n\r\nexport interface Format {\r\n\r\n}\r\n\r\nexport interface PropBase {\r\n    onClick?: () => void;\r\n}\r\n\r\nexport interface LabeledProp extends PropBase {\r\n    label?: string;\r\n    bk?: string;\r\n    vAlign?: 'top' | 'bottom' | 'center' | 'stretch';\r\n}\r\n\r\nexport interface StringProp extends LabeledProp {\r\n    type: 'string';\r\n    name: string;\r\n}\r\n\r\nexport interface NumberProp extends LabeledProp {\r\n    type: 'number';\r\n    name: string;\r\n}\r\n\r\nexport interface FormatProp extends LabeledProp {\r\n    type: 'format';\r\n    format: Format;\r\n}\r\n\r\nexport interface ListProp extends LabeledProp {\r\n    type: 'list';\r\n    list: string | any[];  // string 表示名字，否则就是值\r\n    row: new (props: any) => React.Component;\r\n}\r\n\r\nexport interface ComponentProp extends LabeledProp {\r\n    type: 'component';\r\n    full?: boolean;\r\n    component: any; //JSX.Element;\r\n}\r\n\r\nexport type Prop = StringProp | NumberProp | FormatProp | ListProp | ComponentProp | string;\r\n\r\nexport class PropView {\r\n    private gridProps: PropGridProps\r\n    private props: Prop[];\r\n    //private values:any;\r\n    private rows: PropRow[];\r\n\r\n    constructor(gridProps: PropGridProps, props: Prop[]) {\r\n        this.gridProps = gridProps;\r\n        this.props = props;\r\n        //this.values = values;\r\n        this.buildRows();\r\n    }\r\n\r\n    private buildRows() {\r\n        this.rows = [];\r\n        let isGap: boolean = true;\r\n        for (let prop of this.props) {\r\n            if (typeof prop === 'string') {\r\n                this.rows.push(new PropGap(prop));\r\n                isGap = true;\r\n            }\r\n            else {\r\n                if (!isGap) this.rows.push(new PropBorder());\r\n                let row;\r\n                switch (prop.type) {\r\n                    default: continue;\r\n                    case 'string': row = new StringPropRow(this.gridProps, prop); break;\r\n                    case 'number': row = new NumberPropRow(this.gridProps, prop); break;\r\n                    case 'list': row = new ListPropRow(this.gridProps, prop); break;\r\n                    case 'component': row = new ComponentPropRow(this.gridProps, prop); break;\r\n                }\r\n                this.rows.push(row);\r\n                isGap = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    setValues(values: any) {\r\n        for (let r of this.rows) r.setValues(values);\r\n    }\r\n\r\n    render() {\r\n        return this.rows.map((row, index) => row.render(String(index)));\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {observer} from 'mobx-react';\r\nimport {Prop, PropView} from './propView';\r\n\r\nexport interface PropGridProps {\r\n    className?: string;\r\n    rows: Prop[];\r\n    values: any;\r\n    alignValue?: 'left'|'center'|'right';\r\n    labelFixLeft?: boolean;\r\n}\r\n\r\n@observer\r\nexport class PropGrid extends React.Component<PropGridProps> {\r\n    render() {\r\n        let {className, rows, values} = this.props;\r\n        let propView = new PropView(this.props, rows);\r\n        propView.setValues(values);\r\n        let cn = classNames('container-fluid', className);\r\n        return <div className={cn}>\r\n            {propView.render()}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { Page, ItemSchema, UiSchema, StringSchema, UiTextItem, Edit, ImageSchema, nav, UiImageItem } from '../components';\r\nimport { userApi } from '../net';\r\n\r\nexport class EditMeInfo extends React.Component {\r\n    private schema:ItemSchema[] = [\r\n        {name:'nick', type:'string'} as StringSchema,\r\n        {name:'icon', type:'image'} as ImageSchema\r\n    ];\r\n    private uiSchema:UiSchema = {\r\n        items: {\r\n            nick: {widget:'text', label:'别名', placeholder:'好的别名更方便记忆'} as UiTextItem,\r\n            icon: {widget:'image', label:'头像'} as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data:any;\r\n\r\n    constructor(props:any) {\r\n        super(props);\r\n        let {nick, icon} = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        }\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema:ItemSchema, newValue:any, preValue:any) => {\r\n        let {name} = itemSchema;        \r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        let user:any = nav.user;\r\n        user[name] = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n    render() {\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={this.schema} uiSchema={this.uiSchema}\r\n                data={this.data}\r\n                onItemChanged={this.onItemChanged} />\r\n        </Page>;\r\n    }\r\n}\r\n","import { observable } from 'mobx';\r\nimport { isNumber } from 'util';\r\nimport _ from 'lodash';\r\nimport { LocalArr } from '../../tool';\r\nimport { BoxId } from './boxId';\r\nimport { TuidInner, TuidDiv } from './tuid';\r\n\r\nconst maxCacheSize = 1000;\r\n\r\nexport class IdCache {\r\n    private queue: number[] = [];               // 每次使用，都排到队头\r\n\tprivate cache = observable.map({}, {deep: false});    // 已经缓冲的\r\n\tprivate loading:boolean = false;\r\n\r\n    protected localArr:LocalArr;\r\n    protected waitingIds: number[] = [];          // 等待loading的\r\n    protected tuidInner: TuidInner;\r\n\r\n    constructor(tuidLocal: TuidInner) {\r\n        this.tuidInner = tuidLocal;\r\n        this.initLocalArr();\r\n    }\r\n\r\n    protected initLocalArr() {\r\n        this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\r\n    }\r\n\r\n    useId(id:number, defer?:boolean) {\r\n        if (!id) return;\r\n        if (isNumber(id) === false) return;\r\n        if (this.cache.has(id) === true) {\r\n            this.moveToHead(id);\r\n            return;\r\n        }\r\n        this.tuidInner.cacheTuids(defer===true?70:20);\r\n        this.cache.set(id, id);\r\n        if (this.waitingIds.findIndex(v => v === id) >= 0) {\r\n            this.moveToHead(id);\r\n            return;\r\n        }\r\n\r\n        if (this.queue.length >= maxCacheSize) {\r\n            // 缓冲已满，先去掉最不常用的\r\n            let r = this.queue.shift();\r\n            if (r === id) {\r\n                // 如果移除的，正好是现在用的，则插入\r\n                this.queue.push(r);\r\n                return;\r\n            }\r\n\r\n            //let rKey = String(r);\r\n            if (this.cache.has(r) === true) {\r\n                // 如果移除r已经缓存\r\n                this.cache.delete(r);\r\n            }\r\n            else {\r\n                // 如果移除r还没有缓存\r\n                let index = this.waitingIds.findIndex(v => v === r);\r\n                this.waitingIds.splice(index, 1);\r\n            }\r\n        }\r\n        this.waitingIds.push(id);\r\n        this.queue.push(id);\r\n        return;\r\n    }\r\n\r\n    private moveToHead(id:number) {\r\n        let index = this.queue.findIndex(v => v === id);\r\n        this.queue.splice(index, 1);\r\n        this.queue.push(id);\r\n    }\r\n\r\n    getValue(id:number) {\r\n        return this.cache.get(id);\r\n    }\r\n\r\n    remove(id:number) {\r\n        this.cache.delete(id);\r\n        let index = this.queue.findIndex(v => v === id);\r\n\t\tthis.queue.splice(index, 1);\r\n\t\tthis.localArr.removeItem(id);\r\n    }\r\n\r\n    valueFromId(id:number|BoxId):any {\r\n        let _id:number;\r\n        switch (typeof id) {\r\n            case 'object': _id = (id as BoxId).id; break;\r\n            case 'number': _id = id as number; break;\r\n            default: return;\r\n        }\r\n        return this.getValue(_id);\r\n    }\r\n\r\n    resetCache(id:number) {\r\n        this.remove(id);\r\n        this.useId(id);\r\n    }\r\n\r\n    cacheValue(val:any):boolean {\r\n        if (val === undefined) return false;\r\n        let id = this.getIdFromObj(val);\r\n        if (id === undefined) return false;\r\n        let index = this.waitingIds.findIndex(v => v === id);\r\n        if (index>=0) this.waitingIds.splice(index, 1);\r\n        this.cache.set(id, val);\r\n        return true;\r\n    }\r\n    protected getIdFromObj(val:any) {return this.tuidInner.getIdFromObj(val)}\r\n\r\n    async cacheIds():Promise<void> {\r\n        if (this.waitingIds.length === 0) return;\r\n\t\tlet tuidValues = await this.loadIds();\r\n\t\tif (tuidValues === undefined || tuidValues.length === 0) {\r\n\t\t\tthis.waitingIds.splice(0, this.waitingIds.length);\r\n\t\t\treturn;\r\n\t\t}\r\n        this.cacheIdValues(tuidValues);\r\n    }\r\n\r\n    private cacheIdValues(tuidValues: any[]) {\r\n        if (tuidValues === undefined) return;\r\n        let tuids = this.unpackTuidIds(tuidValues);\r\n        for (let tuidValue of tuids) {\r\n            if (this.cacheValue(tuidValue) === false) continue;\r\n            this.cacheTuidFieldValues(tuidValue);\r\n        }\r\n    }\r\n    async modifyIds(ids:any[]):Promise<void> {\r\n        let tuidValues:string[] = await this.loadTuidIdsOrLocal(ids);\r\n        let localedValues = tuidValues.filter(v => {\r\n            let p = v.indexOf('\\t');\r\n            if (p<0) p = v.length;\r\n            let id = Number(v.substr(0, p));\r\n            let val = this.localArr.getItem(id);\r\n            return (val !== undefined);\r\n        });\r\n        if (localedValues.length === 0) return;\r\n        this.cacheIdValues(localedValues);\r\n    }\r\n    protected divName:string = undefined;\r\n    protected async loadIds(): Promise<any[]> {\r\n\t\tif (this.loading === true) return;\r\n\t\tthis.loading = true;\r\n\t\tlet ret = await this.loadTuidIdsOrLocal(this.waitingIds);\r\n\t\tthis.loading = false;\r\n        return ret;\r\n    }\r\n    protected unpackTuidIds(values:string[]):any[] {\r\n        return this.tuidInner.unpackTuidIds(values);\r\n    }\r\n    protected cacheTuidFieldValues(tuidValue: any) {\r\n        this.tuidInner.cacheTuidFieldValues(tuidValue);\r\n    }\r\n\r\n    async assureObj(id:number):Promise<void> {\r\n        let val = this.cache.get(id);\r\n        switch (typeof val) {\r\n            case 'object': return val;\r\n            case 'number': this.cache.set(id, id); break;\r\n        }\r\n        let ret = await this.loadTuidIdsOrLocal([id]);\r\n        this.cacheIdValues(ret);\r\n    }\r\n\r\n    private async loadTuidIdsOrLocal(ids:number[]):Promise<string[]> {\r\n        let ret:string[] = [];        \r\n        let netIds:number[] = [];\r\n        for (let id of ids) {\r\n            let value = this.localArr.getItem(id);\r\n            //if (value === undefined)\r\n            // 值不存在或者是空字符串，重新获取\r\n            if (!value)\r\n                netIds.push(id);\r\n            else\r\n                ret.push(value);\r\n        }\r\n        let len = netIds.length;\r\n        if (len > 0) {\r\n            let netRet = await this.tuidInner.loadTuidIds(this.divName, netIds);\r\n            for (let i=0; i<len; i++) {\r\n                //有些id可能没有内容，不会返回\r\n                //let id = netIds[i]; \r\n                let row:string = netRet[i];\r\n                if (!row) continue;\r\n                let p = row.indexOf('\\t');\r\n                if (p < 0) p = row.length;\r\n                let id = Number(row.substr(0, p));\r\n\t\t\t\t_.remove(netIds, v => v === id);\r\n                ret.push(row);\r\n                this.localArr.setItem(id, row);\r\n            }\r\n            len = netIds.length;\r\n            for (let i=0; i<len; i++) {\r\n                this.localArr.setItem(netIds[i], '');\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nexport class IdDivCache extends IdCache {\r\n    private div: TuidDiv;\r\n    protected divName:string;\r\n\r\n    constructor(tuidLocal:TuidInner, div: TuidDiv) {\r\n        super(tuidLocal);\r\n        this.div = div;\r\n        this.divName = div.name;\r\n        this.localArr = tuidLocal.cache.arr(tuidLocal.name + '.ids.' + this.divName);\r\n    }\r\n\r\n    protected initLocalArr() {\r\n        // 这个不需要，必须去掉\r\n        // this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\r\n    }\r\n\r\n    protected getIdFromObj(val:any) {return this.div.getIdFromObj(val)}\r\n    protected unpackTuidIds(values:string[]):any[] {\r\n        return this.div.unpackTuidIds(values);\r\n    }\r\n    protected cacheTuidFieldValues(tuidValue: any) {\r\n        this.div.cacheTuidFieldValues(tuidValue);\r\n    }\r\n\r\n    /*\r\n    async cacheIds():Promise<void> {\r\n        if (this.waitingIds.length === 0) return;\r\n        let tuidValues = await this.loadIds();\r\n        if (tuidValues !== undefined) {\r\n            let tuids = this.tuidLocal.unpackTuidIds(tuidValues);\r\n            for (let tuidValue of tuids) {\r\n                if (this.cacheValue(tuidValue) === false) continue;\r\n                this.tuidLocal.cacheTuidFieldValues(tuidValue);\r\n                this.afterCacheValue(tuidValue);\r\n            }\r\n        }\r\n    }\r\n    */\r\n}\r\n","import _ from 'lodash';\r\nimport { LocalArr } from '../../tool';\r\nimport { Entity } from '../entity';\r\nimport { UqMan, ArrFields, Field, SchemaFrom } from '../uqMan';\r\nimport { EntityCaller } from '../caller';\r\nimport { BoxId } from './boxId';\r\nimport { IdCache, IdDivCache } from './idCache';\r\n\r\nexport interface TuidSaveResult {\r\n    id: number;\r\n    inId: number;\r\n}\r\n\r\nexport interface TuidNOResult {\r\n\tdate: string;\r\n\tno: number;\r\n}\r\n\r\nexport abstract class UqTuid<M> extends Entity {\r\n    protected noCache: boolean;\r\n    readonly typeName:string = 'tuid';\r\n    protected idName: string;\r\n    cached: boolean;\r\n    unique: string[];\r\n\r\n    public setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {id} = schema;\r\n        this.idName = id;\r\n    }\r\n\r\n    buildTuidBox(): TuidBox {\r\n        return new TuidBox(this);\r\n    }\r\n\r\n    getIdFromObj(obj:any):number {return obj[this.idName]}\r\n    stopCache():void {this.noCache = true}\r\n    abstract useId(id:number):void;\r\n    abstract boxId(id:number):BoxId;\r\n    abstract valueFromId(id:number):any;\r\n\tabstract resetCache(id:number|BoxId):void;\r\n\tabstract assureBox<T> (id:number|BoxId): Promise<T>;\r\n\tstatic idValue(id: {id:number}|number):number {\r\n\t\tswitch (typeof id) {\r\n\t\t\tdefault: debugger; throw new Error('unknown id');\r\n\t\t\tcase 'object': return id.id;\r\n\t\t\tcase 'number': return id;\r\n\t\t}\r\n\t}\r\n    static equ(id1:{id:number}|number, id2:{id:number}|number): boolean {\r\n        if (id1 === undefined || id1 === null) return false;\r\n\t\tif (id2 === undefined || id2 === null) return false;\r\n\t\treturn Tuid.idValue(id1) === Tuid.idValue(id2);\r\n\t\t/*\r\n        if (typeof id1 === 'object') {\r\n\t\t\tlet id1Id = id1.id;\r\n            return typeof id2 === 'object'? id1Id === id2.id : id1Id === id2;\r\n        }\r\n        if (typeof id2 === 'object') {\r\n\t\t\tlet id2Id = id2.id;\r\n            return typeof id1 === 'object'? id2Id === id1.id : id2Id === id1;\r\n        }\r\n\t\treturn id1 === id2;\r\n\t\t*/\r\n    }\r\n    cacheIds() {}\r\n    async modifyIds(ids:any[]) {}\r\n    isImport = false;\r\n    abstract get hasDiv():boolean;// {return this.divs!==undefined}\r\n    abstract div(name:string):TuidDiv;\r\n    abstract loadMain(id:number|BoxId):Promise<M>;\r\n\tabstract load(id:number|BoxId):Promise<M>;\r\n    abstract all():Promise<M[]>;\r\n\tabstract save(id:number, props:M):Promise<TuidSaveResult>;\r\n\tabstract saveProp(id:number, prop:string, value:any):Promise<void>;\r\n    abstract search(key:string, pageStart:string|number, pageSize:number):Promise<M[]>;\r\n    abstract searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any>;\r\n    abstract loadArr(arr:string, owner:number, id:number):Promise<any>;\r\n    abstract saveArr(arr:string, owner:number, id:number, props:any):Promise<void>;\r\n\tabstract posArr(arr:string, owner:number, id:number, order:number):Promise<void>;\r\n\tabstract no():Promise<TuidNOResult>;\r\n}\r\n\r\nexport abstract class Tuid extends UqTuid<any> {\r\n}\r\n\r\nexport class TuidInner extends Tuid {\r\n    private divs: {[div:string]: TuidDiv};\r\n    protected cacheFields: Field[];\r\n    protected idCache: IdCache;\r\n    protected localArr:LocalArr;\r\n    constructor(uq:UqMan, name:string, typeId:number) {\r\n        super(uq, name, typeId);\r\n        this.idCache = new IdCache(this);\r\n        this.localArr = this.cache.arr(this.name + '.whole');\r\n        if (uq.newVersion === true) this.localArr.removeAll();\r\n    }\r\n\r\n    public setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {arrs} = schema;\r\n        if (arrs !== undefined) {\r\n            this.divs = {};\r\n            for (let arr of arrs) {\r\n                let {name} = arr;\r\n                let tuidDiv = new TuidDiv(this.uq, this, name);\r\n                this.divs[name] = tuidDiv;\r\n                tuidDiv.setSchema(arr);\r\n                tuidDiv.buildFieldsTuid();\r\n            }\r\n        }\r\n    }\r\n    \r\n    useId(id:number, defer?:boolean) {\r\n        if (this.noCache === true) return;\r\n        if (!id) return;\r\n        this.idCache.useId(id, defer);\r\n    }\r\n    boxId(id:number):BoxId {\r\n        if (!id) return;\r\n        if (typeof id === 'object') return id;\r\n        this.useId(id);\r\n        let {createBoxId} = this.uq;\r\n        if (!createBoxId) return {id: id} as BoxId;\r\n        return createBoxId(this, id);\r\n    }\r\n    valueFromId(id:number) {return this.idCache.getValue(id)}\r\n\tresetCache(id:number|BoxId):void {\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tthis.idCache.resetCache(id);\r\n\t}\r\n    async assureBox<T> (id:number|BoxId):Promise<T> {\r\n\t\tif (!id) return;\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tawait this.idCache.assureObj(id);\r\n\t\treturn this.idCache.getValue(id);\r\n    }\r\n\r\n    cacheIds() {\r\n        this.idCache.cacheIds();\r\n        if (this.divs === undefined) return;\r\n        for (let i in this.divs) this.divs[i].cacheIds();\r\n    }\r\n    async modifyIds(ids:any[]) {\r\n        await this.idCache.modifyIds(ids);\r\n    }\r\n    cacheTuids(defer:number) {this.uq.cacheTuids(defer)}\r\n    get hasDiv():boolean {return this.divs!==undefined}\r\n    div(name:string):TuidDiv {\r\n        return this.divs && this.divs[name];\r\n    }\r\n    async loadTuidIds(divName:string, ids:number[]):Promise<any[]> {\r\n        let ret:any[] = await new IdsCaller(this, {divName:divName, ids:ids}, false).request();\r\n        if (ret.length > 0) this.cached = true;\r\n        return ret;\r\n    }\r\n    async loadMain(id:number|BoxId):Promise<any> {\r\n        if (typeof id === 'object') id = id.id;\r\n        await this.idCache.assureObj(id);\r\n        return this.idCache.valueFromId(id);\r\n    }\r\n    async load(id:number|BoxId):Promise<any> {\r\n        if (id === undefined || id === 0) return;\r\n        //let cacheValue = this.idCache.valueFromId(id); \r\n        //if (typeof cacheValue === 'object') return cacheValue;\r\n        if (typeof id === 'object') id = id.id;\r\n        let valuesText = undefined; //this.localArr.getItem(id);\r\n        let values: any;\r\n        if (valuesText) {\r\n            values = JSON.parse(valuesText);\r\n        }\r\n        else {\r\n            values = await new GetCaller(this, id).request();\r\n            if (values !== undefined) {\r\n                // this.localArr.setItem(id, JSON.stringify(values));\r\n            }\r\n        }\r\n        if (values === undefined) return;\r\n        for (let f of this.schema.fields) {\r\n            let {tuid} = f;\r\n            if (tuid === undefined) continue;\r\n            let t = this.uq.getTuid(tuid);\r\n            if (t === undefined) continue;\r\n            let n = f.name;\r\n            values[n] = t.boxId(values[n]);\r\n        }\r\n        this.idCache.cacheValue(values);\r\n        this.cacheTuidFieldValues(values);\r\n        return values;\r\n    }\r\n\r\n    cacheTuidFieldValues(values:any) {\r\n        let {fields, arrs} = this.schema;\r\n        this.cacheFieldsInValue(values, fields);\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs as ArrFields[]) {\r\n                let {name, fields} = arr;\r\n                let arrValues = values[name];\r\n                if (arrValues === undefined) continue;\r\n                let tuidDiv = this.div(name);\r\n                for (let row of arrValues) {\r\n                    //row._$tuid = tuidDiv;\r\n                    //row.$owner = this.boxId(row.owner);\r\n                    tuidDiv.cacheValue(row);\r\n                    this.cacheFieldsInValue(row, fields);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public buildFieldsTuid() {\r\n        super.buildFieldsTuid();\r\n        let {mainFields, $create, $update, stampOnMain} = this.schema;\r\n\t\tif (mainFields === undefined) debugger;\r\n\t\tthis.cacheFields = mainFields || this.fields;\r\n\t\tif (stampOnMain === true) {\r\n\t\t\tif ($create === true) this.cacheFields.push({name: '$create', type: 'timestamp', _tuid: undefined});\r\n\t\t\tif ($update === true) this.cacheFields.push({name: '$update', type: 'timestamp', _tuid: undefined});\r\n\t\t}\r\n        this.uq.buildFieldTuid(this.cacheFields);\r\n    }\r\n\r\n    unpackTuidIds(values:string[]):any[] {\r\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\r\n    }\r\n\r\n    async save(id:number, props:any):Promise<TuidSaveResult> {\r\n        let ret = await new SaveCaller(this, {id:id, props:props}).request();\r\n        if (id !== undefined) {\r\n            this.idCache.remove(id);\r\n            this.localArr.removeItem(id);\r\n        }\r\n        return ret;\r\n\t}\r\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\r\n\t\tawait new SavePropCaller(this, {id, prop, value}).request();\r\n\t\tthis.idCache.remove(id);\r\n\t\tawait this.idCache.assureObj(id);\r\n\t}\r\n    async all():Promise<any[]> {\r\n        let ret: any[] = await new AllCaller(this, {}).request();\r\n        return ret;\r\n    }\r\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any[]> {\r\n        let ret:any[] = await this.searchArr(undefined, key, pageStart, pageSize);\r\n        return ret;\r\n    }\r\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        //let api = this.uqApi;\r\n        //let ret = await api.tuidSearch(this.name, undefined, owner, key, pageStart, pageSize);\r\n        let params:any = {arr:undefined, owner:owner, key:key, pageStart:pageStart, pageSize:pageSize};\r\n        let ret = await new SearchCaller(this, params).request();\r\n        let {fields} = this.schema;\r\n        for (let row of ret) {\r\n            this.cacheFieldsInValue(row, fields);\r\n        }\r\n        return ret;\r\n    }\r\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\r\n        if (id === undefined || id === 0) return;\r\n        //let api = this.uqApi;\r\n        //return await api.tuidArrGet(this.name, arr, owner, id);\r\n        return await new LoadArrCaller(this, {arr:arr, owner:owner, id:id}).request();\r\n    }\r\n    async saveArr(arr:string, owner:number, id:number, props:any) {\r\n        //let params = _.clone(props);\r\n        //params[\"$id\"] = id;\r\n        //return await this.uqApi.tuidArrSave(this.name, arr, owner, params);\r\n        return await new SaveArrCaller(this, {arr:arr, owner:owner, id:id, props:props}).request();\r\n    }\r\n\r\n    async posArr(arr:string, owner:number, id:number, order:number) {\r\n        //return await this.uqApi.tuidArrPos(this.name, arr, owner, id, order);\r\n        return await new ArrPosCaller(this, {arr:arr, owner:owner, id:id, order:order}).request();\r\n\t}\r\n\tasync no():Promise<TuidNOResult> {\r\n\t\treturn await new TuidNoCaller(this, undefined).request();\r\n\t}\r\n}\r\n\r\nabstract class TuidCaller<T> extends EntityCaller<T> {\r\n    protected get entity(): Tuid {return this._entity as Tuid};\r\n}\r\n\r\n// 包含main字段的load id\r\n// 当前为了兼容，先调用的包含所有字段的内容\r\nclass GetCaller extends TuidCaller<number> {\r\n    method = 'GET';\r\n    get path():string {return `tuid/${this.entity.name}/${this.params}`}\r\n}\r\n\r\nclass IdsCaller extends TuidCaller<{divName:string, ids:number[]}> {\r\n    get path():string {\r\n        let {divName} = this.params;\r\n        return `tuidids/${this.entity.name}/${divName !== undefined?divName:'$'}`;\r\n    }\r\n    buildParams():any {return this.params.ids}\r\n    xresult(res:any):any {\r\n        return (res as string).split('\\n');\r\n    }\r\n}\r\n\r\n\r\nclass SaveCaller extends TuidCaller<{id:number, props:any}> {\r\n    get path():string {return `tuid/${this.entity.name}`}\r\n    buildParams():any {\r\n        let {fields, arrs} = this.entity.schema;\r\n        let {id, props} = this.params;\r\n        let params:any = {$id: id};\r\n        this.transParams(params, props, fields);\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                let arrName = arr.name;\r\n                let arrParams = [];\r\n                let arrFields = arr.fields;\r\n                let arrValues = props[arrName];\r\n                if (arrValues !== undefined) {\r\n                    for (let arrValue of arrValues) {\r\n                        let row = {};\r\n                        this.transParams(row, arrValue, arrFields);\r\n                        arrParams.push(row);\r\n                    }\r\n                }\r\n                params[arrName] = arrParams;\r\n            }\r\n        }\r\n        return params;\r\n    }\r\n    private transParams(values:any, params:any, fields:Field[]) {\r\n        if (params === undefined) return;\r\n        for (let field of fields) {\r\n            let {name, tuid, type} = field;\r\n            let val = params[name];\r\n            if (tuid !== undefined) {\r\n                if (typeof val === 'object') {\r\n                    if (val !== null) val = val.id;\r\n                }\r\n            }\r\n            else {\r\n                switch (type) {\r\n                    case 'date':\r\n                        val = this.entity.buildDateParam(val); \r\n                        //val = (val as string).replace('T', ' ');\r\n                        //val = (val as string).replace('Z', '');\r\n                        break;\r\n                    case 'datetime':\r\n                        val = this.entity.buildDateTimeParam(val);\r\n                        //val = new Date(val).toISOString();\r\n                        //val = (val as string).replace('T', ' ');\r\n                        //val = (val as string).replace('Z', '');\r\n                        break;\r\n                }\r\n            }\r\n            values[name] = val;\r\n        }\r\n    }\r\n}\r\n\r\nclass SearchCaller extends TuidCaller<{arr:string, owner:number, key:string, pageStart:string|number, pageSize:number}> {\r\n    get path():string {return `tuids/${this.entity.name}`}\r\n}\r\n\r\nclass AllCaller extends TuidCaller<{}> {\r\n    method = 'GET';\r\n    get path():string {return `tuid-all/${this.entity.name}`}\r\n}\r\n\r\nclass LoadArrCaller extends TuidCaller<{arr:string, owner:number, id:number}> {\r\n    method = 'GET';\r\n    get path():string {\r\n        let {arr, owner, id} = this.params;\r\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/${id}`;\r\n    }\r\n}\r\nclass SavePropCaller extends TuidCaller<{id:number, prop:string, value:any}> {\r\n    get path():string {return `tuid-prop/${this.entity.name}/`;}\r\n}\r\nclass SaveArrCaller extends TuidCaller<{arr:string, owner:number, id:number, props:any}> {\r\n    get path():string {\r\n        let {arr, owner} = this.params;\r\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/`;\r\n    }\r\n    buildParams():any {\r\n        let {id, props} = this.params;\r\n        let params = _.clone(props);\r\n        params['$id'] = id;\r\n        return params;\r\n    }\r\n}\r\nclass ArrPosCaller extends TuidCaller<{arr:string, owner:number, id:number, order:number}> {\r\n    get path():string {\r\n        let {arr, owner} = this.params;\r\n        return `tuid-arr-pos/${this.entity.name}/${owner}/${arr}/`;\r\n    }\r\n    buildParams():any {\r\n        let {id, order} = this.params;\r\n        return { bid: id, $order: order}\r\n    }\r\n}\r\nclass TuidNoCaller extends TuidCaller<{}> {\r\n    get path():string {\r\n        return `tuid-no/${this.entity.name}/`;\r\n    }\r\n    buildParams():any {\r\n\t\tlet d = new Date();\r\n\t\tlet year = d.getFullYear();\r\n\t\tlet month = d.getMonth() + 1;\r\n\t\tlet date = d.getDate();\r\n        return {year, month, date};\r\n    }\r\n}\r\n\r\nexport class TuidImport extends Tuid {\r\n    private tuidLocal: TuidInner;\r\n\r\n    constructor(uq:UqMan, name:string, typeId:number, from: SchemaFrom) {\r\n        super(uq, name, typeId);\r\n        this.from = from;\r\n    }\r\n\r\n    setFrom(tuidLocal: TuidInner) {this.tuidLocal = tuidLocal}\r\n    \r\n    readonly from: SchemaFrom;\r\n    isImport = true;\r\n\r\n    useId(id:number) {this.tuidLocal.useId(id);}\r\n    boxId(id:number):BoxId {return this.tuidLocal.boxId(id);}\r\n    valueFromId(id:number) {return this.tuidLocal.valueFromId(id)}\r\n\tresetCache(id:number|BoxId):void {\r\n\t\tthis.tuidLocal.resetCache(id);\r\n\t}\r\n    async assureBox<T>(id:number):Promise<T> {\r\n        await this.tuidLocal.assureBox(id);\r\n\t\treturn this.tuidLocal.valueFromId(id);\r\n    }\r\n    get hasDiv():boolean {return this.tuidLocal.hasDiv}\r\n    div(name:string):TuidDiv {return this.tuidLocal.div(name)}\r\n    async loadMain(id:number|BoxId):Promise<any> {\r\n        let ret = await this.tuidLocal.loadMain(id);\r\n        return ret;\r\n    }\r\n    async load(id:number|BoxId):Promise<any> {\r\n        return await this.tuidLocal.load(id);\r\n    }\r\n    async save(id:number, props:any):Promise<TuidSaveResult> {\r\n        return await this.tuidLocal.save(id, props);\r\n\t}\r\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\r\n\t\tawait this.tuidLocal.saveProp(id, prop, value);\r\n\t}\r\n    async all():Promise<any[]> {\r\n        return await this.tuidLocal.all();\r\n    }\r\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        return await this.tuidLocal.search(key, pageStart, pageSize);\r\n    }\r\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        return await this.tuidLocal.searchArr(owner, key, pageStart, pageSize);\r\n    }\r\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\r\n        return await this.tuidLocal.loadArr(arr, owner, id);\r\n    }\r\n    async saveArr(arr:string, owner:number, id:number, props:any):Promise<void> {\r\n        await this.tuidLocal.saveArr(arr, owner, id, props);\r\n    }\r\n    async posArr(arr:string, owner:number, id:number, order:number):Promise<void> {\r\n        await this.tuidLocal.posArr(arr, owner, id, order);\r\n    }\r\n\tasync no():Promise<TuidNOResult> {\r\n\t\treturn await this.tuidLocal.no();\r\n\t}\r\n}\r\n\r\n// field._tuid 用这个接口\r\n// Tuid, TuidDiv 实现这个接口\r\nexport class TuidBox {\r\n    tuid: Tuid;\r\n    ownerField:Field = undefined;\r\n    constructor(tuid: Tuid) {\r\n        this.tuid = tuid;\r\n    }\r\n\r\n    boxId(id:number):BoxId {\r\n        return this.tuid.boxId(id);\r\n    }\r\n    getIdFromObj(obj:any):number {\r\n        return this.tuid.getIdFromObj(obj);\r\n    }\r\n    useId(id:number):void {\r\n        return this.tuid.useId(id);\r\n    }\r\n    async showInfo() {\r\n        alert('showInfo not implemented');\r\n    }\r\n}\r\n\r\n\r\nexport class TuidDiv extends TuidInner /* Entity*/ {\r\n    readonly typeName:string = 'div';\r\n    protected cacheFields: Field[];\r\n    protected tuid: TuidInner;\r\n    protected idName: string;\r\n    protected idCache: IdDivCache;\r\n\r\n    //ui: React.StatelessComponent<any>;\r\n    //res: any;\r\n\r\n    constructor(uq: UqMan, tuid: TuidInner, name: string) {\r\n        super(uq, name, 0);\r\n        this.tuid = tuid;\r\n        this.idName = 'id';\r\n        this.idCache = new IdDivCache(tuid, this);\r\n    }\r\n\r\n    get owner() {return this.tuid}\r\n\r\n    /*\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        this.buildFieldsTuid();\r\n    }*/\r\n\r\n    /*\r\n    setUIRes(ui:any, res:any) {\r\n        this.ui = ui && ui.content;\r\n        this.res = res;\r\n    }\r\n    */\r\n\r\n    buildFieldsTuid() {\r\n        super.buildFieldsTuid();\r\n        let {mainFields} = this.schema;\r\n        if (mainFields === undefined) debugger;\r\n        this.uq.buildFieldTuid(this.cacheFields = mainFields);\r\n    }\r\n\r\n    buildTuidDivBox(ownerField: Field): TuidBoxDiv {\r\n        return new TuidBoxDiv(this.tuid, this, ownerField);\r\n    }\r\n\r\n    getIdFromObj(obj:any):number {return obj[this.idName]}\r\n    cacheValue(value:any):void {\r\n        this.idCache.cacheValue(value);\r\n    }\r\n\r\n    useId(id:number, defer?:boolean):void {\r\n        if (this.noCache === true) return;\r\n        this.idCache.useId(id, defer);\r\n    }\r\n\r\n    /*\r\n    boxId(id:number):BoxId {\r\n        if (typeof id === 'object') return id;\r\n        this.useId(id);\r\n        //return new BoxDivId(this.tuid, this, id);\r\n        return this.tuid.boxDivId(this, id);\r\n    }\r\n    */\r\n    valueFromId(id:number):any {\r\n        return this.idCache.getValue(id)\r\n    }\r\n\r\n    async assureBox<T>(id:number):Promise<T> {\r\n\t\tawait this.idCache.assureObj(id);\r\n\t\treturn this.idCache.getValue(id);\r\n    }\r\n\r\n    async cacheIds() {\r\n        await this.idCache.cacheIds();\r\n    }\r\n\r\n    cacheTuidFieldValues(values:any) {\r\n        let fields = this.schema.fields;\r\n        this.cacheFieldsInValue(values, fields);\r\n    }\r\n\r\n    unpackTuidIds(values:string[]):any[] {\r\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\r\n    }\r\n}\r\n\r\nexport class TuidBoxDiv extends TuidBox {\r\n    ownerField: Field;\r\n    private div: TuidDiv;\r\n    constructor(tuid: Tuid, div: TuidDiv, ownerField: Field) {\r\n        super(tuid);\r\n        this.div = div;\r\n        this.ownerField = ownerField;\r\n    }\r\n\r\n    boxId(id:number):BoxId {\r\n        return this.div.boxId(id);\r\n    }\r\n    getIdFromObj(obj:any):number {\r\n        return this.div.getIdFromObj(obj);\r\n    }\r\n    useId(id:number):void {\r\n        return this.div.useId(id);\r\n    }\r\n}\r\n","module.exports = __webpack_public_path__ + \"static/media/AnalyticalChemistry.f85ff3e0.png\";","module.exports = __webpack_public_path__ + \"static/media/LabSupplies.3f6ce00f.png\";","module.exports = __webpack_public_path__ + \"static/media/LifeScience.5c2e6ff5.png\";","module.exports = __webpack_public_path__ + \"static/media/MaterialScience.f2439aa0.png\";","module.exports = __webpack_public_path__ + \"static/media/OrganicChemistry.6d56971c.png\";","module.exports = __webpack_public_path__ + \"static/media/triangle.85296a6e.svg\";","module.exports = __webpack_public_path__ + \"static/media/giftPlate.015bdb05.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/infb.ce9e0db2.jpg\";","module.exports = __webpack_public_path__ + \"static/media/pig.772a31a6.png\";","module.exports = __webpack_public_path__ + \"static/media/welcome.21166a38.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAdEUlEQVR4Xu1dCZQU1bn+/uoZQAWmq0HiErcIz7xoeJqhq8EtmKeCQ1ePkoiJ5r24xyXEfY9HkxjjlhhFjFvUqFGjUaSrAUUjGo3Q1UPUGEnygko0cYXuHkFQZrr+d6qZ0WaYmarqqaqurr51zhxg6l+//37UvVV3IYhLICAQGBABEtgIBAQCAyMgCCJah0BgEAQEQUTzEAgIgog2IBCoDgHxBKkON8daa+bHpxPRAQCPJUkaC+ZtCRjLwLYAxgJYTcAHDKwG0QdsGKsBWs3Mz41pzz3u2KFQcAUBQRBXYNzSyJrH4jtFmqTDwMahDDoUwKghuFpL4MUgaXGp21g05vDcW0OwJVQdICAI4gAsO6IFbdJUgM4i0AwGInZ0nMgQUDKAhRLxjdFk7iknukLWOQKCIM4x61ejuLB1d6NbOpuITnPJpLUZorvJoDnR1LI/WQsLiWoQEASpBrUKHV44fnhnt3wWE84GyBxP+HoRoYsZc9AtzZGPWLbKV+cN4EwQZAhFzs+ftB9JdCNAXxmCGVdUCXiPmc6TU9l7XTEojJQREASpsiEUtfhRDHqwSnXv1Bhnyyn9eu8cNJZlQZAq6p1Pxy8kop9WoeqPCvEv5GTuLH+chduLIIjD+hY05Y8A9nWoVgvxl2RV36cWjsPkUxDEQTXzmvIRAVs7UNlclNFJhAUG8yuQ0AmmThA6JeaPmdACllpQ/pNbCDBfE8er9gWAgfUxVd9mKDYaXVcQxGYLKGhKB4BWm+KfihHwLjMeZhiLYqmORU70Ox+fMt7oLh1GTIcx+DAnuhWyy2VVn1SlbsOrCYLYaAKFTOJeMH/bhmilyHoG5oJLN8VSy990qLuFeFFLfINhnA7QVMe2iO6Tk9n/cawnFMRbLKs2UMwoFzPjJ1ZylfcJuMUgY24s2fEXJ3p2ZAta4jiAzwawlx35XhkiXBJN6lc60RGy4jXvoG0gr8VVAqUdNpTLZVX/oUMdR+KdWmICg3/NwBRHimS0y8kOp/k4chE2YdHFGqSi+bSyiAjT7RadmM6LprLX2ZUfqlw+rTxBBHMipM2Ln5HV3EE2hYWY+FA4cBtYo8WPkhx8CDRA08ao2cWVFguacllfD06fLn1tRAhPj07qz/Xa7bl/ud3WLBGf3pLM3WxXvtHlxBNkgBZQ0JRnAHzVTgMh8MFRNff7vrLF+coklpD7dBwAdEdVvdmOTVMmn07sT8SfkoGAJ6KqvsUTLa8pNxNwqi27zK81NXVPGdX24ge25BtcSBCknwZQSMePBdFd9toGHS+r2QFlC5oyD8DhvbaYcUksZW+wXMzEFzPTIb26TRHac1RbdkV/cRU05VEAR9iJmZmviqVyF9mRbXQZQZD+CKIpOux9pLMckBfTym5MeL3CTV5W9TFWDa9Tm6IYKGUrnj73R1X9mIH0ivNad+emyLMAdrSyDfAn3Wzsu21quZgmbwGWIEgfgIpa4lAGP2HdyPB6BKXEaHX5aivZQlq5A4QTPm3sNgbzBU0x3zapvTpdEm8/bkbu3cF85bXERQS29SqXGRfGUvrVVrE3+n1BkD4toKApPwPMtR2W1zmyqv/cUgrAmoWJ0VKJOz+VZaySU/puA+kW5k/aB5L02f/uhDlyUv++lS+ev9+ogrRRJ9AXrWQJWBhV9RlWco1+XxBkS4KY3aEBG2+P+MurI/nEhLaVn9htQHlNuZqA8z8jCZ8hp3I39qef15T7CPi0O/Xa26Vhk767vMuOr04tcboBvsmObASlbe08Ae3YCquMIEhFZQvz4wdCIrMfb3HRmbKavcFKqu/9gqZwxe9ellV9774ya9LxPSWiyi/wluOcfvzYITmIjW9EUx2POM2jkeQFQSoJoiV+AfAZVg1gsLdJg+kWNeV8Bir6/Vu+AStmEnOZubyu3VxOG03qw6zi6YcgvwJwvLUe3yWrORty1pbCKiEIUkmQtPIeCOMGLTajQ07pVU9DL2iKORYZbfpg4LmYqh/Y68+cQmKAX0LvlHrG9+WUPsdp4ytmlCOZ8ZClHmONnNLNPbnENQACgiA9wOSfbG2hjyNFGy3FcZen0mYxo5zAjDt6f0dM34imsuVuTl5L/JTAF5afHsC7UVXf3kY8/YoUNeVjBoZb6fOIUjR2yPLPXiBYKTTYfUGQnoK/P3/K+Gap9A+r+jPTAbFU9nkrucHuFzSlcoyQkVVd/VBrHduNyCsEbNfzdDkmpur3V+snrymPEzDNSr/LiEwY1750pZVco94XBOmpfGc6MdkgXmrVEFiKTIzNWPqKlZwFQcwv6+YX9t5rbyJKMPOtPb94VVZ1R9PZ+/rLa/HbCHSSVZwS05SWVHaZlVyj3hcE6an8hwuUZMmAZtUQmEu7uLEAqpBRcmBsWulHdDcYBwG8i/lPgzB9TFK387FywHALWvwHAP3YKp+IBHX0DD1jJdeo9wVBeipf0OLHAXSnVUNw2mfvb0ZvhY8tZuGaA3cCtpj4aOo4mQlc0JT/BfBrq3wAPl5WczbnnVlbC5uEIEhPRYuach4D11gVWFZ1R5g5nY4+sH9nazk27REsLbHKx/x4GVX1a63kGvW+o2KHGSS7BKnyCWJ7vYZ7BLH3BBEEGbxVC4L0drFsTnF3OgbZ9AThQTZaqNyEgc01KANeTlYD2h2DiC6WIIitB1+nlmgzwAushN14i9XrY8tukLNu1GCx2n2LJQbpgiBWbb58vzMdjxtE5jqQQS83voP4QxB730HEa15BEKs2X75fmDd5VzQZb9gQHtKX9Er7Xj5B7H5JFx8KBUFstHng3XsmbjNcHrHOUniIc7H8IIjtuVjmfDAx1WTQkotBegU8RU1ZwcB/WpHEyWzeWrzmLWiKzdm8WC2ruu+H/ljhG6T7giCVBMkoP2HGxdYFsr8epEYEsbUehMG3x9Tcydb5Nq6EIEhF7ftuszNIs7C9otBvgjhaUSimmVgyXxCkD0QFTTE3mt7JEjnA9pr0gWy5PUh3siYdwIauDevGjZu1wnrcZQOMsIoIgvSpbD4dv5WI7HQ7bO9q4hdBnOxqQoSHokn9qLA2bLfyEgTpg2RnJvFNg/kBmwAP6ZWvm0+Qnv23zF0YbeyLVV6QdWpU1W+xmWfDigmC9FP6gqaYDW1/O62CCLOiSf1hO7J9ZdwkSEFT7kPFTigW8bzVLLEy0mKfrWpyCpuOIEg/FXXyHcFUd/Lat9KdWwQppBNngtj2ybbEfFE0lbsqbI3Zi3wEQQZAte+eulbgO50Gb9pzgyDF+YlDWOLNdpUfLFYC/t4SIYXash9a5STuiwN0BmwDhUziIDA/7aSRMBttTs4h3ESQzS9Z7Rh0Ru/mT6DEDQBb7ri4uQc+U1Zzjvf0coJDmGTFE2SQahY05XYAJzopOAPnxzxegLTmsfhOJNFtTg736cnhpdfeLil2d2l0kndYZQVBBqnsu4/uO25YU/eTRJjopAF4fkYh4Swwf9lJTKYsM46OpXS7b+icmg+lvCCIRVlXp5WvRaj/NeIWqsE55bYcqOhaVcPgQBMkn1FmxJK65SKmahJ3olPIKLPB6HejaSs7ATgnHUx8XSyZO88qVnF/SwQCS5DeNzxsGPvH2jv+WOviOfjCPnCojE4iLGCiHGC8SURvRpqa3hxZaun8sJTfmWHszJB2BnhnAmawvUN8BoWGgMVRVbfcQK7W+AbVfyAJ0nM+hrl74dYEXBNV9QtqBeD7C+LbNTNNM3cpZC7vVBirVSxV+H1PVvXyTo3iqg6BQBKkz//Wb25AqXUHGyc5VQfB5lqFBfvuglLpQIAPJMIBDOzhht0a2/i9BJrXBemxserSf9c4lrpyHziCFDOJVmbuqESRiU+LJXO/9ApZ823ViGHdKjOnAEp55ScIdpmRJaLFJZQyY9UOyzX4QYi5ljEEjyD9bODGwPoSlw5w89BJXjK1qfjRRylwmRDmj1zLQtTGN78CSIs3jVM2P+O9NvEEz2vgCFLQ4kuAyr2iekAj+mdUWrMHOTj2rD+4zd1LSkRHSoSZzNg9eCWpUURErzDjAeqmB+Qjlq2qURSBcxsogvCtrc3FHSIbB0FpuazqmzZ8dnCVN2SIDj+SiY4koM2BaiOKriXC/WzwA3IqZ+M4unBDFCiCrFsQ367LoHcGhZzwTpNEB49qy66wKo05njGYjyLCkWDsaiUv7m+OAANPkIEHojuW7qdJ9g4RDRuGgSJIPjNpL2LJ5tkbdIWsZi/tryBlYhjGyTZXBoatpq7nw4y/k0T3dzEeGKdmLQ8Zcj2AGhoMFEHs7kj+KV5EaZL4hmibXp512/PEOJuAo2uIaWhdE2Ae63bH8GF8zdbTcm+FNtGKxAJFkGIm/gVmes0p8OZbGGYmEB3iVFfIO0eAGW+BcE1M1W2dx+7cQ3A0AkWQJUumNu29bn1XcOARkQyGABE/WSpJ145pzz4ZVqQCRRAT5LwW/zeBdggr4CHN66awdruCR5C0spQIk0PakEKbVli7XcEjiJa4iMBXhrYlhTwxs9vVzfyDsExjCRxBVmtTdoyg9K+Qt6Owp5dnotNjyeyD9Z5o4AhiAlrQFHOyYmu9g9vo8TPjklhKr+veQCAJUswkTmbmWxu9gYUk/99ER259Ih30zMf1mE8gCdLzFOF6BFTE3C8C+aYIHWBnelDQ8AscQd5/6Esjm7caeT8ANWhgiXiGhgCDvx1Tc78ZmhV/tQNFEHN5a5NBT5ONU578hUl4cxGB38iq/m0X7XlqKjAEeX/+lPHNUqmhJsJ5WtlAG3fvuGuv0wwEQT7UlCkl4AWvkxX2g4RAfZCk5gRZrbV+MYLIX4NUOhGLPwgQsDCq6jP88Vadl5oSZO2j+47rbu5+r7rQhVYYEAj6SVc1I0h50wQxczcMbXzIORDhzmhSP2HIhjwwUDOC5DVlPQFbeZCTMFmXCNCNspo9I2ih14QgBU15GXC2Y3rQgBPxuI8AEa6MJvVL3LdcvUXfCVJIJx4B8czqQxaaYUaAGCdFU/odQcnRV4LkNeVqAs4PSvIijiAiwB+wIR0ca8/+OQjR+UaQNen4LInot0FIWsQQeAQysqoHYqqRLwTZkG7d+WOK/B7A+MCXRgQYCAQk8KUtau6KWgfjC0EKmcS9YK6b+Te1LorwvwkBAzRtTI33DPacIHlN+R4Bc6oo+l8YtJSY/8pEfyc2xrGEPSWmiQwcWoU9oVJnCBChwxheOjh2yPLOWoXuKUE+eFT5j6ZmmKdDjXWWID8zrNk4epvpy/vdhjSfUW4hxned2RTS9YgAM98cS+VOr1XsnhIkr8VvI9BJDpO7XFb1H1rpfLhASZYMaFZy4n4oEPiOrOr31CITzwjSuSA+3TBokZOknE45KKTjx4LoLic+hGwdIsB4MfrxLnGa9XDJ7+g9I0hBU54C8N8OEnoJ3RsPko94qehAB4VM4i4wH+tER8jWHwJsYHas3f+tTj0hSF5TTiHA6ZFpd8qq8wlrhUzieDD/qv5KLiJ2iMCr0Q2ROM1ausGh3pDEXSfIWw9N2Wrk1kYWzF92FJnB58rtuZ850unZ0b3vmYZObQj5ukHgHFnVf+5ntK4TZE06fq5EdK3zJIyDZLXjGed65X20xA4o1QBXfzr/4BGluJ+vfV0lyDsL99l2RKk5C2A3x9gznyGncjc61cvPT0wkic3ZweJqAASY+aJYKneVX6m6SpCCplwG4PJqgjfHLFFVP82pbl6LH0Og+5zqCfm6ReCfTZHh8VFtz31glUExo5wAxmQGdu/uwinbztT/z0qn7323CfIigL2dBrFJnp6S1azjA3CGQsrq4hRaNUeA6TI5lf3RYHF8dloy/UxWs+euWZgYTd2YGEtln3cSv2sEWZNRpkmMx50430KW6Sw5lf2FXRuOj2yza1jIBRoB88zEWEr/4kBB5tPK34iwh3m/KdI1blTbix+sXZj4UneJT5BV/RwnyblGkKKm3MzAqU6c9ydL4IOjas6c+Wt5icG5JUShFWDD2D/W3mFOY9rsKmSU2WD0jGU/21qo3BUn6QI5mZ3oBBRXCGI+vqQS/gqwWydD3SSr+uyBEhGbWzspcVhl+VK5n+nwxYyyjBmJTVnT27Ka3dH8W1FLLGTwYeiWdpOPWLbKLiquEKSoxY9ikKtnQTD4QWI8IQGvbih+smLEqObtuClist/8qepFgF1QhFwdIED0RzmZ3b8y0nfvmbjNcHnEuorfrS+VpK9FIt1bAdIS8/cSIdmS1BfYzdAdgmQSc5nZ8Rsou0EKOYFAv91xxheiKf2N3nuFeZN3RZPR++8XI8Dpo1V96WZdcaIT5GT2TruIukIQceCNXbiFnJsI9N3goTMdjxuEHwD0pw0oXTvCaBoPiZ8nYFSvX6eH+gyZIMX05K8wGcvdTFzYEgjYQYAZj8dS+mH9yZrjVIONswjU923XEbKqP9afzoePKmNGz9TXVN4bOkHEaVB2ailkPEJgdSQ/YkLbyk96zfe8wDm5vyP8CNjI3Rs/h6ZhT0nEdxrMK8p6LM1ko3R77PDlr/QNc1CC9Oy6fg2AnXt+PEpTmBUIVIcAMR/FwNaQpK8CPBWMXQexZD45Xur7kodA06IDrH0fkCDiC3V1BRNaPiNAWGVBik8fLpD4IBh0NsA7lX9pIBNpIm30jIGnoPRLkM5M4psG8wM+pyrcCQS8Q8DhLI3eQPolSEFT/gDgAO+iFZYFAv4hQOAHo2ruW9V47J8gGeUNm4+tanwKHYGAbwgQ6Kqomr2oWocDPUHEAqRqERV6gUFAAma3qENbxy4IEphyikDcQsD8PgLim2NqbsjbQgmCuFUVYScICDxLbMyJpjoecSsYQRC3kBR2aocA4w/EdEW0Pfuk20EIgriNqLBXCwRs7cZZTWCCINWgJnSChoAgSNAqIuIJFAKCIIEqhwgmUAh4uRWQ6GIFqtQimGoQIODUqKrfUo2ulY4giBVC4n7gEWDG0bGU7sncQUGQwJdfBGiFgMRSW0tqmaOjNqxs9t4XBLGLlJALLAIG8X5jkrkXvAhQEMQLVIVNXxFoitCeo9qym1YHunwJgrgMqDDnPwIlRD4/Vl36by88C4J4gaqw6SsCXRvWjRo3a0Xlfliu+RcEcQ1KYagmCDAX5VRO9sq3IIhXyAq7/iDA9Kicyn7dK2eCIF4hK+z6ggCDvhdTs3O9ciYI4hWywq4/CEi8jzwjZ27l48klCOIJrMKoLwgQ3pGTulsnCvQbsiCIL5UUTrxAgID7o6p+jBe2e20KgniJrrDtLQJVHvzqJChBECdoCdlAISBJ0uSWGcvMU5U9uwRBPINWGPYYgVdlVd/LYx8QBPEaYWHfKwQ8W0VYGbAgiFflE3Y9RcDLCYp2CFIAEPU0Q2FcIFA9Ag/Lqj6renX7mgM9QV4EsLd9M0JSIOAfAkSYFU3qD/vhsV+C5NPxuUQkDuX0owLCh1MEfBmc9wY1yAE68fcB2tZp9EJeIOAxAr4Mzi0JYgrkNeWXBJziccLCvEDANgJ+Dc5tEaRMkowyQwLtyMzb282CGRcQYSu78kJOIGAHASJcHU3qF9qRdUtm0EM8q3VSSCuzQbixWn2hJxDYAgHCCsKw/aPJ5803rL5dnhDEjL6gKeYU5P/yLRPhKOwIfEdW9Xv8TtIzghTT8VlM9Fu/ExL+QonA72RVP7IWmXlGEDOZoqYsYKCtFokJn2FBgD8hifaPztA7apGRpwTJZ5QDJMZTDAyrRXLCZwgQIP6RnMxdVqtMPCVI+SmSSZzLzNfWKkHht64ReDGK0v6kLl9fqyw8J8imAXv8dwB5tvNErcATfr1FwCBMH5PUn/DWy+DWfSHIB/Mn7dEkSU8B+HwtkxW+6wcBZlwYS+lX1zpiXwhiJpnX4scQ6L5aJyz8Bx8BAj8YVXPfCkKkvhGk3NWaH78UEv0oCImLGIKJAIH+VhpmHDpmWu6tIEToK0HKJEkn7gLxsUFIXsQQQAQMo11u70gHJTLfCcJPTNym+MmIhSAcGBQQRBwBQYDpMjmVDVQPw3eCmKVYm5m0VzdL5v8SuwWkNCKM2iPg2ypBJ6nWhCDlrpY2aSogLQTErF8nBQupbCDJYWJdM4JUkGRJSIsu0rKHQGDJUXOCCJLYa0Ehlgo0OQJBEDOIfGbSXsTSKyFuCCK1PggQ6LdRNfvNoANT0y5WJTirtSk7Rrj0LAi7Bx00Ed9QEeC5spr73lCt+KEfGIKUu1vz9o6iadi9AJJ+JC981AQBXzddGGqGgSKImQx3tDYX3oncTcDRQ01O6AcNAeMgWe14JmhRDRZP4AjSG2w+rfyECBfXE5gi1gEQIKxio/TVWGr5m/WGUWAJYgJZ1OInMcg8f6653oAV8fYgQHR3dP3OJ9Ksh0v1iEmgCVImyfzEISyxSZIJ9QhwQ8dc49WAbmAfeIKUB++P7LMLNzddTEQnu5G0sOE9Asw4JZbSb/Xek7ce6oIgvRCsnh+fGZHIHJe0eguLsF4tAgRaZBD/NJbUn6vWRpD06oogYgAfpKazeSwMvEuEK+WkPie4UTqPrC4JUu52LYjvzQZdRcA052kLDXcR4LuaDemike3Z99y1W3trdUuQXuiKaeUEJlwFYGzt4Wy4CF40QBeOUbOLw5p53RPELMzbWuvWIxC5joBTw1qooOVFTOdFU9nrghaX2/GEgiDlLlcmPhNMj7gNkLA3AALd0m7yEctWhR2fEBEkcSaYrw97wQKTH/Nxcip3d2Di8SiQEBEkfj2YzvQIJ2G2LwJEd8vJ7HFhByY8BNGUeQAOD3vBApRfTlZ1JUDxeBJKeAiSTjwC4pmeoCSMbokAYZWc1EO/6UZoCJLXlKsJOF+0ZZ8QIHwkJ/WRPnmrmZvQEKSYVk5kwu01Q7LxHK+TVX1U2NMODUF6thESO6T41WIJr8lJfbxf7mrlJzQE4SVTRxTXrd9QKyAb0O8LsqrvF/a8Q0MQs1AFLb4EoKl+FI2IDzHXqDBoAhgTqPz38poVyQ//AF5nYKVEtJINXsnEKyXQnezTlBtmvi2Wyn3Xp1xr5iZkBElcB/A5PqCpyaqe6s/Pem3Kjp+gawKxNJ6JdgEwGoTRYG4p/x0YzcBoMn9n/psxAsCH5o6s5p8ErDUYa4nM3/FaQCrfIxhvMkkr2eh+baClq3lNOZ8AX87UYGB2TNVv8gHrmroIFUHWaMoUCXjBa0TNp0c0mTMPBArU1fn4lPFGV+kffgRlGHTomPbsk374qqWPUBFkUzdLeQiAh0cG859kNRfYBVuFtPIYCO0eN6qG+EhoYhg6guTTSpIImlcNxGA+b0wqF9hZrKvT8XiE6FkvNwU3vzdFVb0hDmYNHUFMYhQzibnMfJrbJCFgWcuGyNdo1tJAvy3Lp5VLiHCF2/n32HujaVjT5FHTXnjfI/uBMhtKgnw0f78dNlLXH1zexnQjGxSPtWf/HKgKDhBMIaM8Bvaiq8VnymruhnrAwI0YQ0mQnrHIEQDuAeDOdAjir8vJ3KNugO6XjUIm8TyY3fxW8Zys6g11MlhoCVImyfz4gYjQneChbYhNwAVRVb/Gr4btpp9iRlnEjOlu2CTi3aPJ3Otu2KoXG6EmiFmEnqMVflzNVHgCViOCo6Jt+tP1UtD+4ixoymUALh9KDqWSNHns4cuyQ7FRj7qhJ0hvUQrpxJkgng3gC3YKZX4pbpZ4zqhkx1/syAddZhNJzI33eAeHsb7aFKFZo9qyKxzqhUK8YQhiVotvbW3u3L4pxcTmd4LJfbczZfDfJGAeSHokmswuD0WFK5L46PHW7Td2RU4G4VgwdrXMj3H98Cb6+dZt2X9ZyoZUoKEI0reG+YdaWyJb0R5SJLJuI/CvMW1Zc1pHQ1zFjHIkM8yfPYjwOQCfY8afifAyCDmpKbKoZfrSlQ0BxiBJNjRBGr34In9rBARBrDESEg2MgCBIAxdfpG6NgCCINUZCooER+H/kWudQubvKQQAAAABJRU5ErkJggg==\"","module.exports = __webpack_public_path__ + \"static/media/已签到.244fa3d6.png\";","export * from './Product';\r\nexport * from './model';\r\n","\nvar content = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-3-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-3-1!../../node_modules/postcss-loader/src/index.js??postcss!./rst.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-3-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-3-1!../../node_modules/postcss-loader/src/index.js??postcss!./rst.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-3-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-3-1!../../node_modules/postcss-loader/src/index.js??postcss!./rst.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import * as React from 'react';\r\nimport logo from '../images/logo.png';\r\n\r\nexport const jnkTop = <div className=\"d-flex align-items-center position-relative\">\r\n    <img className=\"h-3c position-absolute\" src={logo} alt=\"百灵威\" />\r\n    <div className=\"h3 flex-fill text-center\">\r\n        <span className=\"text-primary mr-3\">百灵威</span>\r\n    </div>\r\n</div>;\r\n","import * as React from 'react';\r\nimport { tv } from 'tonva';\r\n\r\nexport const tvAddress = (values: any) => {\r\n    let { country, province, city, county } = values;\r\n    return <>\r\n        {tv(country)}{tv(province, undefined, undefined, () => <></>)}{tv(city, undefined, undefined, () => <></>)}{tv(county, undefined, undefined, () => <></>)}\r\n    </>\r\n}\r\n\r\nexport const tvCountry = (values: any) => {\r\n    return <> {values.chineseName} </>;\r\n}\r\n\r\nexport const tvCurrency = (values: any) => {\r\n    return <> {values.name} </>;\r\n}\r\n\r\nexport const common = {\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    currency: tvCurrency,\r\n};\r\n","import * as React from 'react';\r\nimport { Image } from 'tonva';\r\n\r\nconst imagePath = \"https://www.jkchemical.com/static/Structure/\";\r\nconst pointProductImagePath = \"https://www.jkchemical.com/static/images/pointshop\";\r\nconst altimagePath = \"https://www.jkchemical.com/static/Structure/999.png\";\r\n\r\ninterface ProductImageProps {\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    chemicalId: string;\r\n}\r\n\r\nexport function ProductImage(props: ProductImageProps) {\r\n\r\n    let { style, className, chemicalId } = props;\r\n    return <Image src={chemicalId && (imagePath + chemicalId.substr(0, 3) + '/' + chemicalId + '.png')}\r\n        style={style} className={className} altImage={altimagePath} />;\r\n}\r\n\r\n// export function PointProductImage(props: ProductImageProps) {\r\n\r\n//     let { style, className, chemicalId } = props;\r\n//     return <Image src={chemicalId && (pointProductImagePath + '/' + chemicalId + '.png')}\r\n//         style={style} className={className} altImage={altimagePath} />;\r\n// }\r\n\r\nexport function PointProductImage(props: ProductImageProps) {\r\n\r\n    let { style, className, chemicalId } = props;\r\n    if (chemicalId && /[0-9]$/.test(chemicalId))\r\n        chemicalId = pointProductImagePath + '/' + chemicalId + '.png';\r\n\r\n    return <Image src={chemicalId && chemicalId}\r\n        style={style} className={className} altImage={altimagePath} />;\r\n}","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { tv } from 'tonva';\r\nimport { ProductImage } from 'tools/productImage';\r\n\r\nexport const tvProduct = (values: any) => {\r\n    let product = values;\r\n    let { brand, description, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl } = product;\r\n    return <div className=\"row d-flex\">\r\n        <div className=\"col-12\">\r\n            <div className=\"row py-2\">\r\n                <div className=\"col-12\"><strong>{description}</strong></div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-9\">\r\n                    <div className=\"row\">\r\n                        {item('CAS', CAS)}\r\n                        {item('纯度', purity)}\r\n                        {item('分子式', molecularFomula)}\r\n                        {item('分子量', molecularWeight)}\r\n                        {item('产品编号', origin)}\r\n                        {tv(brand, (values: any) => <>{item(\"品牌\", values.name)}</>)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n};\r\n\r\nconst tvPackx = (values: any) => {\r\n    let { radiox, radioy, unit } = values;\r\n    if (radiox !== 1) return <>{radiox} * {radioy}{unit}</>;\r\n    return <>{radioy}{unit}</>;\r\n}\r\n\r\nfunction item(caption: string, value: any) {\r\n    if (value === null || value === undefined) return null;\r\n    return <>\r\n        <div className=\"col-4 text-muted pr-0\">{caption}:</div>\r\n        <div className=\"col-8\">{value}</div>\r\n    </>;\r\n}\r\n\r\nconst tvProductCategory = (values: any) => {\r\n    let { children } = values;\r\n    return <>\r\n        aaa\r\n    </>\r\n};\r\n\r\nexport const product = {\r\n    productx: tvProduct,\r\n    packx: tvPackx,\r\n    productCategory: tvProductCategory,\r\n}\r\n","import AnalyticalChemistry from './images/AnalyticalChemistry.png';\r\nimport LabSupplies from './images/LabSupplies.png';\r\nimport LifeScience from './images/LifeScience.png';\r\nimport MaterialScience from './images/MaterialScience.png';\r\nimport OrganicChemistry from './images/OrganicChemistry.png';\r\nimport { env } from 'tonva';\r\n\r\nenum EnumCategory { OrganicChemistry = 1, AnalyticalChemistry = 2, LifeScience = 3, MaterialScience = 4, LabSupplies = 5 };\r\nconst CategoryIds_Production: { [id: number]: EnumCategory } = {\r\n\t47: EnumCategory.OrganicChemistry,\r\n\t470: EnumCategory.AnalyticalChemistry,\r\n\t1013: EnumCategory.LifeScience,\r\n\t1219: EnumCategory.MaterialScience,\r\n\t1545: EnumCategory.LabSupplies,\r\n};\r\nconst CategoryIds_Test: { [id: number]: EnumCategory } = {\r\n\t7: EnumCategory.OrganicChemistry,\r\n\t430: EnumCategory.AnalyticalChemistry,\r\n\t986: EnumCategory.LifeScience,\r\n\t1214: EnumCategory.MaterialScience,\r\n\t1545: EnumCategory.LabSupplies,\r\n};\r\n\r\ninterface CategoryRes {\r\n\tsrc: string;\r\n\tlabelColor: string;\r\n}\r\n\r\nconst RootCategoryRes: { [key in EnumCategory]: CategoryRes } = {\r\n\t[EnumCategory.OrganicChemistry]: {\r\n\t\tsrc: OrganicChemistry,\r\n\t\tlabelColor: 'text-info',\r\n\t},\r\n\t[EnumCategory.AnalyticalChemistry]: {\r\n\t\tsrc: AnalyticalChemistry,\r\n\t\tlabelColor: 'text-success',\r\n\t},\r\n\t[EnumCategory.LifeScience]: {\r\n\t\tsrc: LifeScience,\r\n\t\tlabelColor: 'text-danger',\r\n\t},\r\n\t[EnumCategory.MaterialScience]: {\r\n\t\tsrc: MaterialScience,\r\n\t\tlabelColor: 'text-warning',\r\n\t},\r\n\t[EnumCategory.LabSupplies]: {\r\n\t\tsrc: LabSupplies,\r\n\t\tlabelColor: 'text-primary',\r\n\t},\r\n};\r\n\r\ninterface Language {\r\n\tid: number;\r\n\tno: \"zh-CN\";\r\n\tdescription: \"华 -中国\";\r\n};\r\n\r\ninterface SaleRegion {\r\n\tid: number;\r\n\tname: string;\r\n\tcurrency: 5;\r\n\tno: \"CN\";\r\n};\r\n\r\ninterface Global {\r\n\tCHINA: number;\r\n\tCHINESE: Language;\r\n\tSALESREGION_CN: SaleRegion;\r\n\t//TIPDISPLAYTIME: 3000;\r\n\tANDROIDAPPADDRESS: string;\r\n\tPIRVACYURL: string;\r\n\tCONTENTSITE: string;\r\n};\r\n\r\n// 生产配置\r\nconst GLOABLE_PRODUCTION: Global = {\r\n\tCHINA: 44,\r\n\tCHINESE: { \"id\": 196, \"no\": \"zh-CN\", \"description\": \"华 -中国\" },\r\n\tSALESREGION_CN: { \"id\": 1, \"name\": \"中国大陆\", \"currency\": 5, \"no\": \"CN\" },\r\n\t//TIPDISPLAYTIME: 3000,\r\n\tANDROIDAPPADDRESS: \"https://shop.jkchemical.com/download/jk-shop.apk\",\r\n\tPIRVACYURL: \"https://shop.jkchemical.com/privacy/shop.txt\",\r\n\tCONTENTSITE: \"https://web.jkchemical.com\",\r\n\t// CONTENTSITE: \"http://localhost:6061\",\r\n}\r\n\r\n// 测试环境配置\r\nconst GLOABLE_TEST: Global = {\r\n\tCHINA: 43,\r\n\tCHINESE: { \"id\": 197, \"no\": \"zh-CN\", \"description\": \"华 -中国\" },\r\n\tSALESREGION_CN: { \"id\": 4, \"name\": \"中国大陆\", \"currency\": 5, \"no\": \"CN\" },\r\n\t//TIPDISPLAYTIME: 3000,\r\n\tANDROIDAPPADDRESS: \"https://shop.jkchemical.com/download/jk-shop.apk\",\r\n\tPIRVACYURL: \"https://c.jkchemical.com/privacy/shop.txt\",\r\n\t// CONTENTSITE: \"https://c.jkchemical.com/jk-web\",\r\n\tCONTENTSITE: \"http://localhost:6061\",\r\n}\r\n\r\nexport const GLOABLE = env.testing === true ? GLOABLE_TEST : GLOABLE_PRODUCTION;\r\n//export { GLOABLE_PRODUCTION as GLOABLE };\r\n//export { GLOABLE_TEST as GLOABLE };\r\n\r\nlet categoryIdRes: { [id: number]: CategoryRes };\r\n(function () {\r\n\tcategoryIdRes = {};\r\n\tlet categoryIds = env.testing === true ? CategoryIds_Test : CategoryIds_Production;\r\n\tfor (let id in categoryIds) {\r\n\t\tcategoryIdRes[id] = RootCategoryRes[categoryIds[id]];\r\n\t}\r\n})();\r\n\r\nexport function rootCategroyResFromId(categoryId: number): CategoryRes {\r\n\treturn categoryIdRes[categoryId];\r\n}\r\n","import * as React from 'react';\r\nimport { tv } from 'tonva';\r\nimport { tvAddress, tvCountry } from './common';\r\n\r\nexport const tvContact = (values: any) => {\r\n    let { name, mobile, organizationName, address, addressString } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        <b>\r\n            {name}\r\n        </b>\r\n        &nbsp; {mobile} &nbsp; {organizationName}<br />\r\n        <small>{tv(address)} {addressString}</small>\r\n    </div>\r\n}\r\n\r\nexport const tvInvoiceType = (values: any) => {\r\n    let { description } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        {description}\r\n    </div>\r\n}\r\n\r\nexport const tvInvoiceInfo = (values: any) => {\r\n    let { title, taxNo } = values;\r\n    return <div className=\"flex-grow-1\">\r\n        <b>\r\n            {title}\r\n        </b>\r\n        &nbsp; {taxNo}\r\n    </div>\r\n}\r\n\r\nexport const customer = {\r\n    contact: tvContact,\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    invoiceInfo: tvInvoiceInfo,\r\n    invoiceType: tvInvoiceType\r\n}\r\n","import { TVs } from \"tonva\";\r\nimport { common } from \"./common\";\r\nimport { warehouse } from \"./warehouse\";\r\nimport { product } from \"./product\";\r\nimport { order } from \"./order\";\r\nimport { customer } from './customer';\r\n\r\nexport const tvs:TVs = {\r\n    common: common,\r\n    warehouse: warehouse,\r\n    product: product,\r\n    order: order,\r\n    customer: customer,\r\n}","import * as React from 'react';\r\n\r\nconst tvWarehouse = (values: any) => {\r\n    let { name } = values;\r\n    return <div>\r\n        {name}\r\n    </div>\r\n}\r\n\r\nexport const warehouse = {\r\n    warehouse: tvWarehouse,\r\n}\r\n","import { tvProduct } from \"./product\";\r\nimport { tvAddress, tvCountry, tvCurrency } from \"./common\";\r\nimport { tvContact } from \"./customer\";\r\n\r\nexport const order = {\r\n    productx: tvProduct,\r\n    address: tvAddress,\r\n    country: tvCountry,\r\n    province: tvCountry,\r\n    city: tvCountry,\r\n    county: tvCountry,\r\n    contact: tvContact,\r\n    currency: tvCurrency,\r\n}\r\n","import { AppConfig } from \"tonva\";\r\nimport { jnkTop } from \"./me/loginTop\";\r\nimport { tvs } from \"./tvs\";\r\nimport { GLOABLE } from \"global\";\r\n\r\nexport const appConfig: AppConfig = {\r\n    appName: '百灵威系统工程部/cart',\r\n    version: '1.1.124',\r\n    tvs: tvs,\r\n    loginTop: jnkTop,\r\n    oem: '百灵威',\r\n    privacy: GLOABLE.PIRVACYURL\r\n};","import { CartPackRow } from \"cart/Cart\";\r\n\r\nexport function groupByProduct(packItems: any[]) {\r\n    let result: any[] = [];\r\n    for (let packItem of packItems.sort((a, b) => a.price - b.price)) {\r\n        let { product, pack, quantity, price, retail, currency } = packItem;\r\n        let packRow: CartPackRow = {\r\n            pack: pack,\r\n            price: price,\r\n            retail: retail,\r\n            quantity: quantity,\r\n            currency: currency && currency.id\r\n        }\r\n        let cpi = result.find(e => e.product.id === product.id);\r\n        if (cpi === undefined) {\r\n            cpi = { product: product, packs: [] };\r\n            result.push(cpi);\r\n        }\r\n        cpi.packs.push(packRow);\r\n    }\r\n    return result;\r\n}","import { observable, autorun, IReactionDisposer } from 'mobx';\r\nimport { TuidDiv, BoxId, Tuid } from 'tonva';\r\n//import { CCartApp } from '../CCartApp';\r\nimport { PackRow, Product } from 'model';\r\nimport { groupByProduct } from 'tools/groupByProduct';\r\nimport { CApp } from 'tapp';\r\n\r\nexport interface CartItem {\r\n    product: Product; // BoxId;\r\n    packs: CartPackRow[];\r\n    $isSelected?: boolean;\r\n    $isDeleted?: boolean;\r\n    createdate: number;\r\n}\r\n\r\nexport interface CartPackRow extends PackRow {\r\n    /**\r\n     * 销售成交价（在购物车中是目录价或市场活动价或协议价的最小值），订单中还会经过券的计算\r\n     */\r\n    price: number;\r\n\r\n    /**\r\n     * 订单中的初始销售成交价（订单中应用折扣券之前的价格）\r\n     */\r\n    priceInit?: number;\r\n    /**\r\n     * 订单中目录价\r\n     */\r\n    retail: number;\r\n    currency: any;\r\n}\r\n\r\nexport class Cart {\r\n    private cApp: CApp;\r\n    private cartData: any;\r\n    private cartStore: CartStore;\r\n    private disposer: IReactionDisposer;\r\n\r\n    /*\r\n    @observable data: any = {\r\n        list: observable<CartItem>([]),\r\n    };\r\n    */\r\n    @observable cartItems: CartItem[];\r\n    count = observable.box<number>(0);\r\n    amount = observable.box<number>(0);\r\n    editButton = observable.box<boolean>(false);\r\n    constructor(cApp: CApp) {\r\n        this.cApp = cApp;\r\n        //this.cartItems = this.data.list;\r\n        this.disposer = autorun(this.calcSum);\r\n    }\r\n\r\n    dispose() {\r\n        this.disposer();\r\n    }\r\n\r\n    private calcSum = () => {\r\n        if (!this.cartItems) return;\r\n        let count = 0, amount = 0;\r\n        for (let cp of this.cartItems) {\r\n            let { $isSelected, $isDeleted, packs } = cp;\r\n            if ($isDeleted === true || !($isSelected === true)) continue;\r\n            for (let pi of packs) {\r\n                let { price, quantity } = pi;\r\n                count += quantity;\r\n                if (price === Number.NaN || quantity === Number.NaN) continue;\r\n                amount += quantity * price;\r\n            }\r\n        }\r\n        this.count.set(count);\r\n        this.amount.set(parseFloat(amount.toFixed(2)));\r\n    }\r\n\r\n    async init(): Promise<void> {\r\n        let { isLogined } = this.cApp;\r\n        if (isLogined)\r\n            this.cartStore = new CartRemote(this.cApp);\r\n        else\r\n            this.cartStore = new CartLocal(this.cApp);\r\n        let cartData = await this.cartStore.load();\r\n        this.cartData = cartData;\r\n        let count = 0;\r\n        for (let cd of cartData) {\r\n            let { quantity } = cd as any;\r\n            count += quantity;\r\n        }\r\n        this.count.set(count);\r\n    }\r\n\r\n    async buildItems() {\r\n        if (this.cartItems) return;\r\n        let { uqs, currentSalesRegion } = this.cApp;\r\n        let cartData = this.cartData;\r\n        // 初始化购物车中产品的目录价\r\n        let { product } = uqs;\r\n        let { PriceX } = product;\r\n        let promises: PromiseLike<void>[] = [];\r\n        cartData.forEach((e: any) => promises.push(PriceX.obj({ product: e.product, pack: e.pack, salesRegion: currentSalesRegion })));\r\n        let prices = await Promise.all(promises);\r\n        for (let index = cartData.length - 1; index >= 0; index--) {\r\n            let e: any = cartData[index];\r\n            let priceMap: any = prices.find((v: any) => Tuid.equ(v.product, e.product)\r\n                && Tuid.equ(v.pack, e.pack) && v.discountinued === 0 && v.expireDate > Date.now());\r\n            if (priceMap && priceMap.retail) {\r\n                e.retail = priceMap.retail;\r\n            } else {\r\n                cartData.splice(index, 1);\r\n            }\r\n        }\r\n\r\n        let cartDataGrouped = groupByProduct(cartData);\r\n        let productPromises: Promise<any>[] = [];\r\n        let cartItems: CartItem[] = [];\r\n        if (cartData && cartData.length) {\r\n            for (let key of cartData) {\r\n                let { product: productId, pack, quantity, price, retail, currency, createdate } = key;\r\n                let product = this.cApp.getProduct(productId);\r\n                productPromises.push(product.loadListItem());\r\n                cartItems.push({\r\n                    product: product,\r\n                    packs: [{ pack: pack, quantity: quantity, price: price, retail: retail, currency: currency && currency.id }],\r\n                    $isSelected: true,\r\n                    $isDeleted: false,\r\n                    createdate: createdate,\r\n                });\r\n            };\r\n        };\r\n        await Promise.all(productPromises);\r\n        this.cartItems = cartItems;\r\n        delete this.cartData;\r\n    }\r\n\r\n    /*\r\n    private mergeToRemote(localItems: any[]) {\r\n        let originLength = localItems.length;\r\n        let nowLength = this.items.length;\r\n        if (originLength > 0) {\r\n            if (nowLength > 0) {\r\n                // 合并，谁覆盖谁？\r\n                for (let i = 0; i < originLength; i++) {\r\n                    let { product: tempProduct, pack: tempPack } = localItems[i];\r\n                    let cartItemExits = this.items.find(v => v.product === tempProduct && v.pack === tempPack);\r\n                    if (cartItemExits) {\r\n                        // 如果本地购物车中的产品已经过期，则要删除\r\n                    } else {\r\n                        this.items.push(localItems[i]);\r\n                    }\r\n                }\r\n            } else {\r\n                this.items.push(...localItems);\r\n            }\r\n            // 保存到远程\r\n        }\r\n    }\r\n    */\r\n\r\n    getQuantity(productId: number, packId: number): number {\r\n        if (!this.cartItems) return 0;\r\n        let cps = this.cartItems.filter(v => v.$isDeleted !== true && Tuid.equ(v.product, productId));\r\n        if (!cps.length) return 0;\r\n        let cpp = cps.find((v => v.packs[0].pack.id === packId));\r\n        return cpp === undefined ? 0 : cpp.packs[0].quantity;\r\n        /* if (!cp) return 0;\r\n        let cpp = cp.packs.find(v => v.pack.id === packId);\r\n        return cpp === undefined ? 0 : cpp.quantity; */\r\n    }\r\n\r\n    isDeleted(productId: number): boolean {\r\n        let i = this.cartItems.findIndex(v => v.$isDeleted === true && Tuid.equ(v.product, productId));\r\n        return i !== -1;\r\n    }\r\n\r\n    getSelectedItems(): CartItem[] {\r\n        return this.cartItems.filter(v => {\r\n            let { $isSelected, $isDeleted } = v;\r\n            return $isSelected === true && $isDeleted !== true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    add = async (product: Product/*BoxId*/, pack: BoxId, quantity: number, price: number, retail: number, currency: any) => {\r\n        let cartItemExists = this.cartItems.find((e) => Tuid.equ(e.product, product) && Tuid.equ(e.packs[0].pack, pack));\r\n        if (!cartItemExists) {\r\n            this.cartItems.push({\r\n                product: product,\r\n                packs: [{ pack: pack, quantity: quantity, price: price, retail: retail, currency: currency }],\r\n                $isSelected: true,\r\n                $isDeleted: false,\r\n                createdate: Date.now()\r\n            });\r\n        }\r\n        else {\r\n            let { $isDeleted, packs } = cartItemExists;\r\n            if ($isDeleted === true) packs.splice(0);\r\n\r\n            let packExists: CartPackRow = packs.find(e => Tuid.equ(e.pack, pack));\r\n            packExists.quantity = quantity;\r\n            packExists.price = price;\r\n            packExists.currency = currency;\r\n\r\n            cartItemExists.$isSelected = true;\r\n            cartItemExists.$isDeleted = false;\r\n            cartItemExists.createdate = Date.now();\r\n        }\r\n\r\n        await this.cartStore.storeCart(product, pack, quantity, price, currency);\r\n    }\r\n    removeStrike = async (data: any) => {\r\n        console.log(data);\r\n        // data.forEach((el: CartItem2) => {\r\n        //     el.packs.forEach(async (v: any) => {\r\n        //         await this.cartStore.storeCart(el.product, v.pack, v.quantity, v.price, v.currency);\r\n        //     })\r\n        // });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param rows\r\n     */\r\n    async removeItem(rows: [{ productId: number, packId: number }]) {\r\n        if (rows && rows.length > 0) {\r\n            rows.forEach(pe => {\r\n                let cartItemIndex = this.cartItems.findIndex(e => Tuid.equ(e.product, pe.productId)\r\n                    && Tuid.equ(e.packs[0].pack, pe.packId));\r\n                if (cartItemIndex >= 0) {\r\n                    let cartItem = this.cartItems[cartItemIndex];\r\n                    let i = cartItem.packs.findIndex(e => e.pack.id === pe.packId)\r\n                    if (i >= 0) {\r\n                        cartItem.packs.splice(i, 1);\r\n                        if (cartItem.packs.length === 0) {\r\n                            this.cartItems.splice(cartItemIndex, 1);\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n            this.cartStore.removeFromCart(rows);\r\n        }\r\n    }\r\n\r\n    /*\r\n    setDeletedMark(productId: number, packId: number) {\r\n        let cp = this.items.find(v => v.$isDeleted !== true && v.product === productId && v.pack === packId);\r\n        if (cp !== undefined)\r\n            cp.$isDeleted = true;\r\n    }\r\n\r\n    async removeDeletedItem() {\r\n        let rows: { product: number, packItem: CartPackRow }[] = [];\r\n        for (let cp of this.items) {\r\n            let { quantity, $isDeleted } = cp;\r\n            if ($isDeleted === true || quantity === 0) {\r\n                // TODO:\r\n            }\r\n        }\r\n        if (rows.length === 0) return;\r\n        await this.cartStore.removeFromCart(rows);\r\n\r\n        // 下面是从本地数据结构中删除\r\n        for (let cp of this.items) {\r\n            let { packs } = cp;\r\n            let packIndexes: number[] = [];\r\n            let len = packs.length;\r\n            for (let i = 0; i < len; i++) {\r\n                if (packs[i].quantity === 0) packIndexes.push(i);\r\n            }\r\n            for (let i = packIndexes.length - 1; i >= 0; i--) packs.splice(packIndexes[i], 1);\r\n        }\r\n\r\n        let itemIndexes: number[] = [];\r\n        let len = this.items.length;\r\n        for (let i = 0; i < len; i++) {\r\n            let { $isDeleted, packs } = this.items[i];\r\n            if ($isDeleted === true || packs.length === 0) itemIndexes.push(i);\r\n        }\r\n        for (let i = itemIndexes.length - 1; i >= 0; i--) this.items.splice(itemIndexes[i], 1);\r\n    }\r\n\r\n    async clear() {\r\n        this.items.forEach(v => v.$isDeleted = true);\r\n        await this.removeDeletedItem();\r\n    }\r\n    */\r\n\r\n}\r\n\r\nabstract class CartStore {\r\n\r\n    protected cApp: CApp;\r\n    constructor(cApp: CApp) {\r\n        this.cApp = cApp;\r\n    }\r\n    //abstract get isLocal(): boolean;\r\n    abstract async load(): Promise<CartItem[]>;\r\n    abstract async storeCart(product: Product, pack: BoxId, quantity: number, price: number, currency: any): Promise<void>;\r\n    abstract async removeFromCart(rows: [{ productId: number, packId: number }]): Promise<void>;\r\n}\r\n\r\nclass CartRemote extends CartStore {\r\n    //private getCartQuery: Query;\r\n    //private setCartAction: Action;\r\n    //private removeFromCartAction: Action;\r\n\r\n    //get isLocal(): boolean { return false }\r\n\r\n    /*\r\n    constructor(cApp: CApp) {\r\n        super(cApp);\r\n\r\n        let { cUqOrder } = this.cApp;\r\n        this.getCartQuery = cUqOrder.query('getcart')\r\n        this.setCartAction = cUqOrder.action('setcart');\r\n        this.removeFromCartAction = cUqOrder.action('removefromcart');\r\n    }\r\n    */\r\n\r\n    async load(): Promise<CartItem[]> {\r\n        let ret = await this.cApp.uqs.order.GetCart.page(undefined, 0, 100);\r\n        return ret && ret.$page && ret.$page.filter((v: any) => v.product && v.pack) as any;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param product\r\n     * @param pack\r\n     * @param quantity\r\n     * @param price\r\n     * @param currency\r\n     */\r\n    async storeCart(product: Product, pack: BoxId, quantity: number, price: number, currency: any) {\r\n        await this.cApp.uqs.order.SetCart.submit({\r\n            product,\r\n            pack: pack.id,\r\n            price: price,\r\n            currency: currency,\r\n            quantity: quantity\r\n        });\r\n    }\r\n\r\n    async removeFromCart(rows: [{ productId: number, packId: number }]) {\r\n        let param = rows.map(e => { return { product: e.productId, pack: e.packId } });\r\n        await this.cApp.uqs.order.RemoveFromCart.submit({ rows: param });\r\n    }\r\n}\r\n\r\nconst LOCALCARTNAME: string = \"cart\";\r\nclass CartLocal extends CartStore {\r\n\r\n    private cartData: any[] = [];\r\n    private productTuid: Tuid;\r\n    private packTuid: TuidDiv;\r\n    constructor(cApp: CApp) {\r\n        super(cApp);\r\n\r\n        this.productTuid = this.cApp.uqs.product.ProductX;\r\n        this.packTuid = this.productTuid.div('packx');\r\n    }\r\n\r\n    //get isLocal(): boolean { return true }\r\n\r\n    async load(): Promise<CartItem[]> {\r\n        try {\r\n            let cartstring = localStorage.getItem(LOCALCARTNAME);\r\n            if (cartstring === null) return [];\r\n            this.cartData = JSON.parse(cartstring);\r\n            let cartDataBoxed = [];\r\n            for (let i = 0; i < this.cartData.length; i++) {\r\n                let { product, pack, quantity, price, currency } = this.cartData[i];\r\n                if (product && pack) {\r\n                    let productbox = this.productTuid.boxId(product);\r\n                    let packbox = this.packTuid.boxId(pack);\r\n                    cartDataBoxed.push({\r\n                        product: productbox,\r\n                        pack: packbox,\r\n                        quantity: quantity,\r\n                        price: price,\r\n                        currency: currency\r\n                    } as any)\r\n                }\r\n            }\r\n            return cartDataBoxed;\r\n        }\r\n        catch (e) {\r\n            localStorage.removeItem(LOCALCARTNAME);\r\n            this.cartData = [];\r\n            return this.cartData;\r\n        }\r\n    }\r\n\r\n    async storeCart(product: Product, pack: BoxId, quantity: number, price: number, currency: any) {\r\n        let cartItemExists = this.cartData.find(e => Tuid.equ(e.product, product) && TuidDiv.equ(e.pack, pack));\r\n        if (cartItemExists !== undefined) {\r\n            cartItemExists.quantity = quantity;\r\n            cartItemExists.price = price;\r\n            cartItemExists.currency = currency && currency.id;\r\n        } else\r\n            this.cartData.push({ product: product.id, pack: pack.id, quantity: quantity, price: price, currency: currency && currency.id });\r\n        localStorage.setItem(LOCALCARTNAME, JSON.stringify(this.cartData));\r\n    }\r\n\r\n    async removeFromCart(rows: [{ productId: number, packId: number }]) {\r\n\r\n        rows.forEach(e => {\r\n            let i = this.cartData.findIndex(v => v.product = e.productId && v.pack === e.packId);\r\n            if (i >= 0)\r\n                this.cartData.splice(i, 1);\r\n        })\r\n        localStorage.setItem(LOCALCARTNAME, JSON.stringify(this.cartData));\r\n    }\r\n}","import { CSub, CBase, CAppBase, IConstructor, PageWebNav } from 'tonva';\r\nimport { UQs } from '../uqs';\r\nimport { CApp } from './CApp';\r\n\r\nexport abstract class CUqBase extends CBase {\r\n    get cApp(): CApp { return this._cApp; }\r\n\tprotected get uqs(): UQs { return this._uqs as UQs };\r\n\tgetPageWebNav(): PageWebNav {return this.cApp.getPageWebNav();}\r\n}\r\n\r\nexport abstract class CUqSub<T extends CUqBase> extends CSub<T> {\r\n    get cApp(): CApp { return this.cApp; }\r\n    protected get uqs(): UQs { return this._uqs as UQs };\r\n\tprotected get owner(): T { return this._owner as T }\r\n\tgetPageWebNav(): PageWebNav {return this.cApp.getPageWebNav();}\r\n}\r\n\r\nexport abstract class CUqApp extends CAppBase {\r\n    get uqs(): UQs { return this._uqs };\r\n\r\n    protected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n        let c = new type(this);\r\n        c.init();\r\n        return c;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { CHome } from './CHome';\r\nimport { SearchBox } from 'tonva';\r\n\r\nexport class VSearchHeader extends View<CHome> {\r\n\r\n    private onSearch = async (key: string, param: 'home' | 'insearch' | 'productdetail') => {\r\n        let { cProduct, topKey } = this.controller.cApp;\r\n        if (param !== 'home') {\r\n            nav.popTo(topKey);\r\n        }\r\n\r\n        cProduct.start(key);\r\n    }\r\n\r\n    render(param: 'home' | 'insearch' | 'productdetail') {\r\n        let size: any = param === 'home' ? \"md\" : 'sm';\r\n        return <SearchBox className=\"w-100\"\r\n            size={size}\r\n            onSearch={(key: string) => this.onSearch(key, param)}\r\n            placeholder=\"搜索品名、编号、CAS、MDL等\" />\r\n    }\r\n}","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { LMR, FA, View } from 'tonva';\r\nimport logo from '../images/logo.png';\r\nimport { CHome } from './CHome';\r\nimport 扫一扫 from 'images/扫一扫.png';\r\nexport class VSiteHeader extends View<CHome> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let left = <img className=\"m-1 ml-2\" src={logo} alt=\"logo\" style={{ height: \"3rem\", width: \"2.5rem\" }} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        // let right = undefined; // \r\n        let right = undefined;\r\n        /* if (navigator.userAgent.indexOf(\"Html5Plus\") > -1) {\r\n            right = <img src={扫一扫} alt=\"\" className=\"mr-2\" style={{ width: 24 }} onClick={this.controller.openScanCode} />;\r\n        } */\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-1 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"px-3 py-4\">\r\n                {this.controller.renderSearchHeader('md')}\r\n            </div>\r\n        </LMR>\r\n        //<div className=\"h4 px-3 mb-0\">百灵威科技</div>\r\n    }\r\n}","/* eslint-disable */\r\nimport React from 'react';\r\nimport { View } from 'tonva';\r\nimport { CHome } from './CHome';\r\nimport Slider from \"react-slick\";\r\nimport \"slick-carousel/slick/slick.css\";\r\nimport \"slick-carousel/slick/slick-theme.css\";\r\n\r\nconst sliderSetting = {\r\n    dots: false,\r\n    infinite: true,\r\n    speed: 500,\r\n    autoplay: true,\r\n    slidesToShow: 1,\r\n    slidesToScroll: 1,\r\n    arrows: false,\r\n    isArrows: true,\r\n    isDots: true\r\n};\r\n\r\nexport class VSlider extends View<CHome> {\r\n\r\n    public render(param: any) {\r\n\r\n        let { banners } = this.controller;\r\n        if (banners.length > 0) {\r\n            let random = Math.floor(Math.random() * 10 % banners.length);\r\n            return <img src={banners[random].path} className=\"d-block w-100\" alt=\"...\"></img>\r\n        }\r\n\r\n        /**\r\n        return <Slider {...sliderSetting} className=\"bg-white\" >\r\n            {this.controller.banners.map((banner, index) => <div key={index} >\r\n                <img src={banner.path} className=\"d-block w-100\" alt=\"...\"></img>\r\n            </div>)}\r\n        </Slider>\r\n        **/\r\n    }\r\n}\r\n","/* eslint-disable */\r\nexport let browser = {\r\n    versions: function () {\r\n        var u = navigator.userAgent, app = navigator.appVersion;\r\n        return {\r\n            trident: u.indexOf('Trident') > -1,                            //IE内核\r\n            presto: u.indexOf('Presto') > -1,                              //opera内核\r\n            webKit: u.indexOf('AppleWebKit') > -1,                         //苹果、谷歌内核\r\n            gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') === -1,    //火狐内核\r\n            mobile: !!u.match(/AppleWebKit.*Mobile.*/),                    //是否为移动终端\r\n            ios: !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),               //ios终端\r\n            android: u.indexOf('Android') > -1, //android终端或者uc浏览器\r\n            uc: u.indexOf('Linux') > -1, //android终端或者uc浏览器\r\n            iPhone: u.indexOf('iPhone') > -1,                              //是否为iPhone或者QQHD浏览器\r\n            iPad: u.indexOf('iPad') > -1,                                  //是否iPad\r\n            webApp: u.indexOf('Safari') === -1,                             //是否web应该程序，没有头部与底部\r\n            html5Plus: u.indexOf('Html5Plus') > -1                      //是否微信 （2015-01-22新增）\r\n        };\r\n    }()\r\n};\r\n\r\nexport let xs = (function () {\r\n\r\n    function getViewportSize(w?: any) {\r\n        w = w || window;\r\n        if (w.innerWidth != null) return { w: w.innerWidth, h: w.innerHeight };\r\n        var d = w.document;\r\n        if (document.compatMode === \"CSS1Compat\")\r\n            return { w: d.documentElement.clientWidth, h: d.documentElement.clientHeight };\r\n        return { w: d.body.clientWidth, h: d.body.clientHeight };\r\n    }\r\n    return getViewportSize().w < 576;\r\n})();\r\n\r\nexport let xsOrIpad = xs || browser.versions.iPad;","import * as React from 'react';\r\nimport { VPage } from 'tonva';\r\nimport { CHome } from './CHome';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VSlider } from './VSlider';\r\nimport { browser } from 'tools/browser';\r\nimport { GLOABLE } from 'global';\r\n\r\nexport class VHome extends VPage<CHome> {\r\n\r\n    async open(param?: any) {\r\n        // this.openPage(this.page);\r\n    }\r\n\r\n    /*\r\n    render(param: any): JSX.Element {\r\n        return <this.pageContent />\r\n    }\r\n\r\n    private page = () => {\r\n        return <Page header={false}>\r\n            <this.pageContent />\r\n        </Page>;\r\n    };\r\n    */\r\n\r\n    downloadApp = () => {\r\n        if (browser.versions.android)\r\n            window.open(GLOABLE.ANDROIDAPPADDRESS);\r\n    }\r\n\r\n    header() {\r\n        let header = <></>;\r\n        if (!browser.versions.html5Plus && browser.versions.android) {\r\n            header = <div className=\"bg-warning d-flex align-items-center\"\r\n                onClick={this.downloadApp}>\r\n                <span className=\"small text-danger ml-3\">\r\n                    APP购物更方便\r\n                </span>\r\n                <button type=\"button\" className=\"btn btn-primary btn-sm ml-auto m-1\">立即安装</button>\r\n            </div>\r\n        }\r\n        return header;\r\n    }\r\n\r\n    content() {\r\n        return <this.pageContent />\r\n    }\r\n\r\n    private pageContent = () => {\r\n        let { controller } = this;\r\n        let { renderCategoryRootList } = controller;\r\n        let siteHeader = this.renderVm(VSiteHeader);\r\n        return <>\r\n            {siteHeader}\r\n            <div className=\"mb-3\">\r\n                {this.renderVm(VSlider)}\r\n            </div>\r\n            {renderCategoryRootList()}\r\n        </>\r\n    };\r\n}","import * as React from 'react';\r\nimport { FA, nav } from 'tonva';\r\nimport classNames from 'classnames';\r\n\r\nexport const CustomHeaderTemplate = (content?: any, right?: any, bg?: any, textC?: any, back?: any) => {\r\n    return <header className={classNames('d-flex align-items-center p-0 justify-content-between', bg ? bg : 'bg-white')} style={{ background: bg, minHeight: '3rem' }}>\r\n        <nav className={`d-flex align-items-center justify-content-center ${textC ? textC : 'text-white'}`}\r\n            style={{ cursor: 'pointer', width: \"2.5rem\", height: \"2.3rem\", color: textC, }}\r\n            onClick={() => { nav.back(); if (back) back() }}>\r\n            <FA name=\"angle-left\" />\r\n        </nav>\r\n        <div className=\"flex-fill\">{content}</div>\r\n        <aside className=\"d-flex justify-content-end align-items-stretch\" style={{ minWidth: '2.3rem', padding: 2 }}>{right}</aside>\r\n    </header>\r\n}","import { observer } from 'mobx-react';\r\nimport * as React from 'react';\r\nimport { VPage } from 'tonva';\r\nimport { CustomHeaderTemplate } from 'tools/CustomHeaderTemplate';\r\nimport { CHome } from './CHome';\r\n\r\nconst ScanCodeTip: string = '只可扫本司产品二维码';\r\n\r\nexport class VScanCode extends VPage<CHome> {\r\n\r\n    scan: any;\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    media = () => {\r\n        if (navigator.userAgent.indexOf(\"Html5Plus\") > -1) {\r\n            // @ts-ignore \r\n            this.scan = new plus.barcode.Barcode('bcid');\r\n            this.scan.onmarked = this.onmarked;\r\n            this.scan.start();\r\n        }\r\n    }\r\n\r\n    onmarked = async (type: any, result: any) => {\r\n        var text = '未知: ';\r\n        switch (type) {\r\n            // @ts-ignore \r\n            case plus.barcode.QR:\r\n                text = 'QR';\r\n                break;\r\n            // @ts-ignore \r\n            case plus.barcode.EAN13:\r\n                text = 'EAN13';\r\n                break;\r\n            // @ts-ignore \r\n            case plus.barcode.EAN8:\r\n                text = 'EAN8';\r\n                break;\r\n        }\r\n        console.log('result==>', result);// '912152 LT40U57 Jkchemical 1'   \r\n        let reg = /(Jkchemical)/, verArr = [1];\r\n        if (text === 'QR' && reg.test(result)) {\r\n            let Ver = result.charAt(result.length - 1);\r\n            let shiftArr = result.split(' ');\r\n            if (verArr.includes(Number(Ver))) {\r\n                let { scanCodetoProductDetail } = this.controller;\r\n                this.scanClose();\r\n                await scanCodetoProductDetail(shiftArr[0]);\r\n            }\r\n        } else {\r\n            alert('此码无法解析额');\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    scanClose = () => {\r\n        if (navigator.userAgent.indexOf(\"Html5Plus\") > -1) {\r\n            // @ts-ignore \r\n            this.scan.close();\r\n        }\r\n    }\r\n\r\n    close = () => {\r\n        this.scanClose();\r\n        this.closePage();\r\n    }\r\n\r\n    private page = observer(() => {\r\n        this.media();\r\n        setTimeout(() => {\r\n            this.media();\r\n        }, 5);\r\n        let header = <div className='w-100 text-center text-light'>扫一扫</div>;\r\n        return <div className=\"w-100 h-100 d-flex flex-column\">\r\n            <div className=\"w-100\">\r\n                {CustomHeaderTemplate(header, '', '#555555', '', this.close)}\r\n            </div>\r\n            <div className=\"alert alert-warning py-0 w-100 rounded-0 m-0 text-center\" role=\"alert\">{ScanCodeTip}</div>\r\n            <main className=\"flex-fill\">\r\n                <div id='bcid' className=\"w-100 h-100\" style={{ background: '#F5F5F5' }}></div>\r\n            </main>\r\n        </div>;\r\n    });\r\n}\r\n","import { Tuid } from 'tonva';\r\nimport { PageItems } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VSearchHeader } from './VSearchHeader';\r\nimport { VHome } from './VHome';\r\nimport { VScanCode } from './VScanCode';\r\n\r\nclass HomeSections extends PageItems<any> {\r\n\r\n    private sectionTuid: Tuid;\r\n\r\n    constructor(sectionTuid: Tuid) {\r\n        super();\r\n        this.firstSize = this.pageSize = 13;\r\n        this.sectionTuid = sectionTuid;\r\n    }\r\n\r\n    protected async loadResults(param: any, pageStart: any, pageSize: number): Promise<{ [name: string]: any[] }> {\r\n        let ret = await this.sectionTuid.search(\"\", pageStart, pageSize);\r\n        return { $page: ret };\r\n    }\r\n    protected async load(param: any, pageStart: any, pageSize: number): Promise<any[]> {\r\n        if (pageStart === undefined) pageStart = 0;\r\n        let ret = await this.sectionTuid.search(\"\", pageStart, pageSize);\r\n        return ret;\r\n    }\r\n\r\n    protected setPageStart(item: any): any {\r\n        if (item === undefined) return 0;\r\n        return item.id;\r\n    }\r\n}\r\n\r\nexport class CHome extends CUqBase {\r\n\r\n    homeSections: HomeSections;\r\n    sectionTuid: Tuid;\r\n\r\n    banners: any[];\r\n    async internalStart(param: any) {\r\n\r\n        /*\r\n        let { cProductCategory } = this.cApp;\r\n        await cProductCategory.start();\r\n        this.openVPage(VHome);\r\n        */\r\n    }\r\n\r\n    openScanCode = () => {\r\n        this.openVPage(VScanCode)\r\n    }\r\n\r\n    renderSearchHeader = (size?: string) => {\r\n        return this.renderView(VSearchHeader, size);\r\n    }\r\n\r\n    renderCategoryRootList = () => {\r\n        let { cProductCategory } = this.cApp;\r\n        return cProductCategory.renderRootList();\r\n    }\r\n\r\n    getSlideShow = async () => {\r\n\t\tif (this.banners) return;\r\n\t\tlet list = await this.uqs.webBuilder.GetSlideShow.table({});\r\n\t\tthis.banners = list.map(v => ({ path: v.path, src: v.src }));\r\n\t\t/*\r\n        list.forEach(v => {\r\n            this.banners.push({ path: v.path, src: v.src });\r\n\t\t})\r\n\t\t*/\r\n    }\r\n\r\n    scanCodetoProductDetail = async (origin: any) => {\r\n        let { cProduct, currentSalesRegion } = this.cApp;\r\n        let productByOrigin = await this.uqs.product.GetProductByOrigin.obj({ origin, salesRegion: currentSalesRegion.id });\r\n        await cProduct.showProductDetail(productByOrigin.id, 'ScanCode');\r\n    }\r\n\r\n    // tab = () => this.renderView(VHome);\r\n    tab: VHome = new VHome(this);\r\n}","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { View, nav } from 'tonva';\r\nimport { CCart } from './CCart';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VCartLabel extends View<CCart> {\r\n\r\n    private showCart = async () => {\r\n        let { cart } = this.controller.cApp;\r\n\t\tcart.editButton.set(false);\r\n        nav.navigate(\"/cart\");\r\n    }\r\n\r\n    render(): JSX.Element {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet { cart } = this.controller.cApp;\r\n\t\t\tlet count: any = cart.count.get();\r\n\t\t\tlet badge, onClick, pointer;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tonClick = this.showCart;\r\n\t\t\t\tpointer = 'cursor-pointer';\r\n\t\t\t\tif (count < 100) badge = <u style={{right:0}}>{count}</u>;\r\n\t\t\t\telse badge = <u style={{right:0}}>99+</u>;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn <div className={classNames('jk-cart ', pointer)} onClick={onClick}>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<span className=\"fa-stack w-auto h-auto\">\r\n\t\t\t\t\t\t<i className=\"fa fa-square fa-stack-2x text-white d-none\"></i>\r\n\t\t\t\t\t\t<span className=\"shopping-cart\"></span>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t{badge}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t}));\r\n\t}\r\n}","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { UpdownWidget } from 'tonva';\r\n\r\nconst keys = [107, 109, 110, 187, 189];\r\n\r\nexport class MinusPlusWidget extends UpdownWidget {\r\n    @observable protected value: any;\r\n    @observable protected disabled: boolean;\r\n    // @observable protected hasFocus: boolean;\r\n\r\n    protected isValidKey(key: number): boolean {\r\n        if (keys.find(v => v === key) !== undefined) return false;\r\n        return super.isValidKey(key);\r\n    }\r\n\r\n\t/*\r\n    protected onBlur = (evt: React.FocusEvent<any>) => {\r\n        super.onBlur(evt);\r\n        this.hasFocus = false;\r\n    }\r\n\r\n    protected onFocus(evt: React.FocusEvent<any>) {\r\n        super.onFocus(evt);\r\n        this.hasFocus = true;\r\n\t}\r\n\t*/\r\n\r\n    protected onChange(evt: React.ChangeEvent<any>) {\r\n    }\r\n\r\n    private minusClick = () => {\r\n        let v = this.getValue();\r\n        if (!v) v = 0;\r\n        this.setValue(v - 1);\r\n    }\r\n    private plusClick = () => {\r\n        let v = this.getValue();\r\n        if (!v) v = 0;\r\n        this.setValue(v + 1);\r\n    }\r\n\r\n    private ref = (input: HTMLInputElement) => {\r\n        this.input = input;\r\n        if (this.input === null) return;\r\n        let p: HTMLElement;\r\n        for (p = this.input; ; p = p.parentElement) {\r\n            if (!p) break;\r\n            if (p.tagName !== 'FIELDSET') continue;\r\n            if ((p as any)['disabled'] === true) {\r\n                this.disabled = true;\r\n            }\r\n            break;\r\n        }\r\n    }\r\n\r\n    private renderContent = observer((): JSX.Element => {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn: any = {\r\n            //'form-control': true,\r\n        };\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        let hasFocus = this.hasFocus; // document.hasFocus() && document.activeElement === this.input;\r\n        let hasAction = this.readOnly !== true && this.disabled !== true;\r\n        let hasValue = isNaN(this.value) === false && this.value !== undefined && this.value > 0;\r\n        let cursorPointer: string,\r\n            minusColor: string, minusClick: any,\r\n            plusColor: string, plusClick: any;\r\n        if (this.disabled === true) {\r\n            cursorPointer = 'cursor-pointer';\r\n            minusColor = plusColor = 'text-light';\r\n        }\r\n        else {\r\n            minusClick = this.minusClick;\r\n            plusClick = this.plusClick;\r\n            minusColor = 'text-danger-2'; //'text-black-50';\r\n            plusColor = 'text-danger';\r\n        }\r\n        let minus = <i className={classNames('fa',\r\n            'fa-minus-circle', 'fa-lg', minusColor, cursorPointer,\r\n            { invisible: !(hasFocus === true || (hasAction === true && hasValue === true)) })}\r\n            onClick={minusClick} />;\r\n        let input = <input ref={this.ref}\r\n            className={classNames(this.className, cn, 'mx-1 w-4c form-control',\r\n                { invisible: !(hasFocus === true || hasValue === true) })}\r\n            type=\"text\"\r\n            defaultValue={this.value}\r\n            onChange={this.onChange}\r\n            placeholder={this.placeholder}\r\n            readOnly={this.readOnly}\r\n            disabled={this.disabled}\r\n            onKeyDown={this.onKeyDown}\r\n            onFocus={(evt: React.FocusEvent<any>) => this.onFocus(evt)}\r\n            onBlur={(evt: React.FocusEvent<any>) => this.onBlur(evt)}\r\n            maxLength={10} />;\r\n\r\n        let plus = <i className={classNames('fa fa-plus-circle fa-lg',\r\n            plusColor, cursorPointer,\r\n            { invisible: !(hasAction === true) })}\r\n            onClick={plusClick} />;\r\n        return <div className=\"d-flex align-items-center\">{minus}{input}{plus}\r\n            {this.renderErrors()}\r\n        </div>;\r\n    });\r\n\r\n    render() {\r\n        return <this.renderContent />;\r\n    }\r\n}\r\n","import { PageItems } from 'tonva';\r\nimport * as _ from 'lodash';\r\nimport { result } from 'lodash';\r\n\r\nexport class ElasticSearchPager<T extends any> extends PageItems<T>{\r\n\r\n    private searchUrl: string;\r\n    protected idFieldName: any;\r\n    private pageNumber: number;\r\n    constructor(searchUrl: string, pageSize?: number, firstSize?: number, itemObservable?: boolean) {\r\n        super(itemObservable);\r\n        this.searchUrl = searchUrl;\r\n        if (pageSize !== undefined) this.pageSize = pageSize;\r\n        if (firstSize !== undefined) this.firstSize = firstSize;\r\n        this.pageNumber = 1;\r\n    }\r\n\r\n    setReverse() {\r\n        this.appendPosition = 'head';\r\n    }\r\n\r\n    protected async onLoad() {\r\n        if (this.idFieldName) return;\r\n        this.sortOrder = 'asc';\r\n    }\r\n\r\n    protected async loadResults(param: any, pageStart: number, pageSize: number): Promise<{ [name: string]: any[] }> {\r\n        let { keyWord, salesregion } = param;\r\n        let url = this.searchUrl + '/' + keyWord;\r\n        if (this.pageNumber > 1) {\r\n            url += \"/\" + this.pageNumber;\r\n        }\r\n        try {\r\n            let resp = await fetch(url, {\r\n                method: 'GET',\r\n                headers: {\r\n                    'Accept': 'application/json',\r\n                    'Content-Type': 'application/json'\r\n                },\r\n            });\r\n            let ret = await resp.json();\r\n            let items = ret.hits;\r\n            // 做数据变换，返回items\r\n            return { $page: items };\r\n        } catch (error) {\r\n            return { $page: [] };\r\n        }\r\n    }\r\n\r\n    /*\r\n    async refreshItems(item: T) {\r\n        let index = this._items.indexOf(item);\r\n        if (index < 0) return;\r\n        let startIndex: number;\r\n        if (this.appendPosition === 'tail') {\r\n            startIndex = index - 1;\r\n        }\r\n        else {\r\n            startIndex = index + 1;\r\n        }\r\n        let pageStart = this.getPageId(this._items[startIndex]);\r\n        let pageSize = 1;\r\n        let ret = await this.load(\r\n            this.param,\r\n            pageStart,\r\n            pageSize);\r\n        let len = ret.length;\r\n        if (len === 0) {\r\n            this._items.splice(index, 1);\r\n            return;\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n            let newItem = ret[i];\r\n            if (!newItem) continue;\r\n            let newId = newItem[this.idFieldName];\r\n            if (newId === undefined || newId === null) continue;\r\n            if (typeof newId === 'object') newId = newId.id;\r\n            let oldItem = this._items.find(v => {\r\n                let oldId = (v as any)[this.idFieldName];\r\n                if (oldId === undefined || oldId === null) return false;\r\n                if (typeof oldId === 'object') oldId = oldId.id;\r\n                return oldId = newId;\r\n            });\r\n            if (oldItem) {\r\n                _.merge(oldItem, newItem);\r\n            }\r\n        }\r\n    }\r\n    */\r\n\r\n    protected async onLoaded(): Promise<void> {\r\n\r\n        this.pageNumber += 1;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Form, ObjectSchema, NumSchema, ArrSchema, UiSchema, UiArr, FormField, UiCustom, FA, tv, Ax } from 'tonva';\r\nimport { MinusPlusWidget } from '../tools';\r\nimport { CCart } from './CCart';\r\nimport { CartPackRow, CartItem } from './Cart';\r\nimport { xs } from 'tools/browser';\r\n\r\nconst cartSchema = [\r\n    {\r\n        name: 'list',\r\n        type: 'arr',\r\n        arr: [\r\n            { name: 'checked', type: 'boolean' },\r\n            { name: 'product', type: 'object' } as ObjectSchema,\r\n            {\r\n                name: 'packs', type: 'arr', arr: [\r\n                    { name: 'pack', type: 'object' } as ObjectSchema,\r\n                    { name: 'price', type: 'number' } as NumSchema,\r\n                    { name: 'retail', type: 'number' } as NumSchema,\r\n                    { name: 'quantity', type: 'number' } as NumSchema,\r\n                    { name: 'currency', type: 'object' } as ObjectSchema\r\n                ]\r\n            }\r\n        ],\r\n    } as ArrSchema\r\n];\r\n\r\nexport class VCart extends VPage<CCart> {\r\n    /*\r\n    async open() {\r\n        this.openPage(this.page);\r\n    }\r\n    */\r\n\r\n    protected CheckOutButton = observer(() => {\r\n        let { checkOut, strikeOut, cApp } = this.controller;\r\n        let { cart } = cApp;\r\n        let amount = cart.amount.get();\r\n        let check = cart.editButton.get() ? '删除' : \"去结算\";\r\n        let content = cart.editButton.get() ? <>{check}</> : amount > 0 ?\r\n            <>{check} (¥{amount})</> :\r\n            <>{check}</>;\r\n        if (cart.editButton.get()) {\r\n            return <div className=\"d-flex justify-content-end\">\r\n                <button className=\"btn btn-success w-25 mx-5\" style={{ background: '#28a745' }}\r\n                    type=\"button\"\r\n                    onClick={strikeOut}>\r\n                    {content}\r\n                </button>\r\n            </div>;\r\n        } else {\r\n            return <div className=\"d-flex justify-content-center\">\r\n                <button className=\"btn btn-success mx-5\" style={{ background: '#28a745' }}\r\n                    type=\"button\"\r\n                    onClick={checkOut} disabled={amount <= 0}>\r\n                    {content}\r\n                </button>\r\n            </div>;\r\n        }\r\n    });\r\n\r\n    render(params: any): JSX.Element {\r\n        return <this.tab />;\r\n    }\r\n\r\n    private renderCartItem = (item: CartItem) => {\r\n        let { product } = item;\r\n        let { controller } = this;\r\n        let { onItemClick, renderCartProduct } = controller;\r\n        return <div className=\"row justify-content-between\">\r\n            <div className=\"col-lg-5 px-0\" >{/* onClick={() => onItemClick(item)} */}\r\n                <Ax href={'/product/' + product.id}>\r\n                    {renderCartProduct(product)}\r\n                </Ax>\r\n            </div>\r\n            <div className=\"col-lg-6 px-0 mt-2\"><FormField name=\"packs\" /></div>\r\n        </div>\r\n    }\r\n\r\n    private packsRow = (item: CartPackRow) => {\r\n        let { pack, price } = item;\r\n        return <>\r\n            <div className=\"px-2 d-flex align-items-center\">\r\n                <div className=\"col-4 px-0\"><b>{tv(pack)}</b></div>\r\n                <div className=\"col-4 px-0\"><span className=\"text-danger h5\">¥{price}</span></div>\r\n                <div className=\"col-4 px-0\"><FormField name=\"quantity\" /></div>\r\n            </div>\r\n            {/* <div>{this.controller.renderDeliveryTime(pack)}</div> */}\r\n        </>\r\n        /* return <div className=\"px-2\">\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-6c mr-4 text-right\"><span className=\"text-danger h5\">¥{price}</span></div>\r\n                <FormField name=\"quantity\" />\r\n            </div>\r\n            <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n        </div>; */\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        selectable: true,\r\n        deletable: true,\r\n        restorable: false,\r\n        items: {\r\n            list: {\r\n                widget: 'arr',\r\n                Templet: this.renderCartItem,\r\n                ArrContainer: (label: any, content: JSX.Element) => content,\r\n                RowContainer: (content: JSX.Element) => <div className=\"py-3\">{content}</div>,\r\n                items: {\r\n                    packs: {\r\n                        widget: 'arr',\r\n                        Templet: this.packsRow,\r\n                        selectable: false,\r\n                        deletable: false,\r\n                        ArrContainer: (label: any, content: JSX.Element) => content,\r\n                        RowContainer: (content: JSX.Element) => content,\r\n                        RowSeperator: <div className=\"border border-gray border-top my-3\" />,\r\n                        items: {\r\n                            quantity: {\r\n                                widget: 'custom',\r\n                                className: 'text-center',\r\n                                WidgetClass: MinusPlusWidget as any,\r\n                                onChanged: this.controller.onQuantityChanged\r\n                            } as UiCustom\r\n                        },\r\n                    } as UiArr\r\n                },\r\n                onDeleted: this.controller.onRemoveCartItem,\r\n            } as UiArr\r\n        }\r\n    }\r\n\r\n    protected cartForm = observer(() => {\r\n        let { cart } = this.controller.cApp;\r\n        let { cartItems } = cart;\r\n        let data = { list: cartItems };\r\n        return <>\r\n            {!xs ? <div className=\"col-lg-12 px-3\"><h1 className=\"mt-4 mb-3\">购物车</h1></div> : null}\r\n            <div className=\"d-none d-lg-block\">\r\n                <div className=\"w-100 border-bottom \">\r\n                    <div className=\"col-lg-6 d-flex ml-auto mr-0 mb-2 px-2 font-weight-bolder h6\">\r\n                        <div className=\"col-4\">包装</div>\r\n                        <div className=\"col-4\">单价</div>\r\n                        <div className=\"col-4 text-left pl-0\" style={{ textIndent: '2em' }}>数量</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <Form className=\"bg-white flex-fill overflow-auto reset-z-fieldset\"\r\n                schema={cartSchema} uiSchema={this.uiSchema} formData={data} />\r\n        </>\r\n    });\r\n\r\n    private empty() {\r\n        return <div className=\"py-5 text-center bg-white\">你的购物车空空如也</div>\r\n    }\r\n\r\n    /**\r\n     * 是否编辑\r\n     */\r\n    private whetherToEdit = () => {\r\n        // let { cart } = this.controller.cApp;\r\n        // cart.editButton.set(!cart.editButton.get());\r\n    }\r\n\r\n    /*\r\n    private page = observer((params: any): JSX.Element => {\r\n        let { cart } = this.controller.cApp;\r\n        let footer: any, content: any;\r\n        let cancel = cart.editButton.get() ? '取消' : '编辑';\r\n        let right = <small className=\"mr-3\" onClick={this.whetherToEdit}>{cancel}</small>\r\n        if (cart.count.get() === 0 && cart.cartItems.length === 0) {\r\n            content = this.empty();\r\n            footer = undefined;\r\n        }\r\n        else {\r\n            content = React.createElement(this.cartForm);\r\n            footer = React.createElement(this.CheckOutButton);\r\n        }\r\n        // return <Page header=\"购物车\" right={right} footer={footer}>\r\n        //     {content}\r\n        // </Page>;\r\n        return <Page header=\"购物车\" footer={footer}>\r\n            {content}\r\n        </Page>;\r\n    })\r\n    */\r\n\r\n    // header() {return <div className=\"navheader\">购物车</div>}\r\n    header() {\r\n        if (!xs) return '';\r\n        return <div className=\"navheader\">购物车</div>;\r\n    }\r\n    footer() {\r\n        let { cart } = this.controller.cApp;\r\n        let footer: any;\r\n        if (cart.count.get() === 0 && cart.cartItems && cart.cartItems.length === 0) {\r\n            footer = undefined;\r\n        }\r\n        else {\r\n            footer = React.createElement(this.CheckOutButton);\r\n        }\r\n        return footer;\r\n    }\r\n\r\n    content() {\r\n        let { cart } = this.controller.cApp;\r\n        let content: any;\r\n        if (cart.count.get() === 0 && cart.cartItems && cart.cartItems.length === 0) {\r\n            content = this.empty();\r\n        }\r\n        else {\r\n            content = React.createElement(this.cartForm);\r\n        }\r\n        return content;\r\n    }\r\n\r\n    private tab = observer(() => {\r\n        let { cart } = this.controller.cApp;\r\n        let header = <header className=\"py-2 text-center bg-info text-white\">\r\n            <FA className=\"align-middle\" name=\"shopping-cart\" size=\"2x\" /> &nbsp; <span className=\"h5 align-middle\">购物车</span>\r\n        </header>;\r\n        if (cart.count.get() === 0 && cart.cartItems.length === 0) {\r\n            return <>\r\n                {header}\r\n                {this.empty()}\r\n            </>;\r\n        }\r\n\r\n        let content = React.createElement(this.cartForm);\r\n        let footer = React.createElement(this.CheckOutButton);\r\n        return <>\r\n            {content}\r\n            {footer}\r\n        </>;\r\n    });\r\n\r\n    /*\r\n    header() {\r\n        let { cart } = this.controller.cApp;\r\n        let cancel = cart.editButton.get() ? '取消' : '编辑';\r\n        let header = <header className=\"py-2 text-center bg-info text-white position-relative\">\r\n            <FA className=\"mr-3\" name=\"shopping-cart\" size=\"lg\" />\r\n            <span>购物车</span>\r\n        </header>;\r\n        return header;\r\n    }\r\n    */\r\n    /*\r\n    footer() {\r\n        return <div className=\"p-3 d-flex justify-content-center\"><this.CheckOutButton /></div>;\r\n    }\r\n    */\r\n    /*\r\n    content() {\r\n        return <this.tab />\r\n    }\r\n    */\r\n}","import { RowContext, BoxId } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VCartLabel } from './VCartLabel';\r\nimport { VCart } from './VCart';\r\nimport { CartPackRow, CartItem } from './Cart';\r\nimport { Product } from 'model';\r\nimport { product } from 'tvs/product';\r\n\r\nexport class CCart extends CUqBase {\r\n\r\n    private selectedCartItems: CartItem[];\r\n\r\n    protected async internalStart(param: any) {\r\n        this.openVPage(VCart);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * 显示购物车图标\r\n     */\r\n    renderCartLabel() {\r\n        return this.renderView(VCartLabel);\r\n    }\r\n\r\n    /**\r\n     * 修改购物车中产品数量 \r\n     * @param context \r\n     * @param value \r\n     * @param prev \r\n     */\r\n    onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data, parentData } = context;\r\n        let { product } = parentData;\r\n        let { pack, price, retail, currency } = data as CartPackRow;\r\n        let { cart } = this.cApp;\r\n        if (value > 0)\r\n            await cart.add(product, pack, value, price, retail, currency);\r\n        else\r\n            await cart.removeItem([{ productId: product.id, packId: pack.id }]);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param row \r\n     */\r\n    onRemoveCartItem = (row: any) => {\r\n        let { product, packs } = row;\r\n        let { cart } = this.cApp;\r\n        let packsToDeleted: any = [];\r\n        packs.forEach((each: any) => {\r\n            packsToDeleted.push({ productId: product.id, packId: each.pack.id });\r\n        });\r\n        cart.removeItem(packsToDeleted);\r\n    }\r\n\r\n    onRowStateChanged = async (context: RowContext, selected: boolean, deleted: boolean) => {\r\n        alert('onRowStateChanged')\r\n    }\r\n\r\n    /*\r\n    private loginCallback = async (user: User): Promise<void> => {\r\n        let { cApp } = this;\r\n        await cApp.currentUser.setUser(user);\r\n        await cApp.loginCallBack(user);\r\n        this.closePage(1);\r\n        await this.doFirstOrderChecking();\r\n    };\r\n    */\r\n\r\n    onItemClick = (cartItem: CartItem) => {\r\n        let { cart, cProduct } = this.cApp;\r\n        let { product } = cartItem;\r\n        if (!cart.isDeleted(product.id)) {\r\n            cProduct.showProductDetail(product.id);\r\n        }\r\n    }\r\n    /**\r\n     * 商品从购物车永久性删除\r\n     */\r\n    strikeOut = async () => {\r\n        let { cart } = this.cApp;\r\n        this.selectedCartItems = cart.getSelectedItems();\r\n        await cart.removeStrike(this.selectedCartItems)\r\n\r\n\r\n        // let combinedData = this.selectedCartItems.map((el: CartItem2) => {\r\n        //     return el.packs.map((v: any) => {\r\n        //         return {\r\n        //             productId: el.product, packId: v.pack\r\n        //         }\r\n        //     })\r\n        // }).flat();\r\n        // combinedData.forEach(async (el: any) => {\r\n        //     await cart.removeFromCart(el);\r\n        // })\r\n    }\r\n\r\n    checkOut = async () => {\r\n        let { cart } = this.cApp;\r\n        this.selectedCartItems = cart.getSelectedItems();\r\n        if (this.selectedCartItems === undefined) return;\r\n        /*\r\n        if (!this.isLogined) {\r\n            nav.showLogin(this.loginCallback, true);\r\n        } else {\r\n            await this.doFirstOrderChecking();\r\n        }\r\n        */\r\n        await this.cApp.assureLogin();\r\n        await this.doFirstOrderChecking();\r\n    }\r\n\r\n    private doFirstOrderChecking = async () => {\r\n        let { cMe, currentUser } = this.cApp;\r\n        if (!currentUser.allowOrdering) {\r\n            cMe.toPersonalAccountInfo(this.doCheckOut);\r\n            // cMe.openMeInfoFirstOrder({\r\n            //     onlyRequired: false,\r\n            //     caption: \"请补充账户信息\",\r\n            //     note: <>\r\n            //         化学品是受国家安全法规限制的特殊商品，百灵威提供技术咨询、资料以及化学产品的对象必须是具有化学管理和应用能力的专业单位（非个人）。\r\n            //     为此，需要您重新提供非虚拟的、可核查的信息。这些信息包括下面所有带有 <span className=\"text-danger\">*</span> 的信息。\r\n            //     </>,\r\n            //     actionButton: {\r\n            //         value: \"下一步\",\r\n            //         action: this.doCheckOut\r\n            //     }\r\n            // });\r\n        } else {\r\n            await this.doCheckOut();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 导航到CheckOut界面\r\n     */\r\n    doCheckOut = async () => {\r\n\r\n        let { cOrder } = this.cApp;\r\n        let { selectedCartItems } = this;\r\n        if (selectedCartItems === undefined) return;\r\n        await cOrder.createOrderFromCart(selectedCartItems);\r\n        // await cOrder.start(this.selectedCartItems);\r\n    }\r\n\r\n    //tab = () => this.renderView(VCart);\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderDeliveryTime(pack);\r\n    }\r\n\r\n    renderCartProduct = (product: Product) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderCartProduct(product);\r\n    }\r\n\r\n    tabPage: VCart = new VCart(this);\r\n}\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport function renderBrand(brand: any) {\r\n\tif (!brand) return;\r\n    return renderPropItem('品牌', brand.name);\r\n}\r\n\r\nexport function renderPropItem(caption: string, value: any, captionClass?: string) {\r\n    if (value === null || value === undefined || value === '0') return null;\r\n    let capClass = captionClass ? classNames(captionClass) : classNames(\"text-muted\");\r\n    let valClass = captionClass ? classNames(captionClass) : \"\";\r\n    return <>\r\n        <div className={classNames(\"col-6 col-sm-2 pr-0 small\", capClass)}> {caption}</div>\r\n        <div className={classNames(\"col-6 col-sm-4\", valClass)}>{value}</div>\r\n    </>;\r\n}\r\n\r\n/**\r\n * 产品未售提示UI\r\n */\r\nexport function renderUnsold(discountinued: number) {\r\n    if (discountinued && discountinued === 1)\r\n        return <div onClick={(e: any) => e.stopPropagation()} className='w-100 carousel-control-prev'><b className=\"alert-primary alert\">该产品已下架！</b></div>\r\n    else\r\n        return <></>\r\n}\r\n","import * as React from 'react';\r\nimport { View } from 'tonva';\r\nimport { CProduct } from '../CProduct';\r\nimport { observer } from 'mobx-react';\r\nimport { renderPropItem } from '../renders';\r\nimport { Product } from '../../model';\r\n\r\nexport class VChemicalInfoInCart extends View<CProduct> {\r\n    render(product: Product): JSX.Element {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {chemical} = product;\r\n\t\t\tif (!chemical) return;\r\n\t\t\tlet { purity, CAS, molecularFomula, molecularWeight } = chemical;\r\n\t\t\treturn <>\r\n\t\t\t\t{renderPropItem('CAS', CAS)}\r\n\t\t\t\t{renderPropItem('纯度', purity)}\r\n\t\t\t\t{renderPropItem('分子式', molecularFomula)}\r\n\t\t\t\t{renderPropItem('分子量', molecularWeight)}\r\n\t\t\t</>\r\n\t\t}));\r\n    }\r\n\r\n\t/*\r\n    private content = observer((param: any) => {\r\n\r\n        let { productId } = param;\r\n        let { chemicalInfoContainer } = this.controller;\r\n        let chemicalInfo = chemicalInfoContainer[productId];\r\n        if (chemicalInfo !== undefined) {\r\n            let { chemical, purity, CAS, molecularFomula, molecularWeight } = chemicalInfo;\r\n            return <>\r\n                {productPropItem('CAS', CAS)}\r\n                {productPropItem('纯度', purity)}\r\n                {productPropItem('分子式', molecularFomula)}\r\n                {productPropItem('分子量', molecularWeight)}\r\n            </>\r\n        }\r\n        return <></>;\r\n\t})\r\n\t*/\r\n}\r\n","import * as React from 'react';\r\nimport { View, FA } from 'tonva';\r\nimport { CProduct } from '../CProduct';\r\nimport { observer } from 'mobx-react';\r\nimport { Product } from '../../model';\r\n\r\nexport class VFavorite extends View<CProduct> {\r\n\t/*\r\n    @observable private isProductFarirates: boolean = false;\r\n    private favoriteOrCancel = async (product: number) => {\r\n        let { cApp } = this.controller;\r\n\t\tlet { cFavorites, cMe } = cApp;\r\n\t\tawait cApp.assureLogin();\r\n        //const { user } = nav;\r\n        //if (user !== undefined) {\r\n            if (this.isProductFarirates)\r\n                await cFavorites.delProductFavorites(product);\r\n            else\r\n                await cFavorites.addProductFavorites(product);\r\n            await this.initInventoryAllocation(product);\r\n        //} else {\r\n        //    cMe.showLogin();\r\n        //}\r\n    }\r\n\r\n    private isMyFarirates = async (id: number) => {\r\n        let { cFavorites } = this.controller.cApp;\r\n        // let customerFavoritesProducts = await cFavorites.getMyFavorites();\r\n        // return customerFavoritesProducts.some((el: any) => el.product.id === id);\r\n        return await cFavorites.getProductIsFavorites(id);\r\n    }\r\n\r\n    private initInventoryAllocation = async (id: number) => {\r\n        let { currentUser } = this.controller.cApp;\r\n        if (currentUser)\r\n            this.isProductFarirates = await this.isMyFarirates(id);\r\n    }\r\n\t*/\r\n    render(param: any): JSX.Element {\r\n        let { product, curPack } = param;\r\n    \treturn React.createElement(observer(() => {\r\n            let { favorite, favoriteOrCancel } = product as Product;\r\n\t\t\t//let { currentUser } = this.controller.cApp;\r\n\t\t\t//if (currentUser)\r\n\t\t\t//    this.initInventoryAllocation(productId);\r\n\t\t\tlet icon = favorite === true ? \"heart\" : 'heart-o';\r\n\t\t\tlet onClick = (evt: React.MouseEvent) => {\r\n\t\t\t\tevt.stopPropagation();\r\n\t\t\t\tfavoriteOrCancel();\r\n\t\t\t}\r\n\r\n\t\t\treturn <div className=\"d-flex justify-content-end\">\r\n\t\t\t\t<small onClick={onClick} style={{ zIndex: 9 }}>\r\n\t\t\t\t\t<FA className=\"mr-3 text-danger\" name={icon} size=\"lg\" />\r\n\t\t\t\t</small>\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { tv, View } from 'tonva';\r\nimport { CProduct } from '../CProduct';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VDelivery extends View<CProduct> {\r\n\t/*\r\n    @observable private inventoryAllocation: any[];\r\n    @observable private futureDeliveryTimeDescription: string;\r\n\t*/\r\n    render(param: any): JSX.Element {\r\n        let { id: packId } = param;\r\n        //let { obj: packObj } = param;\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\t//let { packId, productId } = param;\r\n            let { product } = this.controller;\r\n\t\t\tif (!product) return;\r\n\t\t\tlet {futureDeliveryTimeDescription} = product;\r\n            let inventoryAllocation = product.getInventoryAllocation(packId);\r\n\t\t\tif (!inventoryAllocation) return null;\r\n\t\t\tif (!futureDeliveryTimeDescription) return null;\r\n\r\n            \r\n\t\t\tif (inventoryAllocation.length === 0) {\r\n\t\t\t\tif (!futureDeliveryTimeDescription) return null;\r\n\t\t\t\treturn <div>{'期货: ' + futureDeliveryTimeDescription}</div>;\r\n\t\t\t}\r\n\t\t\treturn <>{inventoryAllocation.map((v, index) => {\r\n\t\t\t\tlet { warehouse, quantity, deliveryTimeDescription } = v;\r\n\t\t\t\tif (quantity > 0) {\r\n\t\t\t\t\treturn <div key={index} className=\"text-success\">\r\n\t\t\t\t\t\t{tv(warehouse, (values: any) => <span className=\"small\">{values.name}</span>)}: {(quantity > 10 ? '>10' : quantity)}\r\n\t\t\t\t\t\t{deliveryTimeDescription}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn undefined;\r\n\t\t\t\t}\r\n\t\t\t})}</>;\r\n\t\t}));\r\n    }\r\n\r\n\t/*\r\n    private initInventoryAllocation = async (productId: number, packId: number, salesRegionId: number) => {\r\n        if (this.inventoryAllocation === undefined)\r\n            this.inventoryAllocation = await this.controller.getInventoryAllocation(productId, packId, salesRegionId);\r\n    }\r\n\r\n    private initFutureDeliveryTimeDescription = async (productId: number, salesRegionId: number) => {\r\n        if (this.futureDeliveryTimeDescription === undefined)\r\n            this.futureDeliveryTimeDescription = await this.controller.getFutureDeliveryTimeDescription(productId, salesRegionId);\r\n\t}\r\n\r\n    private content = observer((param: any): any => {\r\n        let deliveryTimeUI;\r\n\t\tlet { packId, productId, currentSalesRegion } = param;\r\n        if (productId) {\r\n            this.initInventoryAllocation(productId, packId, currentSalesRegion);\r\n            this.initFutureDeliveryTimeDescription(productId, currentSalesRegion);\r\n        }\r\n        if (this.inventoryAllocation === undefined || this.futureDeliveryTimeDescription === undefined)\r\n\t\t\treturn null;\r\n\r\n        if (this.inventoryAllocation && this.inventoryAllocation.length > 0) {\r\n            deliveryTimeUI = this.inventoryAllocation.map((v, index) => {\r\n                let { warehouse, quantity, deliveryTimeDescription } = v;\r\n                if (quantity > 0) {\r\n                    return <div key={index} className=\"text-success\">\r\n                        {tv(warehouse, (values: any) => <span className=\"small\">{values.name}</span>)}: {(quantity > 10 ? '>10' : quantity)}\r\n                        {deliveryTimeDescription}\r\n                    </div>\r\n                } else {\r\n                    return undefined;\r\n                }\r\n            });\r\n        } else {\r\n            deliveryTimeUI = <div>{this.futureDeliveryTimeDescription && '期货: ' + this.futureDeliveryTimeDescription}</div>;\r\n        }\r\n\t\treturn deliveryTimeUI;\r\n\t})\r\n\t*/\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { View } from 'tonva';\r\nimport { CProduct } from '../CProduct';\r\nimport { ProductImage } from 'tools/productImage';\r\nimport {renderBrand, renderPropItem} from '../renders';\r\nimport { VChemicalInfoInCart } from './VChemicalInfo';\r\nimport { Product } from '../../model';\r\nimport { VFavorite } from './VFavorite';\r\n/*\r\nimport { VProductFavorateLabel } from 'customer/VProductFavorateLabel';\r\nimport { Link } from 'react-router-dom';\r\n*/\r\n\r\n/**\r\n *\r\n */\r\nexport class VProuductView extends View<CProduct> {\r\n    render(product: Product): JSX.Element {\r\n        return React.createElement(observer(() => {\r\n\t\t\tlet { brand, props } = product;\r\n\t\t\tlet { description, descriptionC, origin, imageUrl } = props;\r\n\t\t\treturn <div className=\"d-block mb-4 px-3\">\r\n\t\t\t\t<div className=\"d-flex py-2\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div><strong>{description}</strong></div>\r\n\t\t\t\t\t\t<div>{descriptionC}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>{this.renderVm(VFavorite, {product})}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t<div className=\"col-3\">\r\n\t\t\t\t\t\t<ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"col-9\">\r\n\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t\t{renderPropItem('产品编号', origin)}\r\n\t\t\t\t\t\t\t{this.renderVm(VChemicalInfoInCart, product) /*renderChemicalInfoInCart(productBox)*/}\r\n\t\t\t\t\t\t\t{renderBrand(brand)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n\r\n\t/*\r\n    private async getProudct(product: BoxId) {\r\n        if (this.product === undefined) {\r\n            let ret = await this.controller.getProductAndDiscount(product);\r\n            this.product = ret.product;\r\n            this.discount = ret.discount;\r\n        }\r\n\t}\r\n\t*/\r\n}\r\n","import * as React from 'react';\r\nimport { View, tv } from 'tonva';\r\nimport { CProduct } from '../CProduct';\r\nimport {renderBrand, renderPropItem} from '../renders';\r\nimport { ProductImage } from '../../tools/productImage';\r\nimport { VChemicalInfoInCart } from './VChemicalInfo';\r\nimport { Product } from 'model';\r\n\r\nexport class VInCart extends View<CProduct> {\r\n    render(param: any): JSX.Element {\r\n        return <>{tv(param, this.renderCartProduct)}</>;\r\n    }\r\n\r\n    private renderCartProduct = (product: any) => {\r\n        let { props, brand } = product;\r\n\t\t// if (!props) return;\r\n        let { description, descriptionC, origin, imageUrl } = props || product;\r\n        if (!brand.name) brand = brand.obj;\r\n\t\tlet cName:any;\r\n\t\tif (descriptionC !== description) {\r\n\t\t\tcName = <div className=\"pb-2\"><strong>{descriptionC}</strong></div>;\r\n        }\r\n        return <div className=\"row mx-0\">\r\n                    <div className=\"col-lg-3\">\r\n                        <ProductImage chemicalId={imageUrl} className=\"w-5c h-5c\" />\r\n                    </div>\r\n                    <div className=\"col-lg-9\">\r\n                        <div className=\"py-2 text-truncate\">\r\n                            <strong>{description}</strong>\r\n                        </div>\r\n                        {cName}\r\n                        <div className=\"row mx-0\">\r\n                            {renderPropItem('编号', origin)}\r\n                            {renderBrand(brand)}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n        // return <div className=\"row d-flex mb-3 px-2\">\r\n        //     <div className=\"col-12\">\r\n        //         <div className=\"py-2\">\r\n        //             <strong>{description}</strong>\r\n        //         </div>\r\n\t\t// \t\t{cName}\r\n        //         <div className=\"row\">\r\n        //             <div className=\"col-3\">\r\n        //                 <ProductImage chemicalId={imageUrl} className=\"w-4c h-4c\" />\r\n        //             </div>\r\n        //             <div className=\"col-9\">\r\n        //                 <div className=\"row\">\r\n        //                     {renderPropItem('编号', origin)}\r\n        //                     {this.renderVm(VChemicalInfoInCart, product) /*this.controller.renderChemicalInfoInCart(product)*/}\r\n        //                     {renderBrand(brand)}\r\n        //                 </div>\r\n        //             </div>\r\n        //         </div>\r\n        //     </div>\r\n        // </div>\r\n    };\r\n}\r\n","import * as React from 'react';\r\nimport { View, tv, ObjectSchema, NumSchema, UiSchema, UiCustom, Context, Form, ItemSchema } from 'tonva';\r\nimport { CProduct } from '../CProduct';\r\nimport { MinusPlusWidget } from 'tools';\r\nimport { Product } from 'model';\r\nimport { VFavorite } from './VFavorite';\r\nimport { observer } from 'mobx-react';\r\n\r\n/**\r\n * 显示产品包装价格，配合CProduct.renderProductPrice使用\r\n * 需要的参数product必须是BoxId(或者object?)\r\n */\r\nexport class VPrice extends View<CProduct> {\r\n    isShowTable: boolean = false;\r\n    private schema: ItemSchema[] = [\r\n        { name: 'pack', type: 'object' } as ObjectSchema,\r\n        { name: 'quantity', type: 'number' } as NumSchema,\r\n        { name: 'retail', type: 'number' } as NumSchema,\r\n        { name: 'vipPrice', type: 'number' } as NumSchema,\r\n        { name: 'promotionPrice', type: 'number' } as NumSchema,\r\n        { name: 'currency', type: 'string' },\r\n    ];\r\n\r\n\t/*\r\n    @observable private prices: any;\r\n    private initPrices = async (product: BoxId, salesRegionId: number, discount: number) => {\r\n        if (this.prices === undefined)\r\n            this.prices = await this.controller.getProductPrice(product, salesRegionId, discount);\r\n\t}\r\n\t*/\r\n\r\n    protected renderPrice(product:Product, item: any) {\r\n\t\tlet onQuantityChanged = async (context: Context, value: any, prev: any):Promise<void> => {\r\n\t\t\tlet { data } = context;\r\n\t\t\tlet { pack, retail, vipPrice, promotionPrice, currency } = data;\r\n\t\t\tlet price = this.minPrice(vipPrice, promotionPrice) || retail;\r\n\t\t\tlet { cApp } = this.controller;\r\n\t\t\tlet { cart } = cApp;\r\n\t\t\tif (value > 0)\r\n\t\t\t\tawait cart.add(product, pack, value, price, retail, currency);\r\n\t\t\telse\r\n\t\t\t\tawait cart.removeItem([{ productId: product.id, packId: pack.id }]);\r\n\t\t}\r\n\r\n\t\tlet uiSchema: UiSchema = {\r\n\t\t\titems: {\r\n\t\t\t\tpack: { visible: false },\r\n\t\t\t\tretail: { visible: false },\r\n\t\t\t\tvipPrice: { visible: false },\r\n\t\t\t\tpromotionPrice: { visible: false },\r\n\t\t\t\tcurrency: { visible: false },\r\n\t\t\t\tquantity: {\r\n\t\t\t\t\twidget: 'custom',\r\n\t\t\t\t\tlabel: null,\r\n\t\t\t\t\tclassName: 'text-center',\r\n\t\t\t\t\tWidgetClass: MinusPlusWidget,\r\n\t\t\t\t\tonChanged: onQuantityChanged\r\n\t\t\t\t} as UiCustom\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n        let { retail, vipPrice, promotionPrice } = item;\r\n        let right = null;\r\n        if (retail) {\r\n            let price: number = this.minPrice(vipPrice, promotionPrice);\r\n            let retailUI: any;\r\n            if (price) {\r\n                retailUI = <small className=\"text-muted\"><del>¥{retail}</del></small>;\r\n            }\r\n            else {\r\n                price = retail;\r\n            }\r\n            right = <div className=\"row\">\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                    <small className=\"text-muted\">{retailUI}</small>&nbsp; &nbsp;\r\n                    <span className=\"text-danger\">¥ <span className=\"h5\">{price}</span></span>\r\n                </div>\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                    <Form schema={this.schema} uiSchema={uiSchema} formData={item} />\r\n                </div>\r\n            </div >\r\n\r\n            if (this.isShowTable) \r\n                right = <>\r\n                <td className=\"align-middle\">\r\n                    <small className=\"text-muted\">{retailUI}</small>&nbsp; &nbsp;\r\n                    <span className=\"text-danger\">¥ <span className=\"h5\">{price}</span></span>\r\n                </td>\r\n                <td className=\"align-middle\">\r\n                    <div className=\"d-flex justify-content-center mt-2\">\r\n                        <Form schema={this.schema} uiSchema={uiSchema} formData={item} />\r\n                    </div>\r\n                </td>\r\n            </ >\r\n        } else {\r\n            right = <small>请询价</small>\r\n            if (this.isShowTable) right = <><td className=\"py-3\">请询价</td><td></td></>;\r\n        }\r\n        return right;\r\n    }\r\n\r\n    private minPrice(vipPrice: any, promotionPrice: any) {\r\n        if (vipPrice || promotionPrice)\r\n            return Math.min(typeof (vipPrice) === 'number' ? vipPrice : Infinity, typeof (promotionPrice) === 'number' ? promotionPrice : Infinity);\r\n    }\r\n\r\n    render(product: Product): JSX.Element {\r\n        //let { currentSalesRegion } = this.controller.cApp;\r\n        //return <this.content product={product} SalesRegionId={currentSalesRegion} discount={discount} />;\r\n        let { renderDeliveryTime } = this.controller;\r\n\t\t//this.initPrices(product, SalesRegionId, discount);\r\n\t\tlet {prices} = product;\r\n\t\treturn <>{prices?.map((v: any, index: number) => {\r\n\t\t\tlet { pack, retail } = v;\r\n\t\t\tif (!retail) return <small key={0}>请询价</small>;\r\n\t\t\treturn <div className=\"px-2\" key={pack.id}>\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t<div className=\"col-6\">\r\n\t\t\t\t\t\t<div><b>{tv(pack)}</b></div>\r\n\t\t\t\t\t\t<div>{renderDeliveryTime(pack)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"col-6\">\r\n\t\t\t\t\t\t{this.renderPrice(product, v)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t})}</>;\r\n\t\t/*\r\n        return <>\r\n            {priceUI}\r\n\t\t</>;\r\n\t\t*/\r\n    }\r\n\r\n\t/*\r\n    private content = observer((param?: any) => {\r\n        let priceUI;\r\n        let { product, SalesRegionId, discount } = param;\r\n\r\n        let { renderDeliveryTime } = this.controller;\r\n        this.initPrices(product, SalesRegionId, discount);\r\n        if (this.prices && this.prices.length > 0) {\r\n            priceUI = this.prices.map((v: any, index: number) => {\r\n                let { pack, retail } = v;\r\n                if (retail) {\r\n                    return <div className=\"px-2\" key={pack.id}>\r\n                        <div className=\"row\">\r\n                            <div className=\"col-6\">\r\n                                <div><b>{tv(pack)}</b></div>\r\n                                <div>{renderDeliveryTime(pack)}</div>\r\n                            </div>\r\n                            <div className=\"col-6\">\r\n                                {this.renderPrice(v)}\r\n                            </div>\r\n                        </div>\r\n                    </div>;\r\n                } else {\r\n                    return <small>请询价</small>\r\n                }\r\n            });\r\n        }\r\n        return <>\r\n            {priceUI}\r\n        </>;\r\n\t})\r\n\t*/\r\n}\r\n\r\n\r\nexport class VPriceWithTr extends VPrice {\r\n    isShowTable: boolean = true;\r\n\r\n    render(product: Product): JSX.Element {\r\n\t\tlet {prices} = product;\r\n        return React.createElement(observer(() => {\r\n            return  <>{prices?.map((v: any, index: number) => {\r\n                let { pack, retail } = v;\r\n                return <tr className=\"px-2 text-center\" key={pack.id}>\r\n                    <td className=\"align-middle\"><b>{tv(pack)}</b></td>\r\n                    {this.renderPrice(product, v)}\r\n                    {/* {retail\r\n                        ? <td className=\"align-middle\"><span className=\"d-flex justify-content-center\">{this.renderVm(VFavorite, { product, curPack: v })}</span></td>\r\n                        : <td></td>\r\n                    } */}\r\n                </tr>;\r\n            })}</>;\r\n        }))\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { BoxId, tv, View } from 'tonva';\r\nimport { CProduct } from '../CProduct';\r\nimport { ProductImage } from 'tools/productImage';\r\nimport { observer } from 'mobx-react';\r\n//import { observable } from 'mobx';\r\nimport {renderBrand, renderPropItem, renderUnsold} from '../renders';\r\nimport { Product } from '../../model';\r\nimport { VFavorite } from './VFavorite';\r\nimport { VPrice, VPriceWithTr } from './VPrice';\r\n\r\nexport class VProuductView2 extends View<CProduct> {\r\n    // @observable product: any;\r\n    // @observable discount: number;\r\n    render(product: any): JSX.Element {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet { brand, chemical, props } = product;\r\n\t\t\tlet { description, descriptionC, origin, imageUrl, id } = props;\r\n\t\t\tlet discountinued = 0;\r\n\t\t\tlet { CAS, purity, molecularFomula, molecularWeight } = chemical || {};\r\n\t\t\tlet eName = <div className=\"mr-3\"><strong>{description}</strong></div>;\r\n\t\t\tlet cName:any;\r\n\t\t\tif (descriptionC !== description) {\r\n\t\t\t\tcName = <div>{descriptionC}</div>;\r\n\t\t\t}\r\n\t\t\timageUrl = imageUrl || props.chemical.toString();\r\n\t\t\treturn <div className=\"row mx-0 my-3 bg-white\">\r\n\t\t\t\t<div className=\"col-lg-4 product-left-card d-flex\">\r\n\t\t\t\t\t<ProductImage chemicalId={imageUrl} className=\"mx-auto\" style={{maxHeight:192}} />\r\n\t\t\t\t\t{/* <ProductImage chemicalId={imageUrl} className=\"w-100\" /> */}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"col-lg-8 each-product\">\r\n\t\t\t\t\t<div className=\"details\">\r\n\t\t\t\t\t\t{eName}\r\n\t\t\t\t\t\t{cName}\r\n\t\t\t\t\t\t<div>{this.renderVm(VFavorite, {product})}</div>\r\n\t\t\t\t\t\t<div className=\"row p-0\">\r\n\t\t\t\t\t\t\t{renderPropItem('产品编号', origin)}\r\n\t\t\t\t\t\t\t{renderPropItem('CAS', CAS ||  props.CAS)}\r\n\t\t\t\t\t\t\t{renderPropItem('纯度',purity || props.purity)}\r\n\t\t\t\t\t\t\t{renderPropItem('分子式',molecularFomula || props.molecularFomula)}\r\n\t\t\t\t\t\t\t{renderPropItem('分子量',molecularWeight || props.molecularWeight)}\r\n\t\t\t\t\t\t\t{renderBrand(brand)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{  !this.controller.showFavorites &&\r\n\t\t\t\t\t\t<a className=\"button display-desktop collapsed\" data-toggle=\"collapse\" href={`#description${id}`} role=\"button\" aria-expanded=\"false\" aria-controls=\"jk\" target=\"_blank\"\r\n\t\t\t\t\t\t\tonClick={(event: React.MouseEvent) => { event.stopPropagation();}}>详情\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"container collapse col-lg-12 pt-2 px-0 border-top-0\"\r\n\t\t\t\t\tonClick={(event: React.MouseEvent) => { event.stopPropagation();}} id={`description${id}`}>\r\n\t\t\t\t\t<table id=\"table\" className=\"table article-product-table table-striped\">\r\n\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t<tr className=\"article-product-list\">\r\n\t\t\t\t\t\t\t\t<th>包装</th>\r\n\t\t\t\t\t\t\t\t<th>价格</th>\r\n\t\t\t\t\t\t\t\t<th>数量</th>\r\n\t\t\t\t\t\t\t\t{/* <th>收藏夹</th> */}\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<>{ this.renderVm(VPriceWithTr,product)}</>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t// return <div className=\"d-block mb-4 px-3 bg-white\">\r\n\t\t\t// \t<div className=\"py-2\">\r\n\t\t\t// \t\t{eName}\r\n\t\t\t// \t\t{cName}\r\n\t\t\t// \t\t<div>{this.renderVm(VFavorite, product)}</div>\r\n\t\t\t// \t</div>\r\n\t\t\t// \t<div className=\"row\">\r\n\t\t\t// \t\t<div className=\"col-3\">\r\n\t\t\t// \t\t\t<ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n\t\t\t// \t\t</div>\r\n\t\t\t// \t\t<div className=\"col-9\">\r\n\t\t\t// \t\t\t<div className=\"row\">\r\n\t\t\t// \t\t\t\t{renderPropItem('产品编号', origin)}\r\n\t\t\t// \t\t\t\t{renderPropItem('CAS', CAS)}\r\n\t\t\t// \t\t\t\t{renderPropItem('纯度', purity)}\r\n\t\t\t// \t\t\t\t{renderPropItem('分子式', molecularFomula)}\r\n\t\t\t// \t\t\t\t{renderPropItem('分子量', molecularWeight)}\r\n\t\t\t// \t\t\t\t{renderBrand(brand) /*tv(brand, renderBrand)*/ /* 这个地方会在调试器报警告 */}\r\n\t\t\t// \t\t\t</div>\r\n\t\t\t// \t\t</div>\r\n\t\t\t// \t</div>\r\n\t\t\t// \t{renderUnsold(discountinued)}\r\n\t\t\t// </div>\r\n\t\t}));\r\n\t}\r\n}\r\n\r\n/**\r\n * 收藏列表（有收藏与取消功能）\r\n */\r\n/* export class VProductCarryFavorites extends View<CProduct>{\r\n    render(param: any): JSX.Element {\r\n        let { product } = param;\r\n        return <div className='position-relative'>\r\n            {renderProduct(product)}\r\n            <div className='position-absolute' style={{ top: 20, right: -10 }}>\r\n                {this.renderVm(VProductFavorateLabel, product.id)}\r\n            </div>\r\n        </div>\r\n    }\r\n} */\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { View } from 'tonva';\r\nimport { CProduct } from '../CProduct';\r\nimport { ProductImage } from 'tools/productImage';\r\nimport { renderBrand, renderPropItem } from '../renders';\r\nimport { Product } from '../../model';\r\nimport { VChemicalInfoInCart } from './VChemicalInfo';\r\nimport { VPrice } from './VPrice';\r\n\r\n\r\nexport class VProductWithPrice extends View<CProduct> {\r\n\t/*\r\n    @observable product: any;\r\n    @observable discount: number;\r\n\r\n    private async getProudct(product: BoxId) {\r\n        if (this.product === undefined) {\r\n            let ret = await this.controller.getProductAndDiscount(product);\r\n            this.product = ret.product;\r\n            this.discount = ret.discount;\r\n        }\r\n    }\r\n\t*/\r\n    render(product: Product): JSX.Element {\r\n        return React.createElement(observer(() => {\r\n\t\t\tlet { brand, props } = product;\r\n\t\t\tlet { description, descriptionC, origin, imageUrl } = props;\r\n\t\t\treturn <div className=\"d-block mb-2 px-3\">\r\n\t\t\t\t<div className=\"py-2\">\r\n\t\t\t\t\t<div><strong>{description}</strong></div>\r\n\t\t\t\t\t<div>{descriptionC}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row py-2\">\r\n\t\t\t\t\t<div className=\"col-3\">\r\n\t\t\t\t\t\t<ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"col-9\">\r\n\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t\t{renderPropItem('产品编号', origin)}\r\n\t\t\t\t\t\t\t{this.renderVm(VChemicalInfoInCart, product)}\r\n\t\t\t\t\t\t\t{renderBrand(brand)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"border-top pt-2\">\r\n\t\t\t\t\t{this.renderVm(VPrice, product) /*renderProductPrice(product, discount)*/}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t}));\r\n\t}\r\n    /*\r\n    render(product: BoxId): JSX.Element {\r\n        let { renderProduct, renderProductPrice } = this.controller;\r\n        return <div className=\"d-flex flex-column\">\r\n            <div>{renderProduct(product)}</div>\r\n            <div className=\"p-2 border-top\">{renderProductPrice(product, 1)}</div>\r\n        </div>\r\n    }\r\n    */\r\n}\r\n\r\n/**\r\n * 显示产品信息（不包含包装价格），特定于参数包含相关的CAS/Purity等信息），现应用于产品列表\r\n * @param product\r\n */\r\n/* export function renderProduct(product: any) {\r\n    let { brand, description, descriptionC, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl, discountinued } = product;\r\n    return <div className=\"d-block mb-4 px-3 bg-white\">\r\n        <div className=\"py-2\">\r\n            <div className=\"mr-3\"><strong>{description}</strong></div>\r\n            <div>{descriptionC}</div>\r\n        </div>\r\n        <div className=\"row\">\r\n            <div className=\"col-3\">\r\n                <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n            </div>\r\n            <div className=\"col-9\">\r\n                <div className=\"row\">\r\n                    {productPropItem('产品编号', origin)}\r\n                    {productPropItem('CAS', CAS)}\r\n                    {productPropItem('纯度', purity)}\r\n                    {productPropItem('分子式', molecularFomula)}\r\n                    {productPropItem('分子量', molecularWeight)}\r\n                    {tv(brand, renderBrand)}\r\n                </div>\r\n            </div>\r\n        </div>\r\n        {unsoldProductsUI(discountinued)}\r\n    </div>\r\n} */\r\n","export function randomColor() {\r\n    let arr = ['#ad2031', '#239ab7', '#80a040', '#811f63', '#1B12AC'];\r\n    let i = Math.floor(Math.random() * arr.length);\r\n    return arr[i];\r\n    // return '#' + Math.random().toString(16).substr(-6);\r\n}","import * as React from 'react';\r\nimport { VPage, Page, LMR, FA, tv, List, autoHideTips } from 'tonva';\r\nimport { CPointProduct, OrderSource } from './CPointProduct';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { observable } from 'mobx';\r\nimport { PointProductImage } from 'tools/productImage';\r\nimport { randomColor } from 'tools/randomColor';\r\nimport { pointIcon } from 'tools/images';\r\n\r\nexport class VExchangeOrder extends VPage<CPointProduct> {\r\n\t//@observable protected shippingAddressIsBlank: boolean = false;\r\n\tprotected shippingAddressIsBlank = observable.box<boolean>();\r\n    protected pageDesc: string = OrderSource.EXCHANGEORDER;\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private nullContact = () => {\r\n        return <span className=\"text-primary\">选择收货地址</span>;\r\n    }\r\n\r\n    protected renderPointProduct = (pointProduct: any) => {\r\n        let { product, quantity } = pointProduct;\r\n\t\tif (quantity <= 0) return;\r\n\t\tlet style:React.CSSProperties = { border:`2px solid ${randomColor()}` };\r\n\t\t// let style:React.CSSProperties = { height: '35vw',border:`2px solid ${randomColor()}` };\r\n\t\treturn tv(product, (v) => {\r\n\t\t\treturn <div className=\"w-100 d-flex flex-column mb-4\">{/* 20vh  */}\r\n\t\t\t\t<div title={v.description} className=\"w-100 z-height\" style={style} >\r\n\t\t\t\t\t<PointProductImage chemicalId={v.imageUrl} className=\"w-100 h-100\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"small w-100\">\r\n\t\t\t\t\t<div className=\"text-truncate w-100 my-1\">{v.descriptionC}</div>\r\n\t\t\t\t\t<div className=\"d-flex justify-content-between\">\r\n\t\t\t\t\t\t{/*  <div>\r\n\t\t\t\t\t\t\t<FA name='database' className=\"text-warning\" />\r\n\t\t\t\t\t\t\t<span className=\"text-danger h5\"> {point}</span>\r\n\t\t\t\t\t\t</div> */}\r\n\t\t\t\t\t\t<div className='d-flex'>\r\n\t\t\t\t\t\t\t<img src={pointIcon} alt=\"\" style={{ height: 24 }} />\r\n\t\t\t\t\t\t\t<span className=\"text-danger h5 m-0 ml-1 align-self-end\"> {v.point}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>*{quantity}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t});\r\n    }\r\n\r\n    protected onSubmitOwn = async () => {\r\n        let { submitOrder } = this.controller;\r\n        await submitOrder();\r\n    }\r\n\r\n    protected onSubmit = async () => {\r\n        let { orderData, cApp } = this.controller;\r\n        let { cLottery } = cApp;\r\n        // 必填项验证\r\n        let { shippingContact } = this.pageDesc === OrderSource.EXCHANGEORDER ? orderData : cLottery.prizeOrderData;\r\n        if (!shippingContact) {\r\n            this.shippingAddressIsBlank.set(true);\r\n            //setTimeout(() => this.shippingAddressIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n        await this.onSubmitOwn();\r\n    }\r\n\r\n\t/*\r\n    protected renderTipsUI = () => {\r\n        let chevronRight = <FA name=\"chevron-right\" className=\"cursor-pointer\" />\r\n        let shippingAddressBlankTip = this.shippingAddressIsBlank ?\r\n            <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写收货地址</div>\r\n            : null;\r\n        return {\r\n            chevronRight,\r\n            shippingAddressBlankTip\r\n        }\r\n\t}\r\n\t*/\r\n\r\n    protected renderContact = () => {\r\n        //let { chevronRight, shippingAddressBlankTip } = this.renderTipsUI();\r\n        let { orderData, onSelectShippingContact, cApp } = this.controller;\r\n        let data = this.pageDesc === OrderSource.EXCHANGEORDER ? orderData.shippingContact : cApp.cLottery.prizeOrderData.shippingContact;\r\n        return <div className=\"px-2\">\r\n            <div className=\"row py-3 bg-white mb-1\" onClick={() => onSelectShippingContact()}>\r\n                <div className=\"col-3 text-muted pr-0\">收货地址:</div>\r\n                <div className=\"col-9\">\r\n\t\t\t\t\t<LMR className=\"w-100 align-items-center\"\r\n\t\t\t\t\t\tright={<FA name=\"chevron-right\" className=\"cursor-pointer\" />}>\r\n\t\t\t\t\t\t{tv(data, undefined, undefined, this.nullContact)}\r\n\t\t\t\t\t</LMR>\r\n                    {/*shippingAddressBlankTip*/}\r\n\t\t\t\t\t{autoHideTips(this.shippingAddressIsBlank, ()=><div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写收货地址</div>)}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    protected page = observer(() => {\r\n        let { pointProductsSelected, pointToExchanging: pointsSum } = this.controller;\r\n        let header = <div className=\"w-100 text-center\">兑换确认</div>;\r\n        let footer = <div className=\"d-block\">\r\n            <div className=\"w-100 px-3 d-flex justify-content-between\">\r\n                <div>总计:<span className=\"text-danger ml-2 mr-1 h2\" >{pointsSum}</span>分</div>\r\n                <button type=\"button\" className=\"btn btn-danger m-1\" onClick={this.onSubmit}>确认兑换</button>\r\n            </div>\r\n        </div>;\r\n\r\n        return <Page header={header} right={<></>} footer={footer}>\r\n            {this.renderContact()}\r\n            <List items={pointProductsSelected} item={{\r\n                render: this.renderPointProduct,\r\n                className: 'col-6 col-md-4 col-lg-3 px-3 bg-transparent'\r\n                // className: 'w-50 px-3'\r\n            }}\r\n                className=\"row mx-0 mt-2 bg-transparent\"\r\n                // className=\"d-flex flex-wrap bg-transparent mt-2\"\r\n            ></List>\r\n        </Page>\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 领取奖品页面\r\n */\r\nexport class VMyPrizeExchangeOrder extends VExchangeOrder {\r\n    //@observable shippingAddressIsBlank: boolean = false;\r\n    protected pageDesc: string = OrderSource.PRIZEORDER;\r\n\r\n    renderPointProduct = (pointProduct: any) => {\r\n        return <div>11111</div>\r\n    }\r\n\r\n    /*  protected onSubmitOwn = async () => {\r\n         let { cLottery } = this.controller.cApp;\r\n         await cLottery.submitOrder();\r\n     } */\r\n\r\n    protected page = observer(() => {\r\n        let { cApp } = this.controller;\r\n        let { cLottery } = cApp;\r\n        let footer = <div className=\"d-block\">\r\n            <div className=\"w-100 px-3 d-flex justify-content-end\">\r\n                <button type=\"button\" className=\"btn btn-danger m-1\" onClick={this.onSubmit}>确认领取</button>\r\n            </div>\r\n        </div>;\r\n\r\n        return <Page header=\"奖品领取预览\" footer={footer}>\r\n            {this.renderContact()}\r\n            <List items={cLottery.myPrizeLib} item={{ render: this.renderPointProduct }}\r\n\r\n            ></List>\r\n        </Page>\r\n    })\r\n}","import * as React from 'react';\r\nimport { xsOrIpad, xs } from './browser';\r\n\r\n\r\nexport function pageHTitle(title:any) {\r\n    if (!xsOrIpad)  return <div className=\"text-center mt-5\"><h1>{title}</h1></div>;\r\n    return null;\r\n}\r\n\r\nexport function CrPageHeaderTitle(title:string) {\r\n    if (xs) return title;\r\n    return '';\r\n}","import * as React from 'react';\r\nimport { Page } from 'tonva';\r\nimport { CrPageHeaderTitle, pageHTitle } from 'tools/pageHeaderTitle';\r\nimport { xs } from '../tools/browser';\r\n\r\nexport class VPointRule extends React.Component {\r\n\r\n    render() {\r\n         let header = CrPageHeaderTitle('积分规则');\r\n        return <Page header={header}>\r\n            {pageHTitle('积分规则')}\r\n            <div className='bg-white p-2 mx-auto' style={{maxWidth: !xs ? 800 :'none'}}>\r\n                {/* <ol className=\"mb-3\">\r\n                    <li>订购产品满1元积1分（活动期间积分按活动规则执行），积分按消费额累计；付款后，积分变为有效积分，可以使用；</li>\r\n                    <li>特价产品、产业型产品等不产生积分；</li>\r\n                    <li>积分有效期为自然年三年，过期作废（示例：2010年1-12月份产生的积分在2012年12月31日作废清零，以此类推）；</li>\r\n                    <li>积分目前仅限兑换百灵威积分商城中的产品使用，不兑换现金；</li>\r\n                    <li>此积分政策只针对百灵威终端客户，经销商等不产生积分；</li>\r\n                </ol> */}\r\n                <div className=\" text-muted small\">\r\n                    <p className=\"m-0 pb-1\"><b>1，订购产品满1元积1分（活动期间积分按活动规则执行），积分按消费额累计；付款后，积分变为有效积分，可以使用；</b></p>\r\n                    <p className=\"m-0 pb-1\"><b>2，特价产品、产业型产品等不产生积分；</b></p>\r\n                    <p className=\"m-0 pb-1\"><b>3，积分有效期为自然年三年，过期作废（示例：2010年1-12月份产生的积分在2012年12月31日作废清零，以此类推）；</b></p>\r\n                    <p className=\"m-0 pb-1\"><b>4，积分目前仅限兑换百灵威积分商城中的产品使用，不兑换现金；</b></p>\r\n                    <p><b>5，此积分政策只针对百灵威终端客户，经销商等不产生积分；</b></p>\r\n                </div >\r\n                <div className=\"text-muted small py-2\">\r\n                    <p>百灵威保留本积分活动中条款的解释权利，并有根据需要取消本活动或增删、修订本规定的权利，并于百灵威官网、邮件、报纸或其他途径公告后生效。</p>\r\n                    <p>如有疑问，请致电百灵威客服中心：400-666-7788</p>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n","export const RevenueExpenditure = {\r\n    POINTHISTORY: '收支明细',\r\n    SIGNINHISTORY: '签到明细',\r\n}","import * as React from 'react';\r\nimport { VPage, Page, nav, List, FA, DropdownActions, DropdownAction, EasyDate, tv } from \"tonva\";\r\nimport { CPointProduct, PointProductDetailLevel, topicClump } from \"./CPointProduct\";\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPointRule } from './VPointRule';\r\nimport { PointProductImage } from 'tools/productImage';\r\nimport classNames from 'classnames';\r\nimport { logo_pointShop, signInIcon, exChangeIcon, homeTopicMap, triangleShadingO, triangleShadingT } from 'tools/images';\r\nimport { RevenueExpenditure } from './basicRefer';\r\nimport { randomColor } from 'tools/randomColor';\r\nimport { CrPageHeaderTitle, pageHTitle } from 'tools/pageHeaderTitle';\r\nimport { xs } from '../tools/browser';\r\n\r\nexport class VMyPoint extends VPage<CPointProduct> {\r\n\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    /**\r\n     * 积分规则页面\r\n     */\r\n    private pointRules = () => nav.push(<VPointRule />);\r\n\r\n    /* 积分详情页面 \r\n    private getPointHistory = async () => {\r\n        this.controller.pointDetails();\r\n    }*/\r\n\r\n    private pointblock = (name: any, action: any, icon: any, width?: any) => {\r\n        return <div className={`text-center mx-2 mb-2 ${width}`} onClick={() => action()}>\r\n            <img src={icon} alt=\"\" className=\"w-2c h-2c\" />\r\n            <div className={`text-light small`}>{name}</div>\r\n        </div>\r\n    }\r\n\r\n    private recommendOrHot = (name: string, more: any, toWhere: any, theme?: string, imgArr?: any, action?: any) => {\r\n        let pointProductImage = (pointProduct: any, index: any) => {            \r\n            let { product } = pointProduct;\r\n            let clm = index !== 0 ? (index === 1 ? 'justify-content-center' : 'justify-content-end') : '';\r\n            return <div className={`d-flex align-items-center ${clm}`}>{tv(product, (v) => {\r\n                    return <PointProductImage chemicalId={v.imageUrl} className=\"bg-transparent p-0 z-height-more\" style={{width:'91.6%',border:`2px solid ${randomColor()}`}} />\r\n                    // return <PointProductImage chemicalId={v.imageUrl} className=\"bg-transparent p-0\" style={{width:'91.6%',height:'23vw',border:`2px solid ${randomColor()}`}} />\r\n                 })\r\n            }</div>\r\n        }\r\n        return <div className=\"mb-4\" style={{ zIndex: 9 }}>\r\n            <h6 className='d-flex justify-content-between align-content-end bg-transparent '>\r\n                <small className={classNames(theme ? theme : '', 'align-self-end')} style={{ color: theme ? theme : '' }}>{name}</small>\r\n                <span style={{ color: '#808080' }} className=\"pl-2\" onClick={() => more(name)} ><small >更多 </small><FA name='angle-right' /></span>\r\n            </h6>\r\n            <List\r\n                className=\"row mx-0 bg-transparent justify-content-between\"\r\n                // className=\"d-flex w-100 bg-transparent justify-content-between\"\r\n                items={imgArr.slice(0, 3)}\r\n                item={{\r\n                    render:pointProductImage, //(v: any) => <PointProductImage chemicalId={v.imageUrl ? v.imageUrl : '1'} className=\"w-100 px-1 bg-transparent\" style={{border:`2px solid ${randomColor()}`}} />,\r\n                    onClick: (v) => toWhere(v,PointProductDetailLevel.DIRECT),\r\n                    className: \"col-4 p-0 bg-transparent\"\r\n                }}\r\n                none='暂无产品' />\r\n        </div>\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { myEffectivePoints, myPointTobeExpired, myTotalPoints, pointProductGenre, newPointProducts, hotPointProducts,\r\n            openExchangeHistory, openRevenueExpenditure, openPointProduct, openPointProductDetail, cApp } = this.controller;\r\n        let { openPointSign } = cApp.cSignIn;\r\n        var date = new Date();\r\n        let dateYear = date.getFullYear();\r\n\r\n        let nowPoint = myPointTobeExpired;\r\n        let nowPointTip = nowPoint > 0 ?\r\n            <div className=\"alert alert-warning py-0 w-100 small rounded-0 m-0\" role=\"alert\">\r\n                <span className=\"text-muted\">友情提示: 将有{nowPoint}积分于{dateYear}-12-31过期</span>\r\n            </div>\r\n            : null;\r\n\r\n        let actions: DropdownAction[] = [\r\n            {\r\n                icon: 'get-pocket',\r\n                caption: RevenueExpenditure.POINTHISTORY,\r\n                action: () => openRevenueExpenditure(RevenueExpenditure.POINTHISTORY)\r\n            },\r\n            {\r\n                icon: 'history',\r\n                caption: '兑换记录',\r\n                action: openExchangeHistory\r\n            },\r\n            {\r\n                icon: 'book',\r\n                caption: '积分规则',\r\n                action: this.pointRules\r\n            }\r\n        ];\r\n        let right = <DropdownActions className=\"align-self-center mr-1 bg-transparent border-0 text-light\" icon=\"navicon\" actions={actions} />;\r\n\r\n        let none = <div className=\"mt-4 text-secondary d-flex justify-content-center\">『 无任何类型 』</div>\r\n        let header = CrPageHeaderTitle('积分商城');\r\n        if (!xs) right = null;\r\n        return <Page header={header} right={right} className=\"h-100 bg-white\">\r\n            <div className=\"row mx-0 mt-1\">\r\n                <div className=\"col-lg-3 d-none d-lg-block\">\r\n                    {this.controller.cApp.cMe.renderMeSideBar()}\r\n                </div>\r\n                <div className=\"col-lg-9 px-1\">\r\n                    {pageHTitle(<div className=\"text-left\">积分商城</div>)}\r\n                    {renderDropdownActions(actions)}\r\n                    <div>\r\n                        <div className=\"d-flex flex-column pb-4 w-100\" style={{ background: `url(${homeTopicMap}) no-repeat`, backgroundSize: 'cover' }}>{/* cover contain */}\r\n                            <>{nowPointTip}</>\r\n                            <img src={logo_pointShop} alt=\"img\" className=\"w-8c mt-4 ml-4 mb-3\" />\r\n                            < div className=\"d-flex mx-3 mt-2 ml-4 text-light justify-content-between\" >\r\n                                <div>\r\n                                    <div><small>当前</small> <span className=\"h5\">{myEffectivePoints}</span> <small>分可用</small></div>\r\n                                    <div className=\"mt-2\">{myTotalPoints > 0 ? <small>总分: {myTotalPoints}</small> : null}</div>\r\n                                </div>\r\n                                <div className=\"d-flex justify-content-end mt-1\" style={{ flex: 1 }}>\r\n                                    {this.pointblock(\"签到\", openPointSign, signInIcon)}\r\n                                    {this.pointblock(\"兑换\", openPointProduct, exChangeIcon)}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"pt-3\">\r\n                        {/* 产品类别 */}\r\n                        {\r\n                            pointProductGenre.length\r\n                                ? <div>\r\n                                    {/* style={{ background: `url(${triangleShadingO}) no-repeat scroll bottom right`, backgroundSize: '10%', }} */}\r\n                                    <List className=\"d-flex flex-wrap pt-2 text-center px-2 bg-transparent justify-content-between\"\r\n                                        items={pointProductGenre}\r\n                                        item={{ render: this.renderGenreItem, onClick: (v) => openPointProduct(v), className: 'w-25 bg-transparent' }} none={none} />\r\n                                    <p className=\"d-flex m-0 justify-content-end pr-1\"><img src={triangleShadingO} alt=\"\" className=\"h-3c\" /></p>\r\n                                </div>\r\n                                : null\r\n                        }\r\n                        {/* 新品推荐 热门产品 */}\r\n                        <div className='mb-2 px-4 bg-transparent position-relative' style={{ background: `url(${triangleShadingT}) no-repeat 2% 50% `, backgroundSize: '38px' }}>\r\n                            {newPointProducts.length ? this.recommendOrHot(topicClump.newRecommend, openPointProduct, openPointProductDetail, undefined, newPointProducts) : null}\r\n                            {hotPointProducts.length ? this.recommendOrHot(topicClump.hotProduct, openPointProduct, openPointProductDetail, undefined, hotPointProducts) : null}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"d-none d-lg-block py-md-5 my-md-5\"></div>\r\n                </div>\r\n            </div>\r\n        </Page >;\r\n    });\r\n\r\n    private renderGenreItem = (item: any) => {\r\n        let { name, imageUrl } = item;\r\n        return <div>\r\n            <label className=\"w-100 d-flex flex-column justify-content-center\">\r\n                {\r\n                    imageUrl\r\n                        ? <div className=\"m-auto\"><PointProductImage chemicalId={imageUrl ? imageUrl : ':0-0268.png'} className=\"w-2c\" /></div>\r\n                        // ? <div className=\"w-25 m-auto\"><PointProductImage chemicalId={imageUrl ? imageUrl : ':0-0268.png'} className=\"w-100\" /></div>\r\n                        : <FA name=\"leaf\" className='mt-2 text-success mb-2' size='lg' />\r\n                }\r\n                <div className='text-dark small'>{name}</div>\r\n            </label>\r\n        </div>\r\n    }\r\n}\r\n\r\nexport function renderPointRecord(item: any) {\r\n    let { comments, point, date } = item;\r\n    return <div className=\"d-flex w-100 justify-content-between align-content-center small px-3 py-2\">\r\n        <div>\r\n            <div className=\"text-muted\">{comments}</div>\r\n            <div className=\"text-muted small\"><EasyDate date={date} /></div>\r\n        </div>\r\n        <div className=\"d-table h-100\">\r\n            <div className=\"font-weight-bolder h-100 d-table-cell align-middle text-danger\">{point >= 0 ? '+' : ''}{point}</div>\r\n        </div>\r\n    </div>\r\n}\r\n\r\nexport function renderDropdownActions(actions: any) {\r\n    if (xs) return null;\r\n    return <div className=\"row mx-0 justify-content-end mb-2\">\r\n        {actions.map((v: any,index:number) => {\r\n            return <div className='m-1 cursor-pointer' key={index} onClick={v.action}>\r\n                <FA name={v.icon} className=\"text-info\"></FA>\r\n                <span> {v.caption}</span>\r\n            </div>\r\n        })}\r\n    </div>\r\n}","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { CSelectContact } from './CSelectContact';\r\nimport { List, LMR, FA } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { xs, xsOrIpad } from '../tools/browser';\r\nimport classNames from 'classnames';\r\nimport { Modal } from 'antd';\r\nconst { confirm } = Modal;\r\n\r\nexport class VContactList extends VPage<CSelectContact> {\r\n    async open() {\r\n\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onContactRender = (contact: any) => {\r\n        let { onEditContact, onContactSelected, delContact} = this.controller;\r\n        let right = <>\r\n            {\r\n                !xsOrIpad && <div className=\"p-2 cursor-pointer text-info\" onClick={() => this.onDelContact(contact)}>\r\n                    <FA name=\"trash-o\" />\r\n                </div>\r\n            }\r\n            <div className=\"p-2 cursor-pointer text-info\" onClick={() => onEditContact(contact)}>\r\n                <FA name=\"edit\" />\r\n            </div>\r\n        </>;\r\n        return <LMR right={right} className=\"px-3 py-2\">\r\n            <div onClick={() => onContactSelected(contact)}>\r\n                {tv(contact)}\r\n            </div>\r\n        </LMR>\r\n    }\r\n\r\n    private onDelContact = async (contact:any) => {\r\n        let {  delContact} = this.controller;\r\n        confirm({\r\n            title: <div className=\"text-center pb-2 h5\">提示</div>,\r\n            content: '是否删除该地址？',\r\n            okText: '删除地址',\r\n            okType: 'danger',\r\n            cancelText: '取消',\r\n            style:{top: '35%'},\r\n            onOk() { delContact(contact);},\r\n            onCancel() {},\r\n        });\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { onNewContact, userContacts } = this.controller;\r\n        let footer = <div className=\"d-flex justify-content-center\">\r\n            <button type=\"button\" className={classNames(\"btn btn-primary\", !xs ? 'w-25' : ' w-100')} onClick={() => onNewContact()} >新增地址</button>\r\n        </div>;\r\n        let contactList = <List items={userContacts} item={{ render: this.onContactRender }} none=\"无地址\" />;\r\n        let header: any, title = '地址管理';\r\n        if (xsOrIpad) header = title;\r\n        return <Page footer={footer} header={header}>\r\n            <div className=\"row mx-0\">\r\n                <div className=\"col-lg-3 d-none d-lg-block\">\r\n                    {this.controller.cApp.cMe.renderMeSideBar()}\r\n                </div>\r\n                <div className=\"col-lg-9 px-0 mx-auto\" style={{maxWidth: !xs ? 600 :'none'}}>\r\n                    {!xsOrIpad && <div className=\"text-left mt-5 px-3\"><h1>{title}</h1></div>}\r\n                    {contactList}\r\n                </div>\r\n            </div>\r\n        </Page>\r\n    })\r\n\r\n\r\n    render(param?: any): JSX.Element {\r\n        let { userContacts } = this.controller.cApp.cSelectShippingContact;\r\n        let footer = <button className=\"btn btn-primary mt-2 mx-auto w-50\"\r\n            onClick={() => {\r\n                this.controller.cApp.cOrder.modalTitle = 'contactInfo';\r\n                this.controller.cApp.cOrder.editContact = undefined;\r\n            }} >添加新地址</button>;\r\n        let contactList = <List items={userContacts} item={{ render: this.onContactRender }} className=\"h-max-20c overflow-auto border-bottom scroll-S\" none=\"无地址\" />;\r\n    \treturn React.createElement(observer(() => {\r\n            return <div className=\"d-flex flex-column px-2\">\r\n                {contactList}\r\n                {footer}\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n}","\r\nexport function telephoneValidation(value: string) {\r\n    if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n        return \"固定电话格式不正确，请重新输入！\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function mobileValidation(value: string) {\r\n    if (value && !/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(value))\r\n        return \"手机号格式不正确，请重新输入！\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function emailValidation(value: string) {\r\n    if (value && !/\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/.test(value))\r\n        return \"Email格式不正确，请重新输入！\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function faxValidation(value: string) {\r\n    if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n        return \"传真号码格式不正确，请重新输入！\";\r\n    else\r\n        return undefined;\r\n}\r\n\r\nexport function addressDetailValidation(value: string) {\r\n    return (value && value.length > 200) ? \"详细地址最多200个字！\" : undefined;\r\n}\r\n\r\nexport function zipCodeValidation(value: string) {\r\n    return (value && value.length > 15) ? \"邮编过长，请修改后录入！\" : undefined;\r\n}\r\n\r\n\r\nexport function organizationNameValidation(value: string) {\r\n    return (value && value.length > 100) ? \"单位名称最多100个字！\" : undefined;\r\n}\r\n\r\nexport function departmentNameValidation(value: string) {\r\n    return (value && value.length > 100) ? \"部门名称名称最多100个字！\" : undefined;\r\n}\r\n\r\nexport function salutationValidation(value: string) {\r\n    return (value && value.length > 100) ? \"单位名称最多100个字！\" : undefined;\r\n}\r\n\r\nexport function nameValidation(value: string) {\r\n    return (value && value.length > 50) ? \"姓名最多50个字！\" : undefined;\r\n}","import * as React from 'react';\r\nimport _ from 'lodash';\r\nimport { VPage, Page, Form, Schema, UiSchema, Context, UiInputItem, UiIdItem, BoxId } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { CSelectContact } from './CSelectContact';\r\nimport { addressDetailValidation, emailValidation, telephoneValidation, mobileValidation, organizationNameValidation, nameValidation } from 'tools/inputValidations';\r\nimport { observer } from 'mobx-react';\r\nimport { xsOrIpad } from '../tools/browser';\r\nimport { pageHTitle } from 'tools/pageHeaderTitle';\r\nimport classNames from 'classnames';\r\nimport triangle from 'images/triangle.svg';\r\n\r\nconst schema: Schema = [\r\n    { name: 'id', type: 'id', required: false },\r\n    { name: 'name', type: 'string', required: true },\r\n    { name: 'organizationName', type: 'string', required: true },\r\n    { name: 'mobile', type: 'string', required: true },\r\n    { name: 'telephone', type: 'string', required: false },\r\n    { name: 'email', type: 'string', required: false },\r\n    { name: 'address', type: 'id', required: true },\r\n    { name: 'addressString', type: 'string', required: true },\r\n    { name: 'isDefault', type: 'boolean', required: false },\r\n];\r\n\r\nexport class VContact extends VPage<CSelectContact> {\r\n\r\n    private userContactData: any;\r\n    private form: Form;\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            id: { visible: false },\r\n            name: { widget: 'text', label: '姓名', placeholder: '姓名', rules: nameValidation } as UiInputItem,\r\n            organizationName: { widget: 'text', label: '单位名称', placeholder: '单位名称', rules: organizationNameValidation } as UiInputItem,\r\n            mobile: { widget: 'text', label: '手机号', placeholder: '手机号', rules: mobileValidation } as UiInputItem,\r\n            telephone: { widget: 'text', label: '电话', placeholder: '电话', rules: telephoneValidation } as UiInputItem,\r\n            email: { widget: 'email', label: 'Email', placeholder: 'Email', rules: emailValidation } as UiInputItem,\r\n            address: {\r\n                widget: 'id', label: '所在地区', placeholder: '所在地区',\r\n                pickId: async (context: Context, name: string, value: number) => await this.controller.pickAddress(context, name, value),\r\n                Templet: (address: BoxId) => {\r\n                    return tv(address, (addressValue) => {\r\n                        let { country, province, city, county } = addressValue;\r\n                        /* 下面这种在使用tv之前的一堆判断应该是tv或者什么的有bug, 应该让Henry改改 */\r\n                        return <div className=\"text-truncate\">\r\n                            {country && country.id && tv(country, v => <>{v.chineseName}</>)}\r\n                            {province && province.id && tv(province, (v) => <>{v.chineseName}</>)}\r\n                            {city && city.id && tv(city, (v) => <>{v.chineseName}</>)}\r\n                            {county && county.id && tv(county, (v) => <>{v.chineseName}</>)}\r\n                        </div>;\r\n                    }, () => {\r\n                        return <small className=\"text-muted\">请选择地区</small>;\r\n                    })\r\n                }\r\n            } as UiIdItem,\r\n            addressString: { widget: 'text', label: '详细地址', placeholder: '详细地址', className: \"text-truncate\", rules: addressDetailValidation } as UiInputItem,\r\n            isDefault: { widget: 'checkbox', label: '作为默认地址' },\r\n            submit: { widget: 'button', label: '提交' },\r\n        }\r\n    }\r\n\r\n    async open(userContactData: any) {\r\n        this.userContactData = userContactData;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private onSaveContact = async () => {\r\n        if (!this.form) return;\r\n        await this.form.buttonClick(\"submit\");\r\n    }\r\n\r\n    private onFormButtonClick = async (name: string, context: Context) => {\r\n        await this.controller.saveContact(context.form.data);\r\n        // await this.controller.cApp.cSelectShippingContact.saveContact(context.form.data);\r\n    }\r\n\r\n    private onDelContact = async () => {\r\n        let { contact } = this.userContactData;\r\n        if (await this.vCall(VConfirmDeleteContact, contact) === true) {\r\n            await this.controller.delContact(contact);\r\n            this.closePage();\r\n        };\r\n    }\r\n    \r\n    ContactDataP = () => {\r\n        let { defaultOrganizationName, defaultName, defaultMobile, address, addressString } = this.controller.cApp.currentUser;\r\n        return {\r\n            'organizationName': defaultOrganizationName,\r\n            'name': defaultName,\r\n            'mobile': defaultMobile,\r\n            'address': address,\r\n            'addressString': addressString\r\n        };\r\n    }\r\n    saveButton = (isSave?: boolean) => {\r\n        let btnContent: string;\r\n        if (isSave === undefined || !isSave) {\r\n            let { fromOrderCreation } = this.controller;\r\n            btnContent = fromOrderCreation ? '保存并使用' : '保存';\r\n        } else {\r\n            btnContent = '保存并使用';\r\n        };\r\n        return <button type=\"button\" className=\"btn btn-primary w-100\" onClick={this.onSaveContact}>{btnContent}</button>\r\n    }\r\n\r\n    private page = () => {\r\n        let contactData = _.clone(this.userContactData.contact);\r\n        let titleH:string= `${contactData !== undefined ?  \"编辑\" :'添加'}地址`;\r\n        let buttonDel: any;\r\n        if (contactData !== undefined) {\r\n            buttonDel = <button className=\"btn btn-sm btn-info\" onClick={this.onDelContact}>删除</button>;\r\n        } else {\r\n            contactData = this.ContactDataP();\r\n        };\r\n        let footer = <div className={classNames(!xsOrIpad ? 'w-25 mx-auto' : '')}>\r\n            {this.saveButton()}\r\n        </div>;\r\n        let header: any;\r\n        if (xsOrIpad) {\r\n            header = titleH;\r\n        } else {\r\n            buttonDel = null;\r\n        }\r\n        return <Page header={header} footer={footer} right={buttonDel}>\r\n            <div className=\"App-container container text-left position-relative\">\r\n                {pageHTitle(titleH)}\r\n                <div className=\"postion-img\" style={{left:-\"-200%\",top:200}}>\r\n                    <img src={triangle} />\r\n                </div>\r\n                <Form ref={v => this.form = v} className={classNames(\"my-3\",!xsOrIpad ? 'w-50 mx-auto' :'')}\r\n                    schema={schema}\r\n                    uiSchema={this.uiSchema}\r\n                    formData={contactData}\r\n                    onButtonClick={this.onFormButtonClick}\r\n                    fieldLabelSize={3} />\r\n            </div>\r\n        </Page>\r\n    }\r\n\r\n    render(param?: any): JSX.Element {\r\n        this.userContactData = param;\r\n        let contactData = _.clone(this.userContactData.contact);\r\n        if (contactData === undefined) contactData = this.ContactDataP();\r\n        let footer = this.saveButton(true);\r\n        /* 选择后的地址无法渲染  存在问题 后续处理  完成后处理保存问题 */\r\n        /* if (this.controller.cApp.cSelectShippingContact.TIT) {\r\n            let itemsAddress = this.uiSchema.items.address as UiIdItem;\r\n            itemsAddress = {\r\n                ...itemsAddress,\r\n                pickId:async (context: Context, name: string, value: number) => await this.controller.pickAddress(context, name, value),\r\n            }\r\n        } */\r\n        return React.createElement(observer(() => {\r\n            return <div className=\"App-container container text-left\" >\r\n                <Form ref={v => this.form = v} className=\"my-3 w-min-30c h-max-20c overflow-auto scroll-S\"\r\n                    schema={schema}\r\n                    uiSchema={this.uiSchema}\r\n                    formData={contactData}\r\n                    onButtonClick={this.onFormButtonClick}\r\n                fieldLabelSize={3} />\r\n            {footer}\r\n            </div>\r\n\t\t}));\r\n\t}\r\n}\r\n\r\nexport class VConfirmDeleteContact extends VPage<CSelectContact> {\r\n    async open(contact: any) {\r\n        this.openPage(this.page, contact);\r\n    }\r\n\r\n    private onConfirm = async () => {\r\n        await this.returnCall(true);\r\n        this.closePage();\r\n    }\r\n\r\n    private onCancel = async () => {\r\n        await this.returnCall(false);\r\n        this.closePage();\r\n    }\r\n\r\n    private page = (contact: any) => {\r\n        return <Page header=\"删除地址\" back=\"close\">\r\n            <div className=\"w-75 mx-auto border border-primary rounded my-3 p-3 bg-white\">\r\n                <div className=\"p-4 position-relative\">\r\n                    <i className=\"fa fa-question-circle position-absolute fa-2x text-warning\" style={{ left: 0, top: 0 }} />\r\n                    <b className=\"\">是否删除该地址？</b>\r\n                </div>\r\n                <div className=\"d-flex mt-3 justify-content-end\">\r\n                    <button className=\"btn btn-danger mr-3\" onClick={this.onConfirm}>删除地址</button>\r\n                    <button className=\"btn btn-outline-info mr-3\" onClick={this.onCancel}>取消</button>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page, BoxId } from 'tonva';\r\nimport { tv } from 'tonva';\r\nimport { FA } from 'tonva';\r\nimport { CAddress } from './CAddress';\r\nimport { GLOABLE } from 'global';\r\nimport { observer } from 'mobx-react';\r\nimport { xsOrIpad } from '../tools/browser';\r\nimport { pageHTitle } from 'tools/pageHeaderTitle';\r\n\r\nexport class VAddress extends VPage<CAddress> {\r\n    protected provinceId: number;\r\n    protected cityId: number;\r\n    protected countyId: number;\r\n    protected backLevel = 0;\r\n\r\n    async open(param: any) {\r\n        let provinces = await this.controller.getCountryProvince(GLOABLE.CHINA);\r\n        this.openPage(this.page, { provinces: provinces });\r\n    }\r\n\r\n    private page = (param: any) => {\r\n        this.backLevel++;\r\n        let header = this.titleHeader('选择所在省市');\r\n        return <Page header={header}>\r\n            <>\r\n                {pageHTitle('选择所在省市')}\r\n                <div className=\"row no-gutters pb-5\">\r\n                    {param.provinces.map((v: any) => this.renderPCC(v.province, this.onProvinceClick))}\r\n                </div>\r\n            </>\r\n        </Page>\r\n    }\r\n\r\n    titleHeader = (title:string) => {\r\n        if (xsOrIpad) return title;\r\n        return '';\r\n    }\r\n\r\n    renderPCC = (pcc: BoxId, onClick: any) => {\r\n        return <div key={pcc.id} className=\"col-6 col-md-4 col-lg-3 cursor-pointer\">\r\n            {tv(pcc, (value) => {\r\n                let { id, chineseName } = value;\r\n                return <>\r\n                    <div className=\"pt-1 pb-1 px-2\" onClick={() => onClick(id)}\r\n                        style={{ border: '1px solid #eeeeee', marginRight: '-1px', marginBottom: '-1px' }}\r\n                    >\r\n                        <span className=\"ml-1 align-middle\">\r\n                            <FA name=\"chevron-right\" className=\"text-info small\" />\r\n                            &nbsp; {chineseName}\r\n                        </span>\r\n                    </div>\r\n                </>;\r\n            })}\r\n        </div>\r\n    }\r\n\r\n    onProvinceClick = async (provinceId: any) => {\r\n        this.provinceId = provinceId;\r\n        let cities = await this.controller.getProvinceCities(provinceId);\r\n        if (cities) {\r\n            let len = cities.length;\r\n            if (len === 1) {\r\n                await this.onCityClick(cities[0].city.id);\r\n                return;\r\n            }\r\n            if (len > 1) {\r\n                this.backLevel++;\r\n                let header = this.titleHeader('选择所在城市');\r\n                this.openPageElement(<Page header={header}>\r\n                    <>\r\n                        {pageHTitle('选择所在城市')}\r\n                        <div className=\"row no-gutters pb-5\">\r\n                            {cities.map(v => this.renderPCC(v.city, this.onCityClick))}\r\n                        </div>\r\n                    </>\r\n                </Page>);\r\n                return;\r\n            }\r\n        } else {\r\n            this.closePage(this.backLevel);\r\n            this.saveAddress();\r\n        }\r\n    }\r\n\r\n    onCityClick = async (cityId: any) => {\r\n        this.cityId = cityId;\r\n        let counties = await this.controller.getCityCounties(cityId);\r\n        if (counties && counties.length > 0) {\r\n            this.backLevel++;\r\n            let header = this.titleHeader('选择所在区县');\r\n            this.openPageElement(<Page header={header}>\r\n                <>\r\n                    {pageHTitle('选择所在区县')}\r\n                    <div className=\"row no-gutters pb-5\">\r\n                        {counties.map(v => this.renderPCC(v.county, this.onCountyClick))}\r\n                    </div>\r\n                </>\r\n            </Page>);\r\n        } else {\r\n            this.closePage(this.backLevel);\r\n            this.saveAddress();\r\n        }\r\n    }\r\n\r\n    onCountyClick = async (countyId: any) => {\r\n        this.countyId = countyId;\r\n        this.closePage(this.backLevel);\r\n        this.saveAddress();\r\n    }\r\n\r\n    saveAddress = async () => {\r\n        await this.controller.saveAddress(GLOABLE.CHINA, this.provinceId, this.cityId, this.countyId);\r\n        // await this.controller.cApp.cAddress.saveAddress(GLOABLE.CHINA, this.provinceId, this.cityId, this.countyId);\r\n    }\r\n}\r\n\r\n\r\nexport class VAddressRW extends VAddress {\r\n    onProvinceClick = async (provinceId: any) => {\r\n        this.provinceId = provinceId;\r\n        let cities = await this.controller.cApp.cAddress.getProvinceCities(provinceId);\r\n        if (cities) {\r\n            let { cOrder } = this.controller.cApp;\r\n            let len = cities.length;\r\n            if (len === 1) {\r\n                cOrder.modalTitleS['countyChoice'].preLevel = 'provinceChoice';\r\n                await this.onCityClick(cities[0].city.id);\r\n                return;\r\n            }\r\n            if (len > 1) {\r\n                this.backLevel++;\r\n                cOrder.cities = cities;\r\n                cOrder.modalTitle = 'cityChoice';\r\n                cOrder.modalTitleS['countyChoice'].preLevel = 'cityChoice';\r\n                return;\r\n            }\r\n        } else {\r\n            this.saveAddress();\r\n        }\r\n    }\r\n\r\n    onCityClick = async (cityId: any) => {\r\n        this.cityId = cityId;\r\n        let counties = await this.controller.cApp.cAddress.getCityCounties(cityId);\r\n        if (counties && counties.length > 0) {\r\n            this.backLevel++;\r\n            this.controller.cApp.cOrder.counties = counties;\r\n            this.controller.cApp.cOrder.modalTitle = 'countyChoice';\r\n        } else {\r\n            this.saveAddress();\r\n        }\r\n    }\r\n\r\n    onCountyClick = async (countyId: any) => {\r\n        this.countyId = countyId;\r\n        this.saveAddress();\r\n    }\r\n\r\n    saveAddress = async () => {\r\n        await this.controller.cApp.cOrder.saveAddress(GLOABLE.CHINA, this.provinceId, this.cityId, this.countyId);\r\n    }\r\n}\r\n\r\nexport class VProvince extends VAddressRW{\r\n    render(param?: any): JSX.Element {\r\n        return <div className=\"row no-gutters\">\r\n                {param.provinces.map((v: any) => this.renderPCC(v.province, this.onProvinceClick))}\r\n            </div>\r\n    }\r\n}\r\n\r\nexport class VCity extends VAddressRW{\r\n    render(param?: any): JSX.Element {\r\n        return React.createElement(observer(() => {\r\n            return <div className=\"row no-gutters\">\r\n                {param?.cities.map((v:any) => this.renderPCC(v.city, this.onCityClick))}\r\n            </div>\r\n        }))\r\n    }\r\n}\r\n\r\nexport class VCounty extends VAddressRW{\r\n    render(param?: any): JSX.Element {\r\n        return React.createElement(observer(() => {\r\n            return <div className=\"row no-gutters\">\r\n                {param?.counties.map((v: any) => this.renderPCC(v.county, this.onCountyClick))}\r\n            </div>\r\n        }))\r\n    }\r\n}","import { VAddress } from './VAddress';\r\nimport { CUqBase } from '../tapp/CBase';\r\n\r\nexport class CAddress extends CUqBase {\r\n    protected async internalStart() {\r\n        this.openVPage(VAddress);\r\n    }\r\n\r\n    getCountryProvince = async (countryId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetCountryProvinces.table({ country: countryId });\r\n    }\r\n\r\n    getProvinceCities = async (provinceId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetProvinceCities.table({ province: provinceId });\r\n    }\r\n\r\n    getCityCounties = async (cityId: number): Promise<any[]> => {\r\n        return await this.uqs.common.GetCityCounties.table({ city: cityId });\r\n    }\r\n\r\n    saveAddress = async (countryId: number, provinceId: number, cityId?: number, countyId?: number): Promise<any> => {\r\n        let { Address } = this.uqs.common;\r\n        let newAddress = await Address.save(undefined, { country: countryId, province: provinceId, city: cityId, county: countyId });\r\n        let addressId = newAddress && Address.boxId(newAddress.id);\r\n        this.returnCall(addressId);\r\n    }\r\n}\r\n","import { observable } from 'mobx';\r\nimport { Context, BoxId } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VContactList } from './VContactList';\r\nimport { VContact } from './VContact';\r\nimport { CAddress } from './CAddress';\r\n\r\nexport abstract class CSelectContact extends CUqBase {\r\n    fromOrderCreation: boolean;\r\n\r\n    @observable userContacts: BoxId[] = [];\r\n\r\n    async internalStart(fromOrderCreation: boolean/*contactType: ContactType*/) {\r\n        this.fromOrderCreation = fromOrderCreation;\r\n        let userContactMaps = await this.cApp.currentUser.getContacts();\r\n        this.userContacts = userContactMaps.map((v: any) => v.contact);\r\n        this.openVPage(VContactList);\r\n        if (this.fromOrderCreation && (!this.userContacts || this.userContacts.length === 0)) {\r\n            this.onNewContact();\r\n        }\r\n    }\r\n\r\n     protected abstract getIsDefault(userSetting: any, userContactId: number): Promise<boolean>;\r\n\r\n    /**\r\n     * 打开地址新建界面\r\n     */\r\n    onNewContact = async () => {\r\n        this.openVPage(VContact, { contact: undefined });\r\n    }\r\n\r\n    /**\r\n     * 打开地址编辑界面\r\n     */\r\n    onEditContact = async (userContact: BoxId) => {\r\n        let userContactId = userContact.id;\r\n        let contact = await this.uqs.customer.Contact.load(userContactId);\r\n        let userSetting = await this.cApp.currentUser.getSetting();\r\n        contact.isDefault = await this.getIsDefault(userSetting, userContactId);\r\n        let userContactData: any = { contact: contact };\r\n        this.openVPage(VContact, userContactData);\r\n    }\r\n\r\n    delContact = async (contact: any) => {\r\n        let { id } = contact;\r\n        if (contact.isDefault === undefined) {\r\n            let userSetting = await this.cApp.currentUser.getSetting();\r\n            contact.isDefault = await this.getIsDefault(userSetting, id);\r\n        }\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.delContact(id);\r\n        if (contact.isDefault) {\r\n            this.setDefaultContact(undefined);\r\n        }\r\n        let index = this.userContacts.findIndex(v => v.id === id);\r\n        if (index > -1)\r\n            this.userContacts.splice(index, 1);\r\n    }\r\n\r\n    saveContact = async (contact: any) => {\r\n        let contactBox = await this.saveContactData(contact);\r\n        this.backPage();\r\n        if (this.fromOrderCreation) {\r\n            this.onContactSelected(contactBox);\r\n        }\r\n        /* let { Contact: contactTuid } = this.uqs.customer;\r\n        let newContact = await contactTuid.save(undefined, contact);\r\n        let { id: newContactId } = newContact;\r\n        let contactBox = contactTuid.boxId(newContactId);\r\n\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.addContact(newContactId);\r\n        this.userContacts.push(contactBox);\r\n        let { id, isDefault } = contact;\r\n        if (isDefault === true || this.userContacts.length === 1) {\r\n            await this.setDefaultContact(contactBox);\r\n        }\r\n        // contact.id !== undefined表示是修改了已有的contact(我们只能用“替换”表示“修改”，所以此时需要删除原contact)\r\n        if (id !== undefined) {\r\n            await currentUser.delContact(id);\r\n            let index = this.userContacts.findIndex(v => v.id === id);\r\n            if (index > -1)\r\n                this.userContacts.splice(index, 1);\r\n        }\r\n        this.backPage();\r\n        if (this.fromOrderCreation) {\r\n            this.onContactSelected(contactBox);\r\n        } */\r\n    }\r\n\r\n    saveContactData = async (contact: any) => {\r\n        let { Contact: contactTuid } = this.uqs.customer;\r\n        let newContact = await contactTuid.save(undefined, contact);\r\n        let { id: newContactId } = newContact;\r\n        let contactBox = contactTuid.boxId(newContactId);\r\n\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.addContact(newContactId);\r\n        this.userContacts.push(contactBox);\r\n        let { id, isDefault } = contact;\r\n        if (isDefault === true || this.userContacts.length === 1) {\r\n            await this.setDefaultContact(contactBox);\r\n        };\r\n        // contact.id !== undefined表示是修改了已有的contact(我们只能用“替换”表示“修改”，所以此时需要删除原contact)\r\n        if (id !== undefined) {\r\n            await currentUser.delContact(id);\r\n            let index = this.userContacts.findIndex(v => v.id === id);\r\n            if (index > -1)\r\n                this.userContacts.splice(index, 1);\r\n        };\r\n        return contactBox;\r\n    }\r\n\r\n    protected abstract setDefaultContact(contactId: BoxId): Promise<any>;\r\n\r\n    onContactSelected = (contact: BoxId) => {\r\n        if (this.fromOrderCreation) {\r\n            this.backPage();\r\n            this.returnCall(contact);\r\n        }\r\n    }\r\n\r\n    pickAddress = async (context: Context, name: string, value: number): Promise<number> => {\r\n        let cAddress = this.newC(CAddress); // new CAddress(this.cApp, undefined);\r\n        return await cAddress.call<number>();\r\n    }\r\n\r\n    getContactList = async () => {\r\n        let userContactMaps = await this.cApp.currentUser.getContacts();\r\n        this.userContacts = userContactMaps.map((v: any) => v.contact);\r\n    }\r\n}\r\n\r\nexport class CSelectShippingContact extends CSelectContact {\r\n    @observable TIT: boolean = false;\r\n    protected async getIsDefault(userSetting: any, userContactId: number): Promise<boolean> {\r\n        if (userSetting !== undefined) {\r\n            let { shippingContact } = userSetting;\r\n            return shippingContact && shippingContact.id === userContactId;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected async setDefaultContact(contactId: BoxId) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultShippingContact(contactId);\r\n    }\r\n}\r\n\r\nexport class CSelectInvoiceContact extends CSelectContact {\r\n    protected async getIsDefault(userSetting: any, userContactId: number): Promise<boolean> {\r\n        if (userSetting !== undefined) {\r\n            let { invoiceContact } = userSetting;\r\n            return invoiceContact && invoiceContact.id === userContactId;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected async setDefaultContact(contactId: BoxId) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultInvoiceContact(contactId);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\n\r\nexport class OrderSuccess extends VPage<CPointProduct> {\r\n\r\n    async open(orderCreateResult: any) {\r\n        this.openPage(this.page, orderCreateResult);\r\n    }\r\n\r\n    private page = (orderCreateResult: any) => {\r\n        return <Page header=\"兑换成功\" back=\"close\">\r\n            <div className=\"p-3 bg-white mb-3\">\r\n                <div className=\"mb-3\">兑换成功，感谢您对百灵威的厚爱！</div>\r\n                <p className=\"\">\r\n                    订单: <span className=\"h5 text-info\">{orderCreateResult.no}</span><br /><br />\r\n                    我们将立刻处理您的订单，请注意查收到货短信。\r\n                </p>\r\n            </div>\r\n        </Page>\r\n    }\r\n}","import { BoxId } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\n\r\nexport class pointOrder {\r\n\r\n    webUser: any;   // OK\r\n    organization: BoxId;\r\n    customer: any;  //OK\r\n    salesRegion: BoxId;   // OK\r\n\r\n    @observable shippingContact: BoxId; //OK\r\n    @observable exchangeItems: OrderItem[] = [];\r\n\r\n    @computed get amount() {\r\n        return this.exchangeItems.reduce((pv, cv) => (pv + cv.subAmount), 0);\r\n    };\r\n\r\n    getDataForSave() {\r\n        let exchangeItems: any[] = [];\r\n        this.exchangeItems.forEach(oi => {\r\n            exchangeItems.push({\r\n                product: oi.product, point: oi.point, quantity: oi.quantity //, pack: oi.pack,\r\n                , subAmount: oi.quantity * oi.point\r\n            })\r\n        });\r\n        return {\r\n            webUser: this.webUser,\r\n            organization: this.organization,\r\n            customer: this.customer,\r\n            shippingContact: this.shippingContact,\r\n            amount: this.amount,\r\n            exchangeitems: exchangeItems, // 前面的必须是小写的\r\n            salesRegion: this.salesRegion\r\n        }\r\n    }\r\n}\r\n\r\nexport class OrderItem {\r\n    product: BoxId;\r\n    @observable pack: BoxId;\r\n    @observable quantity: any;\r\n    @observable point: any;\r\n    @computed get subAmount() {\r\n        return this.quantity * this.point;\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, EasyDate } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\nimport { tv, List } from 'tonva';\r\nimport { OrderItem } from './pointOrder';\r\nimport { PointProductImage } from 'tools/productImage';\r\nimport { xs } from 'tools/browser';\r\n\r\nexport class VExchangeHistoryDetail extends VPage<CPointProduct> {\r\n\r\n    async open(order: any) {\r\n\r\n        this.openPage(this.page, order);\r\n    }\r\n\r\n    private renderexchangeItem = (orderItem: OrderItem) => {\r\n        let { product, pack, quantity, point } = orderItem;\r\n        return <>\r\n            {tv(product, (v) => {\r\n                return <div className=\"row m-1 w-100\">\r\n                    <div title={v.description} className=\"col-4 m-0 p-0\"><PointProductImage chemicalId={v.imageUrl} className=\"w-100\"  /></div>\r\n                    <div className=\"col-8 small\">\r\n                        <div><label>{v.descriptionC}</label></div>\r\n                        <div className=\"d-flex justify-content-between my-3\">\r\n                            <div className=\"mt-1\"><b>{pack ? <>{tv(pack, (c) => <>{c.radioy}{c.unit}</>)}</> : v.grade}</b></div>\r\n                            <div>\r\n                                <span className=\"text-danger h6\">{(point * quantity)}</span>\r\n                                <small className=\"text-muted\">分 ({point} × {quantity})</small>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            })}\r\n        </>;\r\n    }\r\n\r\n    private page = (order: any) => {\r\n        let { brief, data } = order;\r\n        let { no, date } = brief;\r\n        let { exchangeItems, shippingContact, amount } = data;\r\n\r\n        let header:any = <>订单详情: {no}</>\r\n        if (!xs) header = '';\r\n        return <Page header={header}>\r\n            { !xs && <div className=\"alert alert-info alert-signin mt-3\">订单编号 <a href=\"#\" className=\"alert-link\">{no}</a></div>}\r\n            <List items={exchangeItems} item={{ render: this.renderexchangeItem }} />\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">收货地址:</div>\r\n                <div className=\"col-9\">{tv(shippingContact)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">下单时间:</div>\r\n                <div className=\"col-9 text-right\"><EasyDate date={date} /></div>\r\n            </div>\r\n            <div className=\"bg-white p-3 my-1 text-right\">\r\n                <span className=\"text-danger font-weight-bold\">总积分: {amount}</span>\r\n            </div>\r\n        </Page>\r\n    }\r\n}\r\n","import { observer } from 'mobx-react';\r\nimport * as React from 'react';\r\n\r\nexport interface PColumnsItem{\r\n    id: number,\r\n    name:string,\r\n}\r\n\r\nexport interface PListTableProps{\r\n    columns: PColumnsItem[],\r\n    content?: any,\r\n}\r\n\r\nexport class ListTable extends React.Component<PListTableProps>{\r\n    constructor(props:any) {\r\n        super(props);\r\n    }\r\n\r\n    render() {\r\n        let { columns, content } = this.props;\r\n        return  React.createElement(observer(() => {\r\n            return <div className=\"tab-pane fade show active mt-3\" id=\"nav-order-1\" role=\"tabpanel\">\r\n\t\t\t\t<div className=\"table-responsive-vertical shadow-z-1\">\r\n\t\t\t\t\t<table id=\"table\" className=\"table article-product-table order-wrap\">\r\n\t\t\t\t\t\t<thead style={{background:'#D8D8D8'}}>\r\n                            <tr>\r\n                                {columns.map((v: any) =>(<th key={v.id} className=\"py-2\">{v.name}</th>))}\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t{content}\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</div>\r\n\t\t\t</div>    \r\n\t\t}));\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, EasyDate } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\nimport { List } from 'tonva';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { CrPageHeaderTitle, pageHTitle } from 'tools/pageHeaderTitle';\r\nimport { ListTable } from 'tools/listTable';\r\n\r\nexport class VExchangeHistory extends VPage<CPointProduct> {\r\n\r\n    private exchangeHistory: any[] = [];        /*积分产品列表 */\r\n    async open(param?: any) {\r\n        this.exchangeHistory = param;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderExchangeHistory = (pointProduct: any, index: number) => {\r\n        let { openOrderDetail } = this.controller;\r\n        let { id, no, date } = pointProduct;\r\n        return <div className=\"p-3 justify-content-between\">\r\n            <div className=\"mr-5\" onClick={() => openOrderDetail(id)}><span className=\"small text-muted\">兑换单号: </span><strong>{no}</strong></div>\r\n            <div className=\"small text-muted\"><EasyDate date={date} /></div>\r\n        </div>;\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let header = CrPageHeaderTitle('兑换历史记录');\r\n        return <Page header={header}>\r\n            {pageHTitle('兑换历史记录')}\r\n            {/* <List items={this.exchangeHistory} item={{ render: this.renderExchangeHistory }} none=\"暂无记录\"></List> */}\r\n            {this.historyListTable()}\r\n        </Page>;\r\n    });\r\n\r\n    historyListTable = () => {\r\n        if (!this.exchangeHistory.length)\r\n            return <div className=\"my-5 text-secondary d-flex justify-content-center\">暂无记录</div>;\r\n        let columns = [{ id: 1, name: '兑换单号' },{ id: 2, name: '日期' },{ id: 3, name: '详情' }];\r\n        let content = <>{\r\n            this.exchangeHistory.map((v: any) => {\r\n                let { id, date, no } = v;\r\n                return <tr className=\"article-product-list order-wrap-list\" key={id}>\r\n                    <td data-title={columns[0].name}>{no}</td>\r\n                    <td data-title={columns[1].name}><EasyDate date={date} /></td>\r\n                    <td data-title={columns[2].name}>\r\n                        <button onClick={() => this.controller.openOrderDetail(id)}\r\n                            type='button' className=\"btn-primary w-4c\">详情</button>\r\n                    </td>\r\n                </tr>\r\n            })\r\n        }</>;\r\n        return <ListTable columns={columns} content={content} ></ListTable>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, Scroller, EasyDate } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\nimport { List } from 'tonva';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { renderPointRecord } from './VMyPoint';\r\nimport { RevenueExpenditure } from './basicRefer';\r\nimport { xs } from 'tools/browser';\r\nimport { CrPageHeaderTitle, pageHTitle } from 'tools/pageHeaderTitle';\r\nimport { ListTable } from 'tools/listTable';\r\n\r\nexport class VRevenueExpenditure extends VPage<CPointProduct> {\r\n    private showList: any = [];\r\n    private tipNone: string = '『 无 』';\r\n    async open(param?: any) {\r\n        this.openPage(this.page, { header: param });\r\n    }\r\n\r\n    private matchData = (header: string) => {\r\n        let { pagePointHistory, cApp } = this.controller;\r\n        let { POINTHISTORY, SIGNINHISTORY } = RevenueExpenditure;\r\n        switch (header) {\r\n            case POINTHISTORY:\r\n                this.showList = pagePointHistory;\r\n                this.tipNone = '『 未曾拥有过 不曾失去过 』';\r\n                return;\r\n            case SIGNINHISTORY:\r\n                this.showList = cApp.cSignIn.signinPageHistory;\r\n                this.tipNone = '『 从未得到过 开启首签之旅 』';\r\n                return;\r\n            default:\r\n                return;\r\n        }\r\n    }\r\n\r\n    protected onScrollBottom = async (scroller: Scroller) => {\r\n        this.showList.more();\r\n    }\r\n\r\n    private page = observer((param: any) => {\r\n        let { header } = param;\r\n        let headerT = header;\r\n        this.matchData(header);\r\n        let none = <div className=\"mt-4 text-secondary d-flex justify-content-center\">{this.tipNone}</div>;\r\n        header = CrPageHeaderTitle(header);\r\n        return <Page header={header} onScrollBottom={this.onScrollBottom}>\r\n            {pageHTitle(headerT)}\r\n            <div className=\"mx-auto\">\r\n                {\r\n                    xs \r\n                        ? <List items={this.showList} item={{ render: renderPointRecord }} none={none} />\r\n                        : this.historyListTable()\r\n                }\r\n            </div>\r\n        </Page>;\r\n    });\r\n\r\n    private historyListTable = (): JSX.Element => {\r\n        if (this.showList && this.showList.items && !this.showList.items.length)\r\n            return <div className=\"my-5 text-secondary d-flex justify-content-center\">{this.tipNone}</div>;\r\n        let columns = [{ id: 1, name: '简述' },{ id: 2, name: '日期' },{ id: 3, name: '收支' }];\r\n        let content = <>{\r\n            this.showList && this.showList.items && this.showList.items.map((v: any) => {\r\n                let { id, date, comments, point } = v;\r\n                return <tr className=\"article-product-list order-wrap-list\" key={id}>\r\n                    <td data-title={columns[0].name}>{comments}</td>\r\n                    <td data-title={columns[1].name}><EasyDate date={date} /></td>\r\n                    <td data-title={columns[2].name} className=\"text-danger font-weight-bolder\">{point >= 0 ? '+' : ''}{point}</td>\r\n                </tr>\r\n            })\r\n        }</>;\r\n        return <ListTable columns={columns} content={content} ></ListTable>;\r\n\t}\r\n}\r\n","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { VPage, Page, FA, tv, Form, UiSchema, UiCustom } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { PointProductImage } from 'tools/productImage';\r\nimport { MinusPlusWidget } from 'tools';\r\nimport { schema, TopicDivision } from './VPointProduct';\r\nimport giftPlate from 'images/giftPlate.png';\r\nimport { observable } from 'mobx';\r\nimport 已下架 from 'images/已下架.png';\r\n\r\nexport class VPointProductDetail extends VPage<CPointProduct> {\r\n    @observable DetailSource: number;\r\n    async open(param?: any) {\r\n        this.DetailSource = param;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            product: { visible: false },\r\n            // pack: { visible: false },\r\n            quantity: {\r\n                widget: 'custom',\r\n                label: null,\r\n                className: 'text-center',\r\n                WidgetClass: MinusPlusWidget,\r\n                onChanged: this.controller.onQuantityChanged as any\r\n            } as UiCustom,\r\n            // point: { visible: false },\r\n            // imageUrl: { visible: false },\r\n        }\r\n    }\r\n\r\n    private renderVDefaultPost = () => {\r\n        return this.controller.renderVDefaultPost();\r\n    }\r\n\r\n    protected renderPointProduct = (pointProduct: any) => {\r\n        let { product, OffShelf } = pointProduct;\r\n        let OffShelfTip: any = undefined;\r\n        if(OffShelf) OffShelfTip = <div className=\"position-absolute w-25\" style={{top:0,left:15}}>\r\n            <img src={已下架} alt=\"\" className=\"w-100\" />\r\n        </div>\r\n        return <>\r\n            {tv(product, (v) => {\r\n                return <div className=\"w-100 row mx-0\">\r\n                    <div title={v.description} className=\"col-12 col-sm-6 position-relative\">\r\n                        <PointProductImage chemicalId={v.imageUrl} className=\"w-100 h-min-12c\" style={{}} />\r\n                        {OffShelfTip}\r\n                    </div>\r\n                    <div className=\"small col-12 col-sm-6 pt-sm-4\">\r\n                        <div className=\"mt-2\">{v.descriptionC}</div>\r\n                        <div className=\"my-2\">{v.grade}</div>\r\n                        <div className=\"row m-0 p-0\">\r\n                            <div className=\"col-5 m-0 p-0\">\r\n                                <span className=\"text-danger h5\">{v.point}</span>\r\n                                <small>分</small>\r\n                            </div>\r\n                            <div className=\"col-7 d-flex justify-content-end align-items-right m-0 p-0\">\r\n                                {\r\n                                    !OffShelf\r\n                                    ? <Form schema={schema} uiSchema={this.uiSchema} formData={pointProduct} className=\"mr-2\" />\r\n                                    : null\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            })}\r\n        </>\r\n    }\r\n\r\n    private page = observer((param: any) => {\r\n        let { pointToExchanging, myEffectivePoints, pointProductsDetail } = this.controller;\r\n        let availablePoints = (myEffectivePoints - pointToExchanging) >= 0 ? (myEffectivePoints - pointToExchanging) : 0;\r\n        let pointsInsuffTip = availablePoints === 0 ? <span className=\"text-danger small\">( <FA name=\"exclamation-circle\" />积分不足 )</span> : null;\r\n        let right = this.controller.renderSelectedLable(this.DetailSource);\r\n        let footer = <div className=\"d-flex justify-content-between m-2\">\r\n            <div className=\"align-self-center\">当前可用:<span className=\"text-danger h4\" >{availablePoints}</span>分 {pointsInsuffTip}</div>\r\n        </div>;\r\n\r\n        return <Page header='产品详情' right={right} footer={footer} className=\"bg-white\">\r\n            <div className=\"\">{this.renderPointProduct(pointProductsDetail)}</div>{/* nav-tabs */}\r\n            <div className=\"d-flex mt-2\"><img src={giftPlate} alt=\"\" className=\"m-auto w-75\" /></div>\r\n            {/* {pointProductsDetail.htmlFragment\r\n                ? <div className=\"mx-2 mt-1\">\r\n                    {TopicDivision('产品介绍')}\r\n                    <div dangerouslySetInnerHTML={{ __html: pointProductsDetail.htmlFragment }} className=\"w-100\"></div>\r\n                </div>\r\n                : <>{this.renderVDefaultPost()}</>\r\n            } */}\r\n        </Page>;\r\n    });\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { View } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { CPointProduct } from './CPointProduct';\r\n\r\nexport class VSelectedLable extends View<CPointProduct> {\r\n\r\n    render(param?: any): JSX.Element { \r\n        return <this.content param={param} />\r\n    };\r\n\r\n    private content = observer((param?: any) => {\r\n        let { pointProductsSelected, openSelectedPointProduct } = this.controller;\r\n        let { length } = pointProductsSelected;\r\n        let count = 0\r\n        let badge, onClick:any, pointer;\r\n        if (length) {\r\n            for (let i of pointProductsSelected) {\r\n                count += i.quantity;\r\n            }\r\n        }\r\n        if (count > 0) {\r\n            onClick = openSelectedPointProduct;\r\n            pointer = 'cursor-pointer';\r\n            if (count < 100) badge = <u>{count}</u>;\r\n            else badge = <u>99+</u>;\r\n        }\r\n        return <div className={classNames('jk-cart ml-1 mr-2', pointer)} onClick={()=>{if(onClick){onClick(param.param)}}}>\r\n            <div>\r\n                <span className=\"fa-stack\">\r\n                    <i className=\"fa fa-square fa-stack-2x text-white\"></i>\r\n                    <i className=\"fa fa-shopping-cart fa-stack-1x text-info\"></i>\r\n                </span>\r\n                {badge}\r\n            </div>\r\n        </div>\r\n    });\r\n}","import * as React from 'react';\r\nimport { View } from 'tonva';\r\nimport { CPointProduct } from './CPointProduct';\r\nimport infb from 'images/infb.jpg'\r\n\r\nexport class VDefaultPost extends View<CPointProduct> {\r\n\r\n    render(): JSX.Element {\r\n        return <this.content />;\r\n    }\r\n\r\n    private content = (): any => {\r\n        return <div className=\"pt-2 px-2 bg-white\">\r\n            {/* <div className=\"border-bottom border-danger h5 py-1 mb-2\">公司概况</div> */}\r\n            <div style={{ textIndent: '2em' }}>\r\n                <p>百灵威科技有限公司是一家致力于研发和生产化学及相关产品，集敏捷制造、全球营销和现代物流为一体的高科技企业。百灵威在中国内地、香港，欧洲及北美等多个国家和地区设有物流中心，实行专业化、个性化的一站式服务，为全球超过200,000 名科技和工业领域的客户提供产品资源及配套技术服务。</p>\r\n                <p>百灵威现代化的研发制造基地拥有一支富有创造天赋的专业团队，新技术、新产品层出不穷，J&K®、Amethyst®、J&K Scientific® 产品已多达30,000 种以上，并呈几何级数增长。作为国际化的资源平台公司，百灵威致力于促进全球产业链的合作，不断推进集约式发展，集成资源600,000 余种，包括高纯有机试剂、无机试剂、生化试剂、分析试剂、标准品、金属有机催化剂、医药中间体、超精细材料、以及实验室仪器、耗材等众多产品。百灵威的柔性生产线能够快速提供小批量、多品种的原料，满足实验、中试以至规模化生产的需要。</p>\r\n                <p>百灵威秉承“诚实守信、开拓创新、合作共赢、实现卓越”的价值观，致力于与化学、生物医药、精细化工、食品工业、现代农业、电子、日化、石化、纺织、生命科学、环境保护、疾病控制、新能源、新材料、航空航天等领域的客户建立互信、长久的合作关系，为实现“促进科技与工业发展，造福人类”的使命而不懈努力！</p>\r\n                <img alt=\"\" src={infb} className=\"w-100\" />\r\n            </div>\r\n        </div >\r\n    };\r\n}\r\n","import { BoxId, RowContext, QueryPager } from 'tonva';\r\nimport { CUqBase } from 'tapp/CBase';\r\nimport { observable } from 'mobx';\r\nimport { VPointProduct, VSelectedPointProduct } from 'pointMarket/VPointProduct';\r\nimport { VExchangeOrder } from './VExchangeOrder';\r\nimport { VMyPoint } from './VMyPoint';\r\nimport { CSelectShippingContact } from 'customer/CSelectContact';\r\nimport { OrderSuccess } from './OrderSuccess';\r\nimport { pointOrder, OrderItem } from './pointOrder';\r\nimport { VExchangeHistoryDetail } from './VExchangeHistoryDetail';\r\nimport { VExchangeHistory } from './VExchangeHistory';\r\nimport { VRevenueExpenditure } from './VRevenueExpenditure';\r\nimport { VPointProductDetail } from './VPointProductDetail';\r\nimport { VSelectedLable } from './VSelectedLable';\r\nimport { GLOABLE } from 'global';\r\nimport { VDefaultPost } from './VDefaultPost';\r\nimport moment from 'moment';\r\n\r\nexport const topicClump = {\r\n    productGenre: '产品分类',\r\n    newRecommend: '新品推荐',\r\n    hotProduct: '热门产品',\r\n}\r\n\r\nexport const OrderSource = {\r\n    EXCHANGEORDER: '兑换订单',\r\n    PRIZEORDER: '奖品订单',\r\n}\r\n\r\nexport const PointProductDetailLevel = {\r\n    DIRECT: 3,\r\n    INDIRECT: 4,\r\n}\r\n\r\nexport class CPointProduct extends CUqBase {\r\n\r\n    @observable myPoints: any[] = [];                  /* 我的积分 */\r\n    @observable myEffectivePoints: number = 0;         /* 我的积分(计算后) */\r\n    @observable myTotalPoints: number = 0;             /* 我的积分(计算后) */\r\n    @observable myPointTobeExpired: number = 0;        /* 我的快过期积分 */\r\n\r\n    @observable navCloseByOrderSuccess: number = 0;    /* 兑换成功后关闭页面层数 */\r\n\r\n    @observable pointProducts: any[] = [];             /* 可兑产品列表 */\r\n    @observable newPointProducts: any[] = [];          /* 新品推荐 */\r\n    @observable hotPointProducts: any[] = [];          /* 热门产品 */\r\n    @observable pointProductsSelected: any[] = [];     /* 已选择产品列表 */\r\n    @observable pointProductsDetail: any;              /* 详情产品 */\r\n    @observable pointToExchanging: number = 0;              /* 将要兑换的积分总计 */\r\n    @observable orderData: pointOrder = new pointOrder();   /* 正在提交的产品列表*/\r\n    @observable couponId: number;                      /* 积分码 */\r\n    @observable platformOrderId: any;                  /* 平台合同号 */\r\n    @observable platformOrder: any[] = [];             /* 平台合同 */\r\n    @observable pagePointHistory: QueryPager<any>;     /* 积分详情 */\r\n    @observable pointProductGenre: any[] = [];         /* 产品类型列表 */\r\n\r\n    pointInterval: any = { startPoint: 0, endPoint: 10000 };\r\n\r\n    protected async internalStart(param?: any) { }\r\n\r\n    /**\r\n     * 刷新积分\r\n     */\r\n    refreshMypoint = async () => {\r\n        let { currentUser } = this.cApp;\r\n        this.myPoints = await currentUser.getPoints();\r\n        this.myEffectivePoints = this.myPoints.reduce((v, e) => { return v + e.effectiveLeftPoint }, 0);\r\n        this.myTotalPoints = this.myPoints.reduce((v, e) => { return v + e.totalLeftPoint }, 0)\r\n        let date = new Date();\r\n        let dateYear = date.getFullYear();\r\n        this.myPointTobeExpired = this.myPoints.reduce((v, e) => { return v + ((dateYear - e.pointYear) > 1 ? e.effectiveLeftPoint : 0) }, 0);\r\n    }\r\n\r\n    /**\r\n     * 初始化可兑换产品列表(暂时弃用)\r\n     */\r\n    initPointProducts = () => {\r\n        if (this.pointProductsSelected.length) {\r\n            for (let i of this.pointProductsSelected) {\r\n                this.pointProducts.forEach((el: any) => {\r\n                    if (i.product.id === el.product.id) el.quantity = i.quantity;\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 清空选择的积分产品  \r\n     */\r\n    clearSelectedPointsProducts = () => {\r\n        this.orderData.exchangeItems = undefined;\r\n        this.pointProductsSelected.length = 0;\r\n        this.pointToExchanging = 0;\r\n    }\r\n\r\n    /**\r\n     * 积分管理页面\r\n     */\r\n    openMyPoint = async (param?: any) => {\r\n        await this.refreshMypoint();        /* 刷新积分 */\r\n        await this.getPointProductGenre();  /* 获取产品类型 */\r\n        this.newPointProducts = await this.getNewPointProducts();    /* 获取新品推荐 */\r\n        this.hotPointProducts = await this.getHotPointProducts();    /* 获取热门产品 */\r\n        this.openVPage(VMyPoint);\r\n    }\r\n\r\n    /**\r\n     * 可兑换产品页面\r\n     */\r\n    openPointProduct = async (name?: any) => {\r\n        // this.initPointProducts();\r\n        this.openVPage(VPointProduct, name);\r\n    }\r\n\r\n    /**\r\n     * 可兑换产品的详情(可生成浏览量)\r\n     */\r\n    openPointProductDetail = async (pointProduct: any, DetailLevel: number) => {\r\n        this.navCloseByOrderSuccess = DetailLevel;\r\n        this.pointProductsDetail = pointProduct;\r\n        if (this.pointProductsSelected.length) {\r\n            for (let i of this.pointProductsSelected) {\r\n                if (pointProduct.product.id === i.product.id)\r\n                    this.pointProductsDetail.quantity = i.quantity;\r\n            }\r\n        } else\r\n            this.pointProductsDetail.quantity = 0;\r\n        let fm = 'YYYY-MM-DD HH:mm:ss';\r\n        this.pointProductsDetail.OffShelf = false;\r\n        let findProduct = await this.getPointProductLibLoad(pointProduct.product.id);\r\n        if (findProduct !== undefined && moment(undefined, fm) >= moment(findProduct.endDate, fm))\r\n            this.pointProductsDetail.OffShelf = true;\r\n        // this.pointProductsDetail.htmlFragment = await this.getPointProductDetailFragment(this.pointProductsDetail);\r\n        await this.setPointProductVisits(pointProduct.product.obj);//生成浏览量\r\n        this.openVPage(VPointProductDetail, DetailLevel);\r\n    }\r\n\r\n    /**\r\n     * 据商品id 获取对应的商品所有信息\r\n     */\r\n    getPointProductLibLoad = async (id: number) => {\r\n        return await this.uqs.积分商城.PointProductLib.load(id);\r\n    }\r\n\r\n    /**\r\n     * 获取积分商品详情的html片段(编译后)\r\n     */\r\n    getPointProductDetailFragment = async (pointProduct: any) => {\r\n        // this.pointProductsDetail.htmlFragment = '<div style=\"color:red;text-align:center;margin-top:2rem;\">帖文 待开发</div>';\r\n        let result = await window.fetch(GLOABLE.CONTENTSITE + '/partial/pointproductdetail/' + pointProduct.product.id);\r\n        if (result.ok) {\r\n            let content = await result.text();\r\n            return content;\r\n        } else {\r\n            return '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 积分收支明细页面\r\n     */\r\n    openRevenueExpenditure = async (topic?: any) => {\r\n        await this.getPointHistory();\r\n        this.openVPage(VRevenueExpenditure, topic)\r\n    }\r\n\r\n    /**\r\n     * 积分兑换记录页面\r\n     */\r\n    openExchangeHistory = async () => {\r\n        let promises: PromiseLike<any>[] = [\r\n            this.uqs.积分商城.PointExchangeSheet.mySheets(undefined, 1, -10),\r\n            this.uqs.积分商城.PointExchangeSheet.mySheets(\"#\", 1, -100)\r\n        ];\r\n        let presult = await Promise.all(promises);\r\n        let exchangeHistory = presult[0].concat(presult[1]);\r\n        this.openVPage(VExchangeHistory, exchangeHistory);\r\n    }\r\n\r\n    /**\r\n     * 历史兑换单详情页面\r\n     */\r\n    openOrderDetail = async (orderId: number) => {\r\n        let order = await this.uqs.积分商城.PointExchangeSheet.getSheet(orderId);\r\n        this.openVPage(VExchangeHistoryDetail, order);\r\n    }\r\n\r\n    /**\r\n     * 已选择的可兑换产品页面\r\n     */\r\n    openSelectedPointProduct = async (DetailLevel: number) => {\r\n        this.navCloseByOrderSuccess = DetailLevel;\r\n        this.pointProductsSelected = this.pointProductsSelected.filter(v => v.quantity !== 0);\r\n        this.openVPage(VSelectedPointProduct);\r\n    }\r\n\r\n    /**\r\n     * 确认兑换订单预览页面\r\n     */\r\n    openExchangeOrder = async () => {\r\n        if (this.orderData.shippingContact === undefined) {\r\n            this.orderData.shippingContact = await this.getDefaultShippingContact();\r\n        }\r\n        this.pointProductsSelected = this.pointProductsSelected.filter(v => v.quantity !== 0);\r\n        this.openVPage(VExchangeOrder);\r\n    }\r\n\r\n    /**\r\n     * 已选择的可兑换产品图标\r\n     */\r\n    renderSelectedLable(DetailLevel: number) {\r\n        return this.renderView(VSelectedLable, DetailLevel);\r\n    }\r\n\r\n    /**\r\n     * 默认帖文\r\n     */\r\n    renderVDefaultPost() {\r\n        return this.renderView(VDefaultPost);\r\n    }\r\n\r\n    // /*领取积分 */\r\n    // openPointDrawing = async (credits?: string) => {\r\n    //     /* \r\n    //     let lastPlatformId = await this.getLastPlatformOrder();\r\n    //     if (lastPlatformId)\r\n    //         this.platformOrder = await this.getPlatFormOrder(this.platformOrderId);\r\n    //     */\r\n    //     this.openVPage(VPlatformOrderPoint, credits);\r\n    // }\r\n\r\n    /* 展示 积分详情*/\r\n    /* pointDetails = async () => {\r\n        this.getPointHistory();\r\n        this.openVPage(VPointDetails);\r\n    } */\r\n\r\n    /**\r\n     * 浏览商品(数据埋点,生产浏览量PV)\r\n     */\r\n    setPointProductVisits = async (pointProduct: any) => {\r\n        return this.uqs.积分商城.SetPointProductVisits.submit({ pointProduct });\r\n    }\r\n\r\n    /**\r\n     * 获取产品类型\r\n     */\r\n    getPointProductGenre = async () => {\r\n        let { Genre } = this.uqs.积分商城;\r\n        this.pointProductGenre = await Genre.all();\r\n    }\r\n\r\n    /**\r\n     * 获取积分详情的数据\r\n     */\r\n    getPointHistory = () => {\r\n        this.pagePointHistory = new QueryPager(this.uqs.积分商城.GetPointHistory, 15, 30);\r\n        this.pagePointHistory.first({ key: \"\" });\r\n    }\r\n\r\n    /**\r\n     * 获取可兑换产品(据 分类、新品推荐、热门产品)\r\n     */\r\n    getPointProductByDifferentPlot = async (plot: any) => {\r\n        let { productGenre, newRecommend, hotProduct } = topicClump;\r\n        let state = typeof plot === 'object' && this.pointProductGenre.some((v) => v.name === plot.name) ? productGenre : plot;\r\n        switch (state) {\r\n            case productGenre:\r\n                this.pointProducts = await this.filterByProductGenre(plot);\r\n                break;\r\n            case newRecommend:\r\n                this.pointProducts = await this.getNewPointProducts();\r\n                break;\r\n            case hotProduct:\r\n                this.pointProducts = await this.getHotPointProducts();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        // this.initPointProducts();\r\n    }\r\n\r\n    /**\r\n     * 据类型筛选商品\r\n     */\r\n    filterByProductGenre = async (currentGenre: any) => {\r\n        // let pointProductFromGenre = await this.getProductsFromGenre(currentGenre);\r\n        let pointProductFromGenre = await this.uqs.积分商城.GetPointProductByGenre.table({ genre: currentGenre });\r\n        return pointProductFromGenre.map((v) => { return { genre: v.genre, product: v.pointProduct } });\r\n    }\r\n\r\n    /**\r\n     * 获取指定分类所属的商品\r\n     */\r\n    getProductsFromGenre = async (genre: any) => {\r\n        return await this.uqs.积分商城.PointProductGenre.table({ genre, pointproduct: undefined });\r\n    }\r\n\r\n    /**\r\n     * 获取新品推荐的产品\r\n     */\r\n    getNewPointProducts = async () => {\r\n        let result = await this.uqs.积分商城.GetNewPointProducts.table({});\r\n        return result.sort((a, b) => a.point - b.point).map((v) => { return { product: v.id } });\r\n    }\r\n\r\n    /**\r\n     * 获取热门产品\r\n     */\r\n    getHotPointProducts = async () => {\r\n        let result = await this.uqs.积分商城.GetHotPointProducts.table({});\r\n        return result.sort((a, b) => a.point - b.point).map((v) => { return { product: v.id } });\r\n    }\r\n\r\n    /**\r\n     * 获取积分区间的积分产品\r\n     */\r\n    getPointsIntervalProducts = async (state: any) => {\r\n        switch (state) {\r\n            case 'below':\r\n                this.pointInterval = { startPoint: 0, endPoint: 10000 };\r\n                break;\r\n            case 'firstLevel':\r\n                this.pointInterval = { startPoint: 10000, endPoint: 50000 };\r\n                break;\r\n            case 'twoLevel':\r\n                this.pointInterval = { startPoint: 50000, endPoint: 150000 };\r\n                break;\r\n            case 'above':\r\n                this.pointInterval = { startPoint: 150000, endPoint: Infinity };\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.pointProducts = await this.getPointsProducts();\r\n        // this.initPointProducts();\r\n        return this.pointProducts;\r\n    }\r\n\r\n    /**\r\n     * 获取积分商城产品(积分划分)\r\n     */\r\n    getPointsProducts = async () => {\r\n        return await this.uqs.积分商城.GetPointProduct.table(this.pointInterval);\r\n    }\r\n\r\n    /**\r\n     * 获取商品源（兑换下单可用）\r\n     */\r\n    getProductSources = async (pointProduct: any) => {\r\n        return await this.uqs.积分商城.PointProductSource.obj({ pointProduct, sourceId: undefined });\r\n    }\r\n\r\n    onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data } = context;\r\n        let IsContain = 0;\r\n        let nowQuantity = value - (prev ? prev : 0);\r\n        /* let availablePoints = this.myEffectivePoints - this.pointToExchanging;\r\n        if (availablePoints <= 0) return;    */\r\n        // 当前产品详情的数量\r\n        this.pointProductsDetail.quantity = value;\r\n        // this.pointToExchanging = this.pointToExchanging + (data.point * nowQuantity);\r\n        this.pointToExchanging = this.pointToExchanging + (data.product.obj.point * nowQuantity);\r\n        this.pointProductsSelected.forEach(element => {\r\n            if (element.product.id === data.product.id) {\r\n                element.quantity = element.quantity + nowQuantity;\r\n                IsContain = IsContain + 1;\r\n            }\r\n        });\r\n        if (IsContain === 0) {\r\n            data.point = data.product.obj.point;\r\n            this.pointProductsSelected.push(data);\r\n        }\r\n    }\r\n\r\n    private createOrderFromCart = async () => {\r\n        let { currentUser, currentSalesRegion } = this.cApp;\r\n        this.orderData.webUser = currentUser.id;\r\n        this.orderData.salesRegion = currentSalesRegion.id;\r\n        if (currentUser.currentCustomer !== undefined) {\r\n            this.orderData.customer = currentUser.currentCustomer.id;\r\n        }\r\n        if (this.pointProductsSelected !== undefined && this.pointProductsSelected.length > 0) {\r\n            this.orderData.exchangeItems = this.pointProductsSelected.map(e => {\r\n                if (e.quantity <= 0) return undefined;\r\n                var item = new OrderItem();\r\n                item.product = e.product;\r\n                // item.pack = e.pack;\r\n                item.quantity = e.quantity;\r\n                item.point = e.point;\r\n                return item;\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * 生成兑换单兑换积分\r\n     */\r\n    submitOrder = async () => {\r\n        this.createOrderFromCart();\r\n\r\n        let PointExchangeSheet = this.uqs.积分商城.PointExchangeSheet;\r\n        let getDataForSave = this.orderData.getDataForSave();\r\n        let result: any = await PointExchangeSheet.save(\"PointExchangeSheet\", getDataForSave);\r\n        let { id, flow, state } = result;\r\n        await PointExchangeSheet.action(id, flow, state, \"submit\");\r\n\r\n        //暂时扣除已经兑换的积分;\r\n        this.myEffectivePoints = this.myEffectivePoints - this.pointToExchanging;\r\n        this.myTotalPoints = this.myTotalPoints - this.pointToExchanging;\r\n        if (this.pointToExchanging > this.myPointTobeExpired) {\r\n            this.myPointTobeExpired = 0;\r\n        } else {\r\n            this.myPointTobeExpired = this.myPointTobeExpired - this.pointToExchanging;\r\n        }\r\n\r\n        //兑换后清空选择的积分产品\r\n        /* this.orderData.exchangeItems = undefined;\r\n        this.pointProductsSelected.length = 0;\r\n        this.pointToExchanging = 0; */\r\n        this.clearSelectedPointsProducts();\r\n\r\n        // 打开下单成功显示界面\r\n        // nav.popTo(this.cApp.topKey);\r\n        this.closePage(this.navCloseByOrderSuccess);\r\n        this.openVPage(OrderSuccess, result);\r\n    }\r\n\r\n    /**\r\n     * 获取当前webuser对应customer的最近一个订单 TODO:delete\r\n    getLastPlatformOrder = async () => {\r\n\r\n        let { currentCustomer } = this.cApp.currentUser;\r\n        let validationResult = await this.uqs.积分商城.GetLastPlatFormOrder.submit({ customer: currentCustomer && currentCustomer.id });\r\n        let { platformOrderId } = validationResult;\r\n        this.platformOrderId = validationResult.platformOrderId;\r\n        return platformOrderId;\r\n    }\r\n    */\r\n\r\n    /*\r\n    getPlatFormOrder = async (platformOrderId: string) => {\r\n        return await this.uqs.积分商城.GetPlatFormOrder.table({ platformOrderId: platformOrderId });\r\n    }\r\n    */\r\n\r\n    IsCouponCanUse = async (couponCode: string) => {\r\n        this.couponId = 0;\r\n        let { currentUser } = this.cApp;\r\n        let { salesTask } = this.uqs;\r\n        let validationResult = await salesTask.IsCanUseCoupon.submit({ code: couponCode, webUser: currentUser && currentUser.id });\r\n\r\n        let { result, id, types } = validationResult;\r\n        if (result === 1) {\r\n            this.couponId = id;\r\n            if (types !== 'credits')\r\n                result = 0;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 领取积分码 TODO:delete\r\n    receivePoint = async (orderId: string) => {\r\n        let { currentCustomer } = this.cApp.currentUser;\r\n        let { AddPlatformOrderPoint } = this.uqs.积分商城;\r\n        let result = await AddPlatformOrderPoint.submit({ orderId: orderId, couponId: this.couponId, customer: currentCustomer && currentCustomer.id });\r\n        let rtn = result.result;\r\n\r\n        return rtn;\r\n    }\r\n    */\r\n\r\n    private openMeInfoOptions: any;\r\n    /**\r\n     * 检查客户信息是否完善（不完善需补充完善后方可领取积分）\r\n     */\r\n    userInfoCompletedChecking = async (options: any): Promise<boolean> => {\r\n        await this.cApp.assureLogin();\r\n        let { cMe, currentUser } = this.cApp;\r\n        if (!currentUser.allowOrdering) {\r\n            cMe.openMeInfoFirstOrder(options);\r\n            return false;\r\n        }\r\n        return true;\r\n        /*\r\n        if (!this.isLogined) {\r\n            this.openMeInfoOptions = options;\r\n            nav.showLogin(this.loginCallback, true);\r\n            return false;\r\n        } else {\r\n            let { cMe, currentUser } = this.cApp;\r\n            if (!currentUser.allowOrdering) {\r\n                cMe.openMeInfoFirstOrder(options);\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        */\r\n    }\r\n    /*\r\n    private loginCallback = async (user: User): Promise<void> => {\r\n        let { cApp } = this;\r\n        await cApp.currentUser.setUser(user);\r\n        await cApp.loginCallBack(user);\r\n        this.closePage(1);\r\n\r\n        let { cMe, currentUser } = this.cApp;\r\n        if (!currentUser.allowOrdering) {\r\n            cMe.openMeInfoFirstOrder(this.openMeInfoOptions);\r\n        }\r\n    };\r\n    */\r\n    /**\r\n     * TODO: delete\r\n     */\r\n    addUsedCoupon = async () => {\r\n        let { AddUsedCoupon } = this.uqs.积分商城;\r\n        let result = await AddUsedCoupon.submit({ couponId: this.couponId });\r\n        let rtn = result.result;\r\n        return rtn;\r\n    }\r\n\r\n    private defaultSetting: any;\r\n    private async getDefaultSetting() {\r\n        if (this.defaultSetting) return this.defaultSetting;\r\n        let { currentUser } = this.cApp;\r\n        return this.defaultSetting = await currentUser.getSetting() || {};\r\n    }\r\n    private contact0: BoxId;\r\n    private async getContact(): Promise<BoxId> {\r\n        if (this.contact0 === null) return;\r\n        if (this.contact0 !== undefined) return this.contact0;\r\n        let { currentUser } = this.cApp;\r\n        let contactArr = await currentUser.getContacts();\r\n        if (contactArr === undefined || contactArr.length === 0) {\r\n            this.contact0 = null;\r\n            return;\r\n        }\r\n        return this.contact0 = contactArr[0].contact;\r\n    }\r\n    async getDefaultShippingContact() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.shippingContact || await this.getContact();\r\n    }\r\n\r\n    selectContact = async () => {\r\n        let cSelect = this.newC(CSelectShippingContact);\r\n        let contactBox = await cSelect.call<BoxId>(true);\r\n        return contactBox;\r\n    }\r\n\r\n    onSelectShippingContact = async () => {\r\n        this.orderData.shippingContact = await this.selectContact()\r\n    }\r\n}","import * as React from 'react';\r\nimport { CPointProduct, PointProductDetailLevel } from 'pointMarket/CPointProduct';\r\nimport {\r\n    VPage, Page, Form, List, tv, ObjectSchema, NumSchema, UiSchema, UiCustom, FA, Tabs, TabProp, autoHideTips\r\n} from 'tonva';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { PointProductImage } from 'tools/productImage';\r\nimport { MinusPlusWidget } from 'tools';\r\nimport { observable } from 'mobx';\r\n//import { GLOABLE } from 'cartenv';\r\n//import { color } from 'order/VMyOrders';\r\nimport { randomColor } from 'tools/randomColor';\r\nimport { pointIcon, triangleShadingO } from 'tools/images';\r\n\r\nexport const renderHr = (HRCL?: any, HRST?: any) => {\r\n    let styleObj = HRST ? HRST : { backgroundColor: '#007bff' };\r\n    return <div className={`flex-fill ${HRCL ? HRCL : 'px-2 text-primary'}`}>\r\n        <hr style={{ height: 1, border: 'none', ...styleObj }} />\r\n    </div>\r\n};\r\n\r\nexport const TopicDivision = (topic: any, CL?: any, ST?: any, HRCL?: any, HRST?: any) => {\r\n    return <div className={`text-center w-100 py-2 ${CL ? CL : 'px-2 text-primary'} d-flex justify-content-between align-items-center`} style={ST}>\r\n        {renderHr(HRCL, HRST)}{topic}{renderHr(HRCL, HRST)}\r\n    </div>\r\n}\r\n\r\n\r\nexport const schema = [\r\n    { name: 'product', type: 'object' } as ObjectSchema,\r\n    // { name: 'pack', type: 'object' } as ObjectSchema,\r\n    { name: 'quantity', type: 'number' } as NumSchema,\r\n    // { name: 'point', type: 'number' } as NumSchema,\r\n    // { name: 'imageUrl', type: 'string' } as StringSchema,\r\n];\r\n\r\nexport class VPointProduct extends VPage<CPointProduct> {\r\n    @observable protected isShowSelectForm: boolean = false;\r\n    //@observable protected productIsNull: boolean = false;\r\n    //@observable protected pointIsEnough: boolean = false;\r\n    protected productIsNull = observable.box(false);\r\n    protected pointIsEnough = observable.box(false);\r\n    private currentInterval: string;\r\n    private themeName: string = '积分商城';\r\n    private tabs: TabProp[];\r\n    protected none: JSX.Element = <div className=\"my-4 text-secondary d-flex justify-content-center\">『 暂无可兑换产品 』</div>;\r\n    rankInterval: any = [\r\n        { caption: '1万以下', state: 'below', icon: 'superpowers', borderC: '#2c93ad' },\r\n        { caption: '1-5万', state: 'firstLevel', icon: 'superpowers', borderC: '#3CC43C' },\r\n        { caption: '5-15万', state: 'twoLevel', icon: 'superpowers', borderC: '#7c1e5e' },\r\n        { caption: '15万以上', state: 'above', icon: 'superpowers', borderC: '#0e2c8c' },\r\n    ];\r\n    async open(param?: any) {\r\n        if (param) {\r\n            this.themeName = param.name ? param.name : param;\r\n            await this.controller.getPointProductByDifferentPlot(param);\r\n        }\r\n        this.openPage(this.page);\r\n    }\r\n    private getTabs = async () => {\r\n        let { getPointsIntervalProducts } = this.controller;\r\n        this.tabs = this.rankInterval.map((v: any) => {\r\n            let { caption, state, icon, borderC } = v;\r\n            return {\r\n                name: caption,\r\n                // caption: (selected: boolean) => TabCaptionComponent(caption, icon, color(selected)),\r\n                caption: (selected: boolean) => this.TabCaptionComponent(caption, icon, borderC, (selected ? '#ffffff' : 'transparent')),\r\n                content: () => {\r\n                    return <>{this.renderList()}</>\r\n                },\r\n                isSelected: this.currentInterval === state,\r\n                load: async () => {\r\n                    this.currentInterval = state;\r\n                    this.controller.pointProducts = await getPointsIntervalProducts(this.currentInterval);\r\n                }\r\n            };\r\n        });\r\n    }\r\n\r\n    private TabCaptionComponent = (label: string, icon: string, borderC: string, color: string) => <div\r\n        className={'py-2 d-flex justify-content-center align-items-center flex-column cursor-pointer '}>\r\n        <small className=\"w-4c text-center rounded-sm font-weight-bold\" style={{ color: borderC, border: `1px solid ${borderC}`, background: color }}>{label}</small>\r\n    </div>;\r\n\r\n    protected renderList = (isToDetail?: boolean) => {\r\n        let { pointProducts, openPointProductDetail } = this.controller;\r\n        return <div style={{ background: `url(${triangleShadingO}) no-repeat 99% 230px,url(${triangleShadingO}) no-repeat 1% 480px`, backgroundSize: '2.5%' }}>\r\n            <List items={pointProducts} item={{\r\n                render: this.renderPointProduct,\r\n                onClick: (v) => { openPointProductDetail(v, PointProductDetailLevel.INDIRECT) },\r\n                className: 'col-6 col-md-4 col-lg-3 px-3 bg-transparent'\r\n                // className: 'w-50 px-3 bg-transparent'\r\n            }} none={this.none}\r\n                // className={`${pointProducts.length !== 0 ? 'd-flex flex-wrap bg-transparent mt-2' : ''}`}\r\n                className={`${pointProducts.length !== 0 ? 'row mx-0 mt-2 bg-transparent' : ''}`}\r\n            ></List>\r\n        </div>\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            product: { visible: false },\r\n            // pack: { visible: false },\r\n            quantity: {\r\n                widget: 'custom',\r\n                label: null,\r\n                className: 'text-center w-2c',\r\n                WidgetClass: MinusPlusWidget,\r\n                onChanged: this.controller.onQuantityChanged as any\r\n            } as UiCustom,\r\n            // point: { visible: false },\r\n            // imageUrl: { visible: false },\r\n        }\r\n    }\r\n\r\n    protected renderPointProduct = (pointProduct: any) => {\r\n        let { product } = pointProduct;\r\n        return <>\r\n            {tv(product, (v) => {\r\n                return <div className=\"w-100 d-flex flex-column mb-4\">{/* height: 20vh  */}\r\n                    <div title={v.description} className=\"w-100 z-height\"><PointProductImage chemicalId={v.imageUrl} className=\"w-100 h-100\" style={{ border: `2px solid ${randomColor()}` }} /></div>\r\n                    {/* <div title={v.description} className=\"w-100\" style={{ height: '35vw' }} ><PointProductImage chemicalId={v.imageUrl} className=\"w-100 h-100\" style={{ border: `2px solid ${randomColor()}` }} /></div> */}\r\n                    <div className=\"small w-100\">\r\n                        <div className=\"text-truncate w-100\">{v.descriptionC}</div>\r\n                        <>\r\n                            {\r\n                                this.isShowSelectForm\r\n                                    ? <div className=\"w-100 d-flex justify-content-between align-items-right mt-1\">{/* justify-content-end */}\r\n                                        <small className=\"align-self-center mb-3 text-primary\" ><FA name=\"shopping-bag\" size='2x' /></small>\r\n                                        <Form schema={schema} uiSchema={this.uiSchema} formData={pointProduct} className=\"mr-2\" />\r\n                                    </div>\r\n                                    : null\r\n                            }\r\n                            <div className='d-flex'>\r\n                                {/* <FA name='database' className=\"text-warning\" /> */}\r\n                                <img src={pointIcon} alt=\"\" style={{ height: 24 }} />\r\n                                <span className=\"text-danger h5 m-0 ml-1 align-self-end\"> {v.point}</span>{/* <small>分</small> */}\r\n                            </div>\r\n                        </>\r\n                    </div>\r\n                </div>\r\n            })}\r\n        </>\r\n    }\r\n\r\n    protected openExchangeOrder = async () => {\r\n        // 未选择产品\r\n        let { pointToExchanging, myEffectivePoints } = this.controller;\r\n\r\n        if (pointToExchanging < 1) {\r\n            this.productIsNull.set(true);\r\n            this.pointIsEnough.set(false);\r\n            //setTimeout(() => this.productIsNull = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n        // 积分不足\r\n        if (pointToExchanging > myEffectivePoints) {\r\n            this.productIsNull.set(false);\r\n            this.pointIsEnough.set(true);\r\n            //setTimeout(() => this.pointIsEnough = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n\r\n        this.controller.openExchangeOrder();\r\n    }\r\n\r\n    protected getRelatedUI = () => {\r\n        let { pointToExchanging, myEffectivePoints } = this.controller;\r\n        /*\r\n        let productIsNullTip = this.productIsNull ?\r\n            <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" />未选择产品</div>\r\n            : null;\r\n        let pointIsEnoughTip = this.pointIsEnough ?\r\n            <div className=\"text-danger small m-0 p-0\"><FA name=\"exclamation-circle\" />积分不足<br />剩余{myEffectivePoints}分</div>\r\n            : null;\r\n        */\r\n        let footer = <div className=\"d-block\">\r\n            <div className=\"w-100 px-3 d-flex justify-content-between\">\r\n                <div>总计:<span className=\"text-danger ml-2 mr-1 h2\" >{pointToExchanging}</span>分</div>\r\n                <div>\r\n                    {/*productIsNullTip*/autoHideTips(this.productIsNull, <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" />未选择产品</div>)}\r\n                    {/*pointIsEnoughTip*/autoHideTips(this.pointIsEnough, <div className=\"text-danger small m-0 p-0\"><FA name=\"exclamation-circle\" />积分不足<br />剩余{myEffectivePoints}分</div>)}\r\n                </div>\r\n                <button type=\"button\" className=\"btn btn-danger m-1\" onClick={this.openExchangeOrder}>去兑换</button>\r\n            </div>\r\n        </div>;\r\n        return footer;\r\n    }\r\n\r\n    protected page = observer(() => {\r\n        this.getTabs();\r\n        let right = this.controller.renderSelectedLable(PointProductDetailLevel.DIRECT);\r\n        return <Page header={this.themeName} right={right}>\r\n            {\r\n                this.themeName === '积分商城'\r\n                    ? <Tabs tabs={this.tabs} tabPosition=\"top\" size=\"lg\" />\r\n                    : <>\r\n                        {/* {TopicDivision(this.themeName)} */}\r\n                        {this.renderList()}\r\n                    </>\r\n            }\r\n        </Page >;\r\n    });\r\n}\r\n\r\n/**\r\n * 已选择的兑换产品列表\r\n */\r\nexport class VSelectedPointProduct extends VPointProduct {\r\n    isShowSelectForm: boolean = true;\r\n    protected none: JSX.Element = <div className=\"mt-4 text-secondary d-flex justify-content-center\">『 已清空您所选择的产品 』</div>;\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    page = observer(() => {\r\n        let { pointProductsSelected } = this.controller;\r\n        let footer = this.getRelatedUI();\r\n\r\n        // let right = <div className=\"mr-2\" onClick={clearSelectedPointsProducts}><FA name=\"trash-o\" className='text-light' /></div>;\r\n        // let none = <div className=\"mt-4 text-secondary d-flex justify-content-center\">『 已清空您所选择的产品 』</div>;\r\n        return <Page header='已选择兑换产品' right={<></>} footer={footer} >\r\n            <List\r\n                items={pointProductsSelected}\r\n                item={{\r\n                    render: this.renderPointProduct,\r\n                    className: 'col-6 col-md-4 col-lg-3 px-3 bg-transparent'\r\n                    // className: \"w-50 px-3\"\r\n                }}\r\n                none={this.none}\r\n                className='row mx-0 mt-2 bg-transparent'\r\n            // className=\"d-flex flex-wrap bg-transparent mt-2\"\r\n            />\r\n        </Page >\r\n    })\r\n}","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport {\r\n    tv, VPage, Page, Form, ItemSchema, NumSchema, UiSchema,\r\n    ObjectSchema, RowContext, UiCustom, FormField, List, Ax\r\n} from 'tonva';\r\nimport { CProduct } from './CProduct';\r\nimport { MinusPlusWidget } from '../tools/minusPlusWidget';\r\nimport { ProductPackRow, Product } from '../model';\r\nimport { ProductImage } from 'tools/productImage';\r\nimport { renderPropItem, renderBrand } from './renders';\r\nimport { xs } from 'tools/browser';\r\nimport { pdfIcon } from 'tools/images';\r\nimport { VFavorite, VPrice } from './views';\r\nimport classNames from 'classnames';\r\nimport { TopicDivision } from 'pointMarket/VPointProduct';\r\n\r\nconst schema: ItemSchema[] = [\r\n    { name: 'pack', type: 'object' } as ObjectSchema,\r\n    { name: 'retail', type: 'number' } as NumSchema,\r\n    { name: 'vipPrice', type: 'number' } as NumSchema,\r\n    { name: 'promotionPrice', type: 'number' } as NumSchema,\r\n    { name: 'currency', type: 'string' },\r\n    { name: 'quantity', type: 'number' } as NumSchema,\r\n    { name: 'inventoryAllocation', type: 'object' } as ObjectSchema,\r\n    { name: 'futureDeliveryTimeDescription', type: 'string' }\r\n];\r\n\r\nexport const languageCaptions: { [language: string]: string } = {\r\n    'DE': '德文',\r\n    'EN': '英文',\r\n    'EN-US': '美式英文',\r\n    'CN': '中文',\r\n}\r\n\r\nexport class VPageProduct extends VPage<CProduct> {\r\n    //private productBox: BoxId;\r\n    //private discount: number;\r\n\r\n    async open(param: any) {\r\n        //let { productData, product, discount } = param;\r\n        //let { getProductSpecFile, getProductMSDSFile } = this.controller;\r\n        //let page = xs ? this.page : this.lpage;\r\n        this.openPage(() => {\r\n            let { cApp, product, openMaterial } = this.controller;\r\n            let { MSDSFiles, specFiles, data, id } = product;\r\n            /* let CurrentUA = browser.versions.mobile;\r\n            let productPdfM = CurrentUA && (productMSDSFiles.length || productSpecFiles.length) ? true : false; */\r\n            let header: any, cartLabel: any, material: any;\r\n\r\n            if (xs) {\r\n                header = cApp.cHome.renderSearchHeader();\r\n                cartLabel = cApp.cCart.renderCartLabel();\r\n                material = <div className=\"col-lg-9 mt-lg-2 display-mobile mb-lg-2\">\r\n                    {this.renderProductMaterial()}\r\n                </div>;\r\n            }\r\n            /* let viewProduct = new ViewMainSubs<MainProductChemical, ProductPackRow>(this.renderProduct, this.renderPack);\r\n            viewProduct.model = product; */\r\n\r\n            return <Page header={header} right={cartLabel} className=\"bg-white\">\r\n                <section className=\"container mt-lg-2 product-sigle-page\">\r\n                    <div className=\"row\">\r\n                        {this.renderProduct(product)}\r\n                        <div className=\"display-mobile px-2 ml-2 my-3 w-100\" style={{ lineHeight: 1.8 }}>\r\n                            {TopicDivision('产品资料')}\r\n                            {this.material(id)}\r\n                        </div>\r\n                        {/* {material} */}\r\n                    </div>\r\n                </section>\r\n\r\n                {/* 产品信息 */}\r\n                {/* <div className=\"px-2 py-2 bg-white mb-3\">{viewProduct.render()}</div> */}\r\n                {/* PDF */}\r\n                {/* {\r\n\t\t\t\t\tproductPdfM\r\n\t\t\t\t\t\t? <div className=\"py-2 px-3 bg-light\">\r\n\t\t\t\t\t\t\t{TopicDivision('产品资料')}\r\n\t\t\t\t\t\t\t<div>{this.renderProductMaterial()}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: null\r\n\t\t\t\t} */}\r\n            </Page>;\r\n            //} else {\r\n            /*\r\n            下面的做法大概不行，因为嵌套的层次较深，且都是observer的，上层observable的变化会嵌套执行下层的代码，而下层代码的render\r\n            会操作数据库，得不偿失（和React的可能还不一样，React只会更新必要的html，不会再执行查询DB的操作）\r\n            */\r\n            /*\r\n             let { controller, productBox } = this;\r\n             let { renderProductWithPrice } = controller;\r\n             return <Page header={header} right={cartLabel}>\r\n                 <div className=\"px-2 py-2 bg-white mb-3\">\r\n                     {renderProductWithPrice(productBox)}\r\n                 </div>\r\n             </Page>\r\n             */\r\n            //}\r\n        });\r\n    }\r\n\r\n    /*\r\n    private lpage = () => {\r\n        //let { renderHeader, renderFooter } = this.controller.cApp;\r\n        let {product} = this.controller;\r\n        let {data} = product;\r\n           return <Page>\r\n             <section className=\"container mt-lg-2 product-sigle-page\">\r\n                    <div className=\"row\">\r\n                        {this.renderProduct(data.main, data.subs)}\r\n                    </div>\r\n                </section>\r\n        </Page>\r\n    }\r\n    */\r\n\r\n    /*\r\n    render(param: any) {\r\n\r\n        return <this.page />;\r\n    }\r\n    */\r\n\r\n    private material = (id: any) => {\r\n        let { openMaterial } = this.controller;\r\n        let Materials = [\r\n            { id: 1, name: \"化学品安全技术说明书（SDS）\", type: \"MSDS\" },\r\n            { id: 2, name: \"技术规格说明书（Specifications）\", type: \"SPEC\" },\r\n            { id: 3, name: \"质检报告（COA）\", type: \"COA\" },\r\n        ];\r\n        return <div className={classNames('left-below', !xs ? 'd-none d-sm-block' : 'display-mobile')}>{/* display-desktop*/}\r\n            {\r\n                Materials.map((v: any) => {\r\n                    return <Ax key={v.name} href={'/product/mscu/' + v.type + '/' + id} >{/* onClick={() => openMaterial(v.type)} */}\r\n                        <div className=\"mint\" >{v.name}</div></Ax>\r\n                })\r\n            }\r\n        </div>\r\n    }\r\n\r\n    private renderProduct = (product: Product) => {\r\n        let { openMaterial } = this.controller;\r\n        let { id, brand, props, chemical } = product;\r\n        let { description, descriptionC, CAS, purity, molecularFomula, molecularWeight, origin, imageUrl } = props;\r\n        let eName = <div className=\"py-2\"><strong>{description}</strong></div>;\r\n        let cName: any;\r\n        if (descriptionC !== description) {\r\n            cName = <div>{descriptionC}</div>;\r\n        }\r\n        imageUrl = imageUrl || props.chemical.toString();\r\n        return <>\r\n            <div className=\"col-lg-4 product-left-card \">\r\n                <div className=\"preview\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                    <div className=\"d-none d-sm-block mt-5\">{this.material(id)}</div>\r\n                    {/* <div className=\"left-below display-desktop mt-1\">\r\n                        {this.renderProductMaterial()}\r\n                    </div> */}\r\n                </div>\r\n            </div>\r\n            <div className=\"col-lg-8\">\r\n                <div className=\"details\">\r\n                    {eName}\r\n                    {cName}\r\n                    <div className=\"row mx-3\">\r\n                        {renderPropItem('产品编号', origin, \"font-weight-bold\")}\r\n                        {renderPropItem('CAS', CAS || chemical.CAS, \"font-weight-bold\")}\r\n                        {renderPropItem('纯度', purity || chemical.purity)}\r\n                        {renderPropItem('分子式', molecularFomula || chemical.molecularFomula)}\r\n                        {renderPropItem('分子量', molecularWeight || chemical.molecularWeight)}\r\n                        {renderBrand(brand)}\r\n                    </div>\r\n                </div>\r\n                {this.renderVm(VFavorite, { product })}\r\n                {this.renderVm(VPrice, product)}\r\n            </div>\r\n        </>\r\n\r\n        return <div className=\"mb-3 px-2\">\r\n            {eName}\r\n            {cName}\r\n            <div className=\"row mt-3\">\r\n                <div className=\"col-12 col-sm-3\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"w-100\" />\r\n                </div>\r\n                <div className=\"col-12 col-sm-9\">\r\n                    <div className=\"row mx-3\">\r\n                        {renderPropItem('产品编号', origin, \"font-weight-bold\")}\r\n                        {renderPropItem('CAS', CAS, \"font-weight-bold\")}\r\n                        {renderPropItem('纯度', purity)}\r\n                        {renderPropItem('分子式', molecularFomula)}\r\n                        {renderPropItem('分子量', molecularWeight)}\r\n                        {renderBrand(brand)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {this.renderVm(VFavorite, { product })/*this.controller.renderFavoritesLabel(product)*/}\r\n            {this.renderVm(VPrice, product) /*renderProductPrice(product, discount)*/}\r\n        </div>;\r\n        /*\r\n        let NewProductPropItem = (caption: string, value: any, captionClass?: string,isSplit?:boolean) => {\r\n            if (value === null || value === undefined || value === '0') return null;\r\n            let Class = captionClass ? classNames(captionClass) : \"\";\r\n            let Split = isSplit === undefined || isSplit  ? ' | ' : '';\r\n            return <span className={classNames(Class)}>{Split} {caption}：{value}</span>\r\n        }\r\n        return <>\r\n            <div className=\"col-lg-4 product-left-card \">\r\n                <div className=\"preview\">\r\n                    <ProductImage chemicalId={imageUrl} className=\"border\" />\r\n                    <div className=\"left-below display-desktop mt-1\">\r\n                        {this.renderProductMaterial()}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"col-lg-8\">\r\n                <div className=\"details\">\r\n                    <h5 className=\"product-title\">{description} <b><br />{descriptionC}</b></h5>\r\n                    <p>\r\n                        {NewProductPropItem('产品编号',origin,'',false)}\r\n                        {NewProductPropItem('CAS',CAS)}\r\n                        {NewProductPropItem('纯度',purity)}\r\n                        {NewProductPropItem('分子式',molecularFomula)}\r\n                        {NewProductPropItem('分子式',molecularWeight)}\r\n                        {NewProductPropItem('品牌',brand.name)}\r\n                    </p>\r\n                    {false && <p>产品编号：{origin} | CAS： {CAS} { brand ? `|  品牌：${brand.name}`:''}</p> }\r\n                </div>\r\n                {this.controller.renderFavoritesLabel(id)}\r\n                <div className=\"mt-lg-2\">\r\n                    {packs.map((v: any) => <div key={v.pack.id}>{this.renderPack(v)}</div> )}\r\n                </div>\r\n            </div>\r\n        </>\r\n        */\r\n        // { this.renderVm(VProductFavirateLabel, this.productBox) }\r\n    }\r\n\r\n    private arrTemplet = (item: ProductPackRow) => {\r\n        let { pack, retail, vipPrice, promotionPrice } = item;\r\n        let right = null;\r\n        if (retail) {\r\n            let price: number = this.minPrice(vipPrice, promotionPrice);\r\n            let retailUI: any;\r\n            if (price) {\r\n                retailUI = <small className=\"text-muted\"><del>¥{retail}</del></small>;\r\n            }\r\n            else {\r\n                price = retail;\r\n            }\r\n            right = <div className=\"row\">\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\">\r\n                    <small className=\"text-muted\">{retailUI}</small>&nbsp; &nbsp;\r\n                    <span className=\"text-danger\">¥ <span className=\"h5\">{price}</span></span>\r\n                </div>\r\n                <div className=\"col-sm-6 pb-2 d-flex justify-content-end align-items-center\"><FormField name=\"quantity\" /></div>\r\n            </div >\r\n        } else {\r\n            right = <small>请询价</small>\r\n        }\r\n\r\n        return <div className=\"px-2\">\r\n            <div className=\"row\">\r\n                <div className=\"col-4 p-0\">\r\n                    <div><b>{tv(pack)}</b></div>\r\n                    <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n                </div>\r\n                <div className=\"col-8 p-0\">\r\n                    {right}\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private onQuantityChanged = async (context: RowContext, value: any, prev: any) => {\r\n        let { data } = context;\r\n        let { pack, retail, vipPrice, promotionPrice, currency } = data;\r\n        let price = this.minPrice(vipPrice, promotionPrice) || retail;\r\n        let { cApp, product } = this.controller;\r\n        let { cart } = cApp;\r\n        if (value > 0)\r\n            await cart.add(product, pack, value, price, retail, currency);\r\n        else\r\n            await cart.removeItem([{ productId: product.id, packId: pack.id }]);\r\n    }\r\n\r\n    private minPrice(vipPrice: any, promotionPrice: any) {\r\n        if (vipPrice || promotionPrice)\r\n            return Math.min(typeof (vipPrice) === 'number' ? vipPrice : Infinity, typeof (promotionPrice) === 'number' ? promotionPrice : Infinity);\r\n    }\r\n\r\n    private uiSchema: UiSchema = {\r\n        Templet: this.arrTemplet,\r\n        items: {\r\n            quantity: {\r\n                widget: 'custom',\r\n                className: 'text-center',\r\n                WidgetClass: MinusPlusWidget as any,\r\n                onChanged: this.onQuantityChanged\r\n            } as UiCustom\r\n        },\r\n    };\r\n\r\n    private renderPack = (pack: ProductPackRow) => {\r\n        return <>\r\n            <div className=\"sep-product-select\" />\r\n            <Form className=\"mx-3\" schema={schema} uiSchema={this.uiSchema} formData={pack} />\r\n        </>;\r\n    }\r\n\r\n    private dealWithPDF = (fileName: string) => {\r\n        let shiftArr = fileName ? fileName.replace(/\\.pdf/ig, '').split('_') : [];\r\n        let lang = shiftArr[1];\r\n        let caption = languageCaptions[lang];\r\n        if (!caption) caption = languageCaptions['CN'];\r\n        /*\r\n        switch (shiftArr[1]) {\r\n            case 'DE':\r\n                return '德文';\r\n            case 'EN':\r\n                return '英文';\r\n            case 'EN-US':\r\n                return '英美';\r\n            case 'CN':\r\n                return '中文';\r\n            default:\r\n                return '中文';\r\n        }\r\n        */\r\n        return caption;\r\n    }\r\n\r\n    private renderPDF = (content: any) => {\r\n        let { fileName } = content;\r\n        let language = this.dealWithPDF(fileName);\r\n        let { ToVerifyPdf, product } = this.controller;\r\n        return <div className=\"mx-2 d-flex flex-column text-center\" onClick={() => { ToVerifyPdf({ content, product }) }}>\r\n            <img src={pdfIcon} alt=\"\" style={{ width: 24 }} />\r\n            <div className=\"small\">{language}</div>\r\n        </div>\r\n    }\r\n\r\n    private renderProductMaterial = () => {\r\n        let { MSDSFiles, specFiles, data } = this.controller.product;\r\n        let MaterialArr = [\r\n            { type: '化学品安全技术说明书(SDS)', content: MSDSFiles },\r\n            { type: '技术规格说明书(SPEC)', content: specFiles }\r\n        ];//COA EUM\r\n        // let MaterialArr = [{ type: 'MSDS', content: productMSDSFiles }, { type: 'SPEC', content: productSpecFiles }];//COA EUM\r\n\r\n        let renderListItemPDF = (Material: any, index: number) => {\r\n            let { type, content } = Material;\r\n            if (content.length) {\r\n                /* return <div className=\"d-flex pt-2 border-bottom\">\r\n                    <div className=\"w-3c align-self-center mr-2 mb-2\" >{type}</div>\r\n                    <List items={content} item={{ render: this.renderPDF, className: 'px-2 border-left' }} className=\"d-flex bg-light mb-1\" />\r\n                </div> */\r\n                return <>\r\n                    <div className=\"accordion background-grey w-100\" style={{ background: '#F2F2F2' }}>\r\n                        <a className=\"w-100 btn text-left collapsed\" data-toggle=\"collapse\" href={`#description${index}`} role=\"button\" aria-expanded=\"false\" aria-controls=\"jk\" target=\"_blank\">\r\n                            {type}&emsp;<i className=\"fa fa-chevron-down\"></i>\r\n                        </a>\r\n                    </div>\r\n                    <div className=\"container collapse show w-100 pt-2 px-0 border border-top-0\" id={`description${index}`}>\r\n                        <List items={content} item={{ render: this.renderPDF, className: 'px-2' }} className=\"d-flex bg-light mb-1\" />\r\n                    </div>\r\n                </>\r\n            } else {\r\n                return null;\r\n            }\r\n        };\r\n        return <List items={MaterialArr} item={{ render: renderListItemPDF, className: \"d-block pb-2\" }} />;\r\n    }\r\n}\r\n","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { VPage, Scroller, Page } from 'tonva';\r\nimport { CProduct } from './CProduct';\r\nimport { List } from 'tonva';\r\nimport { Product } from 'model';\r\nimport Pagination from 'antd/lib/pagination/Pagination';\r\nimport { observer } from 'mobx-react';\r\nimport { xs } from 'tools/browser';\r\n/*\r\nimport { NavHeader, NavFooter } from 'tools/ShopPage';\r\nimport { xs } from 'tools/browser';\r\nimport { observer } from 'mobx-react-lite';\r\n*/\r\n\r\nexport class VPageList extends VPage<CProduct> {\r\n\t\r\n    private searchKey: string;\r\n    async open() {\r\n        this.openPage(this.page)\r\n        //this.searchKey = key;\r\n        //xs ? this.openPage(this.page) : this.openPage(this.largePage);\r\n\t}\r\n\t\r\n\r\n\t\r\n    /* render(key: any) {\r\n        this.searchKey = key;\r\n        return <this.page />\r\n\t} */\r\n\t\r\n\r\n    private onProductClick = async (product: Product) => {\r\n\t\tlet {id} = product;\r\n\t\t// await this.controller.showProductDetail(product.id);\r\n\t\t//if (this.isWebNav === true) {\r\n\t\t\tlet url = \"/product/\" + id;\r\n\t\t\tconsole.log(url);\r\n\t\t\tthis.navigate(url);\r\n\t\t//}\r\n\t\t//else {\r\n\t\t//\tawait this.controller.showProductDetail(id);\r\n\t\t//}\r\n    }\r\n\r\n    private onScrollBottom = async (scroller: Scroller) => {\r\n        scroller.scrollToBottom();\r\n        let { productsPager,esproductsPager } = this.controller;\r\n        if(!(esproductsPager instanceof Array))\r\n            esproductsPager.more();\r\n        // productsPager.more();\r\n    }\r\n\r\n    private renderProduct = (p: Product) => {\r\n        // console.log(p);\r\n        return this.controller.cApp.cProduct.renderProduct(p);\r\n    }\r\n\r\n\t/* header() {\r\n\t\treturn this.isWebNav===true? null: this.controller.cApp.cHome.renderSearchHeader();\r\n\t}\r\n\r\n\tright() {\r\n\t\treturn this.isWebNav===true? null: this.controller.cApp.cCart.renderCartLabel();\r\n\t} */\r\n\r\n\t/* content() {\r\n        let { productsPager,esproductsPager, searchKey } = this.controller;\r\n        let none = <div className=\"p-3 text-warning\">[无]</div>;\r\n\t\treturn <Page header={''}>\r\n            <div className=\"bg-white py-2 px-3 my-1 text1\"><small className=\" small text-muted\">搜索: </small>{searchKey}</div>\r\n            <div className=\"row mx-0 bg-light\">\r\n                <div className=\"col-lg-3 product-side d-none d-lg-block\">\r\n                    {this.controller.cApp.cProductCategory.renderRootSideBar()}\r\n                </div>\r\n                <div className=\"col-lg-9 product-introduct px-0\">\r\n                    <List before={''} none={none} items={esproductsPager} item={{ render: this.renderProduct, onClick: this.onProductClick }} />\r\n                    <div className=\"text-center mt-3 mb-5 border\">\r\n                        <Pagination onChange={(v)=>{console.log(v);\r\n                        }} defaultCurrent={1} total={500} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\t\t</Page>;\r\n    } */\r\n\t\r\n    private page = observer(() => {\r\n\r\n        let { productsPager, esproductsPager,cApp,searchKey, esProductsPagerMore, esProductsTotal, currentPage} = this.controller;\r\n        let { cHome, cCart } = cApp;\r\n        let header: any, cart: any;\r\n        if (xs) {\r\n            header = cHome.renderSearchHeader();\r\n            cart = cCart.renderCartLabel();\r\n        }\r\n        let none = <div className=\"p-3 text-warning\">[无]</div>\r\n        \r\n        return <Page header={header}  right={cart} onScrollBottom={this.onScrollBottom}>\r\n            <div className=\"bg-white py-2 px-3 my-1 text1\"><small className=\" small text-muted\">搜索: </small>{searchKey}</div>\r\n            <div className=\"row mx-0 bg-light\">\r\n                <div className=\"col-lg-3 product-side d-none d-lg-block\">\r\n                    {this.controller.cApp.cProductCategory.renderRootSideBar()}\r\n                </div>\r\n                <div className=\"col-lg-9 product-introduct px-0\">\r\n                    <List before={''} none={none} items={esproductsPager} item={{ render: this.renderProduct, onClick: this.onProductClick }} />\r\n                    <div className=\"text-center mt-3 mb-5 d-none d-sm-block\">\r\n                        <Pagination onChange={(v) => {\r\n                            document.body.scrollIntoView({behavior: \"smooth\", block: \"end\", inline: \"nearest\"});\r\n                            esProductsPagerMore(v);//scrollTo(0,0);\r\n                        }} defaultCurrent={currentPage} pageSize={20}\r\n                            total={esProductsTotal ? esProductsTotal.value : 0} showSizeChanger={false} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\t\t</Page>;\r\n        \r\n        /* return <Page header={header} right={cart} onScrollBottom={this.onScrollBottom}>\r\n            <div className=\"bg-white py-2 px-3 mb-1 text1\"><small className=\" small text-muted\">搜索: </small>{searchKey}</div>\r\n            <List before={''} none={none} items={esproductsPager} item={{ render: this.renderProduct, onClick: this.onProductClick }} />\r\n        </Page> */\r\n    });\r\n\r\n    /* private largePage = () => {\r\n        let { productsPager, cApp } = this.controller;\r\n        //let { renderHeader, renderFooter } = cApp;\r\n        let none = <div className=\"p-3 text-warning\">[无]</div>\r\n        return <Page webNav={{ navRawHeader: renderHeader(), navRawFooter: renderFooter() }}>\r\n            <div className=\"bg-white py-2 px-3 mb-1\"><small className=\" small text-muted\">搜索: </small>{this.searchKey}</div>\r\n            <List before={''} none={none} items={productsPager} item={{ render: this.renderProduct, onClick: this.onProductClick }} />\r\n        </Page>\r\n\t}; */\r\n}","import * as React from 'react';\r\nimport { CProduct } from './CProduct';\r\nimport { VPage, Page } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react-lite';\r\nimport Pdfh5 from 'pdfh5'\r\nimport \"pdfh5/css/pdfh5.css\";\r\n\r\nexport class VPagePDF extends VPage<CProduct> {\r\n    @observable pdfh5: any;\r\n    @observable fileName: string = '';      /* 文件名称 */\r\n    @observable fileUrl: any;               /* 文件路径 */\r\n    @observable isFoundFile: boolean = true;/* 文件是否存在 */\r\n\r\n    async open(param?: any) {\r\n        this.fileName = this.controller.currentFileName;\r\n        this.fileUrl = param;\r\n        setTimeout(() => {this.parsRenderPDF()}, 50);\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private parsRenderPDF = () => {\r\n        if (this.fileUrl.status) {\r\n            this.isFoundFile = false;\r\n        } else {\r\n            this.isFoundFile = true;\r\n            this.pdfh5 = new Pdfh5(\"#PDFVIEW\", {\r\n                // pdfurl: this.fileUrl\r\n                data: this.fileUrl\r\n            });\r\n        }\r\n    }\r\n\r\n    // showAci\r\n\r\n\r\n    private page = observer(() => {\r\n        let header = <div className=\"w-100 text-center\">{this.fileName}</div>;\r\n        let right = <></>;// <div className=\"mr-2\" onClick={() => this.isShowActionSheet = true}><FA name='ellipsis-h' /></div>;\r\n        //setTimeout(() => {this.ParsRenderPDF()}, 50);\r\n        \r\n        // return <Page header={header} right={right} >\r\n        return <Page >\r\n            {/* <div className=\"position-fixed d-flex flex-column justify-content-end\" style={{ top: 0, left: 0, bottom: 0, right: 0, background: 'rgba(0, 0, 0, .3)' }}>\r\n                <div className=\"\">\r\n                    <div>\r\n                        <button className=\"btn btn-light w-100\">下载</button>\r\n                    </div>\r\n                    <footer className=\"mt-2\">\r\n                        <button className=\"btn btn-light w-100\" onClick={() => this.isShowActionSheet = false}>取消</button>\r\n                    </footer>\r\n                </div>\r\n            </div> */}\r\n            {\r\n                this.isFoundFile \r\n                    ? <div id=\"PDFVIEW\" className=\"w-100 my-2\" style={{ height: '100vh',overflowY:'auto' }}></div>\r\n                    : <div className=\"text-center py-5\">{this.fileUrl.msg}</div>\r\n            }\r\n        </Page>\r\n    })\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { VPage, autoHideTips } from 'tonva';\r\nimport { CProduct } from './CProduct';\r\nimport { Page } from '../tonva/components/page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { xs } from '../tools/browser';\r\nimport { VPagePDF } from './VPagePDF';\r\nimport { languageCaptions } from './VPageProduct';\r\n\r\nconst materialCaptions:{[type:string]:any} = {\r\n\t'MSDS': {type:'MSDS', CName:\"化学品安全技术说明书\", EName:'Material Safety Data Sheet (MSDS)'},\r\n\t'SPEC': {type:'SPEC', CName:\"技术规格说明书\", EName:'Specifications (SPEC)'},\r\n\t'COA': {type:'COA', CName:\"质检报告\", EName:'Certificate of Analysis (COA)'},\r\n}\r\n\r\nconst defLangs = [{language:\"CN\" },{language:\"EN\"},{language: \"DE\" },{language:\"EN-US\"},];\r\n\r\nexport class VPageVerifyCode extends VPage<CProduct> {\r\n    private productOrigin: HTMLInputElement;\r\n    private productLot: HTMLInputElement;\r\n    private captchaInput: HTMLInputElement;\r\n    private selectVal: HTMLSelectElement;\r\n\tprivate productOriginTip = observable.box<string>();\r\n\tprivate productLotTip = observable.box<string>();\r\n\tprivate captchaTip = observable.box<string>();\r\n\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.page, {origin:param});\r\n\t}\r\n\r\n\t/* header() {return <div className=\"w-100 text-center\">产品资料</div>}\r\n\r\n\tright(){return <></>}\r\n */\r\n\tpage = observer((param?: any) => {\t\t\r\n\r\n\t\tlet { materialType } = this.controller;\r\n\t\tlet assistContent = (materialType === 'MSDS' || materialType === 'SPEC') ? <>{this.captchaUI(materialType)}</> : <>{this.lots()}</>; \r\n\t\tlet content = materialCaptions[materialType];\r\n\t\tlet header: any,right:any;\r\n\t\tif (xs) {\r\n\t\t\theader = <div className=\"w-100 text-center\">产品资料</div>;\r\n\t\t\tright = <></>;\r\n\t\t};\r\n\t\tlet { origin } = param;\r\n\t\treturn <Page header={header} right={right}>\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t<div className=\"col-lg-12\"><h1 className=\"title my-4\">{content.CName}</h1></div>\r\n\t\t\t\t\t<div className=\"col-lg-12\">\r\n\t\t\t\t\t\t<div className=\"box\">\r\n\t\t\t\t\t\t\t<div className=\"content\">\r\n\t\t\t\t\t\t\t\t<p>{content.EName}</p>\r\n\t\t\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"col-md-3\">\r\n\t\t\t\t\t\t\t\t\t\t<input ref={v => this.productOrigin = v} type=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='form-control border-primary my-2' defaultValue={origin ? origin : ''}  placeholder='产品编号' />\r\n\t\t\t\t\t\t\t\t\t\t{autoHideTips(this.productOriginTip, tip => <div className='small text-danger'>* {tip}</div>)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{assistContent}\r\n\t\t\t\t\t\t\t\t\t<div className=\"col-md-12\">\r\n\t\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary w-5c mt-2 mb-5\" onClick={(e:any)=>{e.preventDefault();this.onSubmit()}}>查询</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Page>\r\n\t\t\r\n\r\n\t\t/* return <div className=\"d-flex flex-column pt-3 m-auto mt-lg-2\" style={{ maxWidth: '20rem' }}>\r\n\t\t\t<div className='d-flex '>\r\n\t\t\t\t<img src={captcha} alt=\"\" className=\"border p-1 rounded-lg\" />\r\n\t\t\t\t<button className=\"btn btn-link btn-block w-6c align-self-end py-0\"\r\n\t\t\t\t\tonClick={(e:any)=>{ getCaptcha()}}>换一张</button>\r\n\t\t\t</div>\r\n\t\t\t<form onSubmit={(e) => { e.preventDefault(); this.onSubmit() }} >\r\n\t\t\t\t<input ref={v => this.verifyCodeInput = v} type=\"text\" \r\n\t\t\t\t\tclassName='form-control border-primary mt-2' \r\n\t\t\t\t\tplaceholder='输入验证码' \r\n\t\t\t\t\tstyle={{ maxWidth: '20rem' }} />\r\n\t\t\t</form>\r\n\t\t\t\r\n\t\t\t{\r\n\t\t\t\t// this.verifyInfo && <div className='small text-danger'>* {this.verifyInfo}</div>\r\n\t\t\t\tautoHideTips(this.verifyInfo, tip => <div className='small text-danger'>* {tip}</div>)\r\n\t\t\t}\r\n\t\t\t<button className=\"btn btn-sm btn-outline-primary mt-2\" type=\"button\" \r\n\t\t\t\tonClick={() => this.onSubmit()} \r\n\t\t\t\tstyle={{ maxWidth: '20rem' }}>确 认</button>\r\n\t\t</div>; */\r\n\t})\r\n\r\n\tprivate lots = () => {\r\n\t\treturn <div className=\"col-md-3\">\r\n\t\t\t\t<input ref={v => this.productLot = v} type=\"text\"\r\n\t\t\t\t\tclassName='form-control border-primary my-2' \r\n\t\t\t\t\tplaceholder='产品批号' />\r\n\t\t\t\t{autoHideTips(this.productLotTip, tip => <div className='small text-danger'>* {tip}</div>)}\r\n\t\t\t</div>\r\n\t}\r\n\r\n\tprivate captchaUI = (type:string) => {\r\n\t\tlet { captcha, productMsdsVersions, getCaptcha } = this.controller;\r\n\t\tlet langUI: undefined | JSX.Element;\r\n\t\t\r\n\t\tif (type === 'MSDS') {\r\n\t\t\tlet langArr: any[] = productMsdsVersions.length ? productMsdsVersions : defLangs;\r\n\t\t\tlangUI = <select ref={v => this.selectVal = v} defaultValue='CN' className=\"p-1 mr-2 mb-2 text-dark\">\r\n\t\t\t\t\t{langArr.map((v: any) => (<option key={v.language} value={v.language}>{languageCaptions[v.language]}</option>))}\r\n\t\t\t\t</select>\r\n\t\t};\r\n\t\treturn <>\r\n\t\t\t<div className=\"col-md-3\">\r\n\t\t\t\t<input ref={v => this.captchaInput = v} type=\"text\"\r\n\t\t\t\t\tclassName='form-control border-primary my-2' placeholder='验证码' />\r\n\t\t\t\t{autoHideTips(this.captchaTip, tip => <div className='small text-danger'>* {tip}</div>)}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"col-md-6 my-2\">\r\n\t\t\t\t{langUI}\r\n\t\t\t\t<img src={captcha} alt=\"\" className=\"border p-1 rounded-lg mb-1\" style={{height:35}} />\r\n\t\t\t\t<button className=\"btn btn-link btn-block w-5c p-0 m-0 d-inline-block align-self-center\"\r\n\t\t\t\t\tonClick={(e:any) => { e.preventDefault();getCaptcha()}}>换一张</button>\r\n\t\t\t</div>\r\n\t\t</>;\r\n\t}\r\n\r\n\tprivate onSubmit = async () => {\r\n        let productOrigin = this.productOrigin.value;\r\n        let productLot = this.productLot ? this.productLot.value : true;\r\n\t\tlet currtCaptcha = this.captchaInput ? this.captchaInput.value : true;\r\n\r\n\t\tif (!productOrigin) this.productOriginTip.set('产品编号不可为空');\r\n\t\tif (!productLot) this.productLotTip.set('产品批号不可为空');\r\n\t\tif (!currtCaptcha) this.captchaTip.set('验证码不可为空');\r\n\r\n\t\tif (!productOrigin || !productLot || !currtCaptcha) return;\r\n\t\tlet {  getPDFFileUrl } = this.controller;\r\n\t\tlet content: any = await getPDFFileUrl({ origin: productOrigin ,captcha: currtCaptcha, lang: this.selectVal ? this.selectVal.value : undefined, lot: productLot });\r\n\t\tif (content === undefined) return;\r\n\t\tif (content.status) {\r\n\t\t\tif (content.status === 400) this.captchaTip.set(content.msg);\r\n\t\t\t else alert(content.msg);\r\n\t\t} else {\r\n\t\t\tif (this.captchaInput) this.captchaInput.value = '';\r\n\t\t\tif (this.productLot) this.productLot.value = '';\r\n\t\t\tthis.openVPage(VPagePDF, content);\r\n\t\t};\r\n    }\r\n}\r\n","import { observable } from 'mobx';\r\nimport { BoxId, QueryPager } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VPageProduct } from './VPageProduct';\r\nimport { VPageList } from './VPageList';\r\nimport { VPagePDF } from './VPagePDF';\r\nimport { VPageVerifyCode } from './VPageVerifyCode';\r\nimport { VDelivery, VInCart, VProductWithPrice, VProuductView2 } from './views';\r\nimport { Product } from '../model';\r\nimport { GLOABLE } from 'global';\r\nimport { ElasticSearchPager } from '../tools/elasticSearchPager';\r\nimport { xs } from 'tools/browser';\r\n\r\n/**\r\n *\r\n */\r\n/*\r\ninterface ProductProps {\r\n    //packs?: {[packId:number]: PackValues};\r\n    inventoryAllocation?: any[];\r\n    futureDeliveryTimeDescription?: string;\r\n    chemical?: any;\r\n    prices?: any;\r\n    favorite?: boolean;\r\n    MSDSFiles: any;\r\n    specFiles: any;\r\n    data: any;\r\n    discount: any;\r\n}\r\n*/\r\n\r\nexport class CProduct extends CUqBase {\r\n    productsPager: QueryPager<Product>;\r\n    @observable esproductsPager: ElasticSearchPager<Product> | any[];\r\n    @observable esProductsTotal: any;\r\n    @observable currentPage: number = 1;\r\n    //@observable productSpecFiles: any[] = [];\r\n    //@observable productMSDSFiles: any[] = [];\r\n    //@observable futureDeliveryTimeDescriptionContainer: { [cacheId: string]: string } = {};\r\n    //@observable chemicalInfoContainer: { [productId: number]: any } = {};\r\n\r\n    @observable captcha: any;\r\n    @observable materialType: string;\r\n    @observable currentFileName: any;\r\n    @observable currentLanguage: any;\r\n    @observable currentProduct: any;\r\n    @observable productMsdsVersions: any[] = [];\r\n    @observable showFavorites: Boolean = false;\r\n\r\n    //@observable productData: any;\r\n    //@observable product: any;\r\n    //@observable discount: any;\r\n\r\n    private salesRegion: any;\r\n    private language: any;\r\n\r\n    product: Product;\r\n\r\n    searchKey: string;\r\n    protected async internalStart(param?: any) {\r\n        this.searchKey = param;\r\n        this.searchByKey();\r\n        this.openVPage(VPageList);\r\n    }\r\n\r\n    /*\r\n    renderProductList2(key: any) {\r\n        return this.renderView(VProductList);\r\n    }\r\n    */\r\n\r\n    private productConverter = (item: any, queryResults?: { [name: string]: any[] }): Product => {\r\n        let product = this.cApp.getProduct(item.id);\r\n        product.props = item;\r\n        // product.props.imageUrl = item.chemical.toString();\r\n        product.loadListItem();\r\n        return product;\r\n    }\r\n\r\n    private async searchByKey() {\r\n        let { currentSalesRegion } = this.cApp;\r\n        if (xs) {\r\n            this.esproductsPager = new ElasticSearchPager<Product>(GLOABLE.CONTENTSITE + '/api/search', 10, 10);\r\n            this.esproductsPager.setItemConverter(this.productConverter);\r\n            this.esproductsPager.first({\r\n                keyWord: this.searchKey,\r\n                salesRegion: currentSalesRegion.id\r\n            });\r\n        };\r\n        if (!xs) await this.esProductsPagerMore(this.currentPage);\r\n\r\n        /* this.productsPager = new QueryPager<Product>(this.uqs.product.SearchProduct, 10, 10);\r\n        this.productsPager.setItemConverter(this.productConverter);\r\n        this.productsPager.first({\r\n            keyWord: this.searchKey,\r\n            salesRegion: currentSalesRegion.id\r\n        }); */\r\n    }\r\n\r\n    searchWebByKey(key: string) {\r\n        let { currentSalesRegion } = this.cApp;\r\n        this.productsPager = new QueryPager<any>(this.uqs.product.SearchProduct, 3, 3);\r\n        this.productsPager.setItemConverter(this.productConverter);\r\n        this.productsPager.first({ keyWord: key, salesRegion: currentSalesRegion.id })\r\n    }\r\n\r\n    async searchByCategory({ productCategory, name }: { productCategory: number; name: string }) {\r\n        this.searchKey = name; this.currentPage = 1;\r\n        await this.searchByKey();\r\n\r\n        /* this.productsPager = new QueryPager<any>(this.uqs.product.SearchProductByCategory, 10, 10);\r\n        this.productsPager.setItemConverter(this.productConverter);\r\n        await this.productsPager.first({\r\n            productCategory,\r\n            salesRegion: currentSalesRegion.id\r\n        }); */\r\n\r\n        this.openVPage(VPageList);\r\n    }\r\n\r\n    esProductsPagerMore = async (page: number) => {\r\n        this.currentPage = page;\r\n        let url = GLOABLE.CONTENTSITE + '/api/search/' + this.searchKey + '/' + page;\r\n        let resp = await fetch(url, {\r\n            method: 'GET',\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n            },\r\n        });\r\n        let ret = await resp.json();\r\n        let items = ret.hits;\r\n        let arr = [];\r\n        for (let key of items) {\r\n            let product = this.productConverter(key);\r\n            arr.push(product);\r\n        }\r\n        this.esproductsPager = arr;\r\n        this.esProductsTotal = ret.total;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    showProductDetail = async (productId: BoxId | number | string, JumpSource?: any) => {\r\n        if (!productId) return;\r\n        if (typeof productId === 'string') {\r\n            productId = Number(productId);\r\n        }\r\n        this.product = this.cApp.getProduct(productId);\r\n        await this.product.loadDetail();\r\n        if (JumpSource) this.closePage();\r\n        this.openVPage(VPageProduct);\r\n    }\r\n\r\n    /*\r\n    renderProductPrice = (product: BoxId, discount: number) => {\r\n        return this.renderView(VProductPrice, { product: product, discount: discount });\r\n    }\r\n    */\r\n\r\n    renderProductWithPrice = (product: BoxId) => {\r\n        return this.renderView(VProductWithPrice, product);\r\n    }\r\n\r\n    /*\r\n    getProductPrice = async (product: BoxId, salesRegionId: number, discount: number) => {\r\n        let { id: productId } = product;\r\n        let { currentSalesRegion, cart, currentLanguage, uqs } = this.cApp;\r\n\r\n        let prices = await uqs.product.PriceX.table({ product: product, salesRegion: salesRegionId });\r\n        let priceSet = prices.filter(e => e.discountinued === 0 && e.expireDate > Date.now()).sort((a, b) => a.retail - b.retail).map(element => {\r\n            let ret: any = {};\r\n            ret.pack = element.pack;\r\n            ret.retail = element.retail;\r\n            if (discount !== 0)\r\n                ret.vipPrice = Math.round(element.retail * (1 - discount));\r\n            ret.currency = currentSalesRegion.currency;\r\n            ret.quantity = cart.getQuantity(productId, element.pack.id)\r\n            return ret;\r\n        });\r\n        let promises: PromiseLike<any>[] = [];\r\n        priceSet.forEach(v => {\r\n            promises.push(uqs.promotion.GetPromotionPack.obj({ product: productId, pack: v.pack, salesRegion: currentSalesRegion, language: currentLanguage }));\r\n        })\r\n        let results = await Promise.all(promises);\r\n\r\n        for (let i = 0; i < priceSet.length; i++) {\r\n            let promotion = results[i];\r\n            let discount = promotion && promotion.discount;\r\n            if (discount)\r\n                priceSet[i].promotionPrice = Math.round((1 - discount) * priceSet[i].retail);\r\n        }\r\n        return priceSet;\r\n    }\r\n    */\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        return this.renderView(VDelivery, pack);\r\n    }\r\n\r\n    /*\r\n    renderChemicalInfoInCart = (product: BoxId) => {\r\n        return this.renderView(VChemicalInfoInCart, product);\r\n    }\r\n    */\r\n\r\n    /*\r\n    renderFavoritesLabel = (product: Product) => {\r\n        //let { cApp } = this;\r\n        //let { cFavorites } = cApp;\r\n        //return cFavorites.renderFavoritesLabel(product);\r\n        return this.renderView(VFavorite, product);\r\n    }\r\n    */\r\n\r\n    /**\r\n     *\r\n     */\r\n    renderProduct = (product: Product) => {\r\n        return this.renderView(VProuductView2, product);\r\n    }\r\n\r\n    renderCartProduct = (product: Product) => {\r\n        return this.renderView(VInCart, product);\r\n    }\r\n\r\n    /**\r\n     * 在线预览PDF,开启验证\r\n     */\r\n    ToVerifyPdf = async (fileInfo: any) => {\r\n        //let { currentUser } = this.cApp;\r\n        let { content, product } = fileInfo;\r\n        let reg = /\\w*\\//ig\r\n        this.currentFileName = content.fileName ? content.fileName.replace(reg, '').toLocaleUpperCase() : undefined;\r\n        this.currentLanguage = content.language;\r\n        this.currentProduct = product;\r\n        await this.cApp.assureLogin();\r\n        //let loginCallback = async (user: User) => {\r\n        //    await currentUser.setUser(user);\r\n        //    this.closePage(1);\r\n        //    await this.openMaterial();\r\n        //};\r\n        //if (!this.isLogined)\r\n        //    nav.showLogin(loginCallback, true);\r\n        //else\r\n        // await this.openMaterial();\r\n    }\r\n\r\n    /**\r\n     * 获取PDF文件流\r\n     */\r\n    getPDFFileUrl = async (row: any) => {\r\n        // await this.cApp.assureLogin();\r\n        let { origin, captcha, lang, lot } = row;\r\n        if (this.materialType === 'MSDS')\r\n            return await this.fetchPdf('/partial/productMsdsFileByOrigin/' + `${lang}/${origin}/${captcha}`);\r\n        if (this.materialType === 'SPEC')\r\n            return await this.fetchPdf('/partial/productSpecFileByOrigin/' + `${origin}/${captcha}`);\r\n        if (this.materialType === 'COA') {\r\n            return undefined;\r\n        };\r\n    }\r\n\r\n    fetchPdf = async (url: string) => {\r\n        let res = await window.fetch(GLOABLE.CONTENTSITE + url);\r\n        if (res.status === 200) {\r\n            let content = await res.arrayBuffer();\r\n            return content;\r\n        } else {\r\n            return {\r\n                status: res.status,\r\n                msg: res.status !== 400 ? res.statusText : '验证码错误!'\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取验证码\r\n     */\r\n    getCaptcha = async () => {\r\n        let timer = (new Date()).getTime();\r\n        this.captcha = GLOABLE.CONTENTSITE + `/partial/captcha/?timer=${timer}`;//'http://dummyimage.com/200x100';\r\n    }\r\n\r\n    /**\r\n     * 产品资料页面\r\n     */\r\n    openMaterial = async (Type?: string, id?: string) => {\r\n        if (Type === 'MSDS' || Type === 'SPEC') await this.getCaptcha();\r\n        this.materialType = Type;\r\n        let origin: any;\r\n        if (!isNaN(Number(id))) this.product = this.cApp.getProduct(Number(id));\r\n        if (this.product && this.product.props) {\r\n            origin = this.product.props.origin;\r\n            if (origin && Type === 'MSDS') {\r\n                let result = await window.fetch(GLOABLE.CONTENTSITE + '/partial/productMsdsVersion/' + origin);\r\n                if (result.ok) {\r\n                    this.productMsdsVersions = await result.json();\r\n                }\r\n                else this.productMsdsVersions = [];\r\n            }\r\n        }\r\n        this.openVPage(VPageVerifyCode, origin);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { View } from '../tonva/vm/view';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { CApp } from '../tapp/CApp';\r\nimport { COrder } from './COrder';\r\nimport { FA } from 'tonva';\r\n\r\n\r\nexport class VModelByCreateOrder extends View<COrder>{\r\n\r\n    render() {\r\n        let { modalTitle, modalTitleS, renderModelContent } = this.controller;\r\n        let showBack = modalTitle && modalTitleS[modalTitle].preLevel;\r\n        return <div className='modal modal-dialog-show' style={{ display: modalTitle ? 'block' : 'none', background: \"rgba(0,0,0,.3)\", }}>\r\n            <div className=\"d-flex justify-content-center align-content-center w-100 h-100\" >\r\n                <div className=\"border bg-light m-auto rounded pb-4 position-relative\" style={{ maxWidth: 800 }}>\r\n                    <div className=\"position-absolute cursor-pointer\" style={{ right: 5, top: 0 }} onClick={() => { this.controller.modalTitle = ''; }}><FA name=\"times-circle-o\" className=\"text-primary\" /></div>\r\n                    {\r\n                        showBack &&\r\n                        <div className=\"position-absolute cursor-pointer\" style={{ left: 8, top: 8 }}\r\n                            onClick={() => { this.controller.modalTitle = modalTitleS[modalTitle]?.preLevel }}>\r\n                            <FA name=\"chevron-left\" className=\"text-break\" />\r\n                        </div>\r\n                    }\r\n                    <div className=\"text-center border-bottom h4 py-2\">{modalTitleS[modalTitle]?.title}</div>\r\n                    <div className=\"h-max-30c overflow-auto scroll-S\" style={{overflowX:\"hidden\"}}>{renderModelContent()}</div>\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, tv, List, LMR, FA, autoHideTips } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { OrderItem } from './Order';\r\nimport { CartPackRow } from '../cart/Cart';\r\nimport classNames from 'classnames';\r\n//import { GLOABLE } from 'cartenv';\r\nimport { xs } from '../tools/browser';\r\nimport { VModelByCreateOrder } from './VModelByCreateOrder';\r\n\r\nexport class VCreateOrder extends VPage<COrder> {\r\n\r\n    @observable private useShippingAddress: boolean = true;\r\n    //@observable private shippingAddressIsBlank: boolean = false;\r\n    //@observable private invoiceAddressIsBlank: boolean = false;\r\n\t//@observable private invoiceIsBlank: boolean = false;\r\n\tprivate shippingAddressTip = observable.box();\r\n\tprivate invoiceAddressTip = observable.box();\r\n\tprivate invoiceTip = observable.box();\r\n\r\n    async open(param: any) {\r\n        document.documentElement.scrollIntoView();\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private nullContact = () => {\r\n        return <span className=\"text-primary\">选择收货地址</span>;\r\n    }\r\n\r\n    private packsRow = (item: CartPackRow, index: number) => {\r\n        let { pack, quantity, retail, price } = item;\r\n\r\n        let retailUI: any;\r\n        if (price !== retail) {\r\n            retailUI = <del>¥{retail * quantity}</del>;\r\n        }\r\n        return <div key={index} className=\"px-2 py-2 border-top\">\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-12c mr-4 text-right\">\r\n                    <small className=\"text-muted\">{retailUI}</small>&nbsp; &nbsp;\r\n                    <span className=\"text-danger h5\"><small>¥</small>{parseFloat((price * quantity).toFixed(2))}</span>\r\n                    <small className=\"text-muted\">(¥{parseFloat(price.toFixed(2))} × {quantity})</small>\r\n                </div>\r\n            </div>\r\n            <div>{this.controller.renderDeliveryTime(pack)}</div>\r\n        </div>;\r\n    }\r\n\r\n    private renderOrderItem = (orderItem: OrderItem) => {\r\n        let { product, packs } = orderItem;\r\n        let { controller, packsRow } = this;\r\n        return <div className=\"row w-100 mx-0\">\r\n                <div className=\"col-lg-6 pb-3\">{controller.renderOrderItemProduct(product)}</div>\r\n                <div className=\"col-lg-6\">{\r\n                    packs.map((p, index) => {\r\n                        return packsRow(p, index);\r\n                    })\r\n                }</div>\r\n            </div>\r\n    }\r\n\r\n    private orderItemKey = (orderItem: OrderItem) => {\r\n        let pack = orderItem.packs[0]?.pack;\r\n        let packID = pack ? String(pack.id) : '';\r\n        return orderItem.product.id + packID;\r\n    }\r\n\r\n    private renderCoupon = observer((param: any) => {\r\n        let { couponAppliedData, hasAnyCoupon, removeCoupon } = this.controller;\r\n        if (couponAppliedData['id'] === undefined) {\r\n            let tip = hasAnyCoupon ? \"有可用优惠卡/券，点击使用\" : \"输入优惠券/积分码\";\r\n            return <span className=\"text-primary\">{tip}</span>;\r\n        } else {\r\n            let { code, types } = couponAppliedData;\r\n            let { couponOffsetAmount, couponRemitted, point } = param;\r\n            let offsetUI, remittedUI, noOffsetUI;\r\n            let cancelCouponUI = <div\r\n                className=\"position-absolute text-primary border text-center border-primary dropdown-menu-right rounded-circle\"\r\n                style={{ border: 1, cursor: 'pointer', width: 19, height: 19, lineHeight: 1, top: 5, right: 5 }}\r\n                onClick={(e) => { e.stopPropagation(); removeCoupon(); }}\r\n            >&times;</div>\r\n            if (types === \"credits\") {\r\n                offsetUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                    <div className=\"text-muted\">积分:</div>\r\n                    <div className=\"text-right text-danger\">{point}<small>分</small></div>\r\n                </div>\r\n            }\r\n            else if (couponOffsetAmount || couponRemitted) {\r\n                if (couponOffsetAmount) {\r\n                    offsetUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                        <div className=\"text-muted\">折扣:</div>\r\n                        <div className=\"text-right text-danger\"><small>¥</small>{couponOffsetAmount.toFixed(2)}</div>\r\n                    </div>\r\n                }\r\n                if (couponRemitted) {\r\n                    remittedUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                        <div className=\"text-muted\">抵扣:</div>\r\n                        <div className=\"text-right text-danger\"><small>¥</small>{couponRemitted.toFixed(2)}</div>\r\n                    </div>\r\n                }\r\n            } else {\r\n                noOffsetUI = <div>谢谢惠顾</div>;\r\n            }\r\n            return <div className=\"mr-2 position-relative border-primary border px-3 py-1 rounded\">\r\n                <div className=\"text-success\">{code.substr(0, 4)} {code.substr(4)}</div>\r\n                {offsetUI}\r\n                {remittedUI}\r\n                {noOffsetUI}\r\n                {cancelCouponUI}\r\n            </div>\r\n        }\r\n    });\r\n\r\n    private onBuyerAccountChanged = () => {\r\n\r\n    }\r\n\r\n    private renderBuyerAccount = (item: any) => {\r\n        let { buyerAccount } = item;\r\n        return <div>{tv(buyerAccount, (v) => {\r\n            let { description, organization } = v;\r\n            return <>{description}{tv(organization, (o) => {\r\n                return <>{o.name}</>\r\n            }, undefined, () => null)}</>\r\n        })}</div>\r\n    }\r\n\r\n    private renderBuyerAccounts = observer(() => {\r\n        let { buyerAccounts } = this.controller;\r\n        if (!buyerAccounts || buyerAccounts.length === 0) return null;\r\n        return <div className=\"row mx-0 py-3 bg-white mb-1\">\r\n            <div className=\"col-4 col-sm-2 pb-2 text-muted\">订单账号:</div>\r\n            <div className=\"col-8 col-sm-10\">\r\n                <List items={buyerAccounts} item={{ render: this.renderBuyerAccount, onSelect: this.onBuyerAccountChanged }}></List>\r\n            </div>\r\n        </div>\r\n    })\r\n\r\n    private onSubmit = async () => {\r\n        let { orderData } = this.controller;\r\n        // 必填项验证\r\n\t\tlet { shippingContact, invoiceContact, invoiceType, invoiceInfo } = orderData;\r\n\t\tlet renderTip = (tip:string) => <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> {tip}</div>;\r\n        if (!shippingContact) {\r\n\t\t\tthis.shippingAddressTip.set(renderTip('必须填写收货地址'));\r\n            //this.shippingAddressIsBlank = true;\r\n            //setTimeout(() => this.shippingAddressIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n            return;\r\n        }\r\n        if (!invoiceContact) {\r\n            if (this.useShippingAddress) {\r\n\t\t\t\torderData.invoiceContact = shippingContact; //contactBox;\r\n\t\t\t\tthis.invoiceAddressTip.set(null);\r\n                //this.invoiceAddressIsBlank = false;\r\n            } else {\r\n                //this.invoiceAddressIsBlank = true;\r\n\t\t\t\t//setTimeout(() => this.invoiceAddressIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n\t\t\t\tthis.invoiceAddressTip.set(renderTip('必须填写发票地址'));\r\n                return;\r\n            }\r\n        }\r\n        if (!invoiceType || !invoiceInfo) {\r\n            //this.invoiceIsBlank = true;\r\n\t\t\t//setTimeout(() => this.invoiceIsBlank = false, GLOABLE.TIPDISPLAYTIME);\r\n\t\t\tthis.invoiceTip.set(renderTip('必须填写发票信息'));\r\n            return;\r\n        }\r\n\r\n        this.controller.submitOrder();\r\n    }\r\n\r\n    saveShowModal = (type:string) => {\r\n        this.controller.modalTitle = 'contactList';\r\n        this.controller.replyToContactType = type;\r\n    }\r\n\r\n    private page = observer(() => {\r\n\r\n        let { cApp, orderData, onSelectShippingContact, onSelectInvoiceContact, onInvoiceInfoEdit, onCouponEdit, getValidCardForWebUser } = this.controller;\r\n\t\tlet { currentUser } = cApp;\r\n\t\tlet { allowOrdering } = currentUser;\r\n        let footer = <div className=\"w-100 px-3 py-1\" style={{ backgroundColor: \"#f8f8f8\" }}>\r\n            <div className=\"d-flex justify-content-left\">\r\n                <div className=\"text-danger flex-grow-1 align-self-center\" style={{ fontSize: '1.8rem' }}><small>¥</small>{orderData.amount}</div>\r\n                <button type=\"button\"\r\n                    className={classNames('btn', { 'btn-danger': allowOrdering, 'btn-secondary': !allowOrdering })}\r\n                    onClick={this.onSubmit} disabled={!allowOrdering}>提交订单\r\n                </button>\r\n            </div>\r\n        </div>;\r\n\r\n        let chevronRight = xs ? <FA name=\"chevron-right\" className=\"cursor-pointer\" /> : <></>;\r\n\t\t/*\r\n        let shippingAddressBlankTip = this.shippingAddressIsBlank ?\r\n            <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写收货地址</div>\r\n            : null;\r\n        let invoiceAddressBlankTip = this.invoiceAddressIsBlank ?\r\n            <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写发票地址</div> : null;\r\n\t\t*/\r\n        let divInvoiceContact: any = null;\r\n        if (this.useShippingAddress === false) {\r\n            if (orderData.invoiceContact !== undefined) {\r\n                divInvoiceContact = <div className=\"col-8 col-sm-10 offset-4 offset-sm-2 d-flex\">\r\n                    {tv(orderData.invoiceContact, undefined, undefined, this.nullContact)}\r\n                    <div>{chevronRight}</div>\r\n                </div>\r\n            } else {\r\n                divInvoiceContact = <div className=\"col-8 offset-4 offset-sm-2\">\r\n                    <button className=\"btn btn-outline-primary\"\r\n                        onClick={()=>{ xs ? onSelectInvoiceContact() : this.saveShowModal('invoiceContact')}}>选择发票地址</button>\r\n                    {/*invoiceAddressBlankTip*/}\r\n\t\t\t\t\t{autoHideTips(this.invoiceAddressTip)}\r\n                </div>\r\n            }\r\n\t\t}\r\n\t\t\r\n\t\tlet labeled = (label:string, content:JSX.Element, contentClass?:string):JSX.Element => {\r\n            return <>\r\n\t\t\t\t<div className=\"col-4 col-sm-2 pb-2 text-muted\">{label}</div>\r\n            \t<div className={classNames('col-8 col-sm-10', contentClass)}>{content}</div>\r\n\t\t\t</>;\r\n\t\t};\r\n\t\tlet renderPrice = (price:number, className?:string) => {\r\n\t\t\treturn <div className={classNames('text-right', className)}><small>¥</small>{price}</div>;\r\n\t\t}\r\n\r\n        let invoiceContactUI = <div className=\"row mx-0 py-3 bg-white mb-1\">\r\n\t\t\t{labeled('发票地址:', <label className=\"cursor-pointer\">\r\n\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\tdefaultChecked={this.useShippingAddress}\r\n\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\tthis.useShippingAddress = e.currentTarget.checked;\r\n\t\t\t\t\t\torderData.invoiceContact = undefined;\r\n\t\t\t\t\t\t//this.invoiceAddressIsBlank = false;\r\n\t\t\t\t\t\tthis.shippingAddressTip.set(null);\r\n\t\t\t\t\t}} /> 同收货地址\r\n\t\t\t</label>)}\r\n            {divInvoiceContact}\r\n        </div>\r\n\t\t/*\r\n\t\t            <div className=\"col-4 col-sm-2 pb-2 text-muted\">发票地址:</div>\r\n\t\t\t\t\t<div className=\"col-8 col-sm-10\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<label className=\"cursor-pointer\">\r\n\t\t\t\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t\t\t\t\tdefaultChecked={this.useShippingAddress}\r\n\t\t\t\t\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\t\t\t\t\tthis.useShippingAddress = e.currentTarget.checked;\r\n\t\t\t\t\t\t\t\t\t\torderData.invoiceContact = undefined;\r\n\t\t\t\t\t\t\t\t\t\t//this.invoiceAddressIsBlank = false;\r\n\t\t\t\t\t\t\t\t\t\tthis.shippingAddressTip.set(null);\r\n\t\t\t\t\t\t\t\t\t}} /> 同收货地址\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t*/\r\n\r\n        //let invoiceBlankTip = this.invoiceIsBlank ? <div className=\"text-danger small my-2\"><FA name=\"exclamation-circle\" /> 必须填写发票信息</div> : null;\r\n        let invoiceInfoUI = <div className=\"row mx-0 py-3 bg-white\" onClick={()=>{xs ? onInvoiceInfoEdit(): this.controller.modalTitle='invoiceInfo'}}>\r\n            {labeled('发票信息:',\r\n                <LMR className=\"w-100 align-items-center\" right={chevronRight}>\r\n                    {tv(orderData.invoiceType, (v) => <>{v.description}</>, undefined, () => <span className=\"text-primary\">填写发票信息</span>)}\r\n                    {tv(orderData.invoiceInfo, (v) => <> -- {v.title}</>, undefined, () => <></>)}\r\n                    {/*invoiceBlankTip*/}\r\n\t\t\t\t\t{autoHideTips(this.invoiceTip)}\r\n                </LMR>)}\r\n        </div>\r\n\r\n        let freightFeeUI = <></>;\r\n\t\tlet freightFeeRemittedUI = <></>;\r\n\t\tlet {freightFee, freightFeeRemitted} = orderData;\r\n        if (freightFee) {\r\n            freightFeeUI = labeled('运费:', renderPrice(freightFee, 'text-danger'));\r\n            if (freightFeeRemitted) {\r\n                freightFeeRemittedUI = labeled('运费减免:', renderPrice(freightFeeRemitted, 'text-danger'));\r\n            }\r\n        }\r\n\r\n        let couponUI = <div className=\"row mx-0 py-3 bg-white\" onClick={()=>{xs ? onCouponEdit() : getValidCardForWebUser()}}>\r\n\t\t\t{labeled('优惠卡券:', \r\n                <LMR className=\"w-100 align-items-center\" right={chevronRight}>\r\n                    {React.createElement(this.renderCoupon,\r\n                        {\r\n                            couponOffsetAmount: orderData.couponOffsetAmount,\r\n                            couponRemitted: orderData.couponRemitted,\r\n                            point: orderData.point\r\n                        })}\r\n                </LMR>)}\r\n        </div>;\r\n        let header:any;\r\n        if(xs) header = \"订单预览\";\r\n        return <Page header={header} footer={footer}>\r\n             {!xs ? <div className=\"col-lg-12 px-3\"><h1 className=\"mt-4 mb-3\">订单信息</h1></div> :null }\r\n            <div className=\"px-2\">\r\n                <div className=\"row mx-0 py-3 bg-white\" onClick={()=>{ xs ? onSelectShippingContact() : this.saveShowModal('shippingContact')}}>\r\n\t\t\t\t\t{labeled('收货地址:',\r\n\t\t\t\t\t\t<>\r\n                        <LMR className=\"w-100 align-items-center\" right={chevronRight}>\r\n                            {tv(orderData.shippingContact, undefined, undefined, this.nullContact)}\r\n                        </LMR>\r\n                        {/*shippingAddressBlankTip*/}\r\n\t\t\t\t\t\t{autoHideTips(this.shippingAddressTip)}\r\n                    </>)}\r\n                </div>\r\n                {invoiceContactUI}\r\n                {invoiceInfoUI}\r\n            </div>\r\n            <List items={orderData.orderItems} item={{ render: this.renderOrderItem,className:\"w-100\", key: this.orderItemKey as any }} />\r\n            <div className=\"px-2\">\r\n                <div className=\"row mx-0 py-3 pr-3 bg-white my-1\">\r\n\t\t\t\t\t{labeled('商品总额:', renderPrice(orderData.productAmount))}\r\n                    {freightFeeUI}\r\n                    {freightFeeRemittedUI}\r\n                </div >\r\n                {couponUI}\r\n            </div>\r\n            {this.renderVm(VModelByCreateOrder)}\r\n        </Page>\r\n    })\r\n}","import { BoxId } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\nimport { CartPackRow } from 'cart/Cart';\r\nimport { Product } from 'model';\r\n\r\nexport class Order {\r\n\r\n    webUser: any;\r\n    organization: BoxId;\r\n    customer: any;\r\n\r\n    @observable shippingContact: BoxId;\r\n    @observable invoiceContact: BoxId;\r\n    @observable invoiceType: BoxId;\r\n    @observable invoiceInfo: BoxId;\r\n    @observable orderItems: OrderItem[] = [];\r\n\r\n    @observable freightFee: number;\r\n    @observable freightFeeRemitted: number;\r\n\r\n    /*\r\n    @computed get amount() {\r\n        return parseFloat((this.orderItems.reduce((pv, cv) => (pv + cv.subAmount), 0) +\r\n            (this.freightFee ? this.freightFee : 0) +\r\n            (this.freightFeeRemitted ? this.freightFeeRemitted : 0) +\r\n            (this.couponOffsetAmount ? this.couponOffsetAmount : 0) +\r\n            (this.couponRemitted ? this.couponRemitted : 0)).toFixed(2));\r\n    };\r\n    */\r\n    /**\r\n     * 总金额\r\n     */\r\n    @computed get amount() {\r\n        return parseFloat((this.orderItems.reduce((pv, cv) => (pv + cv.subAmount), 0) +\r\n            (this.freightFee ? this.freightFee : 0) +\r\n            (this.freightFeeRemitted ? this.freightFeeRemitted : 0)).toFixed(2));\r\n    };\r\n    // @computed get productAmount() {\r\n    //     return parseFloat(this.orderItems.reduce((pv, cv) => pv + cv.subAmount, 0).toFixed(2));\r\n    // };\r\n    /**\r\n     * 商品总额(未应用券的价格) -----> 已修 应用目录价计算(总额恒定)\r\n     */\r\n    @computed get productAmount() {\r\n        return parseFloat(this.orderItems.reduce((pv, cv) => pv + cv.subListAmount, 0).toFixed(2));\r\n    };\r\n    currency: BoxId;\r\n    @observable coupon: BoxId;\r\n    @observable couponOffsetAmount: number;\r\n    @observable couponRemitted: number;\r\n    @observable point: number;\r\n    comments: string;\r\n    salesRegion: BoxId;\r\n\r\n    getDataForSave() {\r\n        let orderItems: any[] = [];\r\n        this.orderItems.forEach(oi => {\r\n            oi.packs.forEach(pk => {\r\n                this.currency = pk.currency;\r\n                orderItems.push({\r\n                    product: oi.product, pack: pk.pack, price: pk.price, quantity: pk.quantity\r\n                    , subAmount: pk.quantity * pk.price, retail: pk.retail\r\n                })\r\n            })\r\n        });\r\n        return {\r\n            webUser: this.webUser,\r\n            organization: this.organization,\r\n            customer: this.customer,\r\n            shippingContact: this.shippingContact,\r\n            invoiceContact: this.invoiceContact,\r\n            invoiceType: this.invoiceType,\r\n            invoiceInfo: this.invoiceInfo,\r\n            amount: this.amount,\r\n            currency: this.currency,\r\n            freightFee: this.freightFee,\r\n            freightFeeRemitted: this.freightFeeRemitted,\r\n            coupon: this.coupon,\r\n            couponOffsetAmount: this.couponOffsetAmount,\r\n            couponRemitted: this.couponRemitted,\r\n            point: this.point,\r\n            comments: this.comments,\r\n            orderitems: orderItems, // 前面的必须是小写的orderitems\r\n            salesRegion: this.salesRegion,\r\n        }\r\n    }\r\n}\r\n\r\nexport class OrderItem {\r\n    product: Product;\r\n    @observable packs: CartPackRow[];\r\n    @computed get subAmount() {\r\n        return this.packs.reduce((p, c) => {\r\n            return p + c.price * c.quantity\r\n        }, 0);\r\n    }\r\n    @computed get subListAmount() {\r\n        return this.packs.reduce((p, c) => {\r\n            return p + c.retail * c.quantity\r\n        }, 0);\r\n\t}\r\n\t\r\n\tconstructor(product: Product) {\r\n\t\tthis.product = product;\r\n\t}\r\n}","import * as React from 'react';\r\nimport { VPage, Page, FA } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { xs } from '../tools/browser';\r\n\r\nexport class OrderSuccess extends VPage<COrder> {\r\n\r\n    async open(orderCreateResult: any) {\r\n\r\n        this.openPage(this.page, orderCreateResult);\r\n    }\r\n\r\n    private page = (orderCreateResult: any) => {\r\n        let header: any;\r\n        if (xs) {\r\n            header='下单成功'\r\n        }\r\n        return <Page header={header}>\r\n            <div style={{textAlign: \"center\",paddingTop:\"150px\"}}>\r\n                <p>下单成功，感谢您对百灵威的厚爱!<br/>\r\n                订单编号:<span className=\"mint\">{orderCreateResult.no}</span><br />\r\n                我们会加紧处理，请注意查收短信。</p>\r\n                <img src=\"images/shoppingcart.png\" alt=\"\" className=\"w-min-12c py-5 col-5 col-sm-4 \" />\r\n            </div>\r\n        </Page>\r\n        /* return <Page header=\"下单成功\" back=\"close\">\r\n            <div className=\"py-4 px-3 bg-white mb-3 d-flex\">\r\n                <FA name=\"list-alt\" className=\"text-success mr-3\" size=\"4x\" />\r\n                <div>\r\n                    <p className=\"text-primary\"><span className=\"h4\">下单成功！</span></p>\r\n                    <p className=\"\">\r\n                        订单: <span className=\"h5 text-info\">{orderCreateResult.no}</span><br /><br />\r\n                        <span className=\"text-muted\">我们会加紧处理，请注意查收短信。</span>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </Page> */\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, Tabs, TabCaptionComponent, TabProp } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { List, EasyDate } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { xs } from 'tools/browser';\r\nimport { Ax } from '../tonva/components/ax/index';\r\nimport { ListTable } from 'tools/listTable';\r\n\r\nexport const color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VMyOrders extends VPage<COrder> {\r\n\r\n\t/*\r\n    @observable private pendingOrders: any[];\r\n    @observable private processingOrders: any[];\r\n    @observable private completedOrders: any[];\r\n\t@observable private allOrders: any[];\r\n\t*/\r\n\t@observable private list: any[];\r\n\tprivate currentState: string;\r\n\tprivate tabs: TabProp[];\r\n\r\n\t/*\r\n    async open(param: any) {\r\n        this.currentState = param;\r\n        this.openPage(this.page);\r\n\t}\r\n\t*/\r\n\r\n\tinit(param: any) {\r\n\t\tthis.currentState = param;\r\n\t\tlet { getMyOrders } = this.controller;\r\n\t\tlet oss = [\r\n\t\t\t{ caption: '待审核', state: 'processing', icon: 'desktop' },\r\n\t\t\t{ caption: '待发货', state: 'completed', icon: 'truck' },\r\n\t\t\t{ caption: '所有订单', state: 'all', icon: 'file-text-o' },\r\n\t\t];\r\n\t\t/* let TabCaptionComponent = (label:string, icon:string, color:string) => <div \r\n\t\t\tclassName={'d-flex justify-content-center align-items-center flex-column cursor-pointer ' + color}>\r\n\t\t\t<div><i className={'fa fa-lg fa-' + icon} /></div>\r\n\t\t\t<small>{label}</small>\r\n\t\t</div>; */\r\n\t\tthis.tabs = oss.map(v => {\r\n\t\t\tlet { caption, state, icon } = v;\r\n\t\t\treturn {\r\n\t\t\t\tname: caption,\r\n\t\t\t\tcaption: (selected: boolean) => TabCaptionComponent(caption, icon, color(selected)),\r\n\t\t\t\tcontent: () => {\r\n\t\t\t\t\tif (xs) return <List items={this.list} item={{ render: this.renderOrder }} none=\"[无]\" />;\r\n\t\t\t\t\treturn this.orderListTable(state);\r\n\t\t\t\t},\r\n\t\t\t\tisSelected: this.currentState === state,\r\n\t\t\t\tload: async () => {\r\n\t\t\t\t\tthis.currentState = state;\r\n\t\t\t\t\tthis.list = await getMyOrders(this.currentState);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\tprivate orderListTable = (state:string): JSX.Element => {\r\n\t\tif (!this.list.length) return <div className=\"w-100 text-center py-3\">无</div>;\r\n\t\tlet os: { [state: string]: string } = {\r\n\t\t\t'processing': '待审核',\r\n\t\t\t'completed': '待发货',\r\n\t\t};\r\n        let columns = [{ id: 1, name: '订单编号' },{ id: 2, name: '日期' },{ id: 3, name: '订单状态' },{ id: 4, name: '详情' }];\r\n        let content = <>{ this.list.map((v: any) => {\r\n\t\t\tlet { id, no, date, OState } = v;\r\n\t\t\treturn <tr className=\"article-product-list order-wrap-list\" key={id}>\r\n\t\t\t\t<td data-title={columns[0].name} className=\"mint\">{no}</td>\r\n\t\t\t\t<td data-title={columns[1].name}><EasyDate date={date} /></td>\r\n\t\t\t\t<td data-title={columns[2].name}>{os[state !=='all'? state : OState]}</td>\r\n\t\t\t\t<td data-title={columns[3].name}>\r\n\t\t\t\t\t<Ax href={\"/orderDetail/\" + id} className='w-100 m-3' target=\"_blank\">\r\n\t\t\t\t\t\t<button type='button' className=\"btn-primary w-4c\">详情</button>\r\n\t\t\t\t\t</Ax>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t})}</>;\r\n\t\treturn <ListTable columns={columns} content={content} ></ListTable>;\r\n\t}\r\n\r\n\tprivate renderOrder = (order: any, index: number) => {\r\n\t\tlet { openOrderDetail } = this.controller;\r\n\t\tlet { id, no, date } = order;\r\n\t\treturn <div className=\"m-3\">\r\n\t\t\t<div className=\"d-flex w-100 justify-content-between cursor-pointer\" onClick={() => openOrderDetail(id)}>\r\n\t\t\t<div><span className=\"small text-muted\">订单: </span><strong>{no}</strong></div>\r\n\t\t\t<div className=\"small text-muted\"><EasyDate date={date} /></div>\r\n\t\t</div></div>;\r\n\t\t/* return <Ax href={\"/orderDetail/\" + id } className='w-100 m-3' target='_blank'>\r\n\t\t\t<div className=\"d-flex w-100 justify-content-between cursor-pointer\">\r\n\t\t\t<div><span className=\"small text-muted\">订单: </span><strong>{no}</strong></div>\r\n\t\t\t<div className=\"small text-muted\"><EasyDate date={date} /></div>\r\n\t\t</div></Ax>; */\r\n\t}\r\n\r\n\theader() {\r\n\t\tif (!xs) return '';\r\n\t\treturn '我的订单';\r\n\t}\r\n\r\n\tcontent(): JSX.Element {\r\n\t\tlet title = !xs ? <div className=\"text-left mt-5\"><h1>订单管理</h1></div> : null;\r\n\t\treturn \t<div className=\"row mx-0 bg-light my-1\">\r\n\t\t\t\t<div className=\"col-lg-3 d-none d-lg-block\">\r\n\t\t\t\t\t{this.controller.cApp.cMe.renderMeSideBar()}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={`col-lg-9 px-0 mx-auto ${!xs ? 'px-2' :''}`} style={{maxWidth:!xs ? 800 :'none'}}>\r\n\t\t\t\t\t{title}\r\n\t\t\t\t\t<div className=\"mb-5 reset-z-header-boxS\">\r\n\t\t\t\t\t\t<Tabs tabs={this.tabs} tabPosition=\"top\" tabBg={!xs ? 'bg-light' : ''} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t}\r\n\r\n\tprivate page = () => {\r\n\r\n\t\tlet { getMyOrders } = this.controller;\r\n\t\tlet oss = [\r\n\t\t\t{ caption: '待审核', state: 'processing', icon: 'desktop' },\r\n\t\t\t{ caption: '待发货', state: 'completed', icon: 'truck' },\r\n\t\t\t{ caption: '所有订单', state: 'all', icon: 'file-text-o' },\r\n\t\t];\r\n\t\tlet tabs = oss.map(v => {\r\n\t\t\tlet { caption, state, icon } = v;\r\n\t\t\treturn {\r\n\t\t\t\tname: caption,\r\n\t\t\t\tcaption: (selected: boolean) => TabCaptionComponent(caption, icon, color(selected)),\r\n\t\t\t\tcontent: () => {\r\n\t\t\t\t\treturn <List items={this.list} item={{ render: this.renderOrder }} none=\"[无]\" />\r\n\t\t\t\t},\r\n\t\t\t\tisSelected: this.currentState === state,\r\n\t\t\t\tload: async () => {\r\n\t\t\t\t\tthis.currentState = state;\r\n\t\t\t\t\tthis.list = await getMyOrders(this.currentState);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t\t/*\r\n        let tabs = [{\r\n            name: '待审核',\r\n            caption: (selected: boolean) => TabCaptionComponent(\"待审核\", \"desktop\", color(selected)),\r\n            content: () => {\r\n                return <List items={this.processingOrders} item={{ render: this.renderOrder }} none=\"无待审核订单\" />\r\n            },\r\n            isSelected: this.currentState === 'processing',\r\n            load: async () => {\r\n                this.currentState = 'processing';\r\n                this.processingOrders = await getMyOrders(this.currentState);\r\n            }\r\n        }, {\r\n            name: '待发货',\r\n            caption: (selected: boolean) => TabCaptionComponent(\"待发货\", \"truck\", color(selected)),\r\n            content: () => {\r\n                return <List items={this.completedOrders} item={{ render: this.renderOrder }} none=\"还没有已完成的订单\" />\r\n            },\r\n            isSelected: this.currentState === 'completed',\r\n            load: async () => {\r\n                this.currentState = 'completed';\r\n                this.completedOrders = await getMyOrders(this.currentState);\r\n            }\r\n        }, {\r\n            name: '所有订单',\r\n            caption: (selected: boolean) => TabCaptionComponent(\"所有订单\", \"file-text-o\", color(selected)),\r\n            content: () => {\r\n                return <List items={this.allOrders} item={{ render: this.renderOrder }} none=\"还没有订单\" />\r\n            },\r\n            isSelected: this.currentState === 'all',\r\n            load: async () => {\r\n                this.currentState = 'all';\r\n                this.allOrders = await getMyOrders(this.currentState);\r\n            }\r\n\t\t}];\r\n\t\t*/\r\n\t\t// return <Page header=\"我的订单\" tabs={tabs} tabPosition=\"top\" />\r\n\t\t//return <Tabs tabs={tabs} tabPosition='top' />\r\n\t\treturn <Page header=\"我的订单\">\r\n\t\t\t<Tabs tabs={tabs} tabPosition=\"top\" />\r\n\t\t</Page>\r\n\t}\r\n}","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { VPage, Page, BoxId, EasyDate } from 'tonva';\r\nimport { COrder } from './COrder';\r\nimport { tv } from 'tonva';\r\nimport { List } from 'tonva';\r\nimport { OrderItem } from './Order';\r\nimport { CartItem } from 'cart/Cart';\r\nimport { xs } from '../tools/browser';\r\nimport classNames from 'classnames';\r\n\r\nexport class VOrderDetail extends VPage<COrder> {\r\n\r\n    async open(order: any) {\r\n\r\n        this.openPage(this.page, order);\r\n    }\r\n\r\n\r\n    private packsRow = (item: any, index: number) => {\r\n        let { pack, quantity, price, currency } = item;\r\n\r\n        return <div key={index} className={classNames('px-2 py-2',index !== 0 ? 'border-top' :'')}>\r\n            <div className=\"d-flex align-items-center\">\r\n                <div className=\"flex-grow-1\"><b>{tv(pack)}</b></div>\r\n                <div className=\"w-12c mr-4 text-right\">\r\n                    <span className=\"text-danger h5\"><small>¥</small>{parseFloat((price * quantity).toFixed(2))}</span>\r\n                    <small className=\"text-muted\">(¥{parseFloat(price.toFixed(2))} × {quantity})</small>\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private renderOrderItem = (orderItem: OrderItem) => {\r\n        let { product, packs } = orderItem;\r\n        let { controller, packsRow } = this;\r\n        return <div className=\"row my-1 w-100 mx-0\">\r\n                <div className=\"col-lg-6 pb-3\">{controller.renderOrderItemProduct(product)}</div>\r\n                <div className=\"col-lg-6\">{\r\n                    packs.map((p, index) => {\r\n                        return packsRow(p, index);\r\n                    })\r\n                }</div>\r\n            </div>\r\n\t}\r\n\t\r\n    private page = (order: any) => {\r\n\r\n        let { brief, data } = order;\r\n        let { id, no, state, description, date } = brief;\r\n        let { orderItems, currency, shippingContact, invoiceContact, invoiceType, invoiceInfo, amount, couponOffsetAmount, couponRemitted\r\n            , freightFee, freightFeeRemitted } = data;\r\n        let couponUI;\r\n        if (couponOffsetAmount || couponRemitted) {\r\n            let offsetUI, remittedUI;\r\n            if (couponOffsetAmount) {\r\n                offsetUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                    <div className=\"text-muted\">折扣:</div>\r\n                    <div className=\"text-right text-danger\"><small>¥</small>{couponOffsetAmount}</div>\r\n                </div>\r\n            }\r\n            if (couponRemitted) {\r\n                remittedUI = <div className=\"d-flex flex-row justify-content-between\">\r\n                    <div className=\"text-muted\">抵扣:</div>\r\n                    <div className=\"text-right text-danger\"><small>¥</small>{couponRemitted}</div>\r\n                </div>\r\n            }\r\n            couponUI = <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">优惠券:</div>\r\n                <div className=\"col-9\">\r\n                    {offsetUI}\r\n                    {remittedUI}\r\n                </div>\r\n            </div>\r\n        }\r\n\r\n        let freightFeeUI, freightFeeRemittedUI;\r\n        if (freightFee) {\r\n            freightFeeUI = <>\r\n                <div className=\"text-right text-danger\"><small>¥</small>{freightFee}</div>\r\n            </>\r\n            if (freightFeeRemitted) {\r\n                freightFeeRemittedUI = <>\r\n                    <div className=\"text-right text-danger\"><small>¥</small>{freightFeeRemitted}(减免)</div>\r\n                </>\r\n            }\r\n        }\r\n        let orderAgainUI = <div className=\"d-flex justify-content-center\">\r\n            <button className=\"btn btn-primary w-50\" onClick={async () => { this.controller.orderAgain(order.data) }}>再次下单</button>\r\n        </div>\r\n\r\n        let header: any\r\n        if(xs) header = <>订单详情: {no}</>            //orderAgainUI\r\n        return <Page header={header} footer={<></>}>\r\n            { !xs && <div className=\"alert alert-info alert-signin mt-3\">订单编号 <a href=\"#\" className=\"alert-link\">{no}</a></div>}\r\n            <List items={orderItems} item={{ render: this.renderOrderItem }} />\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">收货地址:</div>\r\n                <div className=\"col-9\">{tv(shippingContact)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">发票地址:</div>\r\n                <div className=\"col-9\">{tv(invoiceContact)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">发票信息:</div>\r\n                <div className=\"col-9\">{invoiceTemplate(invoiceType, invoiceInfo)}</div>\r\n            </div>\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">运费:</div>\r\n                <div className=\"col-9\">{freightFeeUI}{freightFeeRemittedUI}</div>\r\n            </div>\r\n            {couponUI}\r\n            <div className=\"bg-white row no-gutters p-3 my-1\">\r\n                <div className=\"col-3 text-muted\">下单时间:</div>\r\n                <div className=\"col-9 text-right\"><EasyDate date={date} /></div>\r\n            </div>\r\n            <div className=\"bg-white p-3 my-1 text-right\">\r\n                <span className=\"text-danger font-weight-bold\">总金额: {amount}{tv(currency)}</span>\r\n            </div>\r\n        </Page>\r\n    }\r\n}\r\n\r\nfunction invoiceTemplate(invoiceType: BoxId, invoiceInfo: BoxId): JSX.Element {\r\n    return <>\r\n        {tv(invoiceType, invoiceTypeUI, undefined, () => <></>)}<br />\r\n        {tv(invoiceInfo, invoiceInfoUI, undefined, () => <></>)}\r\n    </>\r\n}\r\n\r\nfunction invoiceTypeUI(values: any) {\r\n    let { id, description } = values;\r\n    return <>{description}</>;\r\n}\r\n\r\nfunction invoiceInfoUI(values: any) {\r\n    let { id, title, taxNo, address, telephone, bank, accountNo } = values;\r\n    return <>{title}</>;\r\n}","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, UiSchema, UiInputItem, Form, Context, tv, BoxId, FA, autoHideTips } from 'tonva';\r\nimport { Schema } from 'tonva';\r\nimport { CInvoiceInfo } from './CInvoiceInfo';\r\nimport { xs } from 'tools/browser';\r\nimport { VMeSideBar } from 'me/VMeSideBar';\r\nimport { CrPageHeaderTitle } from 'tools/pageHeaderTitle';\r\n\r\nconst schema: Schema = [\r\n    { name: 'id', type: 'id', required: false },\r\n    { name: 'title', type: 'string', required: false },\r\n    { name: 'taxNo', type: 'string', required: false },\r\n    { name: 'address', type: 'id', required: false },\r\n    { name: 'telephone', type: 'string', required: false },\r\n    { name: 'bank', type: 'string', required: false },\r\n    { name: 'accountNo', type: 'string', required: false },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n    items: {\r\n        id: { visible: false },\r\n        title: {\r\n            widget: 'text', label: '单位全称', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 200) ? '单位全称最多200个字！' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        taxNo: {\r\n            widget: 'text', label: '纳税人识别码', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                if (value) {\r\n                    var regArr = [/^[\\da-z]{10,15}$/i, /^\\d{6}[\\da-z]{10,12}$/i, /^[a-z]\\d{6}[\\da-z]{9,11}$/i, /^[a-z]{2}\\d{6}[\\da-z]{8,10}$/i, /^\\d{14}[\\dx][\\da-z]{4,5}$/i, /^\\d{17}[\\dx][\\da-z]{1,2}$/i, /^[a-z]\\d{14}[\\dx][\\da-z]{3,4}$/i, /^[a-z]\\d{17}[\\dx][\\da-z]{0,1}$/i, /^[\\d]{6}[\\da-z]{13,14}$/i],\r\n                        j = regArr.length;\r\n                    for (var i = 0; i < j; i++) {\r\n                        if (regArr[i].test(value)) {\r\n                            return undefined;\r\n                        }\r\n                    }\r\n                    return '纳税人识别码格式不正确，请重新输入！';\r\n                }\r\n            }\r\n        } as UiInputItem,\r\n        address: {\r\n            widget: 'text', label: '注册地址', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 200) ? '注册地址最多200个字！' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        telephone: {\r\n            widget: 'text', label: '注册电话', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                if (value && !/^(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}$/.test(value))\r\n                    return \"注册电话格式不正确，请重新输入！\";\r\n                else\r\n                    return undefined;\r\n            }\r\n        } as UiInputItem,\r\n        bank: {\r\n            widget: 'text', label: '开户银行', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                return (value && value.length > 100) ? '开户银行名称最多100个字！' : undefined;\r\n            }\r\n        } as UiInputItem,\r\n        accountNo: {\r\n            widget: 'text', label: '银行账号', placeholder: '必填',\r\n            rules: (value: string) => {\r\n                if (value && !/^([1-9]{1})(\\d{14}|\\d{18}|\\d{15})$/.test(value))\r\n                    return \"银行账号格式不正确，请重新输入！\";\r\n                else\r\n                    return undefined;\r\n            }\r\n        } as UiInputItem,\r\n        submit: { widget: 'button', label: '提交' },\r\n    }\r\n}\r\n\r\nconst commonRequired = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: false,\r\n    address: false,\r\n    telephone: false,\r\n    bank: false,\r\n    accountNo: false,\r\n    isDefault: false,\r\n};\r\n\r\nconst valueAddedRequired = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: true,\r\n    address: true,\r\n    telephone: true,\r\n    bank: true,\r\n    accountNo: true,\r\n    isDefault: false,\r\n}\r\n\r\nconst commonVisible = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: false,\r\n    address: false,\r\n    telephone: false,\r\n    bank: false,\r\n    accountNo: false,\r\n    isDefault: true,\r\n};\r\n\r\nconst valueAddedVisible = {\r\n    id: false,\r\n    title: true,\r\n    taxNo: true,\r\n    address: true,\r\n    telephone: true,\r\n    bank: true,\r\n    accountNo: true,\r\n    isDefault: true,\r\n}\r\n\r\nexport class VInvoiceInfo extends VPage<CInvoiceInfo> {\r\n    private form: Form;\r\n\t//@observable showTip: boolean = false;\t\r\n\t//saveTip: string = \"\";\r\n\tprivate saveTip = observable.box();\r\n    private invoiceInfoData: any;\r\n\r\n    async open(origInvoice?: any) {\r\n        this.invoiceInfo(origInvoice);\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    invoiceInfo = (origInvoice?:any) => {\r\n        let { invoiceType, invoiceInfo } = origInvoice;\r\n        this.invoiceType = (invoiceType && invoiceType.id) || 1;\r\n        if (invoiceInfo) {\r\n            invoiceInfo.assure();\r\n            this.invoiceInfoData = { ...invoiceInfo.obj };\r\n        } else {\r\n            this.invoiceInfoData = { 'title': this.controller.cApp.currentUser.defaultOrganizationName };\r\n        }\r\n    }\r\n\r\n    private onFormButtonClick = async (name: string, context: Context) => {\r\n        let { form } = context;\r\n        let { data } = form;\r\n        let invoice = {\r\n            invoiceType: this.invoiceType,\r\n            invoiceInfo: data,\r\n        };\r\n        this.invoiceInfoData = data;\r\n\r\n\t\tlet tip:string;\r\n        try {\r\n            await this.controller.saveInvoiceInfo(invoice);\r\n            tip = \"发票信息已经保存\";\r\n        } catch (error) {\r\n            tip = \"发票信息保存失败，请稍后再试\";\r\n        }\r\n        //this.showTip = true;\r\n\t\t//setTimeout(() => { this.showTip = false; }, 2000);\r\n\t\tthis.saveTip.set(tip);\r\n    }\r\n\r\n    private onSaveInvoice = async () => {\r\n        if (!this.form) return;\r\n        await this.form.buttonClick(\"submit\");\r\n    }\r\n\r\n    @observable invoiceType: number;\r\n\r\n    private buildForm(): JSX.Element {\r\n        let requiredFields: any = this.invoiceType === 1 ? commonRequired : valueAddedRequired;\r\n        let visibleFields: any = this.invoiceType === 1 ? commonVisible : valueAddedVisible;\r\n        schema.forEach(e => {\r\n            let { items } = uiSchema;\r\n            e.required = requiredFields[e.name];\r\n            items[e.name].visible = visibleFields[e.name];\r\n        });\r\n\r\n        return React.createElement(observer(() => {\r\n             return <Form ref={v => this.form = v} className=\"my-3\"\r\n            schema={schema}\r\n            uiSchema={uiSchema}\r\n            formData={this.invoiceInfoData}\r\n            onButtonClick={this.onFormButtonClick}\r\n            fieldLabelSize={3} />\r\n        }))\r\n    }\r\n\r\n    private onInvoiceTypeClick = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.invoiceType = parseInt(event.currentTarget.value);\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let frm = this.buildForm();\r\n\r\n\t\t/*\r\n        let tipUI = this.showTip ? (<div className=\"alert alert-primary\" role=\"alert\">\r\n            <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n            {this.saveTip}\r\n\t\t</div>) : null;\r\n        */\r\n        let header = CrPageHeaderTitle('发票');\r\n        return <Page header={header}>\r\n            <div className=\"row mx-0 bg-light my-1\">\r\n                <div className=\"col-lg-3 d-none d-lg-block\">\r\n                    {this.controller.cApp.cMe.renderMeSideBar()}\r\n                </div>\r\n                <div className=\"col-lg-9 px-0\">\r\n                    { !xs && <div className=\"text-center mt-5\"><h1>发票</h1></div>}\r\n                    {this.renderInvoiceContent()}\r\n                </div>\r\n            </div>\r\n        </Page>\r\n    });\r\n\r\n    @observable InvoiceTypeChecked: boolean;\r\n    render(param?: any): JSX.Element{\r\n        return React.createElement(observer(() => {\r\n            if (!this.InvoiceTypeChecked) {\r\n                let { origInvoice } = param;\r\n                this.invoiceInfo(origInvoice);\r\n                this.InvoiceTypeChecked = true;\r\n            };\r\n            return <>{this.renderInvoiceContent()}</>\r\n        }));\r\n    }\r\n\r\n    renderInvoiceContent = () => {\r\n        let frm = this.buildForm();\r\n        return <>\r\n                <div className=\"px-3 mx-auto\" style={{maxWidth:!xs? 600 :'none'}}>\r\n                    <div className=\"form-group row py-3 mb-1 bg-white\">\r\n                        <div className=\"col-12 col-sm-3 pb-2 text-muted\">发票类型:</div>\r\n                        <div className=\"col-12 col-sm-9\">\r\n                            <div className=\"form-check form-check-inline\">\r\n                                <input className=\"form-check-input\" type=\"radio\" name=\"invoiceType\" id=\"common\" value=\"1\"\r\n                                    onChange={(event) => this.onInvoiceTypeClick(event)} checked={this.invoiceType === 1}></input>\r\n                                <label className=\"form-check-label\" htmlFor=\"common\">增值税普通发票</label>\r\n                            </div>\r\n                            <div className=\"form-check form-check-inline\">\r\n                                <input className=\"form-check-input\" type=\"radio\" name=\"invoiceType\" id=\"valueAdded\" value=\"2\"\r\n                                    onChange={(event) => this.onInvoiceTypeClick(event)} checked={this.invoiceType === 2}></input>\r\n                                <label className=\"form-check-label\" htmlFor=\"valueAdded\">增值税专用发票</label>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"p-3 bg-white mx-auto\" style={{maxWidth:!xs? 600 :'none'}}>\r\n                    {frm}\r\n                    <button type=\"button\"\r\n                        className=\"btn btn-primary w-100\"\r\n                        onClick={this.onSaveInvoice}>确定</button>\r\n                    {/*tipUI*/}\r\n                    {autoHideTips(this.saveTip, <div className=\"alert alert-primary\" role=\"alert\">\r\n                        <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                        {this.saveTip}\r\n                    </div>)}\r\n                </div>\r\n            </>\r\n    }\r\n}\r\n","//import { Controller } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VInvoiceInfo } from './VInvoiceInfo';\r\n//import { CCartApp } from 'CCartApp';\r\n//import { Tuid } from 'tonva';\r\n\r\nexport class CInvoiceInfo extends CUqBase {\r\n    fromOrderCreation: boolean;\r\n\r\n    async internalStart(origInvoice: any, fromOrderCreation: boolean) {\r\n        this.fromOrderCreation = fromOrderCreation;\r\n        this.openVPage(VInvoiceInfo, origInvoice);\r\n    }\r\n\r\n    async saveInvoiceInfo(invoice: any) {\r\n        let invoiceBox =  await this.saveInvoiceInfoData(invoice);\r\n        /* let { invoiceType, invoiceInfo } = invoice;\r\n        let newInvoiceInfo = await this.uqs.customer.InvoiceInfo.save(undefined, invoiceInfo);\r\n\r\n        let { id: newInvoiceInfoId } = newInvoiceInfo;\r\n        let invoiceBox = {\r\n            invoiceType: this.uqs.common.InvoiceType.boxId(invoiceType),\r\n            invoiceInfo: this.uqs.customer.InvoiceInfo.boxId(newInvoiceInfoId),\r\n        }\r\n        // if (isDefault === true || !this.fromOrderCreation) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultInvoice(invoiceBox.invoiceType, invoiceBox.invoiceInfo);\r\n        // } */\r\n        if (this.fromOrderCreation) {\r\n            this.backPage();\r\n            this.returnCall(invoiceBox);\r\n        }\r\n    }\r\n\r\n    async saveInvoiceInfoData(invoice: any) {\r\n        let { invoiceType, invoiceInfo } = invoice;\r\n        let newInvoiceInfo = await this.uqs.customer.InvoiceInfo.save(undefined, invoiceInfo);\r\n\r\n        let { id: newInvoiceInfoId } = newInvoiceInfo;\r\n        let invoiceBox = {\r\n            invoiceType: this.uqs.common.InvoiceType.boxId(invoiceType),\r\n            invoiceInfo: this.uqs.customer.InvoiceInfo.boxId(newInvoiceInfoId),\r\n        }\r\n        // if (isDefault === true || !this.fromOrderCreation) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.setDefaultInvoice(invoiceBox.invoiceType, invoiceBox.invoiceInfo);\r\n        // }\r\n        return invoiceBox;\r\n    }\r\n}","/* eslint-disable */\r\nimport { UQs } from '../uqs';\r\nimport { Tuid, BoxId } from 'tonva';\r\nimport { Order } from 'order/Order';\r\nimport moment from 'moment';\r\n\r\nexport const activityTime = {\r\n    startDate: '2020-09-01',\r\n    endDate: '2020-09-30'\r\n}\r\n\r\nexport class CouponBase {\r\n\r\n    constructor(protected id: BoxId, private code: number, expiredDate: Date, private isValid: boolean) {\r\n        this.expiredDate = new Date(expiredDate);\r\n    }\r\n\r\n    protected expiredDate: Date;\r\n\r\n    getCodeShow() {\r\n        let codeShow = String(this.code);\r\n        let p1 = codeShow.substr(0, 4);\r\n        let p2 = codeShow.substr(4);\r\n        return p1 + ' ' + p2;\r\n    }\r\n\r\n    isAvaliable() {\r\n        return this.isValid && this.expiredDate.getTime() > Date.now()\r\n    }\r\n}\r\n\r\nexport interface OrderPriceStrategy {\r\n\r\n    applyTo(order: Order, uqs: UQs): Promise<void>;\r\n}\r\n\r\nexport function createOrderPriceStrategy(couponData: any): OrderPriceStrategy {\r\n    let { id, code, discount, preferential, validitydate, isValid, types, discountSetting } = couponData;\r\n    switch (types) {\r\n        case \"coupon\":\r\n            if (discountSetting && discountSetting.length > 0)\r\n                return new VIPCard(id, code, validitydate, isValid, discountSetting);\r\n            else\r\n                return new Coupon(id, code, validitydate, isValid, discount, preferential);\r\n            break;\r\n        case \"coupon_sale\":\r\n            return new CouponSale(id, code, validitydate, isValid, discount, preferential);\r\n            break;\r\n        case \"vipcard\":\r\n            return new VIPCard(id, code, validitydate, isValid, discountSetting);\r\n            break;\r\n        case \"credits\":\r\n            return new Credits(id, code, validitydate, isValid);\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n}\r\n\r\n/**\r\n * 优惠券的价格验证策略：成交价格取优惠券折扣价与所购产品品牌折扣价中较高者\r\n */\r\nexport class Coupon extends CouponBase implements OrderPriceStrategy {\r\n\r\n    constructor(protected id: BoxId, code: number, expiredDate: Date, isValid: boolean, protected discount: number, protected preferential: number) {\r\n        super(id, code, expiredDate, isValid);\r\n    }\r\n    async applyTo(orderData: Order, uqs: UQs) {\r\n        orderData.coupon = this.id\r\n        if (this.isAvaliable()) {\r\n            if (this.discount) {\r\n                let { orderItems, salesRegion } = orderData;\r\n                if (orderItems !== undefined && orderItems.length > 0) {\r\n                    let { salesTask, product: uqsProduct } = uqs;\r\n                    let couponOffsetAmount = 0;\r\n                    for (let i = 0; i < orderItems.length; i++) {\r\n                        let oi = orderItems[i];\r\n\t\t\t\t\t\tlet { product, packs } = oi;\r\n\t\t\t\t\t\tlet { brand } = product;\r\n                        //let { ProductX } = uqsProduct;\r\n                        //let productTuid: any = await ProductX.load(product)\r\n                        // 获取品牌的折扣\r\n                        let { BottomDiscount } = salesTask;\r\n                        let brandDiscountMap: any = await BottomDiscount.obj({ brand, salesRegion: salesRegion.id });\r\n\r\n                        for (let j = 0; j < packs.length; j++) {\r\n                            let pk = packs[j];\r\n                            // 折扣价格取底线折扣价和折扣价格中较高者\r\n                            let lastDiscount = Math.min((brandDiscountMap ? brandDiscountMap.discount : 0), this.discount);\r\n                            let discountPrice = Math.round(pk.retail * (1 - lastDiscount));\r\n                            // 最终价格取折扣价格和显示的价格（可能会有市场活动价)中较低者\r\n                            pk.price = Math.round(Math.min(pk.price, discountPrice));\r\n                            couponOffsetAmount += Math.round(pk.quantity * (pk.retail - pk.price) * -1);\r\n                        };\r\n                    };\r\n                    orderData.couponOffsetAmount = Math.round(couponOffsetAmount);\r\n\r\n                    /*\r\n                    if (agentPrices && agentPrices.length > 0) {\r\n                        let couponOffsetAmount = 0;\r\n                        for (let i = 0; i < orderItems.length; i++) {\r\n                            let oi = orderItems[i];\r\n                            let { product, packs } = oi;\r\n\r\n                            let eachProductAgentPrice = agentPrices[i];\r\n                            for (let j = 0; j < packs.length; j++) {\r\n                                let pk = packs[j];\r\n                                let agentPrice: any = eachProductAgentPrice.find(\r\n                                    (p: any) => p.product.id === product.id &&\r\n                                        p.pack.id === pk.pack.id &&\r\n                                        p.discountinued === 0 &&\r\n                                        p.expireDate > Date.now());\r\n                                if (!agentPrice) break;\r\n\r\n                                // 折扣价格取agentPrice和折扣价格中较高者\r\n                                let discountPrice = Math.round(Math.max(agentPrice.agentPrice, pk.retail * (1 - this.discount)));\r\n                                // 最终价格取折扣价格和显示的价格（可能会有市场活动价)中较低者\r\n                                pk.price = Math.round(Math.min(pk.price, discountPrice));\r\n                                couponOffsetAmount += Math.round(pk.quantity * (pk.retail - pk.price) * -1);\r\n                            };\r\n                        };\r\n                        orderData.couponOffsetAmount = Math.round(couponOffsetAmount);\r\n                    };\r\n                    */\r\n                }\r\n            }\r\n\r\n            if (this.preferential) {\r\n                orderData.couponRemitted = this.preferential * -1;\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * 销售发放的优惠券的价格验证策略（未使用） \r\n */\r\nexport class CouponSale extends Coupon implements OrderPriceStrategy {\r\n\r\n    async applyTo(orderData: Order, uqs: UQs) {\r\n        orderData.coupon = this.id\r\n        if (this.isAvaliable()) {\r\n            if (this.discount) {\r\n                let { orderItems } = orderData;\r\n                if (orderItems !== undefined && orderItems.length > 0) {\r\n                    let couponOffsetAmount = 0;\r\n                    for (let i = 0; i < orderItems.length; i++) {\r\n                        let oi = orderItems[i];\r\n                        let { packs } = oi;\r\n\r\n                        for (let j = 0; j < packs.length; j++) {\r\n                            let pk = packs[j];\r\n                            // 最终价格取折扣价格和显示的价格（可能会有市场活动价)中较低者\r\n                            pk.price = Math.round(Math.min(pk.price, pk.retail * (1 - this.discount)));\r\n                            couponOffsetAmount += Math.round(pk.quantity * (pk.retail - pk.price) * -1);\r\n                        };\r\n                    };\r\n                    orderData.couponOffsetAmount = Math.round(couponOffsetAmount);\r\n                }\r\n            }\r\n\r\n            if (this.preferential) {\r\n                orderData.couponRemitted = this.preferential * -1;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * VIP卡的价格策略:品牌包含在VIP卡折扣表中的，价格为目录价 * 对应的(1-discount)，否则为目录价\r\n */\r\nexport class VIPCard extends CouponBase implements OrderPriceStrategy {\r\n\r\n    constructor(protected id: BoxId, code: number, expiredDate: Date, isValid: boolean, private discountSetting: any[]) {\r\n        super(id, code, expiredDate, isValid);\r\n    }\r\n    async applyTo(orderData: Order, uqs: UQs) {\r\n        orderData.coupon = this.id\r\n        if (this.isAvaliable() && this.discountSetting && this.discountSetting.length > 0) {\r\n            let { orderItems } = orderData;\r\n            if (orderItems !== undefined && orderItems.length > 0) {\r\n                let couponOffsetAmount = 0;\r\n                for (let i = 0; i < orderItems.length; i++) {\r\n                    let oi = orderItems[i];\r\n\t\t\t\t\tlet { product, packs } = oi;\r\n\t\t\t\t\tlet { brand } = product;\r\n                    // 获取明细中产品的VIP卡折扣\r\n                    let thisDiscountSetting = this.discountSetting.find((e: any) => Tuid.equ(e.brand, brand));\r\n                    let discount = (thisDiscountSetting && thisDiscountSetting.discount) || 0;\r\n\r\n                    for (let j = 0; j < packs.length; j++) {\r\n                        let pk = packs[j];\r\n                        pk.priceInit = pk.price === Math.round(pk.retail * (1 - discount)) ? pk.retail : pk.price;\r\n                        // 最终价格取折扣价格和显示的价格（可能会有市场活动价)中较低者\r\n                        pk.price = Math.round(Math.min(pk.price, pk.retail * (1 - discount)));\r\n                        couponOffsetAmount += Math.round(pk.quantity * (pk.retail - pk.price) * -1);\r\n                    };\r\n                };\r\n                orderData.couponOffsetAmount = Math.round(couponOffsetAmount);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport class Credits extends CouponBase implements OrderPriceStrategy {\r\n    async applyTo(orderData: Order, uqs: UQs) {\r\n        orderData.coupon = this.id;\r\n        if (this.isAvaliable()) {\r\n            let { orderItems } = orderData;\r\n            if (orderItems !== undefined && orderItems.length > 0) {\r\n                let couponOffsetAmount = 0;\r\n                for (let i = 0; i < orderItems.length; i++) {\r\n                    let oi = orderItems[i];\r\n                    let { packs } = oi;\r\n                    for (let j = 0; j < packs.length; j++) {\r\n                        let pk = packs[j];\r\n                        pk.priceInit = pk.price;\r\n                        //双倍积分 无折扣 取最大的价格 \r\n                        pk.price = Math.round(Math.max(pk.price, pk.retail));\r\n                        couponOffsetAmount = 0;\r\n                    };\r\n                };\r\n                orderData.couponOffsetAmount = Math.round(couponOffsetAmount);\r\n            }\r\n        }\r\n        let multiple = 2;\r\n        if (IsInActivePeriod()) multiple = 4;\r\n        orderData.point = Math.round(orderData.productAmount * multiple);\r\n    }\r\n}\r\n\r\n/**\r\n * 是否在活动期\r\n */\r\nexport function IsInActivePeriod() {\r\n    let { startDate, endDate } = activityTime;\r\n    let newDate = moment().format('YYYY-MM-DD');\r\n    return newDate >= startDate && newDate <= endDate;\r\n}","import * as React from 'react';\r\nimport { CCoupon } from './CCoupon';\r\nimport { View, FA, LMR } from 'tonva';\r\nimport { VIPCard, IsInActivePeriod, activityTime } from './Coupon';\r\nimport moment from 'moment';\r\nimport { xs } from '../tools/browser';\r\n\r\nfunction getTips(result: number, types: string, code: string) {\r\n    let invalidTip = `${COUPONBASE[types]['name']}【${code}】无效，请与您的专属销售人员联系。`;\r\n    switch (result) {\r\n        case 0:\r\n            invalidTip = `${COUPONBASE[types]['name']}【${code}】不存在，请与您的专属销售人员联系。`;\r\n            break;\r\n        case 2:\r\n            invalidTip = `该${COUPONBASE[types]['name']}【${code}】已失效，请与您的专属销售人员联系。`;\r\n            break;\r\n        case 4:\r\n            invalidTip = `该${COUPONBASE[types]['name']}【${code}】已经使用过，不可重复领用。`;\r\n            break;\r\n        case 6:\r\n            invalidTip = `您不能领用自己发出的${COUPONBASE[types]['name']}【${code}】。`;\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    return invalidTip;\r\n}\r\n\r\nexport class VCoupon extends View<CCoupon> {\r\n\r\n    protected coupon: any;\r\n    protected renderRight = (): JSX.Element => {\r\n        return null;\r\n    }\r\n\r\n    private showDiscountSetting = (vipCardId: VIPCard, event: React.MouseEvent) => {\r\n        event.stopPropagation();\r\n        this.controller.showDiscountSetting(vipCardId);\r\n    }\r\n\r\n    protected renderCardDescription = (): JSX.Element => {\r\n        let { discount } = this.coupon;\r\n        let cardDescription: any;\r\n        if (typeof discount === 'number') {\r\n            if (discount !== 0) {\r\n                let discountShow: any;\r\n                discountShow = (1 - discount) * 10;\r\n                cardDescription = <div className=\"mr-3 font-weight-bold text-danger\"><big>{discountShow === 10 ? '无折扣' : <>{discountShow.toFixed(1)} 折</>}</big></div>\r\n            }\r\n        }\r\n        return cardDescription;\r\n    }\r\n\r\n    protected renderActivityDescription = (): JSX.Element => {\r\n        return null;\r\n    }\r\n\r\n    protected renderCardReveal = (param: any): JSX.Element => {\r\n        let { isOpenMyCouponManage } = this.controller;\r\n        let { result, types, code, validitydate, useddate, expireddate } = this.coupon;\r\n        let CardReveal: any;\r\n        if (!isOpenMyCouponManage) {\r\n            CardReveal = <div className=\"alert alert-primary my-1\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {getTips(result, types, code)}\r\n            </div>\r\n        } else {\r\n            let showDate = validitydate !== undefined ? validitydate : (useddate !== undefined ? useddate : expireddate);\r\n            let newDate = getEasyDate(showDate);\r\n            let content = <div className=\"float-right pr-2\">\r\n                <div className=\"pb-1\">\r\n                    <FA name='th-large' className='mr-1 text-secondary' />\r\n                    <small className=\"ml-3\">{useddate !== undefined ? '使用日期' : '有效期'}: {newDate}</small>\r\n                    {/* <small className=\"ml-3\">{useddate !== undefined ? '使用日期' : '有效期'}: <EasyDate date={showDate} /></small> */}\r\n                </div>\r\n            </div>;\r\n            let left = <div>\r\n                <span className=\"text-body\"><small>{COUPONBASE[types]['name']}</small></span>\r\n            </div>;\r\n            CardReveal = <div className=\"py-3 pl-3 pr-2 mb-1 alert\" style={{ backgroundColor: '#e8eaeb', color: \"text-secondary\" }}>\r\n                <LMR left={left}>\r\n                    {content}\r\n                </LMR>\r\n            </div>\r\n        }\r\n        return CardReveal;\r\n    }\r\n\r\n    protected getCodeShow = (code: number) => {\r\n        let codeShow = String(code);\r\n        let p1 = codeShow.substr(0, 4);\r\n        let p2 = codeShow.substr(4);\r\n        codeShow = p1 + ' ' + p2;\r\n        return codeShow;\r\n    }\r\n\r\n    render(param: any): JSX.Element {\r\n        this.coupon = param\r\n        let { result, code, discount, validitydate, isValid, types } = param;\r\n\r\n        let couponUi;\r\n        if (result !== 1 || !isValid) {\r\n            // this.controller.cApp.currentCouponCode = undefined;\r\n            // couponUi = <div className=\"alert alert-primary my-1\" role=\"alert\">\r\n            //     <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n            //     {getTips(result, types, code)}\r\n            // </div>\r\n            couponUi = this.renderCardReveal(param);\r\n        } else {\r\n            // this.controller.cApp.currentCouponCode = code;\r\n            /*\r\n            let bcenter: any;\r\n            if (preferential)\r\n                bcenter = <div className=\"text-muted\"><small>优惠：<span className=\"mx-3\">￥{preferential}</span></small></div>;\r\n            */\r\n            let tipUI = null;\r\n            if (types !== 'credits') {\r\n                if (discount)\r\n                    tipUI = <small className=\"text-success cursor-pointer\">此{COUPONBASE[types]['name']}全场通用</small>\r\n                else\r\n                    tipUI = <small className=\"text-success cursor-pointer\" onClick={(event) => {\r\n                        event.stopPropagation();\r\n                        if (xs) this.showDiscountSetting(this.coupon, event);\r\n                        else this.controller.showModelCardDiscount(this.coupon)\r\n                    }}>查看适用品牌及折扣</small>\r\n            }\r\n            let newDate = getEasyDate(validitydate);\r\n\r\n            let content = <div className=\"float-right pr-2\">\r\n                <div className=\"pb-1\">\r\n                    <FA name='th-large' className='mr-1 text-warning' />{this.getCodeShow(code)}\r\n                    <small className=\"ml-3\">有效期：{newDate}</small>\r\n                </div>\r\n                <div className=\"float-right\">\r\n                    {tipUI}\r\n                </div>\r\n            </div>;\r\n\r\n            let left = <div>\r\n                <span className=\"text-muted\"><small>{COUPONBASE[types]['name']}</small></span>\r\n                {this.renderCardDescription()}\r\n            </div>;\r\n\r\n            couponUi = <div className=\"bg-white py-3 px-2 mb-1 reset-z-header-boxS\">\r\n                <LMR left={left} right={this.renderRight()}>\r\n                    {content}\r\n                </LMR>\r\n                {this.renderActivityDescription()}\r\n            </div>\r\n        }\r\n        return couponUi;\r\n    }\r\n}\r\n\r\nexport class VVIPCard extends VCoupon {\r\n\r\n    /*\r\n    private showDiscountSetting = (vipCardId: VIPCard, event: React.MouseEvent) => {\r\n        event.stopPropagation();\r\n        this.controller.showDiscountSetting(vipCardId);\r\n    }\r\n\r\n    protected renderRight = (): JSX.Element => {\r\n        return <span className=\"ml-3 my-3\" onClick={(event) => this.showDiscountSetting(this.coupon, event)}>\r\n            <FA name=\"chevron-right\" className=\"corsor-pointer\"></FA>\r\n        </span>;\r\n    }\r\n    */\r\n}\r\n\r\nexport class VCredits extends VCoupon {\r\n\r\n\r\n    protected renderCardDescription = (): JSX.Element => {\r\n        return <div className=\"font-weight-bold text-danger\">\r\n            <big>{\r\n                IsInActivePeriod() ? '限时四倍积分' : '双倍积分'\r\n            }</big>\r\n        </div>\r\n    }\r\n\r\n    protected renderActivityDescription = (): JSX.Element => {\r\n        let { startDate, endDate } = activityTime;\r\n        return IsInActivePeriod() ? <div className=\"text-danger mt-1\">\r\n            <small className=\"text-muted\">{startDate.replace(/-/g, '.')} 至 {endDate.replace(/-/g, '.')} 内下单可获四倍积分 </small>\r\n        </div> : null;\r\n    }\r\n\r\n    /*\r\n    render(param: any): JSX.Element {\r\n        let { coupon, onClick } = param;\r\n        this.coupon = coupon;\r\n        let { result, id, code, discount, preferential, validitydate, isValid, types } = param;\r\n\r\n        let couponUi;\r\n        if (result !== 1 || !isValid) {\r\n            // this.controller.cApp.currentCreditCode = undefined;\r\n            couponUi = <div className=\"alert alert-primary my-1\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {getTips(result, types, code)}\r\n            </div>\r\n        } else {\r\n            // this.controller.cApp.currentCreditCode = code;\r\n            let content = <div onClick={() => onClick(code)}>\r\n                <div className=\"pb-1\">\r\n                    <FA name='th-large' className='mr-1 text-warning' />{this.getCodeShow(code)}\r\n                    <small className=\"ml-3\">有效期：<EasyDate date={validitydate} /></small>\r\n                </div>\r\n                <div><small className=\"text-success\">此{cardTypeName[types]}全场通用</small></div>\r\n            </div>;\r\n\r\n            let left = <div onClick={() => onClick(code)}>\r\n                <span className=\"text-muted\"><small>{cardTypeName[types]}</small></span>\r\n                {this.renderCardDescription()}\r\n            </div>;\r\n\r\n            couponUi = <div className=\"bg-white p-3 mb-1\">\r\n                <LMR left={left}>\r\n                    {content}\r\n                </LMR>\r\n            </div>\r\n        }\r\n        return couponUi;\r\n    }\r\n    */\r\n}\r\n\r\nexport class VCouponUsed extends VCoupon {\r\n    protected renderCardReveal = (param: any): JSX.Element => {\r\n        let { validitydate, types, useddate, expireddate } = param;\r\n        let couponUi;\r\n        let showDate = validitydate !== undefined ? validitydate : (useddate !== undefined ? useddate : expireddate);\r\n        let newDate = getEasyDate(showDate);\r\n        let content = <div className=\"float-right pr-2\">\r\n            <div className=\"pb-1\">\r\n                <FA name='th-large' className='mr-1 text-secondary' />\r\n                <small className=\"ml-3\">{useddate !== undefined ? '使用日期' : '有效期'}: {newDate}</small>\r\n            </div>\r\n        </div>;\r\n        let left = <div>\r\n            <span className=\"text-body\"><small>{COUPONBASE[types]['name']}</small></span>\r\n        </div>;\r\n        couponUi = <div className=\"py-3 pl-3 pr-2 mb-1 alert\" style={{ backgroundColor: '#e8eaeb', color: \"text-secondary\" }}>\r\n            <LMR left={left}>\r\n                {content}\r\n            </LMR>\r\n        </div>\r\n        return couponUi;\r\n    }\r\n}\r\n\r\nexport function getEasyDate(validitydate: any) {\r\n    let date = moment(validitydate).format('YYYY-MM-DD').split('-');\r\n    // let date = new Date(validitydate).toLocaleDateString().split('/');\r\n    let year = new Date().getFullYear().toString();\r\n    return `${date[0] === year ? '' : (date[0] + '年')}${date[1]}月${date[2]}日`;\r\n}\r\n\r\nexport const COUPONBASE: any = {\r\n    'coupon': { 'name': '优惠券', 'view': VCoupon },\r\n    'credits': { 'name': '积分券', 'view': VCredits },\r\n    'vipcard': { 'name': 'VIP卡', 'view': VVIPCard }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, List, FA, LMR, autoHideTips } from 'tonva';\r\nimport { CCoupon } from './CCoupon';\r\nimport { observable } from 'mobx';\r\nimport { VVIPCard, VCoupon, VCredits } from './VVIPCard';\r\nimport { VModelCardDiscount } from './VModelCardDiscount';\r\nimport { observer } from 'mobx-react';\r\nimport { xs } from 'tools/browser';\r\n\r\nexport class VCoupleAvailable extends VPage<CCoupon> {\r\n\r\n    private couponInput: HTMLInputElement;\r\n    private vipCardForWebUser: any;\r\n    private coupons: any[];\r\n\r\n\t//@observable tips: string;\r\n\tprivate tips = observable.box(null);\r\n    async open(param: any) {\r\n        let { vipCardForWebUser, couponsForWebUser } = param;\r\n        this.vipCardForWebUser = vipCardForWebUser;\r\n        this.coupons = couponsForWebUser.map((v: any) => v.coupon).concat(param.creditsForWebUser.map((v: any) => v.coupon));\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private applyCoupon = async () => {\r\n        let coupon = this.couponInput.value;\r\n        await this.applySelectedCoupon(coupon);\r\n    }\r\n\r\n    /**\r\n     * 应用选择的vipcard等 \r\n     */\r\n    private applySelectedCoupon = async (coupon: string) => {\r\n\t\tthis.tips.set(await this.controller.applySelectedCoupon(coupon));\r\n\t\t/*\r\n        this.tips = await this.controller.applySelectedCoupon(coupon);\r\n        //if (this.tips)\r\n\t\t//\tsetTimeout(() => this.tips = undefined, GLOABLE.TIPDISPLAYTIME);\r\n\t\t*/\r\n    }\r\n\r\n    private renderCoupon = (coupon: any) => {\r\n        let { result, code, types, discount } = coupon;\r\n        if (result === 1) {\r\n            // let content = this.renderVm(COUPONBASE[types]['view'], coupon);\r\n            let content = null;\r\n            if (types === \"coupon\")\r\n                content = discount ? this.renderVm(VCoupon, coupon) : this.renderVm(VVIPCard, coupon);\r\n            else if (types === \"credits\")\r\n                content = this.renderVm(VCredits, coupon);\r\n            return <div className=\"d-block\">\r\n                <div className=\"px-2 bg-white\" onClick={() => this.applySelectedCoupon(code)}>\r\n                    {content}\r\n                </div>\r\n            </div>\r\n        } else\r\n            return null;\r\n    }\r\n\r\n\t/*\r\n    private tipsUI = observer(() => {\r\n        let tipsUI = <></>;\r\n        if (this.tips) {\r\n            tipsUI = <div className=\"alert alert-primary\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {this.tips}\r\n            </div>\r\n        }\r\n        return tipsUI;\r\n\t})\r\n\t*/\r\n\r\n    private page = observer(() => {\r\n\r\n        let vipCardUI;\r\n        if (this.vipCardForWebUser) {\r\n            let { coupon } = this.vipCardForWebUser;\r\n            vipCardUI = <div onClick={() => this.applySelectedCoupon(coupon.code)}>{this.renderVm(VVIPCard, coupon)}</div>\r\n        }\r\n\r\n        let right = <button className=\"btn btn-primary w-100\" onClick={this.applyCoupon}>使用</button>\r\n\r\n        return <Page header=\"可用优惠\"> \r\n            {this.renderContent({right:right,vipCardUI:vipCardUI})}\r\n            {this.controller.renderModelCardDiscount()}\r\n        </Page >\r\n    })\r\n\r\n    renderContent = (param: any) => {\r\n        let { right, vipCardUI } = param;\r\n        let left = <div className=\"d-flex align-items-center mr-3\"><div className=\"align-middle\">优惠卡/券:</div></div>\r\n        return <>\r\n            <div className=\"px-2 py-3 reset-z-header-boxS\">\r\n                <LMR left={left} right={right}>\r\n                    <input ref={v => this.couponInput = v} type=\"number\" className=\"form-control\"></input>\r\n                </LMR>\r\n                {/*React.createElement(this.tipsUI)*/}\r\n                {autoHideTips(this.tips,\r\n                    <div className=\"alert alert-primary\" role=\"alert\">\r\n                        <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                        {this.tips.get()}\r\n                    </div>\r\n                )}\r\n            </div >\r\n            <div className=\"px-2 bg-white\">\r\n                {vipCardUI}\r\n            </div>\r\n            <List items={this.coupons} item={{ render: this.renderCoupon }} none={null}></List>\r\n        </>\r\n    }\r\n\r\n    render(param?: any): JSX.Element {\r\n        let { vipCardForWebUser, couponsForWebUser } = param;\r\n        this.vipCardForWebUser = vipCardForWebUser;\r\n        this.coupons = couponsForWebUser.map((v: any) => v.coupon).concat(param.creditsForWebUser.map((v: any) => v.coupon));\r\n        let vipCardUI:any;\r\n        if (this.vipCardForWebUser) {\r\n            let { coupon } = this.vipCardForWebUser;\r\n            vipCardUI = <div onClick={() => this.applySelectedCoupon(coupon.code)}>{this.renderVm(VVIPCard, coupon)}</div>;\r\n        }\r\n        \r\n        let right = <button className=\"btn btn-primary w-3c\" onClick={this.applyCoupon}>使用</button>\r\n        return React.createElement(observer(() => { \r\n            return <div style={{width:!xs ? 500 :'none'}}>\r\n                {this.renderContent({right:right,vipCardUI:vipCardUI})}\r\n                {this.controller.cApp.cCoupon.renderModelCardDiscount()}\r\n            </div>\r\n        }))\r\n    }\r\n}\r\n\r\n/*\r\n\r\n            <div className=\"px-2 py-3\">\r\n                <div className=\"row pr-3 my-1\">\r\n                    <div className=\"col-4 col-sm-2 d-flex align-items-center text-muted\"><span className=\"align-middle\">优惠卡券:</span></div>\r\n                    <div className=\"col-8 col-sm-10 d-flex\">\r\n                        <input ref={v => this.couponInput = v} type=\"number\" className=\"form-control\"></input>\r\n                    </div>\r\n                </div>\r\n                <div className=\"row my-1\">\r\n                    <div className=\"col-12\">\r\n                        <button className=\"btn btn-primary w-100\" onClick={this.applyCoupon}>使用填写的卡券</button>\r\n                    </div>\r\n                </div>\r\n                {React.createElement(this.tipsUI)}\r\n            </div>\r\n*/","import { observable } from 'mobx';\r\nimport { BoxId, Context } from 'tonva';\r\nimport { nav } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VCreateOrder } from './VCreateOrder';\r\nimport { Order, OrderItem } from './Order';\r\nimport { OrderSuccess } from './OrderSuccess';\r\nimport { CSelectShippingContact, CSelectInvoiceContact } from '../customer/CSelectContact';\r\nimport { VMyOrders } from './VMyOrders';\r\nimport { VOrderDetail } from './VOrderDetail';\r\nimport { CInvoiceInfo } from '../customer/CInvoiceInfo';\r\nimport { groupByProduct } from '../tools/groupByProduct';\r\nimport { CartItem, CartPackRow } from '../cart/Cart';\r\nimport { createOrderPriceStrategy, OrderPriceStrategy } from 'coupon/Coupon';\r\nimport { Product } from 'model';\r\nimport { VContactList } from 'customer/VContactList';\r\nimport { VContact } from 'customer/VContact';\r\nimport { VAddress, VCity, VCounty, VProvince } from '../customer/VAddress';\r\nimport { GLOABLE } from 'global';\r\nimport { CAddress } from 'customer/CAddress';\r\nimport { VInvoiceInfo } from 'customer/VInvoiceInfo';\r\nimport { VCoupleAvailable } from 'coupon/VCouponAvailable';\r\n\r\nconst FREIGHTFEEFIXED = 12;\r\nconst FREIGHTFEEREMITTEDSTARTPOINT = 100;\r\n\r\nexport class COrder extends CUqBase {\r\n    @observable orderData: Order = new Order();\r\n    /**\r\n     * 存储已经被应用的卡券，以便在使用后（下单后）将其删除\r\n     */\r\n    @observable couponAppliedData: any = {};\r\n    \r\n    @observable replyToContactType: string;\r\n    @observable modalTitle: any;\r\n    @observable modalTitleS: { [desc: string]: any } = {\r\n        'contactList': { id: 1, title: '地址管理', preLevel: '' },\r\n        'contactInfo': { id: 2, title: '地址信息', preLevel: 'contactList' },\r\n        'provinceChoice': { id: 3, title: '所在省市', preLevel: 'contactInfo' },\r\n        'cityChoice': { id: 4, title: '所在城市', preLevel: 'provinceChoice' },\r\n        'countyChoice': { id: 5, title: '所在区县', preLevel: 'cityChoice' },\r\n        'invoiceInfo': { id: 6, title: '发票信息', preLevel: '' },\r\n        'validCard': { id: 7, title: '可用优惠', preLevel: '' },\r\n    };\r\n\r\n    @observable editContact: any;\r\n    @observable provinces:any[]=[];\r\n    @observable cities:any[]=[];\r\n    @observable counties: any[] = [];\r\n    @observable addressId:any;\r\n\r\n    hasAnyCoupon: boolean;\r\n    /**\r\n     * 当前webuser对应的buyeraccount，用来设置订单中的buyeraccount\r\n     */\r\n    @observable buyerAccounts: any[] = [];\r\n    @observable validCardForWebUser: any;\r\n\r\n    protected async internalStart(param: any) {\r\n    }\r\n\r\n    createOrderFromCart = async (cartItems: CartItem[]) => {\r\n        let { cApp, uqs } = this;\r\n        let { currentUser, currentSalesRegion, cCoupon } = cApp;\r\n        this.orderData.webUser = currentUser.id;\r\n        this.orderData.salesRegion = currentSalesRegion.id;\r\n        this.removeCoupon();\r\n        this.hasAnyCoupon = await this.hasCoupons();\r\n\r\n        let buyerAccountQResult = await uqs.webuser.WebUserBuyerAccount.query({ webUser: currentUser.id })\r\n        if (buyerAccountQResult) {\r\n            this.buyerAccounts = buyerAccountQResult.ret;\r\n            if (this.buyerAccounts && this.buyerAccounts.length === 1) {\r\n                this.orderData.customer = this.buyerAccounts[0].buyerAccount;\r\n            }\r\n        }\r\n\r\n        if (this.orderData.shippingContact === undefined) {\r\n            this.orderData.shippingContact = await this.getDefaultShippingContact();\r\n        }\r\n\r\n        if (this.orderData.invoiceContact === undefined) {\r\n            this.orderData.invoiceContact = await this.getDefaultInvoiceContact();\r\n        }\r\n\r\n        if (this.orderData.invoiceType === undefined) {\r\n            this.orderData.invoiceType = await this.getDefaultInvoiceType();\r\n        }\r\n\r\n        if (this.orderData.invoiceInfo === undefined) {\r\n            this.orderData.invoiceInfo = await this.getDefaultInvoiceInfo();\r\n        }\r\n\r\n        if (cartItems !== undefined && cartItems.length > 0) {\r\n            this.orderData.currency = cartItems[0].packs[0].currency;\r\n            this.orderData.orderItems = cartItems.map(e => {\r\n\t\t\t\tlet {product, packs} = e;\r\n                var item = new OrderItem(product);\r\n                item.packs = packs.map((v: any) => { return { ...v } }).filter((v: any) => v.quantity > 0 && v.price);\r\n                item.packs.forEach(pk => {\r\n                    pk.priceInit = pk.price;\r\n                })\r\n                return item;\r\n            });\r\n\r\n            // 运费和运费减免\r\n            this.orderData.freightFee = FREIGHTFEEFIXED;\r\n            if (this.orderData.productAmount > FREIGHTFEEREMITTEDSTARTPOINT)\r\n                this.orderData.freightFeeRemitted = FREIGHTFEEFIXED * -1;\r\n            else\r\n                this.orderData.freightFeeRemitted = 0;\r\n        }\r\n\r\n        /*\r\n        let currentCode = currentCouponCode || currentCreditCode;\r\n        if (currentCode) {\r\n            let coupon = await cCoupon.getCouponValidationResult(currentCode);\r\n            if (coupon.result === 1)\r\n                this.applyCoupon(coupon);\r\n            else {\r\n                this.cApp.currentCouponCode = undefined;\r\n                this.cApp.currentCreditCode = undefined;\r\n            }\r\n        }\r\n        */\r\n        // 如果当前webuser有VIP卡，默认下单时使用其VIP卡\r\n        let { webUserVIPCard } = currentUser;\r\n        if (webUserVIPCard !== undefined) {\r\n            let coupon = await cCoupon.getCouponValidationResult(\r\n                webUserVIPCard.vipCardCode.toString()\r\n            );\r\n            let { result, types, id } = coupon;\r\n            if (result === 1) {\r\n                if (types === \"vipcard\" || types === \"coupon\") {\r\n                    coupon.discountSetting = await cCoupon.getValidDiscounts(types, id);\r\n                }\r\n                this.applyCoupon(coupon);\r\n            }\r\n        }\r\n        this.openVPage(VCreateOrder);\r\n    }\r\n\r\n    private defaultSetting: any;\r\n    private async getDefaultSetting() {\r\n        if (this.defaultSetting) return this.defaultSetting;\r\n        let { currentUser } = this.cApp;\r\n        return this.defaultSetting = await currentUser.getSetting() || {};\r\n    }\r\n\r\n    private contact0: BoxId;\r\n    private async getContact(): Promise<BoxId> {\r\n        if (this.contact0 === null) return;\r\n        if (this.contact0 !== undefined) return this.contact0;\r\n        let { currentUser } = this.cApp;\r\n        let contactArr = await currentUser.getContacts();\r\n        if (contactArr === undefined || contactArr.length === 0) {\r\n            this.contact0 = null;\r\n            return;\r\n        }\r\n        return this.contact0 = contactArr[0].contact;\r\n    }\r\n\r\n    private async getDefaultShippingContact() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.shippingContact || await this.getContact();\r\n    }\r\n\r\n    private async getDefaultInvoiceContact() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceContact || await this.getContact();\r\n    }\r\n\r\n    private async getDefaultInvoiceType() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceType;\r\n    }\r\n\r\n    private async getDefaultInvoiceInfo() {\r\n        let defaultSetting = await this.getDefaultSetting();\r\n        return defaultSetting.invoiceInfo;\r\n    }\r\n\r\n\r\n    orderAgain = async (data: any) => {\r\n        let { orderItems } = data;\r\n\r\n        orderItems = orderItems.map((el: CartItem) => {\r\n            return {\r\n                product: el.product,\r\n                packs: el.packs,\r\n                $isDeleted: false,\r\n                $isSelected: true,\r\n                createdate: 'undefined'\r\n            }\r\n        })\r\n        // console.log('orderItems', orderItems);\r\n        await this.createOrderFromCart(orderItems)\r\n    }\r\n\r\n    /**\r\n     * 提交订单\r\n     */\r\n    submitOrder = async () => {\r\n        let { uqs, cart, currentUser } = this.cApp;\r\n        let { order, webuser, 积分商城 } = uqs;\r\n        let { orderItems } = this.orderData;\r\n\r\n        let result: any = await order.Order.save(\"order\", this.orderData.getDataForSave());\r\n        let { id: orderId, flow, state } = result;\r\n        await order.Order.action(orderId, flow, state, \"submit\");\r\n        // 如果使用了coupon/credits，需要将其标记为已使用\r\n        let { id: couponId, types } = this.couponAppliedData;\r\n        if (couponId) {\r\n            let nowDate = new Date();\r\n            let usedDate = `${nowDate.getFullYear()}-${nowDate.getMonth() + 1}-${nowDate.getDate()}`;\r\n            switch (types) {\r\n                case 'coupon':\r\n                    webuser.WebUserCoupon.del({ webUser: currentUser.id, coupon: couponId, arr1: [{ couponType: 1 }] });\r\n                    webuser.WebUserCouponUsed.add({ webUser: currentUser.id, arr1: [{ coupon: couponId, usedDate: usedDate }] });\r\n                    break;\r\n                case 'credits':\r\n                    积分商城.WebUserCredits.del({ webUser: currentUser.id, arr1: [{ credits: couponId }] });\r\n                    积分商城.WebUserCreditsUsed.add({ webUser: currentUser.id, arr1: [{ credits: couponId, usedDate: usedDate }] });\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n\r\n        let param: [{ productId: number, packId: number }] = [] as any;\r\n        orderItems.forEach(e => {\r\n            e.packs.forEach(v => {\r\n                param.push({ productId: e.product.id, packId: v.pack.id })\r\n            })\r\n        });\r\n        cart.removeItem(param);\r\n\r\n        // 打开下单成功显示界面\r\n        nav.popTo(this.cApp.topKey);\r\n        this.openVPage(OrderSuccess, result);\r\n    }\r\n\r\n    onSelectShippingContact = async () => {\r\n        let cSelect = this.newC(CSelectShippingContact);\r\n        let contactBox = await cSelect.call<BoxId>(true);\r\n        this.orderData.shippingContact = contactBox;\r\n    }\r\n\r\n    onSelectInvoiceContact = async () => {\r\n        let cSelect = this.newC(CSelectInvoiceContact);\r\n        let contactBox = await cSelect.call<BoxId>(true);\r\n        this.orderData.invoiceContact = contactBox;\r\n    }\r\n\r\n    /**\r\n     * 打开输入或选择使用卡券界面\r\n     */\r\n    onCouponEdit = async () => {\r\n        let { cCoupon } = this.cApp;\r\n        let coupon = await cCoupon.call<any>(this.orderData.coupon);\r\n        if (coupon) {\r\n            await this.applyCoupon(coupon);\r\n        }\r\n    }\r\n\r\n    private hasCoupons = async (): Promise<boolean> => {\r\n        let { cCoupon, currentUser } = this.cApp;\r\n        let { id: currentUserId } = currentUser;\r\n        if (await cCoupon.getValidCreditsForWebUser(currentUserId))\r\n            return true;\r\n        let validCoupons = await cCoupon.getValidCouponsForWebUser(currentUserId);\r\n        if (validCoupons && validCoupons.length > 0)\r\n            return true;\r\n        let validCredits = await cCoupon.getValidCreditsForWebUser(currentUserId);\r\n        if (validCredits && validCoupons.length > 0)\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 使用优惠券后计算折扣金额和抵扣额\r\n     */\r\n    applyCoupon = async (coupon: any) => {\r\n\r\n        this.removeCoupon();\r\n        let { result: validationResult, validitydate, isValid } = coupon;\r\n        if (validationResult === 1 && isValid === 1 && new Date(validitydate).getTime() > Date.now()) {\r\n            this.couponAppliedData = coupon;\r\n            let orderPriceStrategy: OrderPriceStrategy = createOrderPriceStrategy(coupon);\r\n            orderPriceStrategy.applyTo(this.orderData, this.uqs);\r\n            /*\r\n            this.orderData.coupon = id;\r\n            if (types === \"coupon\" || types === \"vipcard\") {\r\n                // if (discount) {\r\n                // 仍兼容原来统一折扣的模式\r\n                if ((discountSetting && discountSetting.length > 0) || discount) {\r\n                    let { orderData, uqs, cApp } = this;\r\n                    let { orderItems } = orderData;\r\n                    let { AgentPrice } = uqs.product;\r\n                    if (orderItems !== undefined && orderItems.length > 0) {\r\n                        // 获取每个明细中产品的agentprice;\r\n                        let promises: PromiseLike<any>[] = [];\r\n                        orderItems.forEach(e => {\r\n                            promises.push(AgentPrice.table({ product: e.product.id, salesRegion: cApp.currentSalesRegion.id }));\r\n                        });\r\n                        let agentPrices = await Promise.all(promises);\r\n\r\n                        if (agentPrices && agentPrices.length > 0) {\r\n                            let couponOffsetAmount = 0;\r\n                            for (let i = 0; i < orderItems.length; i++) {\r\n                                let oi = orderItems[i];\r\n                                let { product, packs } = oi;\r\n                                // 获取明细中产品的优惠券/VIP卡折扣\r\n                                if (discountSetting) {\r\n                                    let thisDiscountSetting = discountSetting.find((e: any) => Tuid.equ(e.brand, product.obj.brand));\r\n                                    discount = (thisDiscountSetting && thisDiscountSetting.discount) || discount || 0;\r\n                                }\r\n\r\n                                let eachProductAgentPrice = agentPrices[i];\r\n                                for (let j = 0; j < packs.length; j++) {\r\n                                    let pk = packs[j];\r\n                                    let agentPrice: any = eachProductAgentPrice.find(\r\n                                        (p: any) => p.product.id === product.id &&\r\n                                            p.pack.id === pk.pack.id &&\r\n                                            p.discountinued === 0 &&\r\n                                            p.expireDate > Date.now());\r\n                                    if (!agentPrice) break;\r\n\r\n                                    // 折扣价格取agentPrice和折扣价格中较高者\r\n                                    let discountPrice = Math.round(Math.max(agentPrice.agentPrice, pk.retail * (1 - discount)));\r\n                                    // pk.price = Math.round(Math.max(agentPrice.agentPrice, pk.retail * (1 - discount)));\r\n                                    // 最终价格取折扣价格和显示的价格（可能会有市场活动价)中较低者\r\n                                    pk.price = Math.round(Math.min(pk.price, discountPrice));\r\n                                    couponOffsetAmount += Math.round(pk.quantity * (pk.retail - pk.price) * -1);\r\n                                };\r\n                            };\r\n                            this.orderData.couponOffsetAmount = Math.round(couponOffsetAmount);\r\n                        };\r\n                    }\r\n                }\r\n                if (preferential) {\r\n                    this.orderData.couponRemitted = preferential * -1;\r\n                }\r\n                // 运费和运费减免\r\n                this.orderData.freightFee = FREIGHTFEEFIXED;\r\n                if (this.orderData.productAmount > FREIGHTFEEREMITTEDSTARTPOINT)\r\n                    this.orderData.freightFeeRemitted = FREIGHTFEEFIXED * -1;\r\n            }\r\n\r\n            if (types === \"credits\") {\r\n                this.orderData.point = Math.round(this.orderData.productAmount * 2);\r\n            }\r\n            */\r\n            // 运费和运费减免\r\n            this.orderData.freightFee = FREIGHTFEEFIXED;\r\n            if (this.orderData.productAmount > FREIGHTFEEREMITTEDSTARTPOINT)\r\n                this.orderData.freightFeeRemitted = FREIGHTFEEFIXED * -1;\r\n            else\r\n                this.orderData.freightFeeRemitted = 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 删除优惠券\r\n     */\r\n    removeCoupon = () => {\r\n        this.orderData.coupon = undefined;\r\n        this.couponAppliedData = {};\r\n        this.orderData.couponOffsetAmount = 0;\r\n        this.orderData.couponRemitted = 0;\r\n        this.orderData.point = 0;\r\n        this.orderData.orderItems.forEach((e: OrderItem) => e.packs.forEach((v: CartPackRow) => v.price = v.priceInit));\r\n    }\r\n\r\n    /*\r\n    * 打开我的订单列表（在“我的”界面使用）\r\n    */\r\n    openMyOrders = async (state: string) => {\r\n\r\n        this.openVPage(VMyOrders, state);\r\n    }\r\n\r\n    /**\r\n     * 根据状态读取我的订单\r\n     */\r\n    getMyOrders = async (state: string) => {\r\n        let { order } = this.uqs;\r\n        switch (state) {\r\n            case 'pendingpayment':\r\n                return await order.GetPendingPayment.table(undefined);\r\n            case 'processing':\r\n                return await order.Order.mySheets(undefined, 1, -20);\r\n            case 'completed':\r\n                return await order.Order.mySheets(\"#\", 1, -20)\r\n            case 'all':\r\n                let promises: PromiseLike<any>[] = [];\r\n                promises.push(order.Order.mySheets(undefined, 1, -20));\r\n                promises.push(order.Order.mySheets(\"#\", 1, -20));\r\n                let presult = await Promise.all(promises);\r\n                presult[0].forEach((el:any) => {el.OState = 'processing';});\r\n                presult[1].forEach((el: any) => { el.OState = 'completed'; });\r\n                \r\n                return presult[0].concat(presult[1]).sort((a: any, b: any) => new Date(b.date).valueOf() - new Date(a.date).valueOf());\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 打开发票信息编辑界面\r\n     */\r\n    onInvoiceInfoEdit = async () => {\r\n        let cInvoiceInfo = this.newC(CInvoiceInfo); // new CInvoiceInfo(this.cApp, undefined, true);\r\n        let { invoiceType, invoiceInfo } = this.orderData;\r\n        let origInvoice = {\r\n            invoiceType: invoiceType,\r\n            invoiceInfo: invoiceInfo,\r\n        }\r\n        let newInvoice = await cInvoiceInfo.call<any>(origInvoice, true);\r\n        this.orderData.invoiceType = newInvoice.invoiceType;\r\n        this.orderData.invoiceInfo = newInvoice.invoiceInfo;\r\n    }\r\n\r\n    openOrderDetail = async (orderId: number) => {\r\n\r\n        let order = await this.uqs.order.Order.getSheet(orderId);\r\n        let { data } = order;\r\n        let { orderItems } = data;\r\n        let orderItemsGrouped = groupByProduct(orderItems);\r\n        data.orderItems = orderItemsGrouped;\r\n        this.openVPage(VOrderDetail, order);\r\n    }\r\n\r\n    renderDeliveryTime = (pack: BoxId) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderDeliveryTime(pack);\r\n    }\r\n\r\n    renderOrderItemProduct = (product: Product) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderCartProduct(product);\r\n    }\r\n\r\n    onContactSelected = (contact: BoxId) => {\r\n        if(this.replyToContactType ==='shippingContact') this.orderData.shippingContact = contact;\r\n        if(this.replyToContactType === 'invoiceContact') this.orderData.invoiceContact = contact;\r\n        this.modalTitle = '';\r\n    }\r\n\r\n    /**\r\n     * 打开地址编辑界面\r\n     */\r\n    onEditContact = async (userContact: BoxId) => {\r\n        let userContactId = userContact.id;\r\n        let contact = await this.uqs.customer.Contact.load(userContactId);\r\n        contact.isDefault = false;\r\n        this.editContact = contact;\r\n        this.modalTitle = 'contactInfo';\r\n    }\r\n\r\n    renderModelContent = (param?: any) => {\r\n        if(this.modalTitle === 'contactList')  return this.renderContentList();\r\n        if(this.modalTitle === 'contactInfo')  return this.onNewContact();\r\n        if(this.modalTitle === 'provinceChoice')  return this.pickProvince();\r\n        if(this.modalTitle === 'cityChoice' ) return this.pickCity();\r\n        if(this.modalTitle === 'countyChoice')  return this.pickCounty();\r\n        if(this.modalTitle === 'invoiceInfo')  return this.renderInvoice();\r\n        if(this.modalTitle === 'validCard') return this.renderValidCard();\r\n    }\r\n\r\n    renderContentList = () => {\r\n        return this.renderView(VContactList);\r\n    }\r\n\r\n    getValidCardForWebUser = async () => {\r\n        let { cCoupon } = this.cApp;\r\n        this.validCardForWebUser = await cCoupon.getValidCardForWebUser();\r\n        this.modalTitle = 'validCard';\r\n    }\r\n\r\n    showModelCardDiscount = async (vipCard: any) => {\r\n        await  this.cApp.cCoupon.showModelCardDiscount(vipCard);\r\n    }\r\n    /* 选择发票信息 */\r\n    saveInvoiceInfo = async (invoice: any) => {\r\n        let newInvoice: any = await this.cApp.cInvoiceInfo.saveInvoiceInfoData(invoice);\r\n        this.orderData.invoiceType = newInvoice.invoiceType;\r\n        this.orderData.invoiceInfo = newInvoice.invoiceInfo;\r\n        this.modalTitle = '';\r\n    }\r\n    /* 选择优惠券 */\r\n    applySelectedCoupon = async (coupon: string) => {\r\n        if (!coupon)\r\n            return \"请输入您的优惠卡/券号\";\r\n        else {\r\n            let { cCoupon } = this.cApp;\r\n            let couponRet = await cCoupon.applyCoupon1(coupon);\r\n            if (couponRet) {\r\n                await this.applyCoupon(couponRet);\r\n                this.modalTitle = '';\r\n            };\r\n            return cCoupon.applyTip(couponRet);\r\n        }\r\n    }\r\n\r\n    renderValidCard = () => {\r\n        return this.renderView(VCoupleAvailable,this.validCardForWebUser);\r\n    }\r\n\r\n    renderInvoice = () => {\r\n        let { invoiceType, invoiceInfo } = this.orderData;\r\n        let origInvoice = {\r\n            invoiceType: invoiceType,\r\n            invoiceInfo: invoiceInfo,\r\n        };\r\n        return this.renderView(VInvoiceInfo,{origInvoice:origInvoice});\r\n    }\r\n\r\n    /**\r\n     * 打开地址新建界面\r\n     */\r\n    onNewContact = () => {\r\n        return this.renderView(VContact,{ contact: this.editContact });\r\n    }\r\n\r\n    pickAddress = async (context?: Context, name?: string, value?: number): Promise<number> => {\r\n        this.provinces = await this.cApp.cAddress.getCountryProvince(GLOABLE.CHINA);\r\n        this.modalTitle = 'provinceChoice';\r\n        return this.addressId;\r\n    }\r\n\r\n    pickProvince = () => {\r\n        return this.renderView(VProvince,{provinces:this.provinces});\r\n    }\r\n\r\n    pickCity = () => {\r\n        return this.renderView(VCity,{cities:this.cities});\r\n    }\r\n\r\n    pickCounty = () => {\r\n        return this.renderView(VCounty,{counties:this.counties});\r\n    }\r\n\r\n    saveAddress = async (countryId: number, provinceId: number, cityId?: number, countyId?: number): Promise<any> => {\r\n        let { Address } = this.uqs.common;\r\n        let newAddress = await Address.save(undefined, { country: countryId, province: provinceId, city: cityId, county: countyId });\r\n        let addressId = newAddress && Address.boxId(newAddress.id);\r\n        this.modalTitle = 'contactInfo';\r\n        this.addressId = addressId;\r\n        this.cApp.cSelectShippingContact.TIT = true;\r\n    }\r\n\r\n    saveContact = async (contact: any) => {\r\n        let { cSelectShippingContact, cSelectInvoiceContact } = this.cApp;\r\n        let contactBox: any;\r\n        if (this.replyToContactType === 'shippingContact')\r\n            contactBox = await cSelectShippingContact.saveContactData(contact);\r\n        if (this.replyToContactType === 'invoiceContact')\r\n            contactBox = await cSelectInvoiceContact.saveContactData(contact);\r\n        this.onContactSelected(contactBox);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Ax, View } from 'tonva';\r\nimport { CProductCategory } from './CProductCategory';\r\nimport { FA } from 'tonva';\r\nimport { rootCategroyResFromId } from 'global';\r\n//import { observer } from 'mobx-react';\r\n\r\n/*\r\nconst imgStyle: React.CSSProperties = {\r\n    height: '1.5rem', width: '1.5rem',\r\n    marginLeft: '0.1rem',\r\n    marginRight: '0.3rem'\r\n}\r\n\r\nexport const titleTitle: React.CSSProperties = {\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n    whiteSpace: 'nowrap',\r\n}\r\n\r\nexport const subStyle: React.CSSProperties = {\r\n    fontSize: '0.75rem',\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n    whiteSpace: 'nowrap',\r\n}\r\n*/\r\n\r\nexport class VRootCategory extends View<CProductCategory> {\r\n\r\n    /**\r\n     * \r\n     * @param item 装配了子节点和孙节点的productCategory\r\n     * @param parent \r\n     */\r\n    private renderRootCategory = (item: any, parent: any) => {\r\n        let { name, children, productCategory } = item;\r\n        let { src, labelColor } = rootCategroyResFromId(productCategory);\r\n        return <div className=\"bg-white mb-3\" key={name}>\r\n            <Ax className=\"py-2 px-3 cursor-pointer\"\r\n                href={'/productCategory/' + productCategory}>\r\n                <img className=\"mr-4 cat-root-img\" src={src} alt={name} />\r\n                <b>{name}</b>\r\n            </Ax>\r\n            <div className=\"cat-root-sub\">\r\n                <div className=\"row no-gutters\">\r\n                    {children.map((v: any) => this.renderSubCategory(v, item, labelColor))}\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private renderSubCategory = (item: any, parent: any, labelColor: string) => {\r\n        let { productCategory, name, children, total } = item;\r\n        /*\r\n        return <div key={name}\r\n            className=\"col-6 col-md-4 col-lg-3 cursor-pointer\">\r\n            <A onClick={() => this.categoryClick(item, parent, labelColor)} href={\"/productCategory/\"+ productCategory.id}>\r\n                <div className=\"py-2 px-2 cat-sub\">\r\n                    <div className=\"text-truncate\">\r\n                        <span className=\"ml-1 align-middle\">\r\n                            <FA name=\"chevron-circle-right\" className={labelColor} />\r\n                            &nbsp; {name}\r\n                        </span>\r\n                    </div>\r\n                    {renderThirdCategory(children, total)}\r\n                </div>\r\n                {renderThirdCategory(children, total)}\r\n            </div>\r\n        </div>;\r\n        */\r\n        //onClick={() => this.controller.onClickCategory(item)}\r\n        // let productCategoryId = item.productCategory.id;\r\n        return <Ax key={name}\r\n            className=\"col-6 col-md-4 col-lg-3 cursor-pointer\"\r\n            href={'/productCategory/' + productCategory}>\r\n            <div className=\"py-2 px-2 cat-sub\">\r\n                <div className=\"text-truncate\">\r\n                    <span className=\"ml-1 align-middle\">\r\n                        <FA name=\"chevron-circle-right\" className={labelColor} />\r\n                        &nbsp; {name}\r\n                    </span>\r\n                </div>\r\n                {renderThirdCategory(children, total)}\r\n            </div>\r\n        </Ax>;\r\n    }\r\n\r\n    render(param: any): JSX.Element {\r\n        return <this.content />\r\n    }\r\n\r\n    private content = () => {\r\n        let { rootCategories } = this.controller;\r\n        return <>{rootCategories.map((v: any) => this.renderRootCategory(v, undefined))}</>;\r\n        // return <>{categories2.map(v => <div key={v.productCategory.id}>{tv(v, e => this.renderRoot(e))}</div>)}</>;\r\n    };\r\n\r\n    private renderRoot(root: any) {\r\n        let { productCategory } = root;\r\n        let { id } = productCategory;\r\n        console.log(id);\r\n        return <div key={id}>{id}</div>\r\n    }\r\n}\r\n\r\n\r\nfunction renderThirdCategory(children: any[], total: number) {\r\n    return <div className=\"py-1 px-1 text-muted small text-truncate\">\r\n        {\r\n            children.length === 0 ?\r\n                <>{total > 1000 ? '>1000' : total} 个产品</>\r\n                :\r\n                children.map(v => v.name).join(' / ')\r\n        }\r\n    </div>\r\n}\r\n","import * as React from 'react';\r\nimport { View } from 'tonva';\r\nimport { CProductCategory, ProductCategory } from './CProductCategory';\r\n\r\nexport class VRootCategorySideBar extends View<CProductCategory>{\r\n\t\r\n    //private categoryClick = async (categoryWapper: ProductCategory/*, parent: any, labelColor: string*/) => {\r\n    //    await this.controller.openMainPage(categoryWapper/*, parent, labelColor*/);\r\n    //}\r\n\t\r\n    render() {\r\n        return <div className=\"bg-white\">\r\n            <h2>产品大类</h2>\r\n            <nav id=\"sidebar\">\r\n                <ul className=\"list-unstyled components\">\r\n                    {this.controller.rootCategories.map(v => {\r\n\t\t\t\t\t\tlet {productCategory, name, children} = v;\r\n\t\t\t\t\t\tlet pcId = productCategory; //(productCategory as any).id;\r\n\t\t\t\t\t\tlet menuId = \"Submenu\" + pcId;\r\n\t\t\t\t\t\treturn <li className=\"active\" key={pcId}>\r\n\t\t\t\t\t\t\t<a href={'#' + menuId} data-toggle=\"collapse\" aria-expanded=\"false\">{name}</a>\r\n\t\t\t\t\t\t\t{this.renderChildren(children, menuId)}\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t</nav>\r\n\t\t</div>;\r\n\t\t//<a href={'/productCategory/'+productCategory} data-toggle=\"collapse\" aria-expanded=\"false\">{name}</a>\r\n\t}\r\n\r\n\tprivate renderChildren(children: ProductCategory[], menuId: string) {\r\n\t\treturn <ul className=\"collapse list-unstyled\" id={menuId}>\r\n\t\t\t{children.map(e => {\r\n\t\t\t\tlet { productCategory } = e;\r\n\t\t\t\tlet pcId = (productCategory as any).id || productCategory;\r\n\t\t\t\treturn <li key={pcId}>\r\n\t\t\t\t\t{this.controller.renderCategoryItem(e)}\r\n\t\t\t\t</li>;\r\n\t\t\t})}\r\n\t\t</ul>\r\n\t}\r\n}\r\n","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { Tuid, VPage } from 'tonva';\r\nimport { CProductCategory, ProductCategory } from './CProductCategory';\r\nimport $ from 'jquery';\r\nimport { tv } from '../tonva/uq/tuid/reactBoxId';\r\nimport { xs } from '../tools/browser';\r\n\r\nexport class VCategoryPage extends VPage<CProductCategory> {\r\n\r\n    private renderCategory(/*item: any, parent: any, labelColor: string*/) {\r\n        let { instruction, current, rootCategories, cApp } = this.controller;\r\n        let main, breadcrumbs;\r\n        if (current) {\r\n            let { productCategory, name, children, parent } = current;\r\n            let instructionUi;\r\n            if (instruction) {\r\n                let instr: JQuery<Element> = $(instruction);\r\n                $(\"a[href*='jkchemical.com']\", instr).addClass('d-none');\r\n                // instructionUi = <div className=\"overflow-auto my-3 bg-light\" style={{ height: 320 }} dangerouslySetInnerHTML={{ __html: (instr[0].innerHTML || \"\") }} />;\r\n                instructionUi = <p dangerouslySetInnerHTML={{ __html: (instr[0].innerHTML || \"\") }} />;\r\n            }\r\n            main = <div className=\"col-lg-9 product-introduct\">\r\n                <h1>{name}</h1>\r\n                {instructionUi}\r\n                <div className=\"row\">\r\n                    {children.map(v => this.renderSubcategory(v))}\r\n                </div>\r\n            </div>\r\n            breadcrumbs = <div className=\"breadcrumbs mb-4\" style={{ lineHeight: 1.5 }}>\r\n                <a href=\"#\">首页</a>\r\n                <a href=\"#\">产品</a>\r\n                {tv(parent, (v: any) => {\r\n                    if (v.parent)\r\n                        return <>{tv(v.parent, (j: any) => {\r\n                            let jL = j.productcategorylanguage.find((jl: any) => cApp.currentLanguage.id === jl.language.id);\r\n                            let vL = v.productcategorylanguage.find((vl: any) => cApp.currentLanguage.id === vl.language.id);\r\n                            return <>\r\n                                <a href=\"#\">{jL.name}</a>\r\n                                <a href=\"#\">{vL.name}</a>\r\n                            </>\r\n                        })}</>\r\n                    else {\r\n                        let findRootParent = rootCategories.find((vs: any) => vs.productCategory === v.id);\r\n                        if (findRootParent) return <a href=\"#\">{findRootParent.name}</a>;\r\n                        return null;\r\n                    }\r\n                })}\r\n                <span>{name}</span>\r\n            </div>\r\n        } else {\r\n            main = <div>\r\n                无\r\n            </div>\r\n        }\r\n\r\n        return <section className=\"container mt-lg-2\">\r\n            {breadcrumbs}\r\n            <div className=\"row\">\r\n                <div className=\"col-lg-3 product-side d-none d-lg-block\">\r\n                    {this.controller.renderRootSideBar()}\r\n                </div>\r\n                {main}\r\n            </div>\r\n        </section>\r\n    }\r\n\r\n    private renderSubcategory(item: ProductCategory/*item: any, parent: any, labelColor: string*/) {\r\n        //let labelColor = 'text-success';\r\n        let { name, children, total } = item;\r\n        let hasChildren = children && children.length > 0;\r\n\r\n        let vItem = hasChildren === true ?\r\n            <>\r\n                {\r\n                    children.slice(0, 3).map(v => {\r\n                        return this.controller.renderCategoryItem(v, 'mr-3');\r\n                    })\r\n                }\r\n                <p className=\"text-right\">\r\n                    {\r\n                        this.controller.renderCategoryItem(\r\n                            item,\r\n                            undefined,\r\n                            <>更多 <i className=\"fa fa-angle-right\" aria-hidden=\"true\"></i></>)\r\n                    }\r\n                </p>\r\n            </>\r\n            :\r\n            <div>{this.controller.renderCategoryItem(item, undefined, <>{total > 1000 ? '>1000' : total}个产品</>)}</div>;\r\n\r\n        return <div key={name} className=\"col-lg-4 each-product\">\r\n            {this.controller.renderCategoryItem(\r\n                item,\r\n                undefined,\r\n                <h2 className=\"purple-bg\">{name}</h2>\r\n            )}\r\n            <div className=\"background-grey\">{vItem}</div>\r\n        </div>\r\n    }\r\n\r\n    header() { if (!xs) return ''; return this.controller.cApp.cHome.renderSearchHeader(); }\r\n    right() { if (!xs) return null; return this.controller.cApp.cCart.renderCartLabel(); }\r\n    content() { return this.renderCategory(); }\r\n}","import React from 'react';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VRootCategory } from './VRootCategory';\r\nimport { VRootCategorySideBar } from './VRootCategorySideBar';\r\nimport { GLOABLE } from \"global\";\r\nimport './cat.css';\r\nimport { Ax, BoxId, Tuid, VPage } from 'tonva';\r\nimport { VCategoryPage } from './VCategoryPage';\r\nimport { VCategory } from './VCategory';\r\nimport classNames from 'classnames';\r\n\r\nexport interface ProductCategory {\r\n    productCategory: number; //ID ProductCategory,\r\n    parent: number; // ID,\r\n    name: string; // char(200),\r\n    total: number; // int\r\n    children?: ProductCategory[];\r\n};\r\n\r\nexport class CProductCategory extends CUqBase {\r\n    rootCategories: ProductCategory[];\r\n    current: ProductCategory;\t\t// 当前显示的目录\r\n    instruction: string; \t\t\t// 当前目录的介绍\r\n    //@observable categories2: any[] = [];\r\n\r\n    async internalStart(param: any) {\r\n        await this.loadRoot();\r\n        /*\r\n        this.uqs.product.ProductCategory.stopCache();\r\n\r\n        let { currentSalesRegion, currentLanguage } = this.cApp;\r\n        let results = await this.uqs.product.GetRootCategory.query({\r\n            salesRegion: currentSalesRegion.id,\r\n            language: currentLanguage.id\r\n        });\r\n        let { first, secend, third } = results;\r\n        this.rootCategories = (first as any[]).map(v => {\r\n            return this.buildCategories(v, secend, third);\r\n        });\r\n        */\r\n        /*\r\n        let result2 = await this.getRootCategoriesQuery.query({ salesRegion: currentSalesRegion.id, language: currentLanguage.id });\r\n        if (result2)\r\n            this.categories2 = result2.ret;\r\n        */\r\n    }\r\n\r\n    async loadRoot() {\r\n        if (this.rootCategories) return;\r\n        this.uqs.product.ProductCategory.stopCache();\r\n\r\n        let { currentSalesRegion, currentLanguage } = this.cApp;\r\n        let results = await this.uqs.product.GetRootCategory.query({\r\n            salesRegion: currentSalesRegion, // 去掉.id, 如果传入的是obj参数，会自动取id\r\n            language: currentLanguage, // 去掉.id, 如果传入的是obj参数，会自动取id\r\n        });\r\n        let { first, secend, third } = results;\r\n        (first as any[]).forEach(v => {\r\n            v.productCategory = v.productCategory.id;\r\n            v.children = this.buildChildren(v.productCategory, secend, third);\r\n        });\r\n        this.rootCategories = first;\r\n    }\r\n\r\n    async load(id: number) {\r\n        if (this.current && this.current.productCategory === id) return;\r\n\r\n        let { uqs, currentLanguage } = this.cApp;\r\n        let { product } = uqs;\r\n        let { ProductCategory } = product;\r\n        let promises = [\r\n            ProductCategory.load(id),\r\n            this.getCategoryChildren(id),\r\n            this.getCategoryInstruction(id)\r\n        ];\r\n        let [pcTuid, { first, secend }, instruction] = await Promise.all(promises);\r\n        this.instruction = instruction;\r\n        this.current = {\r\n            productCategory: id,\r\n            parent: undefined,\r\n            name: undefined,\r\n            total: undefined,\r\n            children: [],\r\n        }\r\n\r\n        let parentS = async function (params: any) {\r\n            let isM = true;\r\n            while (isM) {\r\n                let ProductCategoryLoad: any = await ProductCategory.load(params);\r\n                if (ProductCategoryLoad.parent) params = ProductCategoryLoad.parent.id;\r\n                else isM = false;\r\n            }\r\n        };\r\n        await parentS(id);\r\n\r\n        if (pcTuid) {\r\n            let { parent, productcategorylanguage } = pcTuid;\r\n            let pcCurrentLanguage = productcategorylanguage.find((v: any) => Tuid.equ(currentLanguage, v.language));\r\n            this.current.parent = parent;\r\n            this.current.name = pcCurrentLanguage && pcCurrentLanguage.name;\r\n            this.current.children = this.buildChildren(id, first, secend);\r\n        }\r\n    }\r\n\r\n    renderRootList = () => {\r\n        return this.renderView(VRootCategory);\r\n    };\r\n\r\n    /**\r\n     * 渲染PC版SideBar中的目录树\r\n     */\r\n    renderRootSideBar = () => {\r\n        return this.renderView(VRootCategorySideBar, this.rootCategories);\r\n    }\r\n\r\n    /**\r\n     * 获取目录节点相关的介绍贴文\r\n     * @param categoryId 目录节点id\r\n     */\r\n    private getCategoryInstruction = async (categoryId: number) => {\r\n        try {\r\n            let res = await window.fetch(GLOABLE.CONTENTSITE + \"/partial/categoryinstruction/\" + categoryId);\r\n            if (res.ok) {\r\n                let content = await res.text();\r\n                return content;\r\n            }\r\n        } catch (error) {\r\n\r\n        }\r\n    };\r\n\r\n    /**\r\n     * 根据目录节点的id获取该节点的子节点列表\r\n     * @param categoryId 目录节点的id\r\n     */\r\n    private async getCategoryChildren(categoryId: number) {\r\n        let { currentSalesRegion, currentLanguage } = this.cApp;\r\n        return await this.uqs.product.GetChildrenCategory.query({\r\n            parent: categoryId,\r\n            salesRegion: currentSalesRegion.id,\r\n            language: currentLanguage.id\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 为productCategory装配子节点/孙节点 \r\n     * @param id \r\n     * @param subCategories \r\n     * @param secendSubCategory \r\n     */\r\n    private buildChildren(id: number, subCategories: ProductCategory[], secendSubCategory: ProductCategory[]): ProductCategory[] {\r\n        let children: ProductCategory[] = [];\r\n        for (let sub of subCategories) {\r\n            let { productCategory: subProductCategory, parent: subParent, name: subName, total: subTotal } = sub;\r\n            if (!Tuid.equ(id, subParent)) continue;\r\n            children.push({\r\n                productCategory: (subProductCategory as any).id,\r\n                parent: (subParent as any).id,\r\n                name: subName,\r\n                total: subTotal,\r\n                children: secendSubCategory\r\n                    .filter(v => Tuid.equ(v.parent, subProductCategory))\r\n                    .map(v => {\r\n                        return {\r\n                            productCategory: (v.productCategory as any).id,\r\n                            parent: (v.parent as any).id,\r\n                            name: v.name,\r\n                            total: v.total\r\n                        }\r\n                    })\r\n            });\r\n        }\r\n        return children;\r\n    }\r\n\r\n    onClickCategory = async (pc: ProductCategory) => {\r\n\r\n        /*\r\n        this.current = pc;\r\n        let { productCategory, name } = pc;\r\n        let { id: productCategoryId } = ((productCategory as any) as BoxId);\r\n        let promises = [this.getCategoryChildren(productCategoryId), this.getCategoryInstruction(productCategoryId)];\r\n        let [results, instruction] = await Promise.all(promises);\r\n        if (results.first.length !== 0) {\r\n            this.openVPage(VCategory);\r\n        } else {\r\n            let { cProduct } = this.cApp;\r\n            await cProduct.searchByCategory({ productCategory: productCategoryId, name });\r\n        }\r\n        */\r\n        let { productCategory } = pc;\r\n        let { id: productCategoryId } = ((productCategory as any) as BoxId);\r\n        await this.showCategoryPage(productCategoryId);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param categoryId \r\n     */\r\n    async showCategoryPage(categoryId: number) {\r\n        if (!this.rootCategories) await this.loadRoot();  // 供SideBar使用\r\n\r\n        await this.load(categoryId);\r\n        let VP: new (c: CProductCategory) => VPage<any>;\r\n        VP = VCategoryPage;\r\n        /*\r\n        // 如果想要web跟app方式的产品分类页面不一样，可以这么处理\r\n        if (this.isWebNav) {\r\n            VP = VCategoryPage;\r\n        }\r\n        else {\r\n            VP = VCategory;\r\n        }\r\n        */\r\n        if (this.current) {\r\n            let { children } = this.current;\r\n            if (children && children.length > 0) {\r\n                this.openVPage(VP);\r\n            }\r\n            else {\r\n                await this.cApp.cProduct.searchByCategory({\r\n                    productCategory: categoryId,\r\n                    name: this.current.name\r\n                });\r\n            }\r\n        } else {\r\n            this.openVPage(VP);\r\n        }\r\n    }\r\n\r\n    renderCategoryItem(pc: ProductCategory, className?: string, content?: any): JSX.Element {\r\n        if (!pc) debugger;\r\n        let { productCategory, name } = pc;\r\n        let pcId = typeof productCategory === 'object' ? (productCategory as any).id : productCategory;\r\n        return <Ax key={pcId}\r\n            href={'/productCategory/' + pcId}\r\n            className={classNames(className, 'd-block text-truncate')}\r\n        >{content || name}</Ax>\r\n    }\r\n}\r\n","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { VPage, Image } from 'tonva';\r\nimport { CMember } from './CMember';\r\nimport { LMR, Muted, FA, Media } from 'tonva';\r\nimport pig from '../images/pig.png';\r\nimport { observer } from 'mobx-react';\r\n\r\nconst stylePig: React.CSSProperties = {\r\n    width: '100%',\r\n    height: '20rem',\r\n    backgroundImage: `url(${pig})`,\r\n    backgroundSize: 'contain',\r\n    backgroundColor: 'rgba(255,255,255,0.1)',\r\n    opacity: 0.09,\r\n    position: 'absolute',\r\n}\r\n\r\nexport class VMember extends VPage<CMember> {\r\n    private recommendationCodeRef = React.createRef<HTMLInputElement>();\r\n\r\n    async open(param: any) {\r\n\r\n    }\r\n\r\n    render(member: any): JSX.Element {\r\n\r\n        return <this.page />;\r\n    }\r\n\r\n    private submitRecommendationCode() {\r\n        let code = this.recommendationCodeRef.current.value;\r\n        if (code) {\r\n            let { setReferrer: submit } = this.controller;\r\n            submit(code);\r\n        }\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { cApp, member } = this.controller;\r\n        if (member === undefined)\r\n            return <></>;\r\n        let { currentUser } = cApp;\r\n        let { recommendationCode, point } = member;\r\n        if (!point) point = 0;\r\n\r\n        let im = <Image className=\"mr-3 w-3c h-3c\" src={currentUser.icon} />;\r\n        let inviteCode = <div className=\"small\">邀请码: {recommendationCode}</div>;\r\n\r\n        let divPoints = <div className=\"my-3 text-center bg-white h-25\" style={{ position: 'relative' }}>\r\n            <div className=\"w-100 bg-white h-20c\" style={{ position: 'absolute' }} />\r\n            <div className=\"d-flex align-items-center justify-content-center\" style={stylePig} />\r\n            <div className=\"w-100 d-flex align-items-center justify-content-center h-20c\" style={{ position: 'absolute' }}>\r\n                <div className=\"muted mr-3 small\">积分: </div>\r\n                <div className=\"text-danger\" style={{ fontSize: '2rem' }}>{point}</div>\r\n            </div>\r\n        </div>\r\n\r\n        let pointTitle = <p className=\"h4\">我的积分</p>\r\n        let pointDetail = <p className=\"small align-self-end\">查看详情 <FA name=\"angle-right\"></FA></p>\r\n        let pointThisWeek = <><p className=\"h5 mb-0\">0</p><Muted>本周</Muted></>\r\n        let pointAll = <><p className=\"h5 mb-0\">{point}</p><Muted>累计</Muted></>\r\n\r\n        let fansTitle = <p>我的粉丝</p>\r\n        let fansDetail = <p className=\"small align-self-end\">查看详情 <FA name=\"angle-right\"></FA></p>;\r\n        let detail = <div className=\"shadow bg-white rounded p-3 mb-1\">\r\n            <LMR left={fansTitle} right={fansDetail}></LMR>\r\n            <LMR className=\"pb-2\">\r\n                <p className=\"h4 mb-0\">0</p>\r\n                <Muted>今日</Muted>\r\n            </LMR>\r\n            <LMR left={pointThisWeek} right={pointAll} />\r\n            <LMR>\r\n                <input type=\"text\" className=\"form-control\" ref={this.recommendationCodeRef} />\r\n                <button type=\"button\" className=\"btn btn-primary\" onClick={() => this.submitRecommendationCode()}>输入邀请码</button>\r\n            </LMR>\r\n        </div>;\r\n\r\n        return <div>\r\n            <LMR className=\"bg-white p-3 mb-1 align-items-center\"\r\n                left={im} right={inviteCode}>\r\n                <b>{currentUser.name}</b>\r\n            </LMR>\r\n            {divPoints}\r\n            {/*detail*/}\r\n        </div>\r\n    })\r\n}\r\n/*\r\n<div className=\"shadow bg-white rounded p-3 mb-1\">\r\n<LMR left={pointTitle} right={pointDetail}></LMR>\r\n<LMR className=\"pb-2\">\r\n    <p className=\"h4 mb-0\">0</p>\r\n    <Muted>今日</Muted>\r\n</LMR>\r\n<LMR left={pointThisWeek} right={pointAll} />\r\n</div>\r\n*/","/* eslint-disable */\r\nimport * as React from 'react';\r\n//import Loadable from 'react-loadable';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport { FA } from 'tonva';\r\nimport { Loading, nav } from 'tonva';\r\nimport { BoxId } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VMember } from './VMember';\r\n\r\nexport class CMember extends CUqBase {\r\n\r\n    @observable.ref member: any;\r\n    private referrer: BoxId;\r\n\r\n    protected async internalStart(param: any) {\r\n\t\tif (!this.isLogined) return;\r\n\t\tlet { member } = this.uqs;\r\n\t\tlet { id: currentUserId } = this.user;\r\n\t\tlet promises: PromiseLike<any>[] = [\r\n\t\t\tmember.MemberAction.submit({}),\r\n\t\t\tmember.MemberRecommender.table({ referrer: currentUserId }),\r\n\t\t\tmember.MemberRecommender.table({ member: currentUserId }),\r\n\t\t];\r\n\t\tlet [{ code, point }, fans, referrer] = await Promise.all(promises);\r\n\t\tthis.referrer = referrer;\r\n\t\tthis.member = { recommendationCode: code, point, fans, referrer };\r\n    }\r\n\r\n    private loginCallback = async () => {\r\n        nav.pop();\r\n        await this.internalStart(undefined);\r\n    }\r\n\r\n    private render = observer(() => {\r\n        if (this.isLogined) {\r\n            return this.member === undefined ? <Loading /> : this.renderView(VMember);\r\n        } else {\r\n            return <div\r\n                className=\"d-flex h-100 flex-column align-items-center justify-content-center\">\r\n                <div className=\"flex-fill\" />\r\n                <button className=\"btn btn-success w-20c\"\r\n                    onClick={() => nav.showLogin(this.loginCallback, true)}>\r\n                    <FA name=\"sign-out\" size=\"lg\" /> 请登录\r\n                </button>\r\n                <div className=\"flex-fill\" />\r\n                <div className=\"flex-fill\" />\r\n            </div>;\r\n        }\r\n    })\r\n\r\n    tab = () => {\r\n        this.start();\r\n        return <this.render />;\r\n    }\r\n\r\n    setReferrer(code: string) {\r\n        if (code) {\r\n            // 写入map，方法是add，用这个方法可能会写入多次，多以在写入之前要检查有没有，有的话，就不能再调用这个方法了\r\n            // 这个逻辑我认为应该是在服务端，写入的时候要给双方积分，给多少积分的逻辑，也应该在后端，从邀请码到拥有此邀请码\r\n            // 的会员id之间的转换，逻辑也应该在后台，这个后端的逻辑写在ACTION中？\r\n            if (!this.referrer) {\r\n                let { id: currentUserId } = this.user;\r\n            }\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page } from 'tonva';\r\n\r\ninterface Phone {\r\n\tnumber: string;\r\n\tcaption: string;\r\n}\r\n\r\ninterface Section {\r\n\tcaption: string;\r\n\taddress: string;\r\n\tpost?: string;\r\n\tphones: Phone[];\r\n\tfax?: string;\r\n\temail: string[];\r\n}\r\n\r\nconst sections: Section[] = [\r\n\t{\r\n\t\tcaption: 'J&K Scientific Ltd.',\r\n\t\taddress: '北京市朝阳区北辰西路69号峻峰华亭A座5层',\r\n\t\tpost: '100029',\r\n\t\tphones: [\r\n\t\t\t{ number: '4006667788', caption: '400-666-7788' },\r\n\t\t\t{ number: '+861082848833', caption: '+86 10 8284 8833' },\r\n\t\t],\r\n\t\tfax: '+86 10 8284 9933',\r\n\t\temail: ['jkinfo@jkchemical.com', 'jkinfo@jk-sci.com'],\r\n\t},\r\n\t{\r\n\t\tcaption: 'J&K Scientific Ltd. (上海)',\r\n\t\taddress: '上海市浦东区世纪大道1777号东方希望大厦10楼H座',\r\n\t\tpost: '200122',\r\n\t\tphones: [{ number: '+862161638833', caption: '+86 21 6163 8833' }],\r\n\t\tfax: '+86 21 6163 8800',\r\n\t\temail: ['jksh@jkchemical.com', 'jksh@jk-sci.com']\r\n\t},\r\n\t{\r\n\t\tcaption: 'J&K Scientific Ltd. (广东)',\r\n\t\taddress: '广东省广州市天河区珠江新城华夏路28号富力盈信大厦3108室',\r\n\t\tpost: '510623',\r\n\t\tphones: [{ number: '+862038889733', caption: '+86 20 3888 9733' }],\r\n\t\tfax: '+86 20 3888 8285',\r\n\t\temail: ['jkgz@jkchemical.com', 'jkgz@jk-sci.com'],\r\n\t},\r\n\t{\r\n\t\tcaption: 'J&K Scientific Ltd. (成都)',\r\n\t\taddress: '四川省成都市高新区科园南路1号1栋8楼803号',\r\n\t\tpost: '610041',\r\n\t\tphones: [{ number: '+8602883231067', caption: '+86 028 83231067' }],\r\n\t\temail: ['jkinfo@jkchemical.com'],\r\n\t},\r\n\t{\r\n\t\tcaption: 'J&K Scientific Ltd. (香港)',\r\n\t\taddress: 'FLAT/RM 1901, 19/F, Lee Garden One,33 Hysan Avenue, Causeway Bay, Hong Kong',\r\n\t\tphones: [{ number: '+85228105022', caption: '+852 2810 5022' }],\r\n\t\tfax: '+852 2810 5033',\r\n\t\temail: ['jkhk@jkchemical.com'],\r\n\t}\r\n];\r\n\r\nconst Row: React.FunctionComponent<any> = ({ label, content }) => {\r\n\tif (!content) return null;\r\n\treturn <div className=\"my-1\">\r\n\t\t<span className=\"small text-muted\">{label}</span>：{content}\r\n\t</div>;\r\n}\r\n\r\nexport class ContactUs extends React.Component {\r\n\trender() {\r\n\t\tlet right = null;\r\n\t\treturn <Page header=\"联系信息\" right={right}>\r\n\t\t\t<div className='bg-white pb-5'>\r\n\t\t\t\t<div className=\"h4 pb-3 border-bottom border-muted text-center p-3 mb-3\">\r\n\t\t\t\t\t<span className=\"text-primary mr-\">联系我们</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"px-3 my-3\">\r\n\t\t\t\t\t<small className=\"text-muted\">全国客服热线：</small><a href=\"tel:4006667788\">400-666-7788</a>\r\n\t\t\t\t\t<span className=\"ml-4\"><small className=\"text-muted\">QQ：</small>4006667788</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t{sections.map((v, index) => {\r\n\t\t\t\t\tlet { caption, address, post, phones, fax, email } = v;\r\n\t\t\t\t\treturn <div key={index} className=\"my-4\">\r\n\t\t\t\t\t\t<div className=\"h5 text-info border-bottom p-3\">{caption}</div>\r\n\t\t\t\t\t\t<div className=\"px-3\">\r\n\t\t\t\t\t\t\t<Row label=\"地址\" content={address} />\r\n\t\t\t\t\t\t\t<Row label=\"邮编\" content={post} />\r\n\t\t\t\t\t\t\t<Row label=\"电话\" content={\r\n\t\t\t\t\t\t\t\tphones && phones.map((phone, phoneIndex) => {\r\n\t\t\t\t\t\t\t\t\tlet { number, caption } = phone;\r\n\t\t\t\t\t\t\t\t\treturn <a key={phoneIndex} className=\"mr-5\" href={'tel:' + number}>{caption}</a>\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<Row label=\"传真\" content={fax} />\r\n\t\t\t\t\t\t\t<Row label=\"电子邮件\" content={\r\n\t\t\t\t\t\t\t\temail && email.map((e, eIndex) => {\r\n\t\t\t\t\t\t\t\t\treturn <a key={eIndex} className=\"mr-5\" href={'mailto:' + e}>{e}</a>\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</Page >;\r\n\t}\r\n}\r\n/*\r\n<div className=\"my-5\">\r\n<p className=\"h4 text-info\">J&amp;K Scientific Ltd.</p>\r\n<div className=\"small\">\r\n\t<p>地址：北京市朝阳区北辰西路69号峻峰华亭A座5层</p>\r\n\t<p>邮编：100029</p>\r\n\t<p>电话：<a href=\"tel:4006667788\">400-666-7788</a> / <a href=\"tel:861082848833\">+86 10 8284 8833</a></p>\r\n\t<p>传真：+86 10 8284 9933</p>\r\n\t<p>电子邮件：<a href=\"mailto:jkinfo@jkchemical.com\">jkinfo@jkchemical.com</a><a className=\"ml-3\" href=\"mailto:jkinfo@jk-sci.com\">jkinfo@jk-sci.com</a></p>\r\n</div>\r\n</div>\r\n<div className=\"my-5\">\r\n<p className=\"h4 text-info\">J&amp;K Scientific Ltd.(上海)</p>\r\n<div className=\"small\">\r\n\t<p>地址：上海市浦东区世纪大道1777号东方希望大厦10楼H座</p>\r\n\t<p>邮编：200122</p>\r\n\t<p>电话：<a href=\"tel:+862161638833\">+86 21 6163 8833</a></p>\r\n\t<p>传真：+86 21 6163 8800</p>\r\n\t<p>电子邮件：<a href=\"mailto:jksh@jkchemical.com\">jksh@jkchemical.com</a><a className=\"ml-3\" href=\"mailto:jksh@jk-sci.com\">jksh@jk-sci.com</a></p>\r\n</div>\r\n</div>\r\n<div className=\"my-5\">\r\n<p className=\"h4 text-info\">J&amp;K Scientific Ltd.(广东)</p>\r\n<div className=\"small\">\r\n\t<p>地址：广东省广州市天河区珠江新城华夏路28号富力盈信大厦3108室</p>\r\n\t<p>邮编：510623</p>\r\n\t<p>电话：<a href=\"tel:+862038889733\">+86 20 3888 9733</a></p>\r\n\t<p>传真：+86 20 3888 8285</p>\r\n\t<p>电子邮件：<a href=\"mailto:jkgz@jkchemical.com\">jkgz@jkchemical.com</a><a className=\"ml-3\" href=\"mailto:jkgz@jk-sci.com\">jkgz@jk-sci.com</a></p>\r\n</div>\r\n</div>\r\n<div className=\"my-5\">\r\n<p className=\"h4 text-info\">J&amp;K Scientific Ltd.(成都)</p>\r\n<div className=\"small\">\r\n\t<p>地址：四川省成都市高新区科园南路1号1栋8楼803号</p>\r\n\t<p>邮编：610041</p>\r\n\t<p>电话：<a href=\"tel:+8602883231067\">+86 028 83231067</a></p>\r\n\t<p>电子邮件：<a href=\"mailto:jkinfo@jkchemical.com\">jkinfo@jkchemical.com</a></p>\r\n</div>\r\n</div>\r\n<div className=\"my-5\">\r\n<p className=\"h4 text-info\">J&amp;K Scientific Ltd.(香港)</p>\r\n<div className=\"small\">\r\n\t<p>地址：FLAT/RM 1901, 19/F, Lee Garden One,33 Hysan Avenue, Causeway Bay, Hong Kong</p>\r\n\t<p>电话：<a href=\"tel:+85228105022\">+852 2810 5022</a></p>\r\n\t<p>传真：+852 2810 5033</p>\r\n\t<p>电子邮件：<a href=\"mailto:jkhk@jkchemical.com\">jkhk@jkchemical.com</a></p>\r\n</div>\r\n</div>\r\n*/","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport {\r\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema,\r\n    VPage, UiRadio, IdSchema, UiIdItem, Context, BoxId, tv\r\n} from 'tonva';\r\nimport { CMe } from './CMe';\r\nimport {\r\n    faxValidation, emailValidation, mobileValidation, telephoneValidation,\r\n    addressDetailValidation, zipCodeValidation,\r\n    organizationNameValidation, departmentNameValidation,\r\n    salutationValidation, nameValidation\r\n} from '../tools/inputValidations';\r\n\r\nexport class EditMeInfo extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\r\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    @observable private webUserData: any;\r\n\r\n    @observable private webUserContactData: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n\r\n        let { cApp } = this.controller;\r\n        let { firstName, gender, salutation, organizationName, departmentName, telephone\r\n            , mobile, email, fax, zipCode, address, addressString } = cApp.currentUser;\r\n        this.webUserData = {\r\n            firstName: firstName,\r\n            gender: gender,\r\n            salutation: salutation,\r\n            organizationName: organizationName,\r\n            departmentName: departmentName,\r\n        };\r\n\r\n        this.webUserContactData = {\r\n            telephone: telephone,\r\n            mobile: mobile,\r\n            email: email,\r\n            fax: fax,\r\n            address: address,\r\n            addressString: addressString,\r\n            zipCode: zipCode,\r\n        }\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        (nav.user as any)[name] = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n    private onWebUserChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserData[name] = newValue;\r\n        await this.controller.changeWebUser(this.webUserData);\r\n    }\r\n\r\n    private onWebUserContactChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserContactData[name] = newValue;\r\n        await this.controller.changeWebUserContact(this.webUserContactData);\r\n    }\r\n\r\n    private page = () => {\r\n        let { schema, uiSchema, data, onItemChanged, webUserData, onWebUserChanged, webUserContactData, onWebUserContactChanged, controller } = this;\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n            <Edit schema={webUserSchema} uiSchema={webUserUiSchema}\r\n                data={webUserData}\r\n                onItemChanged={onWebUserChanged} />\r\n            <Edit schema={webUserContactSchema} uiSchema={webUserContactUiSchema(controller.pickAddress)}\r\n                data={webUserContactData}\r\n                onItemChanged={onWebUserContactChanged} />\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\nexport const webUserUiSchema: UiSchema = {\r\n    items: {\r\n        firstName: {\r\n            widget: 'text', label: '真实姓名',\r\n            placeholder: '真实姓名',\r\n            rules: nameValidation\r\n        } as UiTextItem,\r\n        gender: { widget: 'radio', label: '性别', list: [{ value: '1', title: '男' }, { value: '0', title: '女' }] } as UiRadio,\r\n        salutation: { widget: 'text', label: '称谓', rules: salutationValidation } as UiTextItem,\r\n        organizationName: { widget: 'text', label: '单位名称', placeholder: '单位名称', rules: organizationNameValidation } as UiTextItem,\r\n        departmentName: { widget: 'text', label: '部门名称', placeholder: '部门名称', rules: departmentNameValidation } as UiTextItem,\r\n    }\r\n}\r\n\r\n// 个人联系方式信息\r\nexport const webUserContactSchema: ItemSchema[] = [\r\n    { name: 'telephone', type: 'string' } as StringSchema,\r\n    { name: 'mobile', type: 'string', required: true } as StringSchema,\r\n    { name: 'email', type: 'string' } as StringSchema,\r\n    { name: 'fax', type: 'string', required: false } as StringSchema,\r\n    { name: 'address', type: 'id', required: false } as IdSchema,\r\n    { name: 'addressString', type: 'string', required: false } as StringSchema,\r\n    { name: 'zipCode', type: 'string', required: false } as StringSchema,\r\n];\r\n\r\nexport function webUserContactUiSchema(pickAddress: any) {\r\n    return {\r\n        items: {\r\n            telephone: { widget: 'text', label: '固定电话', placeholder: '固定电话', rules: telephoneValidation } as UiTextItem,\r\n            mobile: { widget: 'text', label: '手机号', placeholder: '手机号', rules: mobileValidation } as UiTextItem,\r\n            email: { widget: 'text', label: 'Email', rules: emailValidation, placeholder: 'Email' } as UiTextItem,\r\n            fax: { widget: 'text', label: '传真', placeholder: '传真', rules: faxValidation } as UiTextItem,\r\n            address: {\r\n                widget: 'id', label: '所在地区', placeholder: '所在地区',\r\n                pickId: async (context: Context, name: string, value: number) => await pickAddress(context, name, value),\r\n                Templet: (address: BoxId) => {\r\n                    if (!address) return <small className=\"text-muted\">(无)</small>;\r\n                    return tv(address, (addressValue) => {\r\n                        let { country, province, city, county } = addressValue;\r\n                        /* 下面这种在使用tv之前的一堆判断应该是tv或者什么的有bug, 应该让Henry改改 */\r\n                        return <>\r\n                            {country !== undefined && country.id !== undefined && tv(country, v => <>{v.chineseName}</>)}\r\n                            {province !== undefined && province.id !== undefined && tv(province, (v) => <>{v.chineseName}</>)}\r\n                            {city !== undefined && city.id !== undefined && tv(city, (v) => <>{v.chineseName}</>)}\r\n                            {county !== undefined && county.id !== undefined && tv(county, (v) => <>{v.chineseName}</>)}\r\n                        </>;\r\n                    }, () => {\r\n                        return <small className=\"text-muted\">请选择地区</small>;\r\n                    })\r\n                }\r\n            } as UiIdItem,\r\n            addressString: { widget: 'text', label: '详细地址', placeholder: '详细地址', rules: addressDetailValidation } as UiTextItem,\r\n            zipCode: { widget: 'text', label: '邮编', placeholder: '邮编', rules: zipCodeValidation } as UiTextItem,\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { Page, VPage, nav } from 'tonva';\r\nimport logo from '../images/logo.png';\r\nimport { appConfig } from 'configuration';\r\nimport { CMe } from './CMe';\r\n\r\nexport class AboutThisApp extends VPage<CMe>{\r\n\r\n    private version: any;\r\n    async open() {\r\n        this.version = await nav.checkVersion();\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private page = () => {\r\n        let right = null;\r\n        let links: any = <div className=\"sep-product-select\" style={{ width: \"80%\", margin: \" 0 auto 0 auto\" }} />\r\n        return <Page header=\"关于百灵威购物APP\" right={right}>\r\n            <div className='bg-white p-3'>\r\n                <div className=\"h3 flex-fill text-center\">\r\n                    <img src={logo} alt=\"logo\" />\r\n                </div>\r\n                <div className=\"h3 flex-fill text-center\">\r\n                    <span className=\"text-primary mr-3\">百灵威购物APP</span>\r\n                </div>\r\n                <div className=\"h3 flex-fill text-center small\">\r\n                    <span className=\"text-muted mr-3\">V{appConfig.version}</span>\r\n                </div>\r\n\r\n                {\r\n                    (this.version && this.version !== appConfig.version) && <>\r\n                        {links}\r\n                        < div className=\"d-flex my-3 cursor-pointer\" style={{ width: \"70%\", margin: \" 0 auto 0 auto\" }} onClick={() => nav.resetAll()} >\r\n                            <div className=\"text-danger\">发现新版本 V{this.version}，升级APP</div>\r\n                        </div>\r\n                        {links}\r\n                    </>\r\n                }\r\n            </div>\r\n        </Page>;\r\n    }\r\n}","import * as React from 'react';\r\nimport { nav, Image, VPage, Ax } from 'tonva';\r\nimport { Prop, IconText, FA, PropGrid, LMR } from 'tonva';\r\nimport { ContactUs } from './contactUs';\r\nimport { observer } from 'mobx-react';\r\nimport { EditMeInfo } from './EditMeInfo';\r\nimport { CMe } from './CMe';\r\nimport { AboutThisApp } from './aboutThisApp';\r\nimport { appConfig } from 'configuration';\r\nimport { observable } from 'mobx';\r\nimport className from 'classnames';\r\nimport setting from 'images/setting.svg';\r\nimport number1 from 'images/number-01.svg';\r\nimport order1 from 'images/order-01.svg';\r\nimport { browser, xs } from 'tools/browser';\r\nimport { A } from '../tonva/components/ax/index';\r\nimport welcome from 'images/welcome.png';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\t/*\r\n    async open(param?: any) {\r\n\t\tthis.open\r\n\t}\r\n\t*/\r\n\tprivate tips = observable.box('a');\r\n\r\n    private exit() {\r\n        nav.showLogout();\r\n    }\r\n\r\n    private contactUs = () => nav.push(<ContactUs />);\r\n    private privacy = () => {\r\n        this.controller.openPrivacy();\r\n    }\r\n    private aboutThisApp = () => {\r\n        // nav.push(<AboutThisApp />);\r\n        this.openVPage(AboutThisApp)\r\n    }\r\n\r\n    private changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private openContactList = async () => {\r\n        this.controller.openContactList();\r\n    }\r\n\r\n    private openInvoice = async () => {\r\n        this.controller.openInvoice();\r\n    }\r\n\r\n    private openMyPoint = async () => {\r\n        this.controller.openMyPoint();\r\n    }\r\n\r\n    private openCouponManage = async () => {\r\n        this.controller.openCouponManage();\r\n    }\r\n\r\n    private openFavorites = async () => {\r\n        this.controller.openFavorites();\r\n    }\r\n\r\n    private meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"px-3 py-2 cursor-pointer w-100 bg-primary text-white\"\r\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={() => {\r\n                this.openVPage(EditMeInfo);\r\n            }}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-light\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n    private orderStates = () => {\r\n        let { openMyOrders } = this.controller;\r\n        let oss = [\r\n            { caption: '待审核', state: 'processing', icon: 'desktop' },\r\n            { caption: '待发货', state: 'completed', icon: 'truck' },\r\n            { caption: '所有订单', state: 'all', icon: 'file-text-o' },\r\n        ];\r\n\r\n        return <div className=\"d-flex justify-content-around w-100 my-3\">\r\n            {\r\n                oss.map(((os, index) => {\r\n                    let { caption, state, icon } = os;\r\n                    return <div key={index} className=\"flex-fill d-flex flex-column align-items-center cursor-pointer\"\r\n                        onClick={() => openMyOrders(state)}>\r\n                        <FA name={icon} className=\"text-info fa-2x\" />\r\n                        <small>{caption}</small>\r\n                    </div>;\r\n                }))\r\n            }\r\n        </div>\r\n    };\r\n\r\n    render() {\r\n        return <this.page />;\r\n    }\r\n    content() {\r\n        return <this.page />;\r\n    }\r\n    header() {\r\n        if (xs || browser.versions.iPad) return <this.meInfo />;\r\n        return '';\r\n\t}\r\n\tfooter():JSX.Element {return null;}\r\n\r\n    private page = observer(() => {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <IconText iconClass=\"text-info mr-2\" icon=\"phone\" text=\"联系我们\" />,\r\n                onClick: this.contactUs\r\n            },\r\n            {\r\n                type: 'component',\r\n                component: <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text=\"关于百灵威\" />,\r\n                onClick: () => this.controller.openAbout()\r\n            },\r\n            {\r\n                type: 'component',\r\n                component: <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text=\"隐私政策\" />,\r\n                onClick: this.privacy\r\n            },\r\n            {\r\n                type: 'component',\r\n                component: <div className=\"w-100 d-flex justify-content-between\" onClick={this.aboutThisApp}>\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text=\"关于本APP\" />\r\n                    <div className=\"py-2 small\">V{appConfig.version}</div>\r\n                </div>,\r\n            },\r\n            ''\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            let { showLogin } = this.controller;\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => showLogin()}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> 请登录\r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    bk: '',\r\n                    component: <div className=\"text-center flex-fill mb-3\"><button className=\"btn btn-danger w-75\" onClick={this.exit}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> 退出登录\r\n\t\t\t\t\t\t</button>\r\n                    </div>\r\n                },\r\n            ];\r\n\r\n            rows = [\r\n\t\t\t\t/*\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n\t\t\t\t},\r\n\t\t\t\t*/\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <>{this.orderStates()}</>,\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"地址管理\" />,\r\n                    onClick: this.openContactList\r\n                },\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"发票管理\" />,\r\n                    onClick: this.openInvoice\r\n                },\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"积分管理\" />,\r\n                    onClick: this.openMyPoint\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"connectdevelop\" text=\"卡券管理\" />,\r\n                    onClick: this.openCouponManage\r\n                },\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"heart\" text=\"商品收藏\" />,\r\n                    onClick: this.openFavorites\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text=\"修改密码\" />,\r\n                    onClick: this.changePassword\r\n                },\r\n            ]\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n\r\n        if (xs || browser.versions.iPad) return <>\r\n            <PropGrid rows={rows} values={{}} />\r\n        </>;\r\n        else {\r\n            if (user === undefined) {\r\n                return <div className=\"d-flex justify-content-center\" style={{ height: 340 }}>\r\n                    <div className=\"my-auto p-5 rounded\">\r\n                        <div className=\"d-flex\">\r\n                            <img src={welcome} className=\"m-auto\" alt=\"\" />\r\n                        </div>\r\n                        您正在以访客身份查看本站内容,请\r\n                            <Ax href=\"/login\" className=\"alert-link font-weight-bolder\"> 登录 </Ax>\r\n                        或者\r\n                            <Ax href=\"/register\" className=\"alert-link font-weight-bolder\"> 注册会员</Ax>\r\n                    </div>\r\n                </div>\r\n            };\r\n            let meLib = [\r\n                {\r\n                    type: '帐户设置',\r\n                    image: setting,\r\n                    belongs: [\r\n                        {\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text=\"修改密码\" />,\r\n                            href:'/password',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text=\"账户信息\" />,\r\n                            href:'/meInfo',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"地址管理\" />,\r\n                            href:'/contact',\r\n                        },\r\n                    ]\r\n                },{\r\n                    type: '会员管理',\r\n                    image: number1,\r\n                    belongs: [\r\n                        {\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"heart\" text=\"商品收藏\" />,\r\n                            href:'/favorites',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"shopping-bag\" text=\"积分管理\" />,\r\n                            href:'/pointshop',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"connectdevelop\" text=\"卡券管理\" />,\r\n                            href:'/couponManage',\r\n                        },\r\n                    ]\r\n                },{\r\n                    type: '订单管理',\r\n                    image: order1,\r\n                    belongs: [\r\n                        {\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"file-text\" text=\"订单记录\" />,\r\n                            href:'/myOrders',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"发票管理\" />,\r\n                            href:'/invoice',\r\n                        },\r\n                    ]\r\n                },\r\n            ]\r\n            return <div className=\"container mt-lg-2 py-3\">\r\n                <div className=\"row\">\r\n                    {\r\n                        meLib.map((v: any,index:number) => {\r\n                            return <div className=\"col-lg-4 single-product\" key={index}>\r\n                                <div className=\"border text-center pt-5\">\r\n                                    <a href=\"#\"><img src={v.image} className=\"w-50\" /></a>\r\n                                </div>\r\n                                <h2 className=\"mint-bg\">{v.type}</h2>\r\n                                <div className=\"background-grey h-auto\">\r\n                                    <ul className=\"pl-3\">\r\n                                        {\r\n                                            v.belongs.map((o: any,index:number) => {\r\n                                                return <li className=\"list-inline\" key={index}><Ax href={o.href}>{o.component}</Ax></li>\r\n                                            })\r\n                                        }\r\n                                    </ul>\r\n                                </div>\r\n                            </div>\r\n                        })\r\n                    }\r\n                </div>\r\n            </div>\r\n        \r\n        }\r\n\t\t// <button onClick={()=>this.tips.set('ddddd')}>push</button>\r\n\t\t// {autoHideTips(this.tips, <div className=\"text-danger\">{this.tips.get()}</div>)}\r\n    })\r\n}\r\n\r\nexport function userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import * as React from 'react';\r\nimport _ from 'lodash';\r\nimport { observable } from 'mobx';\r\nimport { ItemSchema, Page, VPage, FA, Form, Context, autoHideTips } from 'tonva';\r\nimport { CMe } from './CMe';\r\nimport { webUserSchema, webUserUiSchema, webUserContactSchema, webUserContactUiSchema } from './EditMeInfo';\r\nimport { observer } from 'mobx-react';\r\n\r\ninterface Options {\r\n    onlyRequired: boolean;\r\n    caption: string;\r\n    note: string;\r\n    actionButton: {\r\n        value: string;\r\n        action: any;\r\n    }\r\n}\r\n\r\nexport class EditMeInfoFirstOrder extends VPage<CMe>{\r\n    private options: Options;\r\n\t//@observable tips: JSX.Element;\r\n\tprivate tips = observable.box();\r\n    private form: Form;\r\n\r\n    async open(param: any) {\r\n        // this.onlyRequired = param;\r\n        this.options = param;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    @observable private webUserData: any;\r\n\t@observable private webUserContactData: any;\r\n\t\r\n\tprivate ref = (f:Form) => {\r\n\t\tif (this.form === f) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\tthis.form = f;\r\n\t}\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n\r\n        let { cApp } = this.controller;\r\n        let { firstName, gender, salutation, organizationName, departmentName, telephone\r\n            , mobile, email, fax, address, addressString, zipCode } = cApp.currentUser;\r\n        this.webUserData = {\r\n            firstName: firstName,\r\n            gender: gender,\r\n            salutation: salutation,\r\n            organizationName: organizationName,\r\n            departmentName: departmentName\r\n        };\r\n\r\n        this.webUserContactData = {\r\n            telephone: telephone,\r\n            mobile: mobile,\r\n            email: email,\r\n            fax: fax,\r\n            address: address,\r\n            addressString: addressString,\r\n            zipCode: zipCode\r\n        }\r\n    }\r\n\r\n    private onFormButtonClick = async (name: string, context: Context) => {\r\n        let { data } = context.form;\r\n        _.merge(this.webUserData, data);\r\n        _.merge(this.webUserContactData, data);\r\n        await this.controller.changeWebUser(this.webUserData);\r\n        await this.controller.changeWebUserContact(this.webUserContactData);\r\n\r\n        let { currentUser } = this.controller.cApp;\r\n        if (currentUser.allowOrdering) {\r\n            this.closePage();\r\n            let webUserContacts = await currentUser.getContacts();\r\n            if (webUserContacts === undefined || webUserContacts.length === 0) {\r\n                await currentUser.addContactFromAccount();\r\n            }\r\n            await this.options.actionButton.action();\r\n        } else {\r\n            this.tips.set(<>以上带有 <span className='text-danger'>*</span> 的内容均须填写！</>);\r\n            //setTimeout(() => {\r\n            //    this.tips = undefined;\r\n            //}, GLOABLE.TIPDISPLAYTIME);\r\n        }\r\n    }\r\n\r\n    private onCompleted = async () => {\r\n        if (!this.form) return;\r\n        await this.form.buttonClick(\"submit\");\r\n    }\r\n\r\n    private page = observer(() => {\r\n\t\t/*\r\n        let tipsUI = <></>;\r\n        if (this.tips) {\r\n            tipsUI = <div className=\"alert alert-primary\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {this.tips}\r\n            </div>\r\n\t\t}\r\n\t\t*/\r\n\r\n        let { onlyRequired, caption, note, actionButton } = this.options;\r\n        let schemaFilter = (itemSchema: ItemSchema): boolean => {\r\n            return (onlyRequired === true && itemSchema.required === true)\r\n                || onlyRequired === undefined\r\n                || onlyRequired === false\r\n        }\r\n\r\n        let schemaArr = [];\r\n        for (let item of webUserSchema) {\r\n            if (item.required === true) schemaArr.push(item);\r\n        }\r\n        for (let item of webUserContactSchema) {\r\n            if (item.required === true) schemaArr.push(item);\r\n        }\r\n        if (onlyRequired !== true) {\r\n            for (let item of webUserSchema) {\r\n                if (item.required !== true) schemaArr.push(item);\r\n            }\r\n            for (let item of webUserContactSchema) {\r\n                if (item.required !== true) schemaArr.push(item);\r\n            }\r\n        }\r\n        let uiSchema = {};\r\n        _.merge(uiSchema, webUserUiSchema, webUserContactUiSchema(this.controller.pickAddress));\r\n\r\n        let data = _.merge(this.webUserData, this.webUserContactData);\r\n        let { value } = actionButton;\r\n        return <Page header={caption}>\r\n            <div className=\"alert alert-light my-3 py-4\" role=\"alert\">\r\n                <FA name=\"smile-o\" className=\"text-warning mr-4 my-1\" size=\"2x\" />\r\n                {note}\r\n            </div>\r\n\r\n            <div className=\"App-container container text-left\">\r\n                <Form ref={this.ref} className=\"my-3\"\r\n                    schema={schemaArr.filter(schemaFilter)}\r\n                    uiSchema={uiSchema}\r\n                    formData={data}\r\n                    onButtonClick={this.onFormButtonClick}\r\n                    fieldLabelSize={3} />\r\n            </div>\r\n\r\n            <div className=\"p-3 bg-white\">\r\n                {/*tipsUI*/}\r\n\t\t\t\t{autoHideTips(this.tips, <div className=\"alert alert-primary\" role=\"alert\">\r\n\t\t\t\t\t<FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n\t\t\t\t\t{this.tips}\r\n\t\t\t\t</div>)}\r\n                <button type=\"button\" className=\"btn btn-primary w-100\" onClick={() => this.onCompleted()}>{value}</button>\r\n            </div>\r\n        </Page >;\r\n    });\r\n}\r\n/*\r\n<Edit schema={schemaArr.filter(schemaFilter)} uiSchema={uiSchema}\r\n    data={data}\r\n    onItemChanged={this.onMergeDataChanged} />\r\n\r\n    private onMergeDataChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        this.webUserContactData[name] = newValue;\r\n        this.webUserData[name] = newValue;\r\n        await this.controller.changeWebUser(this.webUserData);\r\n        await this.controller.changeWebUserContact(this.webUserContactData);\r\n    }\r\n*/","import * as React from 'react';\r\nimport { VPage, Page, BoxId, List, Scroller } from 'tonva';\r\nimport { CFavorites } from './CFavorites';\r\nimport { xs } from '../tools/browser';\r\nimport { pageHTitle } from 'tools/pageHeaderTitle';\r\n\r\nexport class VFavorites extends VPage<CFavorites> {\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n    private onScrollBottom = async (scroller: Scroller) => {\r\n        scroller.scrollToBottom();\r\n        let { productsFavorites } = this.controller;\r\n        productsFavorites.more();\r\n    }\r\n    private onProductClick = async (product: BoxId) => {\r\n        let { cProduct } = this.controller.cApp;\r\n        await cProduct.showProductDetail(product.id);\r\n    }\r\n\r\n    private renderProduct = (p: any) => {\r\n        // console.log(p);\r\n        if(!this.controller.cApp.cProduct.showFavorites)\r\n            this.controller.cApp.cProduct.showFavorites = true;\r\n        return this.controller.cApp.cProduct.renderProduct(p);\r\n    }\r\n\r\n    private page = (param: any) => {\r\n        let { productsFavorites } = this.controller;\r\n        //let { cProduct } = cApp;\r\n        let header: any;\r\n        if (xs) {\r\n            header = \"商品收藏\";\r\n        };\r\n        let none = <div className=\"p-3 text-warning mt-4 d-flex justify-content-center\">[无收藏]</div>\r\n        return <Page header={header} onScrollBottom={this.onScrollBottom}>\r\n            <div className=\"row mx-0 bg-light my-1\">\r\n                <div className=\"col-lg-3 d-none d-lg-block\">\r\n                    {this.controller.cApp.cMe.renderMeSideBar()}\r\n                </div>\r\n                <div className=\"col-lg-9 px-0\">\r\n                    {pageHTitle(<div className=\"text-left pl-3\">商品收藏</div>)}\r\n                    <List before={''} none={none} items={productsFavorites} item={{ render: this.renderProduct, onClick: this.onProductClick }} />\r\n                </div>\r\n            </div>\r\n        </Page>\r\n    }\r\n}\r\n","import { VFavorites } from './VFavorites';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { QueryPager } from 'tonva';\r\nimport { Product } from 'model';\r\n//import { VProductFavorateLabel } from './VProductFavorateLabel';\r\n\r\nexport class CFavorites extends CUqBase {\r\n    productsFavorites: QueryPager<any>;\r\n    myFavorites: any[] = [];\r\n    protected async internalStart() {\r\n        await this.searchByFavorites();\r\n        this.openVPage(VFavorites);\r\n    }\r\n\r\n    private productConverter = (item: any, queryResults?: { [name: string]: any[] }): Product => {\r\n        let product = this.cApp.getProduct(item.id);\r\n        product.props = item;\r\n        // product.props.imageUrl = item.chemical.toString();\r\n        product.loadListItem();\r\n        return product;\r\n    }\r\n\r\n    async searchByFavorites() {\r\n        let { currentUser, currentSalesRegion } = this.cApp;\r\n        this.productsFavorites = new QueryPager<any>(this.uqs.webuser.getMyFavirates, 10, 10);\r\n        this.productsFavorites.setItemConverter(this.productConverter);\r\n        await this.productsFavorites.first({ webUser: currentUser, salesRegion: currentSalesRegion });\r\n    }\r\n\r\n    /*\r\n    async getMyFavorites() {\r\n        let { currentUser, currentSalesRegion } = this.cApp;\r\n        let myFavorites = await this.uqs.webuser.myFavorites.query({ webUser: currentUser, salesRegion: currentSalesRegion });\r\n        return myFavorites.ret;\r\n    }\r\n    */\r\n\t/*\r\n    renderFavoritesLabel = (productid: number) => {\r\n        let { currentUser } = this.cApp;\r\n        // let myFavorite = await this.uqs.webuser.myFavorites.obj({ webUser: currentUser, product: productid });\r\n        return this.renderView(VProductFavorateLabel, productid)\r\n\t}\r\n\t*/\r\n}\r\n","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { View, nav, LMR, Image, FA } from 'tonva';\r\nimport { EditMeInfo } from './EditMeInfo';\r\nimport { CMe } from './CMe';\r\n\r\nexport class VLoginState extends View<CMe> {\r\n\r\n    render() {\r\n        let { user } = nav;\r\n        let { showLogin, renderCarLabel } = this.controller;\r\n        if (!user) {\r\n            return <>\r\n                <li className=\"nav-item d-none d-lg-block\" onClick={() => showLogin()}>\r\n                    <a className=\"nav-link header-login\">注册/登录</a>\r\n                </li>\r\n                {renderCarLabel()}\r\n            </>;\r\n            /*\r\n            return <div className=\"d-flex align-items-center justify-content-end small text-muted\">\r\n                <a className=\"px-2\" href=\"./shop?type=signUp\">注册</a>\r\n                <a className=\"px-2\" href=\"./shop?type=login\">登录</a>\r\n                {this.controller.renderCarLabel()}\r\n            </div>\r\n            */\r\n        }\r\n        let { id, name, nick, icon } = user;\r\n        return <div className=\"d-flex align-items-center justify-content-end\">\r\n            <div>\r\n                {<Image className=\"w-3c h-3c mr-3\" src={icon} />}\r\n            </div>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </div >;\r\n    }\r\n}\r\n\r\nexport function userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import * as React from 'react';\r\nimport { VPage } from 'tonva';\r\n//import marked from 'marked';\r\nimport logo from '../images/logo.png';\r\nimport { CMe } from './CMe';\r\n\r\nconst imgStyle:React.CSSProperties = {\r\n\twidth: '100%', \r\n\theight: 'auto',\r\n};\r\n\r\nconst content = <>\r\n<p>　　百灵威科技有限公司是一家致力于研发和生产化学及相关产品，集敏捷制造、全球营销和现代物流为一体的高科技企业。\r\n百灵威在中国内地、香港，欧洲及北美等多个国家和地区设有物流中心，实行专业化、个性化的一站式服务，\r\n为全球超过200,000 名科技和工业领域的客户提供产品资源及配套技术服务。</p>\r\n<img src=\"images/aboutus/HebBirdsEye.jpg\" alt=\"BirdsEye\" className=\"pb-3\" style={imgStyle}/>\r\n<p>　　百灵威现代化的研发制造基地拥有一支富有创造天赋的专业团队，新技术、新产品层出不穷，J&K®、Amethyst®、J&K Scientific® 产品\r\n已多达30,000 种以上，并呈几何级数增长。作为国际化的资源平台公司，百灵威致力于促进全球产业链的合作，不断推进集约式发展，\r\n集成资源600,000 余种，包括高纯有机试剂、无机试剂、生化试剂、分析试剂、标准品、金属有机催化剂、医药中间体、超精细材料、\r\n以及实验室仪器、耗材等众多产品。百灵威的柔性生产线能够快速提供小批量、多品种的原料，满足实验、中试以至规模化生产的需要。\r\n</p>\r\n<img src=\"images/aboutus/aboutUs1.jpg\" alt=\"aboutus1\" className=\"pb-3\" style={imgStyle} />\r\n<p>　　百灵威秉承“诚实守信、开拓创新、合作共赢、实现卓越”的价值观，致力于与化学、生物医药、精细化工、食品工业、现代农业、电子、日化、\r\n石化、纺织、生命科学、环境保护、疾病控制、新能源、新材料、航空航天等领域的客户建立互信、长久的合作关系，\r\n为实现“促进科技与工业发展，造福人类”的使命而不懈努力！\r\n</p>\r\n</>;\r\n\r\nexport class VAbout extends VPage<CMe> {\r\n    content() {\r\n        return <div className='bg-white p-3'>\r\n\t\t\t<img className=\"h-3c position-absolute\" src={logo} alt=\"百灵威\" />\r\n\t\t\t<div className=\"h3 flex-fill text-center\">\r\n\t\t\t\t<span className=\"text-primary mr-3\">百灵威集团</span>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"mt-5\">{content}</div>\r\n\t\t</div>;\r\n    }\r\n}\r\n\r\n//dangerouslySetInnerHTML={{ __html: marked(content) }} />","import * as React from 'react';\r\nimport { View, FA, IconText, Ax } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { CMe } from './CMe';\r\nimport setting from 'images/setting.svg';\r\nimport number1 from 'images/number-01.svg';\r\nimport order1 from 'images/order-01.svg';\r\n\r\nexport const meLib = [\r\n                {\r\n                    type: '帐户设置',\r\n                    image: setting,\r\n                    belongs: [\r\n                        {\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text=\"修改密码\" />,\r\n                            href:'/password',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text=\"账户信息\" />,\r\n                            href:'/meInfo',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"地址管理\" />,\r\n                            href:'/contact',\r\n                        },\r\n                    ]\r\n                },{\r\n                    type: '会员管理',\r\n                    image: number1,\r\n                    belongs: [\r\n                        {\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"heart\" text=\"商品收藏\" />,\r\n                            href:'/favorites',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"shopping-bag\" text=\"积分管理\" />,\r\n                            href:'/pointshop',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"connectdevelop\" text=\"卡券管理\" />,\r\n                            href:'/couponManage',\r\n                        },\r\n                    ]\r\n                },{\r\n                    type: '订单管理',\r\n                    image: order1,\r\n                    belongs: [\r\n                        {\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"file-text\" text=\"订单记录\" />,\r\n                            href:'/myOrders',\r\n                        },{\r\n                            component: <IconText iconClass=\"text-info mr-2\" icon=\"address-book-o\" text=\"发票管理\" />,\r\n                            href:'/invoice',\r\n                        },\r\n                    ]\r\n                },\r\n            ]\r\n\r\n\r\nexport class VMeSideBar extends View<CMe> {\r\n\r\n    render(): JSX.Element {\r\n        let { pathname } = document.location;\r\n        return <div className=\"my-5 px-2 border rounded\">\r\n            {meLib.map((v: any,index:number) => {\r\n                return <div key={index}>\r\n                    <div className=\"text-center border-bottom py-2 font-weight-bolder\">{v.type}</div>\r\n                    <ul className=\"px-0 text-center \">\r\n                        {v.belongs.map((o: any,index:number) => {\r\n                            return <li style={{ background:o.href === pathname ? '#f5f5f5':''}}\r\n                                className='list-inline rounded'\r\n                                key={index}><Ax href={o.href}>{o.component}</Ax></li>\r\n                        })}\r\n                    </ul>\r\n                </div>\r\n            })}\r\n        </div>\r\n\t}\r\n}\r\n","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport _ from 'lodash';\r\nimport { Context, nav, VPage, User } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VMe } from './VMe';\r\nimport { CSelectShippingContact } from '../customer/CSelectContact';\r\nimport { EditMeInfoFirstOrder } from './EditMeInfoFirstOrder';\r\nimport { CInvoiceInfo } from '../customer/CInvoiceInfo';\r\nimport { CAddress } from '../customer/CAddress';\r\nimport { CFavorites } from '../customer/CFavorites';\r\nimport { CPointProduct } from 'pointMarket/CPointProduct';\r\nimport { VLoginState } from './VLoginState';\r\nimport { VAbout } from './about';\r\nimport { EditMeInfo } from './EditMeInfo';\r\nimport { VMeSideBar } from './VMeSideBar';\r\n\r\nexport class CMe extends CUqBase {\r\n    //    cApp: CApp;\r\n    protected async internalStart(param?: any) {\r\n\t\tthis.openVPage(VMe);\r\n\t}\r\n\r\n    async changeWebUser(webUser: any) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.changeWebUser(webUser);\r\n    }\r\n\r\n    async changeWebUserContact(webUserContact: any) {\r\n        let { currentUser } = this.cApp;\r\n        await currentUser.changeWebUserContact(webUserContact);\r\n    }\r\n\r\n    tab = () => this.renderView(VMe);\r\n    tabPage: VMe = new VMe(this);\r\n\r\n    openMyOrders = async (state:string) => {\r\n        let { cOrder } = this.cApp;\r\n        await cOrder.openMyOrders(state);\r\n    }\r\n\r\n    openMeInfo = async () => {\r\n        this.openVPage(EditMeInfo);\r\n    }\r\n\r\n    openContactList = async () => {\r\n        let contactList = this.newC(CSelectShippingContact); // new CSelectShippingContact(this.cApp, undefined, false);\r\n        await contactList.start(false);\r\n    }\r\n\r\n    openInvoice = async () => {\r\n        let cInvoiceInfo = this.newC(CInvoiceInfo); // new CInvoiceInfo(this.cApp, undefined, false);\r\n        let { currentUser } = this.cApp;\r\n        let defaultSetting = await currentUser.getSetting();\r\n\r\n        let origInvoice = _.pick(defaultSetting, ['invoiceType', 'invoiceInfo']);\r\n        cInvoiceInfo.start(origInvoice);\r\n    }\r\n\r\n    openMyPoint = async () => {\r\n        /* let cPointProduct = this.newC(CPointProduct);// new CSelectShippingContact(this.cApp, undefined, false);\r\n        await cPointProduct.start(); */\r\n        await this.cApp.cPointProduct.openMyPoint();\r\n    }\r\n    /**\r\n     * 卡券管理\r\n     */\r\n    openCouponManage = async () => {\r\n        let { cCoupon } = this.cApp;\r\n        await cCoupon.openMyCouponManage();\r\n        // let cCouponManage = this.newC(CCouponManage);\r\n        // await cCouponManage.start();\r\n    }\r\n\r\n    /**\r\n     * 商品收藏\r\n     */\r\n    openFavorites = async () => {\r\n        let cMyFavorites = this.newC(CFavorites);\r\n        await cMyFavorites.start();\r\n    }\r\n\r\n    toPersonalAccountInfo = async (fn: Function) => {\r\n        await this.openMeInfoFirstOrder({\r\n            onlyRequired: false,\r\n            caption: \"请补充账户信息\",\r\n            note: <>\r\n                化学品是受国家安全法规限制的特殊商品，百灵威提供技术咨询、资料以及化学产品的对象必须是具有化学管理和应用能力的专业单位（非个人）。\r\n                为此，需要您重新提供非虚拟的、可核查的信息。这些信息包括下面所有带有 <span className=\"text-danger\">*</span> 的信息。\r\n            </>,\r\n            actionButton: {\r\n                value: \"下一步\",\r\n                action: fn\r\n            }\r\n        });\r\n\t}\r\n\t\r\n\topenAbout() {\r\n\t\tthis.openVPage(VAbout);\r\n\t}\r\n\r\n    openMeInfoFirstOrder = async (options?: any) => {\r\n        await this.openVPage(EditMeInfoFirstOrder, options);\r\n    }\r\n\r\n    pickAddress = async (context: Context, name: string, value: number): Promise<number> => {\r\n        let cAddress = this.newC(CAddress); // new CAddress(this.cApp, undefined);\r\n        return await cAddress.call<number>();\r\n    }\r\n\r\n    openPrivacy = () => {\r\n        // this.openVPage(Privacy);\r\n        nav.showPrivacyPage();\r\n    }\r\n\r\n    getCommonText = async (textId: number) => {\r\n        return await this.uqs.order.CommonText.load(textId);\r\n    }\r\n\r\n    renderLoginState() {\r\n        return this.renderView(VLoginState);\r\n    }\r\n\r\n    showLogin = (callback?: (user: User) => Promise<void>) => {\r\n\t\tif (nav.isWebNav) {\r\n\t\t\tnav.navigate('/login');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tnav.showLogin(callback, true);\r\n\t\t}\r\n    }\r\n\r\n    showLoginOut = (callback?: () => Promise<void>) => {\r\n        nav.showLogout(callback);\r\n    }\r\n\r\n    renderCarLabel = () => {\r\n        let { cCart } = this.cApp;\r\n        return cCart.renderCartLabel();\r\n    }\r\n\r\n    renderMeSideBar = () => {\r\n        return this.renderView(VMeSideBar);\r\n    }\r\n\r\n\t/*\r\n    renderLoginState_Web() {\r\n        return this.renderView(VLoginState_Web);\r\n\t}\r\n\t*/\r\n\t/*\r\n    renderCarLabel_Web() {\r\n        let { cCart } = this.cApp;\r\n        return cCart.renderCartLabel_Web();\r\n\t}\r\n\t*/\r\n}","import * as React from 'react';\r\nimport { VPage, TabCaptionComponent, Page } from 'tonva';\r\nimport { CApp } from './CApp';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VMain extends VPage<CApp> {\r\n    async open(param?: any) {\r\n        this.openPage(this.render);\r\n    }\r\n\r\n    render = (param?: any): JSX.Element => {\r\n        let { cHome, cCart, cMe, cart } = this.controller;\r\n        let faceTabs = [\r\n            { name: 'home', label: '首页', icon: 'home', page: cHome.tab, notify: undefined/*store.homeCount*/ },\r\n            // { name: 'member', label: '会员', icon: 'vcard', content: cMember.tab },\r\n            {\r\n                name: 'cart',\r\n                label: '购物车',\r\n                icon: 'shopping-cart',\r\n                //content: cCart.tab, \r\n                page: cCart.tabPage,\r\n                notify: cart.count\r\n            },\r\n            {\r\n                name: 'me',\r\n                label: '我的',\r\n                icon: 'user',\r\n                //content: cMe.tab \r\n                page: cMe.tabPage,\r\n            }\r\n        ].map(v => {\r\n            let { name, label, icon, page, notify } = v;\r\n            return {\r\n                name: name,\r\n                caption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n                page: page,\r\n                notify: notify,\r\n            }\r\n        });\r\n\r\n        return <Page tabsProps={{ tabs: faceTabs }} />\r\n    }\r\n}\r\n\r\n/* export class Main extends VPage<CApp> {\r\n    async open(param?: any) {\r\n        this.openPage(this.render, { param });\r\n    }\r\n\r\n    render = (param?: any): JSX.Element => {\r\n        return <Switch>\r\n            <Route path='/search1/:key' render={() => {\r\n                return <div>cProduct1.start</div>\r\n            }} />\r\n            <Route path='/search/:key' render={() => {\r\n                // this.controller.cProduct.start(param.param);\r\n                this.controller.cProduct.searchByKey(param.param);\r\n                return this.controller.cProduct.renderProductList2(param.param);\r\n            }} />\r\n            <Route path='/' render={() => {\r\n                this.openVPage(VMain);\r\n                return <></>\r\n            }} />\r\n        </Switch>\r\n    }\r\n} */","import * as React from 'react';\r\nimport { CCoupon } from './CCoupon';\r\nimport { VPage, Page, List } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\nimport { VCoupon, VCredits, VVIPCard } from './VVIPCard';\r\n\r\nexport class VSharedCoupon extends VPage<CCoupon> {\r\n\r\n    @observable tipsAfterDawed: string;\r\n    private products: any[] = [];\r\n    async open(param: any) {\r\n        this.products = param.products || [];\r\n        if (this.products.length === 0) {\r\n            this.tipsAfterDawed = `3秒后将跳到首页，开始您的购物之旅。`\r\n        } else {\r\n            this.tipsAfterDawed = \"您可以点击以下产品开始您的购物之旅。\"\r\n        }\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private drawCouponUI = observer(() => {\r\n        let { sharedCouponValidationResult } = this.controller;\r\n        if (sharedCouponValidationResult.result !== 1)\r\n            return null;\r\n        let { couponDrawed, loginWhenDrawCoupon } = this.controller;\r\n        if (couponDrawed) {\r\n            if (this.products.length === 0) {\r\n                this.countDown();\r\n            }\r\n            return React.createElement(this.showTips)\r\n        }\r\n        else {\r\n            return <button className=\"btn btn-primary w-100\"\r\n                onClick={() => loginWhenDrawCoupon(sharedCouponValidationResult)}>领取</button>\r\n        }\r\n    })\r\n\r\n    private countDown = () => {\r\n        let waitingSeconds = 3;\r\n        setInterval(() => {\r\n            this.tipsAfterDawed = `${waitingSeconds}秒后将跳到首页，开始您的购物之旅。`\r\n            if (waitingSeconds === 0) {\r\n                this.backPage();\r\n            }\r\n            waitingSeconds--;\r\n        }, 1000)\r\n    }\r\n\r\n    private showTips = observer(() => {\r\n        return <div className=\"alert alert-info w-100 text-center\">\r\n            <div className=\"pb-3\">\r\n                <span className=\"text-danger\" style={{ fontSize: \"1.4rem\" }}>领取成功</span><br />\r\n                <small className=\"text-muted\">领取的卡券可在&Prime;卡券管理&Prime;中查看</small>\r\n            </div>\r\n            <small>{this.tipsAfterDawed}</small>\r\n        </div>\r\n    })\r\n\r\n    private renderCouponBase = (sharedCouponValidationResult: any) => {\r\n        let { types, discount } = sharedCouponValidationResult;\r\n        // return <>{this.renderVm(COUPONBASE[types]['view'], sharedCouponValidationResult)}</>;\r\n        switch (types) {\r\n            case 'coupon':\r\n                if (discount)\r\n                    return <>{this.renderVm(VCoupon, sharedCouponValidationResult)}</>;\r\n                else\r\n                    return <>{this.renderVm(VVIPCard, sharedCouponValidationResult)}</>;\r\n            case 'credits':\r\n                return <>{this.renderVm(VCredits, sharedCouponValidationResult)}</>;\r\n            case 'vipcard':\r\n                return <>{this.renderVm(VVIPCard, sharedCouponValidationResult)}</>;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    private onProductClick = async (product: any) => {\r\n        await this.controller.showProductDetail(product.id);\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { renderProduct, cApp, sharedCouponValidationResult } = this.controller;\r\n\r\n        let { cCart } = cApp;\r\n        let cart = cCart.renderCartLabel();\r\n        return <Page header=\"与您分享\" right={cart}>\r\n            {this.renderCouponBase(sharedCouponValidationResult)}\r\n            {React.createElement(this.drawCouponUI)}\r\n            <List items={this.products} item={{ render: renderProduct, onClick: this.onProductClick, className: \"mb-1\" }} none={null} />\r\n        </Page>\r\n    })\r\n}","import * as React from 'react';\r\nimport { VPage, Page, List, tv } from 'tonva';\r\nimport { CrPageHeaderTitle } from 'tools/pageHeaderTitle';\r\nimport { CCoupon } from './CCoupon';\r\nimport { pageHTitle } from '../tools/pageHeaderTitle';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VVIPCardDiscount extends VPage<CCoupon>{\r\n\r\n    private vipCard: any;\r\n    async open(vipCard: any) {\r\n        this.vipCard = vipCard;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderVIPCardDiscountSetting(item: any) {\r\n        let { brand, discount } = item;\r\n        return <div className=\"row\">\r\n            <div className=\"col-7\">\r\n                {tv(brand, v => v.name)}\r\n            </div>\r\n            <div className=\"col-5\">\r\n                {100 - discount * 100}%\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    private page = () => {\r\n        let header = CrPageHeaderTitle('折扣明细');\r\n        return <Page header={header}>\r\n            <div style={{maxWidth:990}} className=\"mx-auto mb-5\">\r\n                {pageHTitle('折扣明细')}\r\n                <List items={this.vipCard.discountSetting} item={{ render: this.renderVIPCardDiscountSetting, className: \"px-3 py-2\" }}></List>\r\n            </div>\r\n        </Page>\r\n    }\r\n\r\n    render(param?: any): JSX.Element{\r\n        this.vipCard = param.vipCard;\r\n        return React.createElement(observer(() => {\r\n            return <List items={this.vipCard?.discountSetting} item={{ render: this.renderVIPCardDiscountSetting, className: \"px-3 py-2\" }}></List>\r\n        }));\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, LMR, FA, List, TabProp, TabCaptionComponent, Tabs, Scroller, QueryPager, autoHideTips } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { VCoupon, VCredits, VVIPCard, VCouponUsed } from './VVIPCard';\r\nimport { observable } from 'mobx';\r\nimport { color } from 'order/VMyOrders';\r\nimport { CCoupon } from './CCoupon';\r\nimport { xs } from '../tools/browser';\r\nimport { CrPageHeaderTitle, pageHTitle } from 'tools/pageHeaderTitle';\r\nimport { Modal } from 'antd';\r\nimport { VModelCardDiscount } from './VModelCardDiscount';\r\n\r\nexport class VCouponManage extends VPage<CCoupon> {\r\n\r\n    private couponInput: HTMLInputElement;\r\n    @observable private coupons: QueryPager<any>;\r\n    private currentStatus: string;\r\n    private tabs: TabProp[];\r\n    oss: any = [\r\n        { caption: '可使用', state: 'validCardForWebUser', icon: 'free-code-camp', toolTip: '亲，您现没有可用的优惠券呦！' },\r\n        { caption: '已使用', state: 'usageRecordForWebUser', icon: 'cc-amex', toolTip: '亲，您还未使用过任何优惠券,快去使用噢！' },\r\n        { caption: '已过期', state: 'expiredForWebUser', icon: 'ravelry', toolTip: '亲，您还没已过期的优惠券！' },\r\n    ];\r\n\r\n\t//@observable tips: string;\r\n\tprivate tips = observable.box();\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private getTabs = async () => {\r\n        let { getCoupons } = this.controller;\r\n        this.tabs = this.oss.map((v: any) => {\r\n            let { caption, state, icon, toolTip } = v;\r\n            let none = <div className=\"my-4 text-secondary d-flex justify-content-center\">{`『 ${toolTip} 』`}</div>\r\n            return {\r\n                name: caption,\r\n                caption: (selected: boolean) => TabCaptionComponent(caption, icon, color(selected)),\r\n                content: () => {\r\n                    return <List items={this.coupons} item={{render: this.renderCoupon, className: 'col-lg-6 border rounded px-0'}} className='row mx-0 bg-light mt-2' none={none} />\r\n                },\r\n                isSelected: this.currentStatus === state,\r\n                load: async () => {\r\n                    this.currentStatus = state;\r\n                    this.coupons = await getCoupons(this.currentStatus);\r\n                }\r\n            };\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 领取优惠卡\r\n     */\r\n    private receiveCoupon = async () => {\r\n        let { drawCoupon, getCouponValidationResult, applyTip } = this.controller;\r\n\t\tlet coupon = this.couponInput.value;\r\n\t\tlet tips: string;\r\n        if (!coupon)\r\n            tips = \"请输入您的优惠卡/券号\";\r\n        else {\r\n            this.couponInput.value = '';\r\n\r\n            let validationResult = await getCouponValidationResult(coupon);\r\n            let { result } = validationResult;\r\n            if (result === 1) {\r\n                await drawCoupon(validationResult);\r\n                tips = '领取成功！';\r\n            } else {\r\n                tips = applyTip(result);\r\n            }\r\n\t\t}\r\n\t\tthis.tips.set(tips);\r\n\t\t/*\r\n        if (this.tips) {\r\n        //    setTimeout(() => this.tips = undefined, GLOABLE.TIPDISPLAYTIME);\r\n\t\t}\r\n\t\t*/\r\n        // setTimeout(() => this.controller.closePage(), 500);\r\n        // this.currentStatus = this.oss[0].state;\r\n        // this.coupons = await getCoupons(this.currentStatus);\r\n    }\r\n\r\n    /**\r\n     * 优惠卡展示\r\n     */\r\n    private renderCoupon = (coupon: any) => {\r\n        let { types, discount, conductReveal } = coupon;\r\n        let content = null;\r\n        if (types === \"coupon\")\r\n            content = discount ? this.renderVm(VCoupon, coupon) : this.renderVm(VVIPCard, coupon);\r\n        else if (types === \"credits\")\r\n            content = this.renderVm(VCredits, coupon);\r\n        else if (types === 'vipcard') {\r\n            content = this.renderVm(VVIPCard, coupon);\r\n        }\r\n        if (conductReveal) {\r\n            content = this.renderVm(VCouponUsed, coupon);\r\n        }\r\n        return <div className=\"d-block\">\r\n            <div className=\"px-2 bg-white mt-1\" onClick={() => { this.CouponViewOrUse(coupon) }}>\r\n                {content}\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    /**\r\n     * 折扣明细或使用记录\r\n     */\r\n    private CouponViewOrUse = (coupon: any) => {\r\n        let { showDiscountSetting,showModelCardDiscount } = this.controller;\r\n        let { result, types } = coupon;\r\n        if (result === 1 && types !== 'credits') {\r\n            if (xs) showDiscountSetting(coupon);\r\n            else showModelCardDiscount(coupon);\r\n        }\r\n    }\r\n\r\n    private tipsUI = observer(() => {\r\n        let tipsUI = <></>;\r\n        if (this.tips) {\r\n            tipsUI = <div className=\"alert alert-primary\" role=\"alert\">\r\n                <FA name=\"exclamation-circle\" className=\"text-warning float-left mr-3\" size=\"2x\"></FA>\r\n                {this.tips}\r\n            </div>\r\n        }\r\n        return tipsUI;\r\n    })\r\n    private onScrollBottom = async (scroller: Scroller) => {\r\n        scroller.scrollToBottom();\r\n        if (this.currentStatus !== \"validCardForWebUser\")\r\n            this.coupons.more();\r\n    }\r\n\r\n    private page = observer(() => {\r\n        this.getTabs();\r\n        let right = <button className=\"btn btn-primary w-4c\" onClick={this.receiveCoupon}>领取</button>\r\n        let header = CrPageHeaderTitle('卡券管理');\r\n        return <Page header={header}>\r\n            <div className=\"row mx-0\">\r\n                <div className=\"col-lg-3 d-none d-lg-block\">\r\n                    {this.controller.cApp.cMe.renderMeSideBar()}\r\n                </div>\r\n                <div className=\"col-lg-9 px-0 mx-auto\" style={{ maxWidth: !xs ? 800 : 'none' }}>\r\n                    {pageHTitle(<div className=\"text-left px-2\">卡券管理</div>)}\r\n                    <div className=\"px-2 py-3 mb-5 mx-auto\" style={{maxWidth:990}}>\r\n                        <LMR right={right}>\r\n                            <input ref={v => this.couponInput = v} type=\"number\" placeholder=\"输入领取优惠卡券号码\" className=\"form-control\"></input>\r\n                        </LMR>\r\n                        {/*React.createElement(this.tipsUI)*/}\r\n                        {autoHideTips(this.tips)}\r\n                        <div className=\"mt-2 reset-z-header-boxS\">\r\n                            <Tabs tabs={this.tabs} tabPosition=\"top\" tabBg='bg-light' />\r\n                        </div>\r\n                    </div >\r\n                    {this.controller.renderModelCardDiscount()}\r\n                </div>\r\n            </div>\r\n        </Page>\r\n    })\r\n}","import * as React from 'react';\r\nimport { View, FA } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { CCoupon } from './CCoupon';\r\nimport { Modal } from 'antd';\r\n\r\nexport class VModelCardDiscount extends View<CCoupon> {\r\n\r\n    render(param?: any): JSX.Element {\r\n    \treturn React.createElement(observer(() => {\r\n\t\t\treturn <Modal\r\n                title=\"折扣明细\"\r\n                visible={this.controller.CardDiscount}\r\n                onCancel={() => {this.controller.CardDiscount = false;}}\r\n                style={{top:'35%'}}\r\n                footer={null}>\r\n                {this.controller.renderCardDiscount()}\r\n            </Modal>\r\n\t\t}));\r\n\t}\r\n}","import { observable } from 'mobx';\r\nimport { QueryPager } from 'tonva';\r\nimport { CUqBase } from '../tapp/CBase';\r\nimport { VSharedCoupon } from './VSharedCoupon';\r\nimport { VCoupleAvailable } from './VCouponAvailable';\r\nimport { VVIPCardDiscount } from './VVIPCardDiscount';\r\nimport { VCoupon, VCredits, VVIPCard } from './VVIPCard';\r\nimport { VCouponManage } from './VCouponManage';\r\nimport { VModelCardDiscount } from './VModelCardDiscount';\r\n\r\nexport const COUPONBASE: any = {\r\n    'coupon': { 'name': '优惠券', 'view': VCoupon },\r\n    'credits': { 'name': '积分券', 'view': VCredits },\r\n    'vipcard': { 'name': 'VIP卡', 'view': VVIPCard }\r\n}\r\n\r\n\r\nconst couponTips:{[key:number]: string} = {\r\n\t\"-1\": '对不起，当前服务器繁忙，请稍后再试。',\r\n\t\"1\": '有效',\r\n\t\"0\": \"无此优惠券，请重新输入或与您的专属销售人员联系确认优惠码是否正确。\",\r\n\t\"2\": '优惠券已过期或作废，请重新输入或与您的专属销售人员联系。',\r\n\t\"3\": '优惠券无效，请重新输入或与您的专属销售人员联系。',\r\n\t\"5\": '优惠券无效，请重新输入或与您的专属销售人员联系。',\r\n\t\"6\": '不允许使用本人优惠券！',\r\n\t\"4\": '该优惠券已经被使用过了，不允许重复使用。',\r\n}\r\n\r\nexport class CCoupon extends CUqBase {\r\n    isOpenMyCouponManage: boolean = false;\r\n    @observable couponDrawed: boolean;\r\n    @observable sharedCouponValidationResult: any;\r\n    @observable CardDiscount:boolean = false;\r\n    @observable curCardDiscount:any;\r\n    couponPager: QueryPager<any>;\r\n\r\n    applyCoupon = async (coupon: string) => {\r\n        let validationResult = await this.getCouponValidationResult(coupon);\r\n        let { result: rtn, id, types } = validationResult;\r\n        if (rtn === 1) {\r\n            if (types === 'vipcard' || types === 'coupon') {\r\n                validationResult.discountSetting = await this.getCouponDiscountSetting(types, id);\r\n            }\r\n            this.returnCall(validationResult);\r\n            this.closePage();\r\n        }\r\n        return rtn;\r\n    }\r\n\r\n    applyCoupon1 = async (coupon: string) => {\r\n        let validationResult = await this.getCouponValidationResult(coupon);\r\n        let { result: rtn, id, types } = validationResult;\r\n        if (rtn === 1) {\r\n            if (types === 'vipcard' || types === 'coupon') {\r\n                validationResult.discountSetting = await this.getCouponDiscountSetting(types, id);\r\n            }\r\n            return validationResult;\r\n        }\r\n        return rtn;\r\n    }\r\n\r\n    getCouponValidationResult = async (coupon: string) => {\r\n        let { currentUser } = this.cApp;\r\n        return await this.uqs.salesTask.IsCanUseCoupon.submit({ code: coupon, webUser: currentUser && currentUser.id });\r\n    }\r\n\r\n    /**\r\n     * 优惠卡券管理界面\r\n     */\r\n    openMyCouponManage = async () => {\r\n        this.isOpenMyCouponManage = true;\r\n        this.openVPage(VCouponManage);\r\n    }\r\n\r\n    /**\r\n     * 获取不同状态下的优惠卡券\r\n     */\r\n    getCoupons = async (state: any) => {\r\n        let { webuser } = this.uqs;\r\n        let { currentUser } = this.cApp;\r\n        let result;\r\n        switch (state) {\r\n            case 'validCardForWebUser':\r\n                result = await this.getValidCardForWebUser();\r\n                return this.getValidMusterForWebUser(result);\r\n            case 'usageRecordForWebUser':\r\n                result = new QueryPager<any>(webuser.getMyUsedCoupon, 10, 10);\r\n                await result.first({ webUser: currentUser });\r\n                return result;\r\n            case 'expiredForWebUser':\r\n                result = new QueryPager<any>(webuser.getMyExpiredCoupon, 10, 10);\r\n                await result.first({ webUser: currentUser });\r\n                return result;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 可使用的优惠卡\r\n     */\r\n    getValidMusterForWebUser = (params: any) => {\r\n        let { vipCardForWebUser, couponsForWebUser, creditsForWebUser } = params;\r\n        let shift = couponsForWebUser.map((v: any) => v.coupon).concat(creditsForWebUser.map((v: any) => v.coupon));\r\n        let validMuster = vipCardForWebUser ? [vipCardForWebUser.coupon].concat(shift) : shift;\r\n        let finalValidMuster = validMuster.filter((v: any) => v.result === 1);\r\n        return finalValidMuster;\r\n    }\r\n\r\n    /**\r\n     * 获取已过期的优惠卡\r\n     */\r\n    /* getExpiredMusterForWebUser = async () => {\r\n        let { webuser, 积分商城 } = this.uqs;\r\n        let { currentUser } = this.cApp;\r\n        let expiredMusterForWebUser: any[] = [];\r\n        let couponsMusterForWebUser: any = await webuser.WebUserCoupon.table({ webUser: currentUser });\r\n        let creditsMusterForWebUser: any = await 积分商城.WebUserCredits.table({ webUser: currentUser });\r\n        let vipCardMusterForWebUser: any = await webuser.WebUserVIPCard.obj({ webUser: currentUser });\r\n        if (vipCardMusterForWebUser) {\r\n            let { expiredDate } = vipCardMusterForWebUser;\r\n            if (expiredDate.getTime() < Date.now()) {\r\n                vipCardMusterForWebUser.coupon = await this.getCouponValidationResult(vipCardMusterForWebUser.vipCardCode);\r\n                expiredMusterForWebUser.push(vipCardMusterForWebUser.coupon);\r\n            }\r\n        }\r\n\r\n        if (couponsMusterForWebUser) {\r\n            let result = couponsMusterForWebUser.filter((v: any) => v.expiredDate.getTime() < Date.now());\r\n            if (result.length > 0) {\r\n                for (let i = 0; i < result.length; i++) {\r\n                    let e = result[i];\r\n                    e.coupon = await this.getCouponValidationResult(e.couponCode);\r\n                }\r\n                expiredMusterForWebUser.push(...result.map((v: any) => v.coupon));\r\n            }\r\n        }\r\n\r\n        if (creditsMusterForWebUser) {\r\n            let result = creditsMusterForWebUser.filter((v: any) => v.expiredDate.getTime() < Date.now());\r\n\r\n\r\n            if (result.length > 0) {\r\n                for (let i = 0; i < result.length; i++) {\r\n                    let e = result[i];\r\n                    e.coupon = await this.getCouponValidationResult(e.creditsCode);\r\n                }\r\n                expiredMusterForWebUser.push(...result.map((v: any) => v.coupon));\r\n            }\r\n        }\r\n        // expiredMusterForWebUser.forEach((el: any) => el.conductReveal = true);\r\n        return expiredMusterForWebUser;\r\n    }\r\n */\r\n\r\n    /**\r\n     * 获取用户有效的优惠券/vip卡\r\n     */\r\n    getValidCardForWebUser = async () => {\r\n        let { currentUser } = this.cApp;\r\n        let { id: currentUserId } = currentUser;\r\n\r\n        let validVIPCardForWebUser = await this.getValidVipCardForWebUser(currentUserId);\r\n        if (validVIPCardForWebUser) {\r\n            validVIPCardForWebUser.coupon = await this.getCouponValidationResult(validVIPCardForWebUser.vipCardCode)\r\n        }\r\n\r\n        let validCouponsForWebUser = await this.getValidCouponsForWebUser(currentUserId);\r\n        if (validCouponsForWebUser.length > 0) {\r\n            for (let i = 0; i < validCouponsForWebUser.length; i++) {\r\n                let e = validCouponsForWebUser[i];\r\n                e.coupon = await this.getCouponValidationResult(e.couponCode);\r\n            }\r\n        }\r\n\r\n        let validCreditsForWebUser = await this.getValidCreditsForWebUser(currentUserId);\r\n        if (validCreditsForWebUser.length > 0) {\r\n            for (let i = 0; i < validCreditsForWebUser.length; i++) {\r\n                let e = validCreditsForWebUser[i];\r\n                e.coupon = await this.getCouponValidationResult(e.creditsCode);\r\n            }\r\n        }\r\n\r\n        return {\r\n            'vipCardForWebUser': validVIPCardForWebUser,\r\n            'couponsForWebUser': validCouponsForWebUser,\r\n            'creditsForWebUser': validCreditsForWebUser\r\n        }\r\n    }\r\n\r\n    protected async internalStart(param: any) {\r\n        let result = await this.getValidCardForWebUser();\r\n\r\n        this.openVPage(VCoupleAvailable, result);\r\n    }\r\n\r\n    /**\r\n     * （在订单上）应用coupon\r\n     * @param coupon \r\n     */\r\n    applySelectedCoupon = async (coupon: string) => {\r\n        if (!coupon)\r\n            return \"请输入您的优惠卡/券号\";\r\n        else {\r\n            let ret = await this.applyCoupon(coupon);\r\n            return this.applyTip(ret);\r\n        }\r\n    }\r\n\r\n    applyTip = (ret: any) => {\r\n\t\treturn couponTips[ret];\r\n\t\t/*\r\n        switch (ret) {\r\n            case -1:\r\n                return '对不起，当前服务器繁忙，请稍后再试。';\r\n            case 1:\r\n                return '有效';\r\n            case 0:\r\n                return \"无此优惠券，请重新输入或与您的专属销售人员联系确认优惠码是否正确。\";\r\n            case 2:\r\n                return '优惠券已过期或作废，请重新输入或与您的专属销售人员联系。';\r\n            case 3:\r\n            case 5:\r\n                return '优惠券无效，请重新输入或与您的专属销售人员联系。';\r\n            case 6:\r\n                return '不允许使用本人优惠券！';\r\n            case 4:\r\n                return '该优惠券已经被使用过了，不允许重复使用。';\r\n            default:\r\n                break;\r\n        }*/\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param currentUserId \r\n     */\r\n    getValidVipCardForWebUser = async (currentUserId: number): Promise<any> => {\r\n        let { uqs } = this.cApp;\r\n        let { webuser } = uqs;\r\n        let { WebUserVIPCard } = webuser;\r\n        let vipCardForWebUser: any = await WebUserVIPCard.obj({ webUser: currentUserId });\r\n        if (vipCardForWebUser) {\r\n            let { expiredDate } = vipCardForWebUser\r\n            if (expiredDate.getTime() > Date.now()) {\r\n                return vipCardForWebUser;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param currentUserId \r\n     */\r\n    getValidCouponsForWebUser = async (currentUserId: number): Promise<any[]> => {\r\n        let { uqs } = this.cApp;\r\n        let { webuser } = uqs;\r\n        let { WebUserCoupon } = webuser;\r\n        let couponsForWebUser: any[] = await WebUserCoupon.table({ webUser: currentUserId });\r\n        let validCouponsForWebUser: any[] = [];\r\n        if (couponsForWebUser) {\r\n            validCouponsForWebUser = couponsForWebUser.filter(v => v.expiredDate.getTime() > Date.now());\r\n        }\r\n        return validCouponsForWebUser;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param currentUserId \r\n     */\r\n    getValidCreditsForWebUser = async (currentUserId: number): Promise<any[]> => {\r\n        let { uqs } = this.cApp;\r\n        let { 积分商城 } = uqs;\r\n        let creditsForWebUser: any[] = await 积分商城.WebUserCredits.table({ webUser: currentUserId });\r\n        let validCreditsForWebUser: any[] = [];\r\n        if (creditsForWebUser) {\r\n            validCreditsForWebUser = creditsForWebUser.filter(v => v.expiredDate.getTime() > Date.now());\r\n        }\r\n        return validCreditsForWebUser;\r\n    }\r\n\r\n    /**\r\n     * 显示VIP卡的品牌折扣明细 \r\n     * @param coupon \r\n     */\r\n    showDiscountSetting = async (vipCard: any) => {\r\n        let { types, id } = vipCard;\r\n        vipCard.discountSetting = await this.getCouponDiscountSetting(types, id);\r\n        this.openVPage(VVIPCardDiscount, vipCard);\r\n    }\r\n\r\n    showModelCardDiscount = async (vipCard: any) => {\r\n        let { types, id } = vipCard;\r\n        vipCard.discountSetting = await this.getCouponDiscountSetting(types, id);\r\n        this.curCardDiscount = vipCard;\r\n        this.CardDiscount = true;\r\n    }\r\n    /**\r\n     * 获取卡券的有效折扣  \r\n     */\r\n    getValidDiscounts = async (types: string, id: number) => {\r\n        return await this.getCouponDiscountSetting(types, id);\r\n    }\r\n\r\n    private getCouponDiscountSetting = async (types: string, couponId: number) => {\r\n        if (types === 'vipcard' || types === 'coupon') {\r\n            return await this.uqs.salesTask.VIPCardDiscount.table({ coupon: couponId });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 领取VIP卡 \r\n     */\r\n    showSharedVIPCard = async (param: any) => {\r\n        let { vipcard: vipCardCode, productids } = param;\r\n        await this.autoDrawCouponBase(vipCardCode);\r\n        let products = this.getProducts(productids);\r\n        this.openVPage(VSharedCoupon, { products });\r\n    }\r\n\r\n    /**\r\n     * 领取优惠券 \r\n     */\r\n    showSharedCoupon = async (param: any) => {\r\n        let { coupon, productids } = param;\r\n        await this.autoDrawCouponBase(coupon);\r\n        let products = this.getProducts(productids);\r\n        this.openVPage(VSharedCoupon, { products });\r\n    }\r\n\r\n    /**\r\n     * 领取积分码 \r\n     */\r\n    showSharedCredits = async (param: any) => {\r\n        let { credits, productids } = param;\r\n        await this.autoDrawCouponBase(credits);\r\n        let products = this.getProducts(productids);\r\n        this.openVPage(VSharedCoupon, { products });\r\n    }\r\n\r\n    private autoDrawCouponBase = async (couponBaseCode: string) => {\r\n\r\n        this.couponDrawed = false;\r\n        this.sharedCouponValidationResult = await this.getCouponValidationResult(couponBaseCode);\r\n        let { result } = this.sharedCouponValidationResult;\r\n\r\n        // 自动领取积分券\r\n        let { currentUser } = this.cApp;\r\n        let { id: currentUserId, allowOrdering } = currentUser;\r\n        if (result === 1 && currentUserId && allowOrdering)\r\n            await this.drawCoupon(this.sharedCouponValidationResult);\r\n    }\r\n\r\n    private getProducts = (productids: string) => {\r\n        let products: any;\r\n        if (productids) {\r\n            let { ProductX } = this.uqs.product;\r\n            let productidArray = productids.split('-').filter((v: any) => /^\\d{1,10}$/.test(v));\r\n            products = productidArray.map((v: any) => ProductX.boxId(v));\r\n        }\r\n        return products;\r\n    }\r\n\r\n    loginWhenDrawCoupon = async (credits: any) => {\r\n        let { cApp } = this;\r\n        let { cMe, currentUser } = cApp;\r\n        let { code } = credits;\r\n        this.sharedCouponValidationResult = await this.getCouponValidationResult(code);\r\n        let { result } = this.sharedCouponValidationResult;\r\n        let allowCurrentUser = async () => {\r\n            if (result === 1) {\r\n                if (!currentUser.allowOrdering) {\r\n                    cMe.toPersonalAccountInfo(async () => await this.drawCoupon(this.sharedCouponValidationResult));\r\n                } else {\r\n                    await this.drawCoupon(this.sharedCouponValidationResult);\r\n                }\r\n            }\r\n        }\r\n\r\n\t\tawait this.cApp.assureLogin();\r\n\t\tawait allowCurrentUser();\r\n\t\t/*\r\n        let loginCallback = async (user: User) => {\r\n            await cApp.currentUser.setUser(user);\r\n            await cApp.loginCallBack(user);\r\n            this.closePage(1);\r\n            await allowCurrentUser();\r\n        };\r\n        if (!this.isLogined)\r\n            nav.showLogin(loginCallback, true);\r\n        else {\r\n            await allowCurrentUser();\r\n\t\t}\r\n\t\t*/\r\n    }\r\n\r\n    drawCoupon = async (credits: any) => {\r\n        let { uqs, cApp } = this;\r\n        let { currentUser } = cApp;\r\n        let { id: currentUserId } = currentUser;\r\n        let { 积分商城, webuser } = uqs;\r\n        let { result, id: creditsId, code, validitydate, types } = credits;\r\n        if (result !== 1)\r\n            return;\r\n        switch (types) {\r\n            case 'credits':\r\n                let drawedResult = await 积分商城.WebUserCredits.obj({ webUser: currentUserId, credits: creditsId });\r\n                if (!drawedResult) {\r\n                    let now = new Date();\r\n\r\n                    await 积分商城.WebUserCredits.add({\r\n                        webUser: currentUserId,\r\n                        arr1: [{\r\n                            credits: creditsId,\r\n                            creditsCode: code,\r\n                            createDate: `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`,\r\n                            expiredDate: validitydate\r\n                        }]\r\n                    })\r\n                }\r\n                break;\r\n            case 'coupon':\r\n                let drawedResult3 = await webuser.WebUserCoupon.obj({ webUser: currentUserId, coupon: creditsId });\r\n                if (!drawedResult3) {\r\n                    let now = new Date();\r\n                    await webuser.WebUserCoupon.add({\r\n                        webUser: currentUserId,\r\n                        coupon: creditsId,\r\n                        arr1: [{\r\n                            couponType: 1,\r\n                            couponCode: code,\r\n                            createDate: `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`,\r\n                            expiredDate: validitydate,\r\n                        }]\r\n                    })\r\n                }\r\n                break;\r\n            case 'vipcard':\r\n                let drawedResult2 = await webuser.WebUserVIPCard.obj({ webUser: currentUserId, vipCard: creditsId });\r\n                if (!drawedResult2) {\r\n                    let now = new Date();\r\n                    await this.uqs.webuser.WebUserVIPCard.add({\r\n                        webUser: currentUserId,\r\n                        vipCard: creditsId,\r\n                        arr1: [{\r\n                            vipCardType: 1,\r\n                            createDate: `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`,\r\n                            expiredDate: validitydate,\r\n                            vipCardCode: code\r\n                        }]\r\n                    })\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.couponDrawed = true;\r\n    }\r\n\r\n    async showProductDetail(product: number) {\r\n        let { cProduct } = this.cApp;\r\n        await cProduct.showProductDetail(product);\r\n    }\r\n\r\n    renderProduct = (product: any) => {\r\n        let { cProduct } = this.cApp;\r\n        return cProduct.renderProductWithPrice(product);\r\n    }\r\n\r\n    renderModelCardDiscount = () => {\r\n        return this.renderView(VModelCardDiscount);\r\n    }\r\n    \r\n    renderCardDiscount = () => {\r\n        return this.renderView(VVIPCardDiscount,{vipCard:this.curCardDiscount});\r\n    }\r\n}","import * as React from 'react';\r\nimport { VPage, Page, List, LMR, FA } from 'tonva';\r\nimport { observer } from 'mobx-react';\r\nimport { CYncProjects } from './CYncProjects';\r\n\r\nexport class VYncProjects extends VPage<CYncProjects> {\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { YncProjectsItems } = this.controller;\r\n\r\n        let header = <header>\r\n            <div>选择项目</div>\r\n        </header>;\r\n        return <Page header={header} headerClassName=\"py-1 bg-primary\" >\r\n            <List items={YncProjectsItems} item={{ render: this.renderItem, onClick: this.onClick }} />\r\n        </Page>;\r\n    });\r\n\r\n\r\n    private onClick = async (model: any) => {\r\n        await this.controller.returnYncProject(model);\r\n        this.closePage();\r\n    }\r\n\r\n    private renderItem = (item: any, index: number) => {\r\n        let { ProjectName } = item;\r\n        return <LMR className=\"py-2 border\">\r\n            <div><FA name=\"circle\" className=\"px-2 text-primary\"></FA>{ProjectName}</div>\r\n        </LMR >;\r\n    }\r\n\r\n}\r\n","import { CUqBase } from 'tapp/CBase';\r\nimport { VYncProjects } from './VYncProjects';\r\nimport { YncProjectsResponse, YncProjectsItem } from './YncProductItem';\r\n\r\nexport class CYncProjects extends CUqBase {\r\n\r\n    private OrganCode: string;\r\n    private UserId: number;\r\n    YncProjectsItems: YncProjectsItem[] = [];\r\n    private YncProjectsResponse: YncProjectsResponse;\r\n\r\n    async internalStart(OrganCode: string, UserId: number) {\r\n        this.OrganCode = OrganCode;\r\n        this.UserId = UserId;\r\n        await this.getYncProjects();\r\n        this.openVPage(VYncProjects);\r\n    }\r\n\r\n    getYncProjects = async () => {\r\n        let formData = new FormData();\r\n        formData.append(\"OrganCode\", this.OrganCode);\r\n        formData.append(\"UserId\", this.UserId.toString());\r\n\r\n        let res = await window.fetch('http://apitest.sinopec.ad/api/ynk/projects', {\r\n            method: 'post',\r\n            body: formData,\r\n            headers: {\r\n                'Accept': 'application/x-www-form-urlencoded',\r\n                'Content-Type': 'application/json'\r\n            }\r\n        });\r\n        if (res.ok) {\r\n            let content = await res.json();\r\n            if (content.ok) {\r\n                this.YncProjectsResponse = JSON.parse(content);\r\n                if (this.YncProjectsResponse.code === 200) {\r\n                    this.YncProjectsItems = this.YncProjectsResponse.response;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    returnYncProject = (model: any) => {\r\n        this.returnCall(model);\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, FA } from 'tonva';\r\nimport { CLottery } from './CLottery';\r\nimport { PointProductImage } from 'tools/productImage';\r\nimport { observable } from 'mobx';\r\nimport classNames from 'classnames';\r\n\r\n\r\nexport class VLottery extends VPage<CLottery> {\r\n    @observable currIndex: number;\r\n    @observable winning: any;   /* 中奖的商品 */\r\n    @observable isLottery: boolean = false;\r\n    @observable lotterySuccess: boolean = false;\r\n    @observable aDeg: any = 0;/* 轮盘转到度数 */\r\n    prize = [0, 1, 2, 5, 8, 7, 6, 3];//抽奖轮转顺序  九宫格\r\n    // prize = [0, 1, 2, 3, 4, 5, 6, 7];//抽奖轮转顺序     轮盘\r\n    async open(param?: any) {\r\n        // console.log(await this.controller.cApp.uqs.积分商城);\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private lottery = async () => {\r\n        let { lotteryProducts, productsLib, decreasingNumberOfDraws, winningProduct } = this.controller;\r\n        await decreasingNumberOfDraws();\r\n        let i = 0;//转到哪个位置\r\n        let count = 0;//转圈初始值\r\n        let totalCount = 9;//转动的总圈数\r\n        let speed = 500;//转圈速度，越大越慢\r\n        let timer: any;\r\n        /* ---------------- 轮盘转动 ---------------- */\r\n        // let aaaaa = Math.floor(Math.random() * (3600 - 1000) + 1000);\r\n        // let roll = () => {\r\n        //     this.aDeg += 10;\r\n        //     if (this.aDeg >= aaaaa) {\r\n        //         clearTimeout(timer);\r\n        //         this.isLottery = false; this.lotterySuccess = true;\r\n        //     } else\r\n        //         timer = setTimeout(roll, 50);\r\n        // }\r\n        // roll();\r\n        /* ---------------- 轮盘转动 ---------------- */\r\n        this.currIndex = undefined;\r\n        this.isLottery = true;\r\n        let indexMR = this.mR();//随机取值\r\n        let roll = async () => {\r\n            speed -= 50;//速度衰减\r\n            if (speed <= 10) speed = 10;\r\n            this.currIndex = this.prize[i];\r\n            i++;\r\n            if (i > this.prize.length - 1) {//计算转圈次数\r\n                i = 0; count++;\r\n            }\r\n            if (count >= totalCount && productsLib[indexMR].productId === lotteryProducts[this.currIndex].id) {//满足转圈数和指定位置就停止\r\n                clearTimeout(timer); speed = 500; this.isLottery = false; this.lotterySuccess = true; this.winning = lotteryProducts[this.currIndex];\r\n                await winningProduct(this.winning);\r\n            } else {\r\n                timer = setTimeout(roll, speed);//不满足条件时调用定时器\r\n                if (count >= totalCount - 1 || speed <= 50) speed += 100;//最后一圈减速\r\n            }\r\n        }\r\n        roll();\r\n    }\r\n\r\n    private mR = () => {\r\n        let { productsLib } = this.controller;\r\n        return Math.floor(Math.random() * (productsLib.length - 0) + 0);\r\n    }\r\n\r\n    private renderLotteryBtn = () => {\r\n        let { remainingNumOfDraws } = this.controller;\r\n        return <button className={classNames('btn btn-primary  align-self-center ', this.isLottery ? 'disabled pr-4' : '')} onClick={() => {\r\n            if (remainingNumOfDraws === 0) { this.lotterySuccess = true; return; }\r\n            if (!this.isLottery) { this.lottery() }\r\n        }}>{this.isLottery ? '抽奖中' : '开始抽奖'}\r\n            <span className=\" position-relative\" style={{ display: this.isLottery ? '' : 'none' }}>\r\n                <i className=\"fa-li fa fa-spinner fa-spin position-absolute\" style={{ left: -7 }}></i>\r\n            </span>\r\n        </button>\r\n    }\r\n\r\n    private renderPrizesBlock = (v: any, index: any) => {\r\n        let color = [0, 2, 4, 6].includes(index) ? '#A52A2A' : '#7EC0EE';\r\n        // Math.cos((45 / 2) * (Math.PI / 180)) * 160 / 2 可大约计算border的带宽,存在误差 (------思路错误，需修正)\r\n        // console.log(Math.sin((45) * (Math.PI / 180)) * 160 / 2);\r\n        return <div key={index}\r\n            style={{\r\n                transform: `rotate(${index * 45 - 90}deg) translateY(-50%)`, top: '50%', left: '50%', width: 0, height: 0, border: \"68px solid transparent\",\r\n                borderRight: `160px solid ${this.currIndex === index ? 'rgb(255,203,63)' : color}`, borderLeft: 0, transformOrigin: '0% 0%'\r\n            }}\r\n            className=\"position-absolute\">\r\n            <span className=\"position-absolute\" style={{ top: -10, left: 130, transform: 'rotate(90deg)' }}>{v.content}</span>\r\n        </div>\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { lotteryProducts, remainingNumOfDraws, openMyLotteryPrize } = this.controller;\r\n        let header = <div className=\"w-100 text-center\">幸运抽奖</div>;\r\n\r\n        return <Page header={header} right={<></>} className=\"w-100\">\r\n\r\n            <div className=\"position-relative\" style={{ background: `url(http://bpic.588ku.com/back_pic/04/70/62/26589975a47d9d0.jpg) no-repeat`, backgroundSize: 'cover', }}>\r\n                {/* <img style={{ visibility: 'hidden' }} width=\"100%\" src={timg1_test} alt=\"\" /> */}\r\n                <div className=\"w-100 pb-5\" >\r\n                    {/* 抽奖机会 */}\r\n                    <div className=\"d-flex justify-content-center text-light pt-5 mb-3\" >\r\n                        <span className=\"border border-light rounded px-2 bg-transparent\" style={{ padding: '2px 0' }}>\r\n                            剩余 <b className=\"bg-white p-1 text-danger\">{remainingNumOfDraws}</b> 次抽奖机会\r\n                        </span>\r\n                    </div>\r\n\r\n                    {/* 抽奖区域 */}\r\n                    <div className=\" pb-5 mx-2 rounded-lg w-auto\"\r\n                        style={{ background: \"url(https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1104137880,798719686&fm=26&gp=0.jpg) no-repeat\", backgroundSize: \"100% 100%\" }}>\r\n                        {/* 抽奖标题 */}\r\n                        <div className=\"d-flex justify-content-center p-2 pt-3 h3 text-center text-monospace font-weight-bolder\">\r\n                            <div className=\" position-relative\" style={{ color: \"#cc0000\" }}>\r\n                                <span style={{ top: 3, left: -30, transform: 'rotate(-12deg)' }} className=\"position-absolute\">福</span>\r\n                                利放\r\n                                <span style={{ top: 3, right: -30, transform: 'rotate(12deg)' }} className=\"position-absolute\">送</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* 抽奖内容 */}\r\n                        {/* 轮盘--------------界面适配bug */} {/* overflow-hidden */}\r\n                        {/* <div className=\"border rounded-circle m-auto w-20c h-20c position-relative overflow-hidden\"\r\n                            style={{ transform: `rotate(${this.aDeg}deg)` }}>\r\n                            {lotteryProducts.map((v: any, index: number) => {\r\n                                return this.renderPrizesBlock(v, index);\r\n                            })}\r\n                            <div className=\"border rounded-circle position-absolute w-75 h-75 d-flex justify-content-center align-items-center\"\r\n                                style={{ top: '50%', left: '50%', transform: 'translate(-50%, -50%)', }}>\r\n                                {this.renderLotteryBtn()}\r\n                            </div>\r\n                        </div> */}\r\n                        {/* 九宫格 */}\r\n                        <div className='d-flex flex-wrap px-2 m-auto'>\r\n                            {lotteryProducts.map((v: any, index: number) => {\r\n                                if (index === 4) {\r\n                                    return <div className=\"d-flex justify-content-center\" key={index} style={{ width: '33.3%' }} >\r\n                                        {this.renderLotteryBtn()}\r\n                                    </div>\r\n                                }\r\n                                return <PointProductImage className={classNames('border', this.currIndex === index ? 'border-success' : '')} key={index} style={{ width: \"33.3%\" }} chemicalId={'1'} />\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n                    {/* 我的奖品 */}\r\n                    <div className=\"mx-2 d-flex justify-content-center mt-2\" onClick={() => { if (!this.isLottery) openMyLotteryPrize() }}>\r\n                        <span style={{ borderRadius: \"22px\", color: '#F7C709' }} className=\"text-center py-1 px-3 bg-white\">\r\n                            <FA name='gift' /> <span style={{ color: 'rgb(152,42,7)' }} className=\"small\">我的奖品</span>\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div >\r\n\r\n            {/* 抽奖成功提示 */}\r\n            {\r\n                this.lotterySuccess ?\r\n                    <div className=\"position-fixed d-flex justify-content-center\"\r\n                        style={{ top: 0, left: 0, right: 0, bottom: 0, zIndex: 99999, backgroundColor: 'hsla(120,0%,50%,.7)' }}>\r\n                        <div className=\"align-self-center bg-white rounded-lg px-4 py-3 pb-4 text-center position-relative\">\r\n                            <div className=\"position-absolute\" style={{ top: 5, right: 10, }} onClick={() => { this.lotterySuccess = false; this.winning = undefined; }}><FA name=\"times-circle-o\" /></div>\r\n                            {\r\n                                remainingNumOfDraws === 0 && this.winning === undefined\r\n                                    ? <div className=\"pt-2\">\r\n                                        <div className=\"text-warning\"><FA name='frown-o' size='2x' /></div>\r\n                                        您的抽奖机会用完了！\r\n                                    </div>\r\n                                    : <div className=\"align-self-center bg-white rounded-lg  pt-3 text-center\">\r\n                                        <div>恭喜您</div>\r\n                                        <div>获得-----</div>\r\n                                        <div className=\"py-5\">展示</div>\r\n                                        <div className='small mt-2'>可以到我的奖品中去查看</div>\r\n                                    </div>\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                    : null\r\n            }\r\n        </Page >\r\n    })\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, List } from 'tonva';\r\nimport { CLottery } from './CLottery';\r\n\r\nexport class VMyLotteryPrize extends VPage<CLottery> {\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderMyPrize = (myPrize: any) => {\r\n        return <div>1111</div>\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { myPrizeLib, openMyPrizeOrder } = this.controller;\r\n        let footer = <div className=\"w-100 px-3 d-flex justify-content-end\">\r\n            <button type=\"button\" className=\"btn btn-danger m-1\" onClick={openMyPrizeOrder}>领取奖品</button>\r\n        </div>\r\n\r\n        return <Page header='我的奖品' footer={footer}>\r\n            <List items={myPrizeLib} item={{ render: this.renderMyPrize }} none='无' />\r\n        </Page >\r\n    })\r\n}","import { BoxId } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\n\r\nexport class prizeOrder {\r\n\r\n    webUser: any;   // OK\r\n    organization: BoxId;\r\n    customer: any;  //OK\r\n    salesRegion: BoxId;   // OK\r\n\r\n    @observable shippingContact: BoxId; //OK\r\n    @observable exchangeItems: prizeOrderItem[] = [];\r\n\r\n    @computed get amount() {\r\n        return this.exchangeItems.reduce((pv, cv) => (pv + cv.subAmount), 0);\r\n    };\r\n\r\n    getDataForSave() {\r\n        let exchangeItems: any[] = [];\r\n        this.exchangeItems.forEach(oi => {\r\n            exchangeItems.push({\r\n                product: oi.product, pack: oi.pack, point: oi.point, quantity: oi.quantity\r\n                , subAmount: oi.quantity * oi.point\r\n            })\r\n        });\r\n        return {\r\n            webUser: this.webUser,\r\n            organization: this.organization,\r\n            customer: this.customer,\r\n            shippingContact: this.shippingContact,\r\n            amount: this.amount,\r\n            exchangeitems: exchangeItems, // 前面的必须是小写的\r\n            salesRegion: this.salesRegion\r\n        }\r\n    }\r\n}\r\n\r\nexport class prizeOrderItem {\r\n    product: BoxId;\r\n    @observable pack: BoxId;\r\n    @observable quantity: any;\r\n    @observable point: any;\r\n    @observable imageUrl: any;\r\n    @observable description: any;\r\n    @observable descriptionC: any;\r\n    @observable grade: any;\r\n    @computed get subAmount() {\r\n        return this.quantity * this.point;\r\n    }\r\n}","/* eslint-disable */\r\nimport { CUqBase } from 'tapp/CBase';\r\nimport { VLottery } from './VLottery';\r\nimport { observable } from 'mobx';\r\nimport { VMyLotteryPrize } from './VMyLotteryPrize';\r\nimport { VMyPrizeExchangeOrder } from './VExchangeOrder';\r\nimport { prizeOrder, prizeOrderItem } from './prizeOrder';\r\n\r\nexport class CLottery extends CUqBase {\r\n    @observable lotteryProducts: any[] = [];        /* 抽奖产品列表 */\r\n    @observable remainingNumOfDraws: number = 1;    /* 剩余抽奖次数 */\r\n    @observable productsLib: any[] = [];            /* 抽奖产品集合（加概率） */\r\n    @observable myPrizeLib: any[] = [];             /* 我的奖品 */\r\n    @observable totalNumPrizes: number = 10000;      /* 奖品总量 */\r\n    @observable prizeOrderData: prizeOrder = new prizeOrder();\r\n\r\n    async internalStart(param?: any) { }\r\n\r\n    /**\r\n     * 抽奖界面\r\n     */\r\n    openLotteryProduct = async () => {\r\n        await this.getLotteryProducts();\r\n        await this.getLotteryNumOfDraws();\r\n        this.basedChanceHandlePrizes();\r\n        this.openVPage(VLottery);\r\n    }\r\n\r\n    /**\r\n     * 我的奖品界面\r\n     */\r\n    openMyLotteryPrize = async () => {\r\n        await this.getMyPrizes();\r\n        this.openVPage(VMyLotteryPrize);\r\n    }\r\n\r\n    /**\r\n    * 奖品领取预览界面\r\n    */\r\n    openMyPrizeOrder = async () => {\r\n        let { cPointProduct } = this.cApp;\r\n        if (this.prizeOrderData.shippingContact === undefined) {\r\n            this.prizeOrderData.shippingContact = await cPointProduct.getDefaultShippingContact();\r\n        }\r\n        this.openVPage(VMyPrizeExchangeOrder);\r\n    }\r\n\r\n    /**\r\n     * 中奖获得的产品\r\n     */\r\n    winningProduct = async (winning: any) => {\r\n        console.log('winning', winning);\r\n        await this.addMyPrize(winning);\r\n    }\r\n\r\n    /**\r\n     * 抽奖次数递减\r\n     */\r\n    decreasingNumberOfDraws = async () => {\r\n        this.remainingNumOfDraws -= 1;\r\n        // await this.uqs.积分商城.\r\n    }\r\n\r\n    /**\r\n     * 获取可抽奖次数\r\n     */\r\n    getLotteryNumOfDraws = async () => {\r\n        // this.remainingNumOfDraws = await this.uqs.积分商城.\r\n    }\r\n\r\n    /**\r\n     * 获取抽奖产品列表\r\n     */\r\n    getLotteryProducts = async () => {//PR\r\n        // this.lotteryProducts = await this.uqs.积分商城.\r\n        this.lotteryProducts = [\r\n            { id: 1, content: '111', p: '1', PR: 15 },\r\n            { id: 2, content: '222', p: '4', PR: 20 },\r\n            { id: 3, content: '333', p: '5', PR: 5 },\r\n            { id: 4, content: '444', p: '1', PR: 10 },\r\n            { id: 5, content: '555', p: '1', PR: 10 },\r\n            { id: 6, content: '666', p: '8', PR: 20 },\r\n            { id: 7, content: '777', p: '2', PR: 5 },\r\n            { id: 8, content: '888', p: '7', PR: 15 },\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * 据概率处理抽奖商品\r\n     */\r\n    basedChanceHandlePrizes = () => {\r\n        let arr = [], minPrice = this.lotteryProducts[0];\r\n        for (let key of this.lotteryProducts) {\r\n            if (minPrice.p >= key.p && minPrice.PR > key.PR) minPrice = key;\r\n            let base = key.PR * this.totalNumPrizes / 100;\r\n            arr.push(Array.from(Array(base), (v, k) => { return { productId: key.id, content: key.content } }));\r\n        }\r\n        let shift = arr.flat();\r\n        this.productsLib = shift;\r\n        let total = this.productsLib.length;\r\n\r\n        if (total !== this.totalNumPrizes) {\r\n            for (let i = 0; i < (this.totalNumPrizes - total); i++)  //找8个商品中价值最小的\r\n                this.productsLib.push({ productId: minPrice.id, content: minPrice.content });//productId 暂未定\r\n        }\r\n\r\n        //乱序\r\n        let { length } = this.productsLib, i;\r\n        while (length) {\r\n            i = (Math.random() * length--) >>> 0;\r\n            [this.productsLib[length], this.productsLib[i]] = [this.productsLib[i], this.productsLib[length]]\r\n        }\r\n\r\n        this.lotteryProducts.splice(this.lotteryProducts.length / 2, 0, {}); // 九宫格 使用\r\n    }\r\n\r\n    /**\r\n     * 抽中的产品添加至我的奖品列表   ------------------ 需uq \r\n     */\r\n    addMyPrize = async (prize: any) => {\r\n        // await this.uqs.积分商城\r\n    }\r\n\r\n    /**\r\n     * 获取我的奖品\r\n     */\r\n    getMyPrizes = async () => {\r\n        this.myPrizeLib = [];\r\n        // await this.uqs.积分商城\r\n    }\r\n\r\n    private createOrderFromCart = async () => {\r\n        let { currentUser, currentSalesRegion } = this.cApp;\r\n        this.prizeOrderData.webUser = currentUser.id;\r\n        this.prizeOrderData.salesRegion = currentSalesRegion.id;\r\n        if (currentUser.currentCustomer !== undefined) {\r\n            this.prizeOrderData.customer = currentUser.currentCustomer.id;\r\n        }\r\n\r\n        /* if (this.myPrizeLib !== undefined && this.myPrizeLib.length > 0) {\r\n            this.prizeOrderData.exchangeItems = this.myPrizeLib.map((e: any) => {\r\n                if (e.quantity > 0) {\r\n                    var item = new prizeOrderItem();\r\n                    item.product = e.id;\r\n                    item.pack = e.pack;\r\n                    item.quantity = e.quantity;\r\n                    item.point = e.point;\r\n                    return item;\r\n                }\r\n            });\r\n        } */\r\n    }\r\n\r\n    /**\r\n     * 确认领取(成功 VMyPrizeExchangeOrder 确认使用此函数)\r\n     */\r\n    submitOrder = async () => {\r\n        this.createOrderFromCart();\r\n        console.log(this.prizeOrderData);\r\n\r\n        // let PointExchangeSheet = this.uqs.积分商城.PointExchangeSheet;\r\n        // let getDataForSave = this.orderData.getDataForSave();\r\n        // let result: any = await PointExchangeSheet.save(\"PointExchangeSheet\", getDataForSave);\r\n        // let { id, flow, state } = result;\r\n        // await PointExchangeSheet.action(id, flow, state, \"submit\");\r\n\r\n\r\n        // 打开下单成功显示界面\r\n        // nav.popTo(this.cApp.topKey);\r\n        // this.openVPage(OrderSuccess, result);\r\n    }\r\n\r\n    onSelectShippingContact = async () => {\r\n        let { cPointProduct } = this.cApp;\r\n        this.prizeOrderData.shippingContact = await cPointProduct.selectContact()\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, Page, DropdownAction, DropdownActions, FA } from 'tonva';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { observable } from 'mobx';\r\nimport { signTopicMap, Homemadelogo } from 'tools/images';\r\nimport { CSignIn } from './CSignIn';\r\nimport { RevenueExpenditure } from './basicRefer';\r\nimport moment from 'moment';\r\nimport 积分图标P from 'images/积分图标P.png'\r\nimport 已签到 from 'images/已签到.png'\r\nimport { xs } from 'tools/browser';\r\nimport { CrPageHeaderTitle, pageHTitle } from 'tools/pageHeaderTitle';\r\nimport { renderDropdownActions } from './VMyPoint';\r\n\r\nexport const daysAndMultipleByWelfare = [\r\n    { id: 1, days: 7, multiple: 2 },\r\n    { id: 2, days: 15, multiple: 3 },\r\n    { id: 3, days: 30, multiple: 4 },\r\n    { id: 4, days: 180, multiple: 5 },\r\n    { id: 5, days: 365, multiple: 6 }\r\n];\r\n\r\nexport class VPointSign extends VPage<CSignIn> {\r\n    @observable showTips: any = \"none\";\r\n    rulesNum: number = 0;\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderRule = (rulesNum: any, ruleContent: any) => {\r\n        return <div key={rulesNum} className=\" mb-3 d-flex\" style={{ boxShadow: \"0px 1px 3px #333333\", borderRadius: \"8px\" }}>\r\n            <span className=\"h4 m-0 p-2  align-self-center\" style={{ borderRight: '1px dashed #cccccc' }}>\r\n                {String(rulesNum).padStart(2, '0')}\r\n            </span>\r\n            <div className=\"initialism modal-title flex-fill p-2  align-self-center\">{ruleContent}</div>\r\n        </div>\r\n    }\r\n\r\n    private demandBlock = (name: string, icon: string, color: string, action: any) => {\r\n        return <div onClick={action} className=\"w-25 text-center p-2\" style={{ color }}>\r\n            <FA name={icon} size=\"2x\" />\r\n            <div className=\"small\">{name}</div>\r\n        </div>\r\n    }\r\n\r\n    private page = observer((param: any) => {\r\n        let { isSignin, signinval, openRevenueExpenditure } = this.controller;\r\n        //let { cLottery } = cApp;\r\n        let date = moment().format('YYYY-MM-DD').split('-');\r\n        let timer = `${date[0]} 年 ${date[1]} 月 ${date[2]} 日 `;\r\n\r\n        // if (IsSignin) this.handleChange();\r\n        let actions: DropdownAction[] = [\r\n            {\r\n                icon: 'get-pocket',\r\n                caption: RevenueExpenditure.SIGNINHISTORY,\r\n                action: () => openRevenueExpenditure(RevenueExpenditure.SIGNINHISTORY)\r\n            }\r\n        ];\r\n        let right = <DropdownActions className=\"align-self-center mr-1 bg-transparent border-0 text-light\" icon=\"navicon\" actions={actions} />;\r\n        let header = CrPageHeaderTitle('签到');\r\n        if (!xs) right = null;\r\n        return <Page header={header} right={right}>\r\n            {pageHTitle('签到')}\r\n            {renderDropdownActions(actions)}\r\n            <div className=\"text-center text-light px-5 pt-5\"\r\n                style={{ background: `url(${signTopicMap}) no-repeat`, backgroundSize: \"100% 100%\" }}>\r\n                {/* <div className=\"rounded-circle mx-auto\"\r\n                    style={{ background: 'linear-gradient(#FCF4F3 15%, #EFDCD4, #CC9287, #C17162, #A93338, #A52230)', padding: '.8rem', width: '10rem', height: '10rem' }}>\r\n                    <div className=\"w-100 h-100 rounded-circle pt-3\" style={{ background: \"#A52230\" }}>\r\n                        <div className=\"small pt-2\">已连续签到</div>\r\n                        <div className=\"d-flex align-items-end justify-content-center\">\r\n                            <span className=\"font-weight-bolder display-4\">{signinConsecutiveDays} </span>\r\n                            <span className=\"mb-1 pb-2 ml-1\"> 天</span>\r\n                        </div>\r\n                    </div>\r\n                </div> */}\r\n                <div className=\"pb-5\">\r\n                    <div className=\"h4\">{timer}</div>\r\n                    {isSignin ? <>\r\n                        <img src={积分图标P} alt=\"\" className=\"h-5c\" />\r\n                        <div className=\"pt-3\">\r\n                            <span className=\"bg-white px-3 py-1 font-weight-bolder\" style={{ borderRadius: \"25px\", color: 'rgb(165,34,48)' }}>本次签到获取{signinval}分</span>\r\n                        </div>\r\n                    </>\r\n                        : <>\r\n                            <img src={已签到} alt=\"\" className=\"h-4c mb-3 mt-2\" />\r\n                            <div className=\"mb-2 h5\">今日已签到</div>\r\n                        </>\r\n                    }\r\n                    {/* <div className=\"my-4 h5\">今日已签到</div> */}\r\n                </div>\r\n                {/* <div className=\"rounded-circle mx-auto w-12c h-12c\"\r\n                    style={{ background: 'linear-gradient(#FCF4F3 15%, #EFDCD4, #CC9287, #C17162, #A93338, #A52230)', padding: '.8rem' }}>\r\n                    <div className=\"w-100 h-100 rounded-circle pt-3\" style={{ background: \"#A52230\" }}>\r\n                        <div className=\"pt-4\">已连续签到</div>\r\n                        <div className=\"d-flex align-items-end justify-content-center\">\r\n                            <span className=\"font-weight-bolder display-4\">{signinConsecutiveDays} </span>\r\n                            <span className=\"mb-1 pb-2 ml-1\"> 天</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"small\" style={{ transform: 'translateY(-30px)' }}>\r\n                    <span className=\"bg-white px-3 py-1 font-weight-bolder\" style={{ borderRadius: \"25px\", color: 'rgb(165,34,48)' }}>本次签到获取{signinval}分</span>\r\n                    <div className=\"small mt-2\">连续签到30天，可获得1次抽奖机会</div>\r\n                </div> */}\r\n            </div>\r\n            <div className=\"w-100 p-5 mt-4 d-flex justify-content-center flex-column\" >\r\n                <img src={Homemadelogo} alt=\"\" className=\"w-100 mx-auto\" style={{ opacity: .1, transform: 'skew(-10deg, 0deg)' }} />\r\n            </div>\r\n\r\n            {/* 抽奖 */}\r\n            {/* <div style={{ background: `url(${signViceMap})`, backgroundSize: \"100%\" }} className=\"h-20c\">\r\n                <div className=\"mx-5 mt-2 py-1 d-flex justify-content-center flex-wrap\" style={{ boxShadow: \"0px 1px 3px #333333\", borderRadius: \"8px\" }}>\r\n                    {this.demandBlock('抽奖', 'life-ring', '#CD6600', cLottery.openLotteryProduct)}\r\n                </div>\r\n            </div> */}\r\n\r\n            {/* 签到规则 */}\r\n            {/* <div className=\"pt-4 px-4 mt-4\">\r\n                <p className=\"text-center mb-4\"><span style={{ borderRadius: \"22px\", background: \"#D56F2B\" }} className=\"text-center py-2 px-3 text-white\">签到规则</span></p>\r\n                {this.renderRule(1, '连续签到30天，可获得1次抽奖机会')}\r\n                {this.renderRule(2, '若累计签到中断,则重新计算签到天数。')}\r\n            </div> */}\r\n\r\n            {/* <small style={{ color: 'rgb(255,192,120)' }} >连续签到{welfare.days}天，可获得{welfare.multiple}倍的积分奖励</small> */}\r\n            {/* 签到获取提示 */}\r\n            {/* <div className=\"text-left small w-100 pt-1 pl-2 position-absolute text-body\"\r\n                style={{ top: 0, left: 0, display: this.showTips }}>本次签到获取{signinval}分</div> */}\r\n        </Page >;\r\n\r\n        /* return <Page header='签到领积分' right={right}>\r\n            <div className=\"text-center \" style={{ position: \"relative\", background: \"linear-gradient(rgb(253, 98, 52), rgb(250, 51, 82))\", padding: '3rem' }}>\r\n                <div className=\"d-flex justify-content-center\" style={{ flexDirection: 'column', margin: '0 4rem' }}>\r\n                    <h2 style={{ color: 'rgb(255,192,120)' }} className=\"mb-3\">\r\n                        <FA name='diamond' /> <span className=\"text-light\"><small>x</small> {this.signinval}</span>\r\n                    </h2>\r\n                    {getSignpoint}\r\n                </div>\r\n                <div className=\"text-center text-white small w-100 p-1 alert alert-warning text-muted\" style={{\r\n                    position: \"absolute\", top: 0, left: 0, display: this.showTips\r\n                }}>本次签到获取{this.signinval}分</div>\r\n            </div>\r\n            // <div className=\"text-center my-1 p-1  bg-white\" style={{ borderBottom: \".5px solid #ccc\" }}>签到积分详情</div>\r\n            // <List items={signinPageHistory} item={{ render: renderPointRecord }} none={none} />\r\n        </Page >; */\r\n    })\r\n\r\n\t/*\r\n    protected handleChange = async () => {\r\n        this.showTips = \"\";\r\n        if (!this.showTips)\r\n            setTimeout(() => { this.showTips = \"none\"; this.controller.isSignin = false }, GLOABLE.TIPDISPLAYTIME);\r\n\t}\r\n\t*/\r\n}\r\n","/* eslint-disable */\r\nimport { CUqBase } from 'tapp/CBase';\r\nimport { observable } from 'mobx';\r\nimport { QueryPager } from 'tonva';\r\nimport { VPointSign, daysAndMultipleByWelfare } from './VPointSign';\r\nimport { VRevenueExpenditure } from './VRevenueExpenditure';\r\n\r\nconst pointBase: number = 3; /* 积分基数 */\r\n\r\nexport class CSignIn extends CUqBase {\r\n    @observable signinval: number = pointBase;         /* 签到可领积分 */\r\n    @observable signinConsecutiveDays: number = 0;     /* 连续签到天数 */\r\n    @observable isSignin: boolean = false;             /* 是否签到 */\r\n    @observable signinPageHistory: QueryPager<any>;    /* 签到记录 */\r\n\r\n    async internalStart(param?: any) { }\r\n\r\n    /**\r\n     * 签到   ------------------ 需调用连续签到天数 uq:this.getSigninConsecutiveDays --------------------\r\n     */\r\n    openPointSign = async () => {\r\n        await this.isSignined();\r\n        if (this.isSignin)\r\n            await this.addSigninSheet(47, this.signinval);\r\n        await this.getSigninConsecutiveDays();\r\n        this.openVPage(VPointSign);\r\n    }\r\n\r\n    /**\r\n    * 签到明细页面\r\n    */\r\n    openRevenueExpenditure = async (topic?: any) => {\r\n        await this.getSigninHistory();\r\n        this.openVPage(VRevenueExpenditure, topic)\r\n    }\r\n\r\n    /**\r\n     * 是否签到\r\n     */\r\n    isSignined = async () => {\r\n        let { checkIsSignin } = this.uqs.积分商城;\r\n        let res = await checkIsSignin.obj({});\r\n        this.isSignin = res.result === 0 ? true : false;\r\n    }\r\n\r\n    /**\r\n     * 签到添加积分到\r\n     */\r\n    addSigninSheet = async (customer: any, amount: any) => {\r\n        let { cPointProduct } = this.cApp;\r\n        let { Signin } = this.uqs.积分商城;\r\n        customer = this.cApp.currentUser.currentCustomer;\r\n        customer = customer ? customer : this.user.id;\r\n        await Signin.submit({ webuser: this.user.id, customer: customer, amount: amount });\r\n        await cPointProduct.refreshMypoint();\r\n        // await this.getSigninConsecutiveDays();\r\n        // await this.getSigninHistory();\r\n        // await this.getPointHistory();\r\n\r\n        /**\r\n        let result: any = await SigninSheet.save(\"SigninSheet\", { customer: customer, amount: amount });\r\n        console.log(this.cApp.currentUser);\r\n        let { id, flow, state } = result;\r\n        await SigninSheet.action(id, flow, state, \"submit\");\r\n        await Signin.submit({ webbuser: 47, customer: 47, amount: 3 });\r\n        **/\r\n    }\r\n\r\n\r\n    /**\r\n     * 获取签到记录\r\n     */\r\n    getSigninHistory = async () => {\r\n        this.signinPageHistory = new QueryPager(this.uqs.积分商城.GetPointSigninHistory, 15, 30);\r\n        this.signinPageHistory.first({});\r\n    }\r\n\r\n    /**\r\n     * 连续签到天数  webUser  ----------------------------需uq --------------------------------\r\n     */\r\n    getSigninConsecutiveDays = async () => {\r\n        // this.signinConsecutiveDays \r\n        await this.getSigninHistory();\r\n\r\n    }\r\n\r\n    /**\r\n     * 福利：连续签到 数倍积分（弃用）\r\n     */\r\n    /* multiplePointsWelfare = () => {\r\n        let arr = daysAndMultipleByWelfare;\r\n        if (this.IsSignin) this.signinConsecutiveDays += 1;\r\n        for (let i = 0; i < arr.length; i++) {\r\n            if (this.signinConsecutiveDays < arr[i].days) {\r\n                if (i === 0) this.signinval = pointBase;\r\n                else this.signinval = pointBase * arr[i - 1].multiple;\r\n                return arr[i];\r\n            } else if (this.signinConsecutiveDays >= arr[i].days && i === (arr.length - 1)) {\r\n                this.signinval = pointBase * arr[i].multiple;\r\n                return arr[i];\r\n            }\r\n        }\r\n    } */\r\n\r\n}\r\n","/* eslint-disable */\r\nimport { User } from 'tonva';\r\nimport { BoxId } from 'tonva';\r\nimport { observable, computed } from 'mobx';\r\nimport { UQs } from './uqs';\r\n\r\nexport class WebUser {\r\n    private _user: User;\r\n    id: number;\r\n    name: string;\r\n    nick?: string;\r\n    icon?: string;\r\n\r\n    @observable firstName: string;\r\n    gender: string;\r\n    salutation: string;\r\n    @observable organizationName: string;\r\n    departmentName: string;\r\n\r\n    get defaultOrganizationName(): string {\r\n        return this.organizationName ||\r\n            (this.webUserSettings &&\r\n                (\r\n                    (this.webUserSettings.invoiceInfo && this.webUserSettings.invoiceInfo.obj['title'])\r\n                    || (this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['organizationName'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['organizationName'])\r\n                )\r\n            );\r\n    }\r\n\r\n    get defaultName(): string {\r\n        return this.firstName ||\r\n            (this.webUserSettings &&\r\n                ((\r\n                    this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['name'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['name'])\r\n                )\r\n            );\r\n    }\r\n\r\n    get defaultMobile(): string {\r\n        return this.mobile ||\r\n            (this.webUserSettings &&\r\n                ((\r\n                    this.webUserSettings.shippingContact && this.webUserSettings.shippingContact.obj['mobile'])\r\n                    || (this.webUserSettings.invoiceContact && this.webUserSettings.invoiceContact.obj['mobile'])\r\n                )\r\n            );\r\n    }\r\n\r\n    telephone: string;\r\n    @observable mobile: string;\r\n    email: string;\r\n    fax: string;\r\n    address: BoxId;\r\n    addressString: string;\r\n    zipCode: string;\r\n    VIPDiscount: any;\r\n    webUserVIPCard: any;\r\n    @computed get allowOrdering() {\r\n        // 这个地方要改成相关账号吧？\r\n        return this.currentCustomer !== undefined ||\r\n            (this.mobile && this.firstName && this.organizationName);\r\n    }\r\n\r\n    private webUserSettings: any;\r\n\r\n    private uqs: UQs;\r\n\r\n\r\n    constructor(uqs: UQs) {// cUsqWebUser: CUq, cUsqCustomer: CUq) {\r\n        this.uqs = uqs;\r\n    }\r\n\r\n    setUser = async (user: User) => {\r\n\t\tif (!user) return;\r\n\t\tthis._user = user;\r\n\t\tthis.id = user.id;\r\n\t\tthis.name = user.name;\r\n\t\tthis.nick = user.nick;\r\n\t\tthis.icon = user.icon;\r\n\r\n\t\tawait this.loadWebUser();\r\n    }\r\n\r\n    private async loadWebUser() {\r\n        let { id, _user } = this;\r\n        if (this._user !== undefined) {\r\n            let { webuser: webUserTuid, salesTask } = this.uqs;\r\n            let { WebUser, WebUserContact, WebUserSetting, WebUserCustomer, WebUserBuyerAccount, RecordLogin } = webUserTuid;\r\n            let webUser = await WebUser.load(this.id);\r\n            if (webUser) {\r\n                let { firstName, gender, salutation, organizationName, departmentName } = webUser;\r\n                this.firstName = firstName;\r\n                this.gender = gender;\r\n                this.salutation = salutation;\r\n                this.organizationName = organizationName;\r\n                this.departmentName = departmentName;\r\n                this.webUserVIPCard = await webUserTuid.WebUserVIPCard.obj({ webUser: this });\r\n                if (this.webUserVIPCard !== undefined) {\r\n                    // this.VIPDiscount = await vipCardType.VIPCardTypeDiscount.query({ vipCard: this.webUserVIPCard.vipCardType })\r\n                    this.VIPDiscount = await salesTask.VIPCardDiscount.query({ coupon: this.webUserVIPCard.vipCard });\r\n                }\r\n\r\n                await RecordLogin.submit({ webUser: webUser, ip: \"\", app: \"shop\" });\r\n            }\r\n\r\n\r\n            let contact = await WebUserContact.obj({ \"webUser\": id });\r\n            if (contact) {\r\n                let { telephone, mobile, email, fax, address, addressString, zipCode } = contact;\r\n                this.telephone = telephone;\r\n                this.mobile = mobile;\r\n                this.email = email;\r\n                this.fax = fax;\r\n                this.address = address;\r\n                this.addressString = addressString;\r\n                this.zipCode = zipCode;\r\n            }\r\n\r\n            this.webUserSettings = await WebUserSetting.obj({ webUser: id }) || { webUser: id };\r\n\r\n            let value = await WebUserCustomer.obj({ webUser: id });\r\n            if (value !== undefined) {\r\n                this.currentCustomer = new Customer(value.customer, this.uqs);\r\n                await this.currentCustomer.init();\r\n            }\r\n            let accountValue = await WebUserBuyerAccount.query({ webUser: id });\r\n            let { ret: buyerAccounts } = accountValue;\r\n            if (buyerAccounts && buyerAccounts.length > 0) {\r\n                // TODO: 暂时不考虑有多个相关账号的情况\r\n                this.buyerAccount = buyerAccounts[0].buyerAccount;\r\n            }\r\n        }\r\n    }\r\n\r\n    get isLogined(): boolean {\r\n        return this._user !== undefined;\r\n    }\r\n    get hasCustomer(): boolean {\r\n        return this.currentCustomer !== undefined;\r\n    }\r\n    currentCustomer: Customer;\r\n    buyerAccount: any;\r\n\r\n    async getContacts(): Promise<any[]> {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            return await this.currentCustomer.getContacts()\r\n        }\r\n        */\r\n        return await this.uqs.webuser.WebUserContacts.table({ webUser: this.id });\r\n    }\r\n\r\n    async addContact(contactId: number) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.addContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        await this.uqs.webuser.WebUserContacts.add({ webUser: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async addContactFromAccount() {\r\n        let { firstName, organizationName, mobile, telephone, email, address, addressString } = this;\r\n        if (firstName && organizationName && mobile && address && addressString) {\r\n            let newContact = await this.uqs.customer.Contact.save(undefined, {\r\n                name: firstName,\r\n                organizationName: organizationName,\r\n                mobile: mobile,\r\n                telephone: telephone,\r\n                email: email,\r\n                address: address,\r\n                addressString: addressString\r\n            })\r\n            if (newContact) {\r\n                let { id: newContactId } = newContact;\r\n                await this.addContact(newContactId);\r\n                let newContactBox = this.uqs.customer.Contact.boxId(newContactId);\r\n                this.setDefaultShippingContact(newContactBox);\r\n            }\r\n        }\r\n    }\r\n\r\n    async delContact(contactId: number) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.delContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        await this.uqs.webuser.WebUserContacts.del({ webUser: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async getSetting() {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            return this.currentCustomer.getSetting();\r\n        }\r\n        */\r\n        return this.webUserSettings;\r\n    }\r\n\r\n    async setDefaultShippingContact(contactId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultShippingContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        this.webUserSettings.shippingContact = contactId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoiceContact(contactId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultInvoiceContact(contactId);\r\n            return;\r\n        }\r\n        */\r\n        this.webUserSettings.invoiceContact = contactId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoice(invoiceTypeId: BoxId, invoiceInfoId: BoxId) {\r\n        /*\r\n        if (this.currentCustomer !== undefined) {\r\n            await this.currentCustomer.setDefaultInvoice(invoiceTypeId, invoiceInfoId);\r\n            return;\r\n        }\r\n        */\r\n        // await this.webUserSettingMap.add({ webUser: this.id, arr1: [{ invoiceType: invoiceTypeId, invoiceInfo: invoiceInfoId }] });\r\n        this.webUserSettings.invoiceType = invoiceTypeId;\r\n        this.webUserSettings.invoiceInfo = invoiceInfoId;\r\n        this.saveDefaultSettings();\r\n    }\r\n\r\n    async saveDefaultSettings() {\r\n        await this.uqs.webuser.WebUserSetting.add(this.webUserSettings);\r\n    }\r\n\r\n\r\n    async changeWebUser(webUser: any) {\r\n        await this.uqs.webuser.WebUser.save(this.id, webUser);\r\n        await this.loadWebUser();\r\n    }\r\n\r\n    async changeWebUserContact(webUserContact: any) {\r\n        webUserContact.webUser = this.id;\r\n        await this.uqs.webuser.WebUserContact.add(webUserContact);\r\n        await this.loadWebUser();\r\n    }\r\n\r\n    async getPoints() {\r\n        return await this.uqs.积分商城.getPoints.table({ webuser: this.id });\r\n    }\r\n\r\n};\r\n\r\nexport class Customer {\r\n    private readonly uqs: UQs;\r\n    id: number;\r\n\r\n    private customerSettings: any;\r\n    Contractor: any;\r\n\r\n    constructor(customer: BoxId, uqs: UQs) {\r\n        this.id = customer.id;\r\n        this.uqs = uqs;\r\n    };\r\n\r\n    async getContacts(): Promise<any[]> {\r\n        return await this.uqs.customer.CustomerContacts.table({ customer: this.id });\r\n    }\r\n\r\n    async addContact(contactId: number) {\r\n        await this.uqs.customer.CustomerContacts.add({ customer: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async delContact(contactId: number) {\r\n        await this.uqs.customer.CustomerContacts.del({ customer: this.id, arr1: [{ contact: contactId }] });\r\n    }\r\n\r\n    async init() {\r\n        this.customerSettings = await this.uqs.customer.CustomerSetting.obj({ customer: this.id }) || { customer: this.id };\r\n        let customerContactorMap: any = await this.uqs.customer.CustomerContacts.obj({ customer: this.id });\r\n        if (customerContactorMap)\r\n            this.Contractor = customerContactorMap.contractor;\r\n    }\r\n\r\n    getSetting() {\r\n        return this.customerSettings;\r\n    }\r\n\r\n    async setDefaultShippingContact(contactId: BoxId) {\r\n        this.customerSettings.shippingContact = contactId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoiceContact(contactId: BoxId) {\r\n        this.customerSettings.invoiceContact = contactId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultInvoice(invoiceTypeId: BoxId, invoiceInfoId: BoxId) {\r\n        this.customerSettings.invoiceType = invoiceTypeId;\r\n        this.customerSettings.invoiceInfo = invoiceInfoId;\r\n        await this.setDefaultSettings();\r\n    }\r\n\r\n    async setDefaultSettings() {\r\n        await this.uqs.customer.CustomerSetting.add(this.customerSettings);\r\n    }\r\n\r\n}","/* eslint-disable */\r\nimport ReactDOM from 'react-dom';\r\nimport { User, nav, NavPage, Elements, BoxId, View, Controller, PageWebNav } from 'tonva';\r\nimport { Cart } from \"../cart/Cart\";\r\nimport { CHome } from \"../home\";\r\nimport { CCart } from \"../cart\";\r\nimport { CProduct } from \"../product\";\r\nimport { COrder } from \"../order/COrder\";\r\nimport { CProductCategory } from \"../productCategory/CProductCategory\";\r\nimport { CMember } from \"../member\";\r\nimport { CMe } from \"../me/CMe\";\r\nimport { CUqApp } from \"./CBase\";\r\nimport { VMain } from 'tapp/main';\r\nimport * as qs from 'querystringify';\r\nimport { CCoupon } from \"coupon/CCoupon\";\r\nimport { CPointProduct } from \"pointMarket/CPointProduct\";\r\nimport { CYncProjects } from \"ync/CYncProjects\";\r\nimport { CFavorites } from 'customer/CFavorites';\r\nimport { CLottery } from 'pointMarket/CLottery';\r\nimport { CSignIn } from 'pointMarket/CSignIn';\r\nimport { Product } from '../model';\r\nimport { WebUser } from 'CurrentUser';\r\nimport { GLOABLE } from 'global';\r\nimport { CSelectInvoiceContact, CSelectShippingContact } from 'customer/CSelectContact';\r\n//import { NavHeaderView, NavFooterView } from 'tapp/header';\r\nimport { CAddress } from '../customer/CAddress';\r\nimport { CInvoiceInfo } from 'customer/CInvoiceInfo';\r\n\r\nexport class CApp extends CUqApp {\r\n    private cache: Map<number, Product>;\r\n    cart: Cart;\r\n    currentSalesRegion: any;\r\n    currentLanguage: any;\r\n    currentUser: WebUser;\r\n\r\n    //get uqs(): UQs { return this._uqs as UQs };\r\n\r\n    topKey: any;\r\n\r\n    // currentCouponCode: string;\r\n    // currentCreditCode: string;\r\n\r\n    cHome: CHome;\r\n    cCart: CCart;\r\n\r\n    cProduct: CProduct;\r\n    cOrder: COrder;\r\n    cCoupon: CCoupon;\r\n    cProductCategory: CProductCategory;\r\n    cMember: CMember;\r\n    cMe: CMe;\r\n    cPointProduct: CPointProduct;\r\n    cFavorites: CFavorites;\r\n    cYncProjects: CYncProjects;\r\n    cLottery: CLottery;\r\n    cSignIn: CSignIn;\r\n    cSelectShippingContact: CSelectShippingContact;\r\n    cSelectInvoiceContact: CSelectInvoiceContact;\r\n    cAddress: CAddress;\r\n    cInvoiceInfo: CInvoiceInfo;\r\n\r\n    /*\r\n    protected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n        return new type(this);\r\n    }\r\n    */\r\n\r\n    protected async beforeStart(): Promise<boolean> {\r\n        if (await super.beforeStart() === false) return false;\r\n        this.currentSalesRegion = GLOABLE.SALESREGION_CN;\r\n        this.currentLanguage = GLOABLE.CHINESE;\r\n        this.setUser();\r\n\r\n        this.cache = new Map();\r\n        this.cart = new Cart(this);\r\n        await this.cart.init();\r\n        await this.cart.buildItems();\r\n\r\n        this.cHome = this.newC(CHome);\r\n        this.cProductCategory = this.newC<CProductCategory>(CProductCategory);\r\n        this.cProduct = this.newC(CProduct);\r\n        this.cOrder = this.newC(COrder);\r\n        this.cCart = this.newC(CCart);\r\n        this.cCoupon = this.newC(CCoupon);\r\n        this.cMember = this.newC(CMember);\r\n        this.cMe = this.newC(CMe);\r\n        this.cPointProduct = this.newC(CPointProduct);\r\n        this.cFavorites = this.newC(CFavorites);\r\n        this.cYncProjects = this.newC(CYncProjects);\r\n        this.cLottery = this.newC(CLottery);\r\n        this.cSignIn = this.newC(CSignIn);\r\n        this.cSelectShippingContact = this.newC(CSelectShippingContact);\r\n        this.cSelectInvoiceContact = this.newC(CSelectInvoiceContact);\r\n        this.cAddress = this.newC(CAddress);\r\n        this.cInvoiceInfo = this.newC(CInvoiceInfo);\r\n        await this.cSelectShippingContact.getContactList();\r\n        await this.cHome.getSlideShow();\r\n        return true;\r\n    }\r\n\r\n    protected async internalStart(params: any) {\r\n        //await super.init();\r\n        let promises: PromiseLike<void>[] = [];\r\n        promises.push(this.cProductCategory.start());\r\n        await Promise.all(promises);\r\n        // this.cMe.openMyPoint();\r\n        // this.cLottery.openLotteryProduct();\r\n        // this.cSignIn.openPointSign();\r\n\r\n        let { location } = document;\r\n        let { search, pathname } = location;\r\n        if (search) {\r\n            let query: any = qs.parse(search.toLowerCase());\r\n            switch (query.type) {\r\n                case \"privacy\":\r\n                    this.showMain();\r\n                    this.cMe.openPrivacy();\r\n                    break;\r\n                case \"product\":\r\n                    this.showMain();\r\n                    let prouductBoxId = await this.uqs.product.ProductX.boxId(query.product).assure();\r\n                    await this.cProduct.showProductDetail(prouductBoxId);\r\n                    break;\r\n                case \"coupon\":\r\n                    this.showMain();\r\n                    if (query.coupon)\r\n                        await this.cCoupon.showSharedCoupon(query);\r\n                    break;\r\n                case \"credits\":\r\n                    this.showMain();\r\n                    if (query.credits) {\r\n                        await this.cCoupon.showSharedCredits(query);\r\n                        /*\r\n                        if (query.platform === \"1\")\r\n                            await this.cPointProduct.openPointDrawing(query.credits);\r\n                        else\r\n                            await this.cCoupon.showSharedCredits(query);\r\n                        */\r\n                    }\r\n                    break;\r\n                case \"vipcard\":\r\n                    this.showMain();\r\n                    if (query.vipcard)\r\n                        await this.cCoupon.showSharedVIPCard(query);\r\n                    break;\r\n                case \"login\":\r\n                    if (!this.isLogined)\r\n                        this.cMe.showLogin(async (user: User) => {\r\n                            window.location.href = window.location.origin;\r\n                        });\r\n                    break;\r\n                case \"loginout\":\r\n                    if (this.isLogined)\r\n                        this.cMe.showLoginOut(async () => {\r\n                            window.location.href = window.location.origin;\r\n                        });\r\n                    break;\r\n                case \"productlist\":\r\n                    this.cProduct.start(query.key);\r\n                    break;\r\n                case \"me\":\r\n                    this.cMe.openMyOrders('all');\r\n                    break;\r\n                default:\r\n                    this.showMain();\r\n                    break;\r\n            }\r\n        } else {\r\n            this.showMain();\r\n            //this.openVPage(Entrance);\r\n        }\r\n    }\r\n\r\n    protected async afterStart(): Promise<void> {\r\n        await super.afterStart();\r\n        this.topKey = nav.topKey();\r\n    }\r\n\r\n    private setUser() {\r\n        this.currentUser = new WebUser(this.uqs); //this.cUqWebUser, this.cUqCustomer);\r\n        this.currentUser.setUser(this.user);\r\n    }\r\n\r\n    getPageWebNav(): PageWebNav {\r\n        if (nav.isWebNav === false) return;\r\n        let webNav = this.getWebNav();\r\n        if (webNav === undefined) return;\r\n        let { VNavHeader, VNavRawHeader, VNavFooter, VNavRawFooter, renderPageHeader } = webNav;\r\n        let navHeader: JSX.Element;\r\n        if (VNavHeader) navHeader = this.renderView(VNavHeader);\r\n        let navRawHeader: JSX.Element;\r\n        if (VNavRawHeader) navRawHeader = this.renderView(VNavRawHeader);\r\n        let navFooter: JSX.Element;\r\n        if (VNavFooter) navFooter = this.renderView(VNavFooter);\r\n        let navRawFooter: JSX.Element;\r\n        if (VNavRawFooter) navRawFooter = this.renderView(VNavRawFooter);\r\n        let ret: PageWebNav = {\r\n            navHeader,\r\n            navRawHeader,\r\n            navFooter,\r\n            navRawFooter,\r\n            renderPageHeader,\r\n        };\r\n        return ret;\r\n    }\r\n\r\n    showMain(initTabName?: string) {\r\n        this.openVPage(VMain, initTabName);\r\n        let divLogin = document.getElementById('login');\r\n        if (divLogin) {\r\n            // this.openPage(this.cCart.renderCartLabel());\r\n            this.openPage(this.cMe.renderLoginState());\r\n        }\r\n    }\r\n\r\n\r\n    getProduct(id: number | BoxId): Product {\r\n        if (!id) return;\r\n        // region, language 改变的时候，直接清cache\r\n        /*\r\n        let {currentSalesRegion, currentLanguage} = this;\r\n        if (this.salesRegion !== currentSalesRegion\r\n            || this.language != currentLanguage) {\r\n            this.cache = new Map<number, Product>();\r\n            this.salesRegion = currentSalesRegion;\r\n            this.language = currentLanguage;\r\n        }\r\n        */\r\n        if (typeof id === 'object') id = id.id;\r\n        let product = this.cache.get(id);\r\n        if (!product) {\r\n            product = new Product(this, id);\r\n            this.cache.set(id, product);\r\n        }\r\n        return product;\r\n    }\r\n\r\n    /*\r\n        // onRoute在beforeStart中调用。this.on的作用是将url和function的关系（即route)配置在导航基础结构中供使用\r\n        // 导航的基本原理是：根据当前的location.href，从配置好的route中找到匹配项，执行对应的function。\r\n        protected onRoute() {\r\n            this.on(() => {\r\n                this.showMain();\r\n            });\r\n            this.on({\r\n                '/search/:key': (params: any, queryStr: any) => {\r\n                    this.cProduct.start(params.key);\r\n                },\r\n                '/product/:id': (params: any, queryStr: any) => {\r\n                    this.cProduct.showProductDetail(params.id);\r\n                },\r\n                '/cart': () => {\r\n                    this.cCart.start();\r\n                },\r\n                '/productCategory/:id': (params: any, queryStr: any) => {\r\n                    this.cProduct.showProductDetail(params.id);\r\n                },\r\n                '/pointshop': () => {\r\n                    // 积分商城是否需要登录后才能查看？ \r\n                    this.cPointProduct.openMyPoint();\r\n                }\r\n            });\r\n        }\r\n    */\r\n    /*\r\n        protected async afterStart() {\r\n            await super.afterStart();\r\n            // elements定义div元素id与一个函数的对应关系，定义之后，\r\n            // 当在页面上存在相应id的div元素时，则执行其对应的函数，并将函数执行的结果(UI)挂载在该div上 \r\n            let elements: Elements = {\r\n                login: this.showLogin,\r\n                productlist: this.productList,\r\n                productdetail: this.productDetail,\r\n                carts: this.carts,\r\n            };\r\n    \r\n            this.hookElements(elements);\r\n    \r\n            window.onfocus = () => {\r\n                this.hookElements(elements);\r\n            }\r\n            return;\r\n        }\r\n    */\r\n    private navHome: NavPage = async (params: any) => {\r\n        await this.cHome.getSlideShow();\r\n\r\n        let promises: PromiseLike<void>[] = [];\r\n        promises.push(this.cProductCategory.start());\r\n        await Promise.all(promises);\r\n        this.showMain();\r\n    }\r\n\r\n    private navSearch: NavPage = async (params: any) => {\r\n        let promises: PromiseLike<void>[] = [];\r\n        promises.push(this.cProductCategory.start());\r\n        await Promise.all(promises);\r\n        await this.cart.buildItems();\r\n        this.cProduct.start(params?.key);\r\n    }\r\n\r\n    private navProduct: NavPage = async (params: any) => {\r\n        await this.cart.buildItems();\r\n        this.cProduct.showProductDetail(params?.id);\r\n    }\r\n\r\n    private navProductMSCU: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        this.cProduct.openMaterial(params?.type, params?.id);\r\n    }\r\n\r\n    private navCart: NavPage = async (params: any) => {\r\n        await this.cart.buildItems();\r\n        await this.cSelectShippingContact.getContactList();\r\n        await this.cCart.start();\r\n    }\r\n\r\n    private navProductCategory: NavPage = async (params: any) => {\r\n        let id = params.id;\r\n        if (id) id = Number(id);\r\n        await this.cart.buildItems();\r\n        await this.cProductCategory.showCategoryPage(id);\r\n    }\r\n\r\n    private navPointShop: NavPage = async (params: any) => {\r\n        this.cPointProduct.openMyPoint();\r\n    }\r\n\r\n    private navAbout: NavPage = async (params: any) => {\r\n        this.cMe.openAbout();\r\n    }\r\n\r\n    private navMe: NavPage = async (params: any) => {\r\n        this.cMe.start();\r\n    }\r\n\r\n    private navContactList: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        this.cMe.openContactList();\r\n    }\r\n\r\n    private navInvoice: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        this.cMe.openInvoice();\r\n    }\r\n\r\n    private navMyOrders: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        this.cMe.openMyOrders('all');\r\n    }\r\n\r\n    private navOrderDetail: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        this.cOrder.openOrderDetail(Number(params.orderId));\r\n    }\r\n\r\n    private navCouponManage: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        this.cMe.openCouponManage();\r\n    }\r\n\r\n    private navFavorites: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        this.cMe.openFavorites();\r\n    }\r\n\r\n    private navPassword: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private navMeInfo: NavPage = async (params: any) => {\r\n        await this.assureLogin();\r\n        this.cMe.openMeInfo();\r\n    }\r\n\r\n\r\n    protected onNavRoutes() {\r\n        let routes: { [route: string]: NavPage } = {\r\n            '/app': this.navHome,\r\n            '/index': this.navHome,\r\n            '/home': this.navHome,\r\n            '/search/:key': this.navSearch,\r\n            '/product/:id': this.navProduct,\r\n            '/product/mscu/:type/:id': this.navProductMSCU,\r\n            '/cart': this.navCart,\r\n            '/productCategory/:id': this.navProductCategory,\r\n            '/pointshop': this.navPointShop,\r\n            '/about': this.navAbout,\r\n            '/me': this.navMe,\r\n\r\n            '/contact': this.navContactList,\r\n            '/invoice': this.navInvoice,\r\n            '/myOrders': this.navMyOrders,\r\n            '/orderDetail/:orderId': this.navOrderDetail,\r\n            '/couponManage': this.navCouponManage,\r\n            '/favorites': this.navFavorites,\r\n            '/password': this.navPassword,\r\n            '/meInfo': this.navMeInfo,\r\n        };\r\n        nav.onNavRoutes(routes);\r\n        nav.onNavRoute(this.navHome);\r\n    }\r\n\r\n    /*\r\n    private showLogin = (element: HTMLElement) => {\r\n        ReactDOM.render(this.cMe.renderLoginState_Web(), element);\r\n    }\r\n\r\n    private productList = (element: HTMLElement) => {\r\n        // console.log(\"productlist\");\r\n\r\n        let { location } = document;\r\n        let { search } = location;\r\n        if (search) {\r\n            let query: any = qs.parse(search.toLowerCase());\r\n            let { type, key } = query;\r\n            if (type === \"search\") {\r\n                ReactDOM.render(this.cProduct.renderProductList(key), element);\r\n            }\r\n        }\r\n    }\r\n\r\n    private productDetail = async (element: HTMLElement) => {\r\n        // console.log(\"productDetail\");\r\n\r\n        let { location } = document;\r\n        let { pathname } = location;\r\n        if (pathname) {\r\n            // console.log(pathname);\r\n            let productid = pathname.split('/')[2];\r\n            // console.log(productid);\r\n            if (productid) {\r\n                ReactDOM.render(await this.cProduct.renderProductWeb(productid), element);\r\n            }\r\n        }\r\n    }\r\n\r\n    private carts = (element: HTMLElement) => {\r\n        console.log(\"carts\");\r\n        //element.innerText = \"hello\";\r\n        let { location } = document;\r\n        let { pathname } = location;\r\n        if (pathname) {\r\n            console.log(pathname);\r\n            ReactDOM.render(this.cCart.tab(), element);\r\n        }\r\n    }\r\n    */\r\n\r\n    async assureLogin(): Promise<void> {\r\n        if (this.isLogined) return;\r\n        return new Promise<void>((resolve, reject) => {\r\n            let loginCallback = async (user: User) => {\r\n                if (user) {\r\n                    await this.currentUser.setUser(user);\r\n                    await this.loginCallBack(user);\r\n                }\r\n                if (this.isWebNav) {\r\n                    window.history.back();\r\n                }\r\n                else {\r\n                    this.closePage(1);\r\n                }\r\n                resolve();\r\n            };\r\n            nav.showLogin(loginCallback, true);\r\n        });\r\n    }\r\n\r\n    async loginCallBack(user: User) {\r\n        /*\r\n        if (this.cartService.isLocal) {\r\n            let cartLocal = { ...this.cartViewModel } as CartViewModel;\r\n            // this.cartService.clear(this.cartViewModel);\r\n            this.cartService = CartServiceFactory.getCartService(this);\r\n            this.cartViewModel = await this.cartService.load();\r\n            // this.cartViewModel = await this.cartService.merge(cartLocal);\r\n        }\r\n        */\r\n    }\r\n    /*\r\n    renderHeader = () => {\r\n        return this.renderView(NavHeaderView);\r\n    }\r\n\r\n    renderFooter = () => {\r\n        return this.renderView(NavFooterView);\r\n    }\r\n    */\r\n\r\n    protected onDispose() {\r\n        this.cart.dispose();\r\n    }\r\n}\r\n","/* eslint-disable */\r\nimport * as React from 'react';\r\nimport { VPage, Ax, FA, View, A, Image } from 'tonva';\r\nimport { CApp } from './CApp';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport class VMainWebNav extends VPage<CApp> {\r\n    content() {\r\n        let { cHome } = this.controller;\r\n        return cHome.tab.content();\r\n    }\r\n}\r\n\r\nexport class NavHeaderView extends View<CApp> {\r\n    private searchKey: HTMLInputElement;\r\n    render() {\r\n        let vLogin = React.createElement(() => {\r\n            let { user } = this.controller;\r\n            let v: any;\r\n            if (!user) {\r\n                v = <>\r\n                    <A className=\"\" href=\"/register\" target=\"_self\">注册</A>/\r\n                    <A className=\"\" href=\"/login\" target=\"_self\">登录</A>\r\n                </>;\r\n            }\r\n            else {\r\n                let { name, nick, icon } = user;\r\n                let Avatar: JSX.Element = !icon ? <FA name=\"user\" size=\"lg\" className=\"text-primary\" /> : <Image className=\"w-1c h-1c\" src={icon} />\r\n                v = <>\r\n                    <A className=\"mr-2 nav-item dropdown\" href=\"/me\" target=\"_self\">\r\n                        {Avatar}\r\n                        {/* <FA name=\"user\" size=\"lg\" className=\"text-primary\" /> */}\r\n                        <span className=\"dropdown-menu dropdown-menu-right px-2\">{nick || name}</span>\r\n                    </A>\r\n                    {/* <A className=\"mr-2\" href=\"/me\" target=\"_self\">{nick || name}</A> */}\r\n                    <A className=\"mr-2\" href=\"/logout\" target=\"_self\">退出</A>\r\n                </>;\r\n            }\r\n            return <span className=\"small\">{v}</span>;\r\n        });\r\n        let vCartLabel = React.createElement(observer(() => {\r\n            let { cart } = this.controller;\r\n            if (!cart) return null;\r\n            let count = cart.count.get();\r\n            let vCount: any;\r\n            if (count) vCount = <u>{count}</u>;\r\n            //if (!count) count = undefined;\r\n            return <Ax className=\"mr-3 text-primary jk-cart position-relative\" href=\"/cart\">\r\n                <FA name=\"shopping-cart\" />{vCount}\r\n            </Ax>;\r\n        }));\r\n\r\n        return <header>\r\n            <div className=\"top-header\">\r\n                <div className=\"container\">\r\n                    <div className=\"row\">\r\n                        <div className=\"col-auto ml-auto d-flex align-items-center\">\r\n                            <div className=\"phone mr-2 small\">\r\n                                <img src=\"/images/Phone.svg\" /> 400-666-7788\r\n                            </div>\r\n                            <a className=\"small mr-2\" data-toggle=\"modal\" data-target=\"#choosecountry\">\r\n                                中国\r\n\t\t\t\t\t\t\t</a>\r\n                            {vCartLabel}\r\n                            {vLogin}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div >\r\n\r\n            <nav className=\"navbar navbar-expand-lg\">\r\n                <div className=\"container\">\r\n                    <A href=\"/home\" className=\"header-logo\"><img src=\"/images/logo.svg\" alt=\"logo\" className=\"img-fluid\" /></A>\r\n                    <div className=\"justify-content-center search-wrap\">\r\n                        <ul className=\"d-none d-lg-flex top-list justify-content-center\">\r\n                            <li><a href=\"#\">特惠活动</a> </li>\r\n                            <li><a href=\"#\">结构检索</a> </li>\r\n                            <li><a href=\"#\">订单查询</a> </li>\r\n                            <li><a href=\"/product/mscu/COA/D\" target=\"_blank\">COA</a> </li>\r\n                            <li><a href=\"/product/mscu/MSDS/D\" target=\"_blank\">SDS</a> </li>\r\n                        </ul>\r\n                        <div className=\"custom-search-input\">\r\n                            <div className=\"input-group col-md-12\">\r\n                                <form className=\"w-100\" onSubmit={(e: any) => {\r\n                                    e.preventDefault();\r\n                                    let url = \"/search/\" + this.searchKey.value;\r\n                                    this.navigate(url);\r\n                                }}>\r\n                                    <input type=\"text\" ref={v => this.searchKey = v} className=\"search-query form-control\" placeholder=\"Search\" />\r\n                                </form>\r\n                                <span className=\"input-group-btn\" onClick={() => {\r\n                                    let url = \"/search/\" + this.searchKey.value;\r\n                                    this.navigate(url);\r\n                                }}>\r\n                                    <button className=\"btn\" type=\"button\">\r\n                                        <img src=\"/images/magnifier.svg\" />\r\n                                    </button>\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <a href=\"#\" className=\"display-mobile-block-login display-mobile\">登入</a>\r\n\r\n                    <button className=\"navbar-toggle navbar-toggler navbar-toggler-right collapsed\" type=\"button\" data-toggle=\"collapse\"\r\n                        data-target=\"#navbarResponsive\" aria-controls=\"navbarResponsive\" aria-expanded=\"false\"\r\n                        aria-label=\"Toggle navigation\">\r\n                        <span className=\"bar1\"></span>\r\n                        <span className=\"bar2\"></span>\r\n\r\n                        <span className=\"bar3\"></span>\r\n                    </button>\r\n                    <div className=\"collapse navbar-collapse\" id=\"navbarResponsive\">\r\n                        <ul className=\"navbar-nav ml-auto\">\r\n                            <li className=\"nav-item dropdown\">\r\n                                <a className=\"nav-link dropdown-toggle\" href=\"#\" data-toggle=\"dropdown\" aria-haspopup=\"true\"\r\n                                    aria-expanded=\"false\">\r\n                                    产品\r\n                                </a>\r\n                                <div className=\"dropdown-menu dropdown-menu-right\" aria-labelledby=\"navbarDropdownPortfolio\">\r\n                                    <a className=\"dropdown-item\" href=\"/productCategory/7\">有机化学</a>\r\n                                    <a className=\"dropdown-item\" href=\"/productCategory/430\">分析化学</a>\r\n                                    <a className=\"dropdown-item\" href=\"/productCategory/986\">生命科学</a>\r\n                                    <a className=\"dropdown-item\" href=\"/productCategory/1214\">材料科学</a>\r\n                                    <a className=\"dropdown-item\" href=\"/productCategory/#\">仪器耗材</a>\r\n                                </div>\r\n                            </li>\r\n                            <li className=\"nav-item dropdown\">\r\n                                <a className=\"nav-link dropdown-toggle\" href=\"#\" data-toggle=\"dropdown\" aria-haspopup=\"true\"\r\n                                    aria-expanded=\"false\">\r\n                                    服务\r\n                                </a>\r\n                                <div className=\"dropdown-menu dropdown-menu-right\" aria-labelledby=\"navbarDropdownBlog\">\r\n                                    <a className=\"dropdown-item\" href=\"/myOrders\">订单查询</a>\r\n                                    <a className=\"dropdown-item\" href=\"/pointshop\">积分查询</a>\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n        </header>\r\n    }\r\n}\r\n\r\n/*\r\nexport class NavFooter extends React.Component {\r\n    render() {\r\n        return <div className=\"d-none d-sm-block bg-light pt-3\">\r\n            <div className=\"container\">\r\n                <div className=\"row\">\r\n                    <div className=\"col-lg-3 col-xs-6\">\r\n                        <img src={footer_logo} />\r\n                        <p className=\"mt-lg-3\">促进科技与工业<br />\r\n                                发展，造福人类</p>\r\n                        <img src={qrcode} className=\"w-100 mt-lg-50 qrcode\" />\r\n                    </div>\r\n                    <div className=\"col-lg-3 col-xs-6\">\r\n                        <div className=\"footer-title\">百灵威集团</div>\r\n                        <ul>\r\n                            <li><a href=\"#\">公司简介</a></li>\r\n                            <li><a href=\"#\">企业承诺</a></li>\r\n                            <li><a href=\"#\">合作品牌</a></li>\r\n                            <li><a href=\"#\">招贤纳士</a></li>\r\n\r\n                        </ul>\r\n                    </div>\r\n                    <div className=\"col-lg-3 col-xs-6\">\r\n                        <div className=\"font-weight-bold\">浏览</div>\r\n                        <ul>\r\n                            <li><a href=\"#\">资讯中心</a></li>\r\n                            <li><a href=\"#\">质量证书(COA)</a></li>\r\n                            <li><a href=\"#\">安全说明书(SDS)</a></li>\r\n                            <li><a href=\"#\">大包装与定制生产</a></li>\r\n                            <li><a href=\"#\">订购指南</a></li>\r\n                            <li><a href=\"#\">产品</a></li>\r\n                            <ul>\r\n                                <li><a href=\"#\">有机化学</a></li>\r\n                                <li><a href=\"#\">分析化学</a></li>\r\n                                <li><a href=\"#\">生命科学</a></li>\r\n                                <li><a href=\"#\">材料科学</a></li>\r\n                                <li><a href=\"#\">仪器耗材</a></li>\r\n                            </ul>\r\n                        </ul>\r\n                    </div>\r\n                    <div className=\"col-lg-3 col-xs-6\">\r\n                        <div className=\"footer-title\">联系我们</div>\r\n                        <div className=\"contact \">\r\n                            电话：<br />400-666-7788<br />+86 10 8284 8833\r\n                            </div>\r\n                        <div className=\"contact mt-lg-28 mb-lg-58\">\r\n                            传真：<br />+86 10 8284 9933\r\n                            </div>\r\n                        <div className=\"contact mb-lg-2\">\r\n                            电子邮件：<br />\r\n                            <a href=\"mailto:jkinfo@jkchemical.com\">jkinfo@jkchemical.com</a><br /><a href=\"mailto:jkinfo@jk-sci.com\">jkinfo@jk-sci.com</a>\r\n                        </div>\r\n                        <div className=\"footer-social\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"footer-bottom\">\r\n                <div className=\"container\">\r\n                    <div className=\"row text-center\">\r\n                        <div className=\"col-sm\">© 2020 - Copyright <a href=\"#\">J&K Scientific Ltd., All Rights Reserved</a></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div >\r\n    }\r\n}\r\n*/\r\n\r\n\r\nexport class NavFooterView extends View<CApp> {\r\n    render() {\r\n        return <div className=\"d-none d-sm-block bg-light pt-4 reset-z-footer-bg\">\r\n            <div className=\"container reset-z-ul reset-z-ul-a\">\r\n                <div className=\"row reset-z-footer-title reset-z-contact\">\r\n                    <div className=\"col-lg-3 col-xs-6\">\r\n                        <img src=\"/images/footer-logo.svg\" />\r\n                        <p className=\"mt-lg-3\" style={{ fontSize: 12 }}>促进科技与工业<br />\r\n                                发展，造福人类</p>\r\n                        <img src=\"/images/qrcode.png\" className=\"w-75 mt-lg-28 qrcode\" />\r\n                    </div>\r\n                    <div className=\"col-lg-3 col-xs-6\">\r\n                        <div className=\"footer-title\">百灵威集团</div>\r\n                        <ul>\r\n                            <li><a href=\"https://web.jkchemical.com/ch/about\">公司简介</a></li>\r\n                            <li><a href=\"https://web.jkchemical.com/ch/promise\">企业承诺</a></li>\r\n                            <li><a href=\"https://www.jkchemical.com/brand.aspx?language=ch\" target=\"_blank\">合作品牌</a></li>\r\n                            <li><a href=\"https://web.jkchemical.com/job\" target=\"_blank\">招贤纳士</a></li>\r\n                        </ul>\r\n                    </div>\r\n                    <div className=\"col-lg-3 col-xs-6\">\r\n                        <div className=\"font-weight-bold\">浏览</div>\r\n                        <ul>\r\n                            <li><a href=\"https://web.jkchemical.com/information\" target=\"_blank\">资讯中心</a></li>\r\n                            <li><a href=\"#\">质量证书(COA)</a></li>\r\n                            <li><a href=\"#\">安全说明书(SDS)</a></li>\r\n                            <li><a href=\"#\">大包装与定制生产</a></li>\r\n                            <li><a href=\"#\">订购指南</a></li>\r\n                            <li><a href=\"#\">产品</a></li>\r\n                            <ul>\r\n                                <li><a href=\"/productCategory/7\">有机化学</a></li>\r\n                                <li><a href=\"/productCategory/430\">分析化学</a></li>\r\n                                <li><a href=\"/productCategory/986\">生命科学</a></li>\r\n                                <li><a href=\"/productCategory/1214\">材料科学</a></li>\r\n                                <li><a href=\"/productCategory/#\">仪器耗材</a></li>\r\n                            </ul>\r\n                        </ul>\r\n                    </div>\r\n                    <div className=\"col-lg-3 col-xs-6\">\r\n                        <div className=\"footer-title\">联系我们</div>\r\n                        <div className=\"contact \">\r\n                            电话：<br />400-666-7788<br />+86 10 8284 8833\r\n                            </div>\r\n                        <div className=\"contact mt-lg-28 mb-lg-58\">\r\n                            传真：<br />+86 10 8284 9933\r\n                            </div>\r\n                        <div className=\"contact mb-lg-2\">\r\n                            电子邮件：<br />\r\n                            <a href=\"mailto:jkinfo@jkchemical.com\">jkinfo@jkchemical.com</a><br />\r\n                            <a href=\"mailto:jkinfo@jk-sci.com\">jkinfo@jk-sci.com</a>\r\n                        </div>\r\n                        <div className=\"footer-social\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"footer-bottom mt-2 py-1\">\r\n                <div className=\"container\">\r\n                    <div className=\"row text-center\">\r\n                        <div className=\"col-sm\">© 2020 - Copyright <a href=\"#\">J&K Scientific Ltd., All Rights Reserved</a></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div >\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { CAppBase, nav, NavView, WebNav } from 'tonva';\r\nimport { CApp } from \"./CApp\";\r\nimport { NavHeaderView, NavFooterView } from './webNav';\r\nimport { VMainWebNav } from './webNav';\r\n\r\n\r\nexport class CWeb extends CApp {\r\n\r\n    //protected abstract async onPageStart(params:any):Promise<void>;\r\n\r\n    get webNav(): WebNav<any> {\r\n        return {\r\n            VNavRawHeader: NavHeaderView,\r\n            VNavRawFooter: NavFooterView,\r\n        }\r\n    }\r\n\r\n    protected beforeInit() {\r\n        nav.setIsWebNav();\r\n    }\r\n\r\n    protected afterInit() {\r\n        if (!nav.isMobile) {\r\n            nav.pageWebNav = this.pageWebNav;\r\n        }\r\n    }\r\n\r\n    protected async afterStart(): Promise<void> {\r\n        await super.afterStart();\r\n        this.topKey = nav.topKey();\r\n        nav.resolveRoute();\r\n    }\r\n\r\n    protected async internalStart(params: any) {\r\n        //await super.init();\r\n        /*\r\n        this.cart = new Cart(this);\r\n        await this.cart.init();\r\n\r\n        this.cHome = this.newC(CHome);\r\n        this.cProductCategory = this.newC<CProductCategory>(CProductCategory);\r\n        this.cProduct = this.newC(CProduct);\r\n        this.cOrder = this.newC(COrder);\r\n        this.cCart = this.newC(CCart);\r\n        this.cCoupon = this.newC(CCoupon);\r\n        this.cMember = this.newC(CMember);\r\n        this.cMe = this.newC(CMe);\r\n        this.cPointProduct = this.newC(CPointProduct);\r\n        this.cFavorites = this.newC(CFavorites);\r\n        this.cYncProjects = this.newC(CYncProjects);\r\n        this.cLottery = this.newC(CLottery);\r\n        this.cSignIn = this.newC(CSignIn);\r\n        */\r\n        /*\r\n        await this.cHome.getSlideShow();\r\n\r\n        let promises: PromiseLike<void>[] = [];\r\n        promises.push(this.cProductCategory.start());\r\n        await Promise.all(promises);\r\n        // this.cMe.openMyPoint();\r\n        // this.cLottery.openLotteryProduct();\r\n        // this.cSignIn.openPointSign();\r\n\r\n        let { location } = document;\r\n        let { search, pathname } = location;\r\n        if (search) {\r\n            let query: any = qs.parse(search.toLowerCase());\r\n            switch (query.type) {\r\n                case \"privacy\":\r\n                    this.showMain();\r\n                    this.cMe.openPrivacy();\r\n                    break;\r\n                case \"product\":\r\n                    this.showMain();\r\n                    let prouductBoxId = await this.uqs.product.ProductX.boxId(query.product).assure();\r\n                    await this.cProduct.showProductDetail(prouductBoxId);\r\n                    break;\r\n                case \"coupon\":\r\n                    this.showMain();\r\n                    if (query.coupon)\r\n                        await this.cCoupon.showSharedCoupon(query);\r\n                    break;\r\n                case \"credits\":\r\n                    this.showMain();\r\n                    if (query.credits) {\r\n                        await this.cCoupon.showSharedCredits(query);\r\n                        //if (query.platform === \"1\")\r\n                        //    await this.cPointProduct.openPointDrawing(query.credits);\r\n                        //else\r\n                        //    await this.cCoupon.showSharedCredits(query);\r\n                    }\r\n                    break;\r\n                case \"vipcard\":\r\n                    this.showMain();\r\n                    if (query.vipcard)\r\n                        await this.cCoupon.showSharedVIPCard(query);\r\n                    break;\r\n                case \"login\":\r\n                    if (!this.isLogined)\r\n                        this.cMe.showLogin(async (user: User) => {\r\n                            window.location.href = window.location.origin;\r\n                        });\r\n                    break;\r\n                case \"loginout\":\r\n                    if (this.isLogined)\r\n                        this.cMe.showLoginOut(async () => {\r\n                            window.location.href = window.location.origin;\r\n                        });\r\n                    break;\r\n                case \"productlist\":\r\n                    this.cProduct.start(query.key);\r\n                    break;\r\n                case \"me\":\r\n                    this.cMe.openMyOrders('all');\r\n                    break;\r\n                default:\r\n                    this.showMain();\r\n                    break;\r\n            }\r\n        } else {\r\n            this.showMain();\r\n            //this.openVPage(Entrance);\r\n        }*/\r\n        //let n = nav;\r\n        //this.topKey = nav.topKey();\r\n        //await this.onPageStart(params);\r\n        // nav.resolveRoute();\r\n    }\r\n\r\n    showMain() {\r\n        this.openVPage(VMainWebNav);\r\n    }\r\n}\r\n\r\n/*\r\nexport function renderDom(div: any) {\r\n    ReactDOM.render(\r\n        <React.StrictMode>\r\n            {div}\r\n        </React.StrictMode>,\r\n        document.getElementById('root')\r\n    );\r\n}\r\n\r\nexport function renderCApp(AppClass : new() => CAppBase, param?: any, ...params: any[]) {\r\n    const App: React.FC = () => {\r\n        const onLogined = async () => {\r\n            let cApp = new AppClass();\r\n            cApp.init();\r\n            await cApp.start(param, params);\r\n        }\r\n        return <NavView onLogined={onLogined} notLogined={onLogined} />;\r\n    }\r\n    renderDom(<App />);\r\n}\r\n*/","/* eslint-disable */\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\n//import './css/style.css';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport './index.css';\r\nimport { NavView, start, nav, startPage } from 'tonva';\r\nimport { appConfig } from 'configuration';\r\nimport './App.css';\r\nimport 'antd/dist/antd.css';\r\nimport { CApp, CWeb } from './tapp';\r\n//import logo from './logo.svg';\r\n\r\n/*\r\nlet elRoot = document.getElementById('root');\r\nif (!elRoot) {\r\n\telRoot = document.createElement('div');\r\n\telRoot.style.display = 'none';\r\n\tdocument.body.append(elRoot);\r\n}\r\nReactDOM.render(<App />, elRoot);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n*/\r\n\r\n//let { location } = document;\r\n//if (location.host && false) {\r\n\r\n(async function() {\r\n\tnav.setSettings(appConfig);\r\n\tlet onLogined: () => Promise<void>;\r\n\r\n\tif (nav.isMobile || window.location.pathname.endsWith('/app')) {\r\n\t\trequire('style-loader!./css/style.css');\r\n\t\trequire('style-loader!./css/rst.css');\r\n\t\tonLogined = async () => {\r\n\t\t\tawait start(CApp, appConfig);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\trequire('style-loader!./css/style.css');\r\n\t\tonLogined = async () => {\r\n\t\t\tawait startPage(CWeb, appConfig);\r\n\t\t};\r\n\t}\r\n\r\n\tconst App: React.FC = () => {\r\n\t\treturn <NavView onLogined={onLogined} notLogined={onLogined} />;\r\n\t}\r\n\r\n\tReactDOM.render(\r\n\t\t<React.StrictMode>\r\n\t\t\t<App />\r\n\t\t</React.StrictMode>,\r\n\t\tdocument.getElementById('root')\r\n\t);\r\n\t// If you want your app to work offline and load faster, you can change\r\n\t// unregister() to register() below. Note this comes with some pitfalls.\r\n\t// Learn more about service workers: https://bit.ly/CRA-PWA\r\n\tserviceWorker.unregister();\r\n})();\r\n"],"sourceRoot":""}